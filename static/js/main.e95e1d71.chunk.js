(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{10:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return u}));var s=n(41),i=n(60),a=n(98);const r=s.ab.create({position:i.a.TOP}),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=arguments.length>2?arguments[2]:void 0;return r.show({intent:a.a.SUCCESS,message:e,timeout:t},n)},c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=arguments.length>2?arguments[2]:void 0;return r.show({intent:a.a.WARNING,message:e,timeout:t},n)},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=arguments.length>2?arguments[2]:void 0;return r.show({intent:a.a.DANGER,message:e,timeout:t},n)},d=(e,t)=>r.show(e,t),u=e=>r.dismiss(e)},102:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lineTreeToString=t.stringDagToSingleLine=t.stringDagToLineTree=t.valueToStringDag=t.typeToString=t.stringify=void 0;const s=n(271),i=n(332);function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{_next:0};function n(e){return a(e,t)}switch(e.kind){case"primitive":return e.name;case"variable":return e.constraint&&"none"!==e.constraint?e.constraint:(e.name in t||(t[e.name]="T"+t._next++),t[e.name]);case"list":return`List<${n(e.elementType)}>`;case"array":return`Array<${n(e.elementType)}>`;case"pair":const s=n(e.headType);return"list"===e.tailType.kind&&s===n(e.tailType.elementType)?`List<${s}>`:`[${n(e.headType)}, ${n(e.tailType)}]`;case"function":let i=e.parameterTypes.map(n).join(", ");return 1===e.parameterTypes.length&&"function"!==e.parameterTypes[0].kind||(i=`(${i})`),`${i} -> ${n(e.returnType)}`;default:return"Unable to infer type"}}function r(e){const t=new Map,n=new Map;function i(e,s,i,a){const o=n.get(e);if(void 0!==o)return[o,!1];t.set(e,t.size);const c=s.map(r);let l=i.length+a.length+2*Math.max(0,c.length-1),d=!1;for(let t=0;t<c.length;t++)null==c[t]&&(c[t]=r(void 0)),l+=c[t][0].length,d||(d=c[t][1]);t.delete(e);const u={type:"arraylike",elems:c.map((e=>e[0])),prefix:i,suffix:a,length:l};return d||n.set(e,u),[u,d]}function a(e){const t=e.split("\n");return 1===t.length?[{type:"terminal",str:t[0],length:t[0].length},!1]:[{type:"multiline",lines:t,length:1/0},!1]}function r(e){if(null===e)return[{type:"terminal",str:"null",length:4},!1];if(void 0===e)return[{type:"terminal",str:"undefined",length:9},!1];if(t.has(e))return[{type:"terminal",str:"...<circular>",length:13},!0];if("string"===typeof e){const t=JSON.stringify(e);return[{type:"terminal",str:t,length:t.length},!1]}return"object"!==typeof e?a(e.toString()):t.size>s.MAX_LIST_DISPLAY_LENGTH?[{type:"terminal",str:"...<truncated>",length:14},!1]:"function"===typeof e.toReplString?a(e.toReplString()):Array.isArray(e)?2===e.length?function(e){const s=n.get(e);if(void 0!==s)return[s,!1];t.set(e,t.size);const i=e,[a,o]=r(i[0]),[c,l]=r(i[1]),d=o||l;t.delete(e);const u={type:"pair",head:a,tail:c,length:a.length+c.length+4};return d||n.set(e,u),[u,d]}(e):i(e,e,"[","]"):function(e){return"string"===typeof e.replPrefix&&"string"===typeof e.replSuffix&&"function"===typeof e.replArrayContents}(e)?i(e,e.replArrayContents(),e.replPrefix,e.replSuffix):Object.getPrototypeOf(e)===Object.prototype?function(e){const s=n.get(e);if(void 0!==s)return[s,!1];t.set(e,t.size);const i=Object.entries(e),a=i.map((e=>r(e[1])));let o=2+2*Math.max(0,i.length-1)+2*i.length,c=!1;const l=[];for(let t=0;t<a.length;t++)o+=i[t][0].length,o+=a[t].length,c||(c=a[t][1]),l.push({type:"kvpair",key:i[t][0],value:a[t][0],length:a[t][0].length+i[t][0].length});t.delete(e);const d={type:"arraylike",elems:l,prefix:"{",suffix:"}",length:o};return c||n.set(e,d),[d,c]}(e):a(e.toString())}return r(e)[0]}function o(e,t,n){const s="["+" ".repeat(Math.max(0,t-1)),i=new Map;return function e(a){const r=i.get(a);if(void 0!==r)return r;let o;if("terminal"===a.type)o={type:"line",line:a};else if("multiline"===a.type)o={type:"block",prefixFirst:"",prefixRest:"",block:a.lines.map((e=>({type:"line",line:{type:"terminal",str:e,length:e.length}}))),suffixRest:"",suffixLast:""};else if("pair"===a.type){const t=e(a.head),i=e(a.tail);o=a.length-2>n||"line"!==t.type||"line"!==i.type?{type:"block",prefixFirst:s,prefixRest:"",block:[t,i],suffixRest:",",suffixLast:"]"}:{type:"line",line:a}}else if("arraylike"===a.type){const s=a.elems.map(e);o=a.length-a.prefix.length-a.suffix.length>n||s.some((e=>"line"!==e.type))?{type:"block",prefixFirst:a.prefix+" ".repeat(Math.max(0,t-a.prefix.length)),prefixRest:" ".repeat(Math.max(a.prefix.length,t)),block:s,suffixRest:",",suffixLast:a.suffix}:{type:"line",line:a}}else{if("kvpair"!==a.type)throw"up";{const t=e(a.value);o=a.length>n||"line"!==t.type?{type:"block",prefixFirst:"",prefixRest:"",block:[{type:"line",line:{type:"terminal",str:JSON.stringify(a.key),length:0}},t],suffixRest:":",suffixLast:""}:{type:"line",line:a}}}return i.set(a,o),o}(e)}function c(e){return function e(t,n){if("multiline"===t.type)throw"Tried to format multiline string as single line string";if("terminal"===t.type)n.push(t.str);else if("pair"===t.type)n.push("["),e(t.head,n),n.push(", "),e(t.tail,n),n.push("]");else if("kvpair"===t.type)n.push(JSON.stringify(t.key)),n.push(": "),e(t.value,n);else if("arraylike"===t.type){n.push(t.prefix),t.elems.length>0&&e(t.elems[0],n);for(let s=1;s<t.elems.length;s++)n.push(", "),e(t.elems[s],n);n.push(t.suffix)}return n}(e,[]).join("")}function l(e){let t="";const n=new Map,s=new Map;return function e(i,a){const r=s.get(i);if(void 0!==r){const e=r.get(a.length);if(void 0!==e)return void(t+=t.substring(e[0],e[1]))}const o=t.length;if("line"===i.type)n.has(i.line)||n.set(i.line,c(i.line)),t+=n.get(i.line);else if("block"===i.type){t+=i.prefixFirst;const n=a+" ".repeat(i.prefixFirst.length),s=a+i.prefixRest;e(i.block[0],n);for(let a=1;a<i.block.length;a++)t+=i.suffixRest,t+=s,e(i.block[a],s);t+=i.suffixLast}const l=t.length;if(void 0===r){const e=new Map;e.set(a.length,[o,l]),s.set(i,e)}else r.set(a.length,[o,l])}(e,"\n"),t}t.stringify=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:80;if(e=(0,i.forceIt)(e),"string"===typeof t)throw"stringify with arbitrary indent string not supported";let s=t;return t>10&&(s=10),l(o(r(e),s,n))},t.typeToString=function(e){return a(e)},t.valueToStringDag=r,t.stringDagToLineTree=o,t.stringDagToSingleLine=c,t.lineTreeToString=l},104:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c}));const s="CHANGE_QUERY_STRING",i="GENERATE_LZ_STRING",a="SHORTEN_URL",r="UPDATE_SHORT_URL",o="PLAYGROUND_UPDATE_GITHUB_SAVE_INFO",c="PLAYGROUND_UPDATE_PERSISTENCE_FILE"},105:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(116),i=(n(1),n(12)),a=n(0);const r=e=>{let{handleReplOutputClear:t}=e;return Object(a.jsx)(i.a,{label:"Clear",icon:s.a.REMOVE,onClick:t})}},106:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n(116),i=n(265),a=(n(1),n(12)),r=n(0);const o=e=>{let{handleReplEval:t,isRunning:n}=e;return n?null:Object(r.jsx)(i.a,{content:"...or press shift-enter in the REPL",children:Object(r.jsx)(a.a,{label:"Eval",icon:s.a.CODE,onClick:t})})}},107:function(e,t,n){"use strict";var s=n(1171),i=n(266),a=n(1),r=n.n(a),o=n(24),c=n(250),l=n(94),d=n(251),u=n(262),h=n(41),p=n(19),g=n.n(p),m=n(0);var b=e=>{const{tabs:t,isExpanded:n,expandSideBar:s,collapseSideBar:i}=e,[a,o]=r.a.useState(0);return 0===t.length?Object(m.jsx)("div",{className:"sidebar-container"}):Object(m.jsxs)("div",{className:"sidebar-container",children:[Object(m.jsx)("div",{className:"tab-container",children:t.map(((e,t)=>Object(m.jsxs)(h.e,{className:g()("tab",{selected:n&&a===t}),onClick:()=>{var e;a!==(e=t)?(o(e),s()):n?i():s()},children:[Object(m.jsx)(h.w,{className:"tab-icon",icon:e.iconName,size:14}),e.label]},t)))}),null!==a&&Object(m.jsx)(h.e,{className:"panel",children:t[a].body})]})},f=n(265),v=n(253);var y=n(171),j=n(23);var x=a.memo((e=>{let{selectedTabId:t,renderActiveTabPanelOnly:n,editorWidth:s,sideContentHeight:i,...a}=e;return Object(m.jsx)(y.a,{...a,renderFunction:(e,r)=>Object(m.jsx)("div",{className:"side-content",children:Object(m.jsx)(h.e,{children:Object(m.jsx)("div",{className:"side-content-tabs",children:Object(m.jsx)(h.V,{id:"side-content-tabs",onChange:r,renderActiveTabPanelOnly:n,selectedTabId:t,children:e.map((e=>((e,t,n,s)=>{const i=void 0===e.id||e.id===j.b.module?e.label:e.id;var a;const r={id:i,title:Object(m.jsx)(f.a,{content:e.label,children:Object(m.jsx)("div",{className:(a=e.id,a===j.b.module||a===j.b.htmlDisplay?"side-content-tooltip side-content-tab-alert":"side-content-tooltip"),id:Object(y.b)(i),children:Object(m.jsx)(h.w,{icon:e.iconName,iconSize:20})})}),disabled:e.disabled,className:"side-content-tab"};if(!e.body)return Object(m.jsx)(h.U,{...r},i);const o=t?{...e.body,props:{...e.body.props,workspaceLocation:t,editorWidth:n,sideContentHeight:s}}:e.body,c=Object(m.jsx)("div",{className:"side-content-text",children:o});return Object(m.jsx)(h.U,{...r,panel:c},i)})(e,a.workspaceLocation,s,i)))})})})})})}),v.a),O=n(34);const S={right:!0},w={bottom:!0},C={};t.a=e=>{const t=a.useRef(null),n=a.useRef(null),r=a.useRef(null),h=a.useRef(null),p=a.useRef(null),g=a.useRef(null),[f]=Object(O.a)(n),[v,y]=a.useState(200),[j,E]=a.useState(!1);s.a.onlyShowFocusOnTabs(),a.useEffect((()=>{e.sideContentIsResizeable&&null===p.current&&(p.current=g.current.clientHeight)}));const T=(e,n,s,i)=>{if(s.clientWidth<100){const e=t.current;if(null===e)throw Error("Reference to SideBar not found when resizing.");e.updateSize({width:40,height:"100%"}),E(!1)}else E(!0)},k=(e,t,n)=>{const s=n.clientWidth/f*100;s>95?h.current.updateSize({width:"100%",height:"100%"}):s<5&&h.current.updateSize({width:"0%",height:"100%"})},A=(e,t,n)=>{p.current=g.current.clientHeight>p.current?g.current.clientHeight:p.current;const s=n.clientHeight,i=n.parentNode.clientHeight;s+p.current+2>i?g.current.style.display="none":g.current.style.display="initial"},_=Object(m.jsx)(x,{...e.sideContentProps}),I=Object(m.jsxs)(i.a,{bounds:"parent",className:"resize-side-content",enable:w,onResize:A,onResizeStop:(t,n,s)=>e.handleSideContentHeightChange(s.clientHeight),children:[_,Object(m.jsx)("div",{className:"side-content-divider",ref:g})]});return Object(m.jsxs)("div",{className:"workspace",children:[e.hasUnsavedChanges?Object(m.jsx)(o.a,{message:"You have changes that may not be saved. Are you sure you want to leave?"}):null,Object(m.jsx)(c.a,{...e.controlBarProps}),Object(m.jsxs)("div",{className:"workspace-parent",children:[Object(m.jsx)(i.a,{...(()=>{const n=0!==e.sideBarProps.tabs.length,s=n?40:"auto";return{enable:n?S:C,minWidth:s,maxWidth:"50%",onResize:T,onResizeStop:(e,t,n,s)=>{const i=n.clientWidth;40!==i&&y(i)},ref:t,defaultSize:{width:s,height:"100%"}}})(),children:Object(m.jsx)(b,{...e.sideBarProps,isExpanded:j,expandSideBar:()=>{E(!0);const e=t.current;if(null===e)throw Error("Reference to SideBar not found when expanding.");e.updateSize({width:v,height:"100%"})},collapseSideBar:()=>{E(!1);const e=t.current;if(null===e)throw Error("Reference to SideBar not found when collapsing.");e.updateSize({width:40,height:"100%"})}})}),Object(m.jsxs)("div",{className:"row content-parent",ref:n,children:[Object(m.jsx)("div",{className:"editor-divider",ref:r}),Object(m.jsx)(i.a,{className:"resize-editor left-parent",enable:S,minWidth:0,onResize:k,ref:h,defaultSize:{width:"50%",height:"100%"},as:void 0,children:(e=>e.editorContainerProps?Object(m.jsx)(l.b,{...e.editorContainerProps}):Object(m.jsx)(d.a,{...e.mcqProps}))(e)}),Object(m.jsxs)("div",{className:"right-parent",children:[void 0===e.sideContentIsResizeable||e.sideContentIsResizeable?I:_,Object(m.jsx)(u.a,{...e.replProps})]})]})]})]})}},114:function(e,t,n){"use strict";n.r(t),n.d(t,"deleteSourcecastEntry",(function(){return a})),n.d(t,"recordInit",(function(){return r})),n.d(t,"recordInput",(function(){return o})),n.d(t,"resetInputs",(function(){return c})),n.d(t,"timerPause",(function(){return l})),n.d(t,"timerReset",(function(){return d})),n.d(t,"timerResume",(function(){return u})),n.d(t,"timerStart",(function(){return h})),n.d(t,"timerStop",(function(){return p}));var s=n(7),i=n(83);const a=(e,t)=>Object(s.action)(i.a,{id:e,workspaceLocation:t}),r=(e,t)=>Object(s.action)(i.b,{initData:e,workspaceLocation:t}),o=(e,t)=>Object(s.action)(i.c,{input:e,workspaceLocation:t}),c=(e,t)=>Object(s.action)(i.d,{inputs:e,workspaceLocation:t}),l=e=>Object(s.action)(i.e,{timeNow:Date.now(),workspaceLocation:e}),d=e=>Object(s.action)(i.f,{workspaceLocation:e}),u=(e,t)=>Object(s.action)(i.g,{timeBefore:e,timeNow:Date.now(),workspaceLocation:t}),h=e=>Object(s.action)(i.h,{timeNow:Date.now(),workspaceLocation:e}),p=e=>Object(s.action)(i.i,{timeNow:Date.now(),workspaceLocation:e})},1146:function(e,t){},1148:function(e,t){},1155:function(e,t,n){"use strict";n.r(t);n(487);var s=n(1170),i=n(1167),a=n(52),r=n(33),o=n(24),c=n(43),l=n(186),d=n(244),u=n(37),h=n(41),p=n(3),g=n(98),m=n(64),b=n.n(m),f=n(1),v=n.n(f),y=n(19),j=n.n(y),x=n(34),O=n(21),S=n(132),w=n(60),C=n(116),E=n(265),T=n(32),k=n.n(T),A=n(46),_=n(190),I=n(13),N=n(27),P=n(102),R=n(267);const M={},L=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_CADET_LOGGER;function D(e,t){var n;L&&(n={...t,questionId:M[e],sessionId:e},new Promise(((e,t)=>{G().then((s=>{const i=s.transaction([U],"readwrite");i.oncomplete=e,i.onerror=t,i.objectStore(U).add(n)}))})))}function B(e,t){const n=Object(R.a)();return M[n]=e,D(n,{...t,type:"init",time:Date.now()}),n}const U="logs",G=function(e){let t=null;return()=>t||(t=e(),t)}((()=>new Promise(((e,t)=>{const n=indexedDB.open("evtlogs",1);n.onsuccess=t=>{e(n.result)},n.onerror=e=>{console.error("Failed to get db",e),t(n.error)},n.onupgradeneeded=e=>{(null===e||void 0===e?void 0:e.target).result.createObjectStore(U,{keyPath:"id",autoIncrement:!0})}}))));var F=n(36),H=n(18),V=n(120),W=n(105),$=n(106),X=n(157),q=n(153),z=n(154),Y=n(191),K=n(138),Q=n(192),J=n(12),Z=n(94),ee=n(44),te=n(156),ne=n(0);var se=e=>{const{index:t,result:n}=e;return Object(ne.jsx)("div",{className:j()("ResultCard","pass"===n.resultType?"correct":"wrong"),children:Object(ne.jsxs)(h.e,{elevation:S.a.ONE,children:[Object(ne.jsxs)("div",{className:"result-data",children:[Object(ne.jsx)("div",{className:"result-idx",children:t+1}),Object(ne.jsx)("div",{className:"result-status",children:n.resultType.toUpperCase()})]}),Object(ne.jsx)(h.M,{className:"result-expected",children:n.expected}),Object(ne.jsx)(h.M,{className:"result-actual",children:"error"===n.resultType?(s=n.errors,s.map((e=>{switch(e.errorType){case"timeout":return"[TIMEOUT] Submission exceeded time limit for this test case.";case"syntax":return`[SYNTAX] Line ${e.line}: ${e.errorExplanation}`;case"runtime":return`[RUNTIME] Line ${e.line}: ${e.errorExplanation}`;case"systemError":return`[SYSTEM] ${e.errorMessage}`;default:return`[UNKNOWN] Autograder error: type ${e.errorType}`}})).join("\n\n")):n.actual})]})});var s},ie=n(254);const ae=Object(ne.jsxs)("div",{className:"autograder-help-tooltip",children:[Object(ne.jsx)("p",{children:"Click on each testcase below to execute it with the program in the editor."}),Object(ne.jsx)("p",{children:"To execute all testcases at once, evaluate the program in the editor with this tab active."}),Object(ne.jsx)("p",{children:"A green or red background indicates a passed or failed testcase respectively."}),Object(ne.jsx)("p",{children:"Private testcases (only visible to staff when grading) have a grey background."})]}),re=(e,t)=>Object(ne.jsxs)("div",{className:e,children:[t,Object(ne.jsx)(h.w,{icon:C.a.CARET_DOWN})]}),oe=Object(ne.jsxs)("div",{className:"testcases-header",children:[re("header-fn","Testcase"),re("header-expected","Expected result"),re("header-actual","Actual result")]}),ce=Object(ne.jsxs)("div",{className:"results-header",children:[Object(ne.jsxs)("div",{className:"header-data",children:[re("header-sn","S/N"),re("header-status","Testcase status")]}),re("header-expected","Expected result"),re("header-actual","Actual result")]}),le=(e,t,n)=>Object(ne.jsx)(J.a,{label:e,icon:t?C.a.CARET_DOWN:C.a.CARET_RIGHT,onClick:n,options:{className:"collapse-button",minimal:!0}});var de=e=>{const[t,n]=f.useState(!0),[s,i]=f.useState(!0),{testcases:a,autogradingResults:r,handleTestcaseEval:o,workspaceLocation:c}=e,l=f.useMemo((()=>a.length>0?Object(ne.jsxs)("div",{className:"testcaseCards",children:[oe,a.map(((e,t)=>Object(ne.jsx)(ie.a,{index:t,testcase:e,handleTestcaseEval:o,workspaceLocation:c},t)))]}):Object(ne.jsx)("div",{className:"noResults",children:"There are no testcases provided for this question."})),[a,o,c]),d=f.useMemo((()=>r.length>0?Object(ne.jsxs)("div",{children:[ce,r.map(((e,t)=>Object(ne.jsx)(se,{index:t,result:e},t)))]}):Object(ne.jsx)("div",{className:"noResults",children:"There are no results to show."})),[r]),u=f.useCallback((()=>{n(!t)}),[t]),p=f.useCallback((()=>i(!s)),[s]);return Object(ne.jsxs)("div",{className:"Autograder",children:[Object(ne.jsxs)(h.b,{className:"collapse-button",icon:t?C.a.CARET_DOWN:C.a.CARET_RIGHT,minimal:!0,onClick:u,children:[Object(ne.jsx)("span",{children:"Testcases"}),Object(ne.jsx)(E.a,{content:ae,placement:h.L.LEFT,children:Object(ne.jsx)(h.w,{icon:C.a.HELP})})]}),Object(ne.jsx)(h.g,{isOpen:t,keepChildrenMounted:!0,children:l}),le("Autograder Results",s,p),Object(ne.jsx)(h.g,{isOpen:s,keepChildrenMounted:!0,children:d})]})};var ue=e=>{const{handleContestEntryClick:t,contestEntry:n,rank:s}=e;return Object(ne.jsx)("div",{className:j()("LeaderboardCard"),children:Object(ne.jsxs)(h.e,{className:p.a.INTERACTIVE,elevation:S.a.ONE,onClick:()=>{var e;return t(n.submission_id,null!==(e=n.answer.code)&&void 0!==e?e:"")},children:[Object(ne.jsx)(h.M,{className:"contestentry-entryid",children:n.student_name}),Object(ne.jsx)(h.M,{className:"contestentry-rank",children:s}),Object(ne.jsx)(h.M,{className:"contestentry-score",children:n.final_score})]})})};const he=(e,t)=>Object(ne.jsxs)("div",{className:e,children:[t,Object(ne.jsx)(h.w,{icon:C.a.CARET_DOWN})]}),pe=Object(ne.jsxs)("div",{className:"leaderboard-header",children:[he("header-entryid","Student Name"),he("header-entryrank","Rank"),he("header-score","Score")]});var ge=e=>{const{orderedContestEntries:t,handleContestEntryClick:n}=e,[s,i]=Object(f.useState)(!0),a=Object(f.useMemo)((()=>Object(ne.jsxs)("div",{children:[pe,t.length>0?t.map(((e,t)=>Object(ne.jsx)(ue,{handleContestEntryClick:n,contestEntry:e,rank:t+1},e.submission_id))):Object(ne.jsx)("div",{className:"noResults",children:"There are no eligible contest leaderboard entries found."})]})),[n,t]);return Object(ne.jsxs)("div",{className:"ContestLeaderboard",children:[Object(ne.jsxs)(h.b,{className:"collapse-button",icon:s?C.a.CARET_DOWN:C.a.CARET_RIGHT,minimal:!0,onClick:()=>i(!s),children:[Object(ne.jsx)("span",{children:"Contest Leaderboard"}),Object(ne.jsx)(E.a,{content:"View the top-rated contest entries!",children:Object(ne.jsx)(h.w,{icon:C.a.HELP})})]}),Object(ne.jsx)(h.g,{isOpen:s,keepChildrenMounted:!0,children:a})]})},me=n(10);var be=e=>{const{canSave:t,isValid:n,handleContestEntryClick:s,handleVotingSubmissionChange:i,contestEntry:a,entryNumber:r,minScore:o,maxScore:c}=e;return Object(ne.jsx)("div",{className:j()("ContestEntryCard",{wrong:!n}),children:Object(ne.jsxs)(h.e,{className:p.a.INTERACTIVE,elevation:S.a.ONE,onClick:()=>{var e;return s(a.submission_id,null!==(e=a.answer.code)&&void 0!==e?e:"")},children:[Object(ne.jsx)(h.M,{className:"contestentry-entryid",children:r}),Object(ne.jsx)(h.M,{className:"contestentry-rank",children:Object(ne.jsx)(h.H,{disabled:!t,value:a.score,onValueChange:e=>i(a.submission_id,e),placeholder:`Enter score for entry ${r}`,min:o,max:c,allowNumericCharactersOnly:!0,fill:!0,minorStepSize:null})})]})})};const fe=(e,t)=>Object(ne.jsxs)("div",{className:e,children:[t,Object(ne.jsx)(h.w,{icon:C.a.CARET_DOWN})]}),ve=Object(ne.jsxs)("div",{className:"contestentries-header",children:[fe("header-entryid","Entry Id"),fe("header-entryrank","Score")]});var ye=e=>{const{contestEntries:t,canSave:n,isValid:s,handleContestEntryClick:i,handleVotingSubmissionChange:a,maxScore:r,minScore:o}=e,[c,l]=Object(f.useState)(!0),d=Object(f.useMemo)((()=>Object(ne.jsxs)("div",{children:[ve,t.length>0?t.map(((e,t)=>Object(ne.jsx)(be,{isValid:s,canSave:n,entryNumber:t+1,handleContestEntryClick:i,handleVotingSubmissionChange:a,contestEntry:e,minScore:o,maxScore:r},e.submission_id))):Object(ne.jsx)("div",{className:"noResults",children:"There are no eligible entries for voting found."})]})),[s,n,t,i,a,r,o]);return Object(ne.jsxs)("div",{className:"ContestEntryVoting",children:[Object(ne.jsxs)(h.b,{className:"collapse-button",icon:c?C.a.CARET_DOWN:C.a.CARET_RIGHT,minimal:!0,onClick:()=>l(!c),children:[Object(ne.jsx)("span",{children:"Contest Voting"}),Object(ne.jsx)(E.a,{content:Object(ne.jsxs)("span",{children:["Score your favourite contest entries from ",o," (worst) to ",r," (best)!"]}),children:Object(ne.jsx)(h.w,{icon:C.a.HELP})})]}),Object(ne.jsx)(h.g,{isOpen:c,keepChildrenMounted:!0,children:d})]})};var je=e=>{const{canSave:t,contestEntries:n,handleSave:s,handleContestEntryClick:i}=e,[a,r]=Object(f.useState)(!0),[o,c]=Object(f.useState)([]),l=11-n.length;Object(f.useEffect)((()=>{c(n)}),[n]);return Object(ne.jsx)(ye,{isValid:a,canSave:t,handleContestEntryClick:i,handleVotingSubmissionChange:(e,t)=>{const n=o.map((n=>n.submission_id===e?{...n,score:t}:n));c(n);const i=new Set(n.map((e=>e.score))).size===n.length,a=(e=>e.reduce(((e,t)=>e&&void 0!==t.score&&null!==t.score),!0))(n);i&&a&&(e=>e.reduce(((e,t)=>{const n=t.score;return e&&n>=l&&n<=10}),!0))(n)?(s(n),r(!0)):i&&a?(Object(me.e)(`Vote rankings invalid. Please input scores between ${l} - 10.`),r(!1)):!i&&a?(Object(me.e)("Vote scores are not unique. Please input unique rankings."),r(!1)):r(!1)},contestEntries:o,minScore:l,maxScore:10})};class xe extends f.Component{constructor(){super(...arguments),this.$container=null}shouldComponentUpdate(){return!1}componentDidMount(){window.ToneMatrix&&window.ToneMatrix.initialise_matrix(this.$container)}handleClear(){window.ToneMatrix.clear_matrix()}handleRandomise(){window.ToneMatrix.randomise_matrix()}render(){return Object(ne.jsxs)("div",{className:"sa-tone-matrix",children:[Object(ne.jsx)("div",{className:"row",children:Object(ne.jsxs)("div",{className:j()("controls","col-xs-12",p.a.DARK,p.a.BUTTON_GROUP),children:[Object(ne.jsx)(h.b,{id:"clear-matrix",onClick:this.handleClear,children:"Clear"}),Object(ne.jsx)(h.b,{id:"randomise-matrix",onClick:this.handleRandomise,children:"Randomise"})]})}),Object(ne.jsx)("div",{className:"row",children:Object(ne.jsx)("div",{className:"col-xs-12",ref:e=>this.$container=e})})]})}}var Oe=xe,Se=n(23),we=n(16),Ce=n(51),Ee=n(54),Te=n(107);const ke=e=>{const t=b()(e),n=b()();return t.isBefore(n)},Ae=e=>b()(e).format("Do MMMM, HH:mm");var _e=e=>Object(ne.jsx)("div",{className:"GradingResult",children:Object(ne.jsxs)("div",{className:"grading-result-table",children:[Object(ne.jsx)(h.v,{children:Object(ne.jsxs)("tbody",{children:[Object(ne.jsxs)("tr",{children:[Object(ne.jsx)("th",{children:"XP:"}),Object(ne.jsx)("td",{children:Object(ne.jsxs)(h.Y,{children:[e.xp," / ",e.maxXp]})})]}),Object(ne.jsxs)("tr",{children:[Object(ne.jsx)("th",{children:"Comments:"}),Object(ne.jsx)("td",{children:!e.comments&&Object(ne.jsx)(h.Y,{children:"None"})})]})]})}),e.comments&&Object(ne.jsx)(h.v,{children:Object(ne.jsx)("tbody",{children:Object(ne.jsx)("tr",{children:Object(ne.jsxs)("td",{children:[Object(ne.jsx)(h.i,{}),Object(ne.jsx)(ee.a,{content:e.comments,simplifiedAutoLink:!0,strikethrough:!0,tasklists:!0,openLinksInNewWindow:!0}),Object(ne.jsx)(h.i,{})]})})})}),Object(ne.jsx)("br",{}),Object(ne.jsx)("div",{className:"grading-result-info",children:Object(ne.jsxs)(h.Y,{children:["Graded by ",Object(ne.jsx)("b",{children:e.graderName})," on ",Ae(e.gradedAt)]})})]})});const Ie="assessment";var Ne=e=>{var t,n,s,i,a;const[o,c]=f.useState(!1),[l,d]=f.useState(!1),[m,b]=f.useState(""),[v,y]=f.useState(void 0!==(null===(t=e.assessment)||void 0===t?void 0:t.questions[e.questionId].grader)?Se.b.grading:Se.b.questionOverview),{isMobileBreakpoint:S}=Object(x.e)(),w=Object(r.c)();f.useEffect((()=>{e.handleEditorValueChange("")}),[]),f.useEffect((()=>{if(w(Object(u.fetchAssessment)(e.assessmentId)),0===e.questionId&&e.notAttempted&&c(!0),!e.assessment)return;let t=e.questionId;e.questionId>=e.assessment.questions.length&&(t=e.assessment.questions.length-1);const n=e.assessment.questions[t];let s="";n.type===H.d.programming&&(s=n.answer?n.answer:n.solutionTemplate),e.handleEditorValueChange(s)}),[]),f.useEffect((()=>{_()})),f.useEffect((()=>{S||v!==Se.b.mobileEditor&&v!==Se.b.mobileEditorRun||y(Se.b.questionOverview)}),[S,e,v]);const E=e=>{D(m,e)},k=f.useRef(v);k.current=v;const A=()=>{k.current===Se.b.autograder?w(Object(I.runAllTestcases)(Ie)):w(Object(I.evalEditor)(Ie));const e={time:Date.now(),type:"keyboardCommand",data:F.a.run};E(e)},_=()=>{var t;if(void 0===e.assessment)return;const n=e.assessmentId,s=e.questionId;if(e.storedAssessmentId===n&&e.storedQuestionId===s)return;const i=e.assessment.questions[s];let a=[],r="",o="",c="",l=[];if(i.type===H.d.programming){const t=i;var d,u;if(a=t.autogradingResults,o=t.prepend,c=t.postpend,l=t.testcases,r=t.answer,r||(r=t.solutionTemplate),!m)b(B(`${e.assessment.number}/${e.questionId}`,{chapter:N.Chapter.CALC,externalLibrary:(null===i||void 0===i||null===(d=i.library)||void 0===d||null===(u=d.external)||void 0===u?void 0:u.name)||"NONE",editorValue:r}))}if(i.type===H.d.voting){const e=i;o=e.prepend,c=e.postpend}e.handleEditorUpdateBreakpoints([]),w(Object(I.updateCurrentAssessmentId)(n,s)),w(Object(I.resetWorkspace)(Ie,{autogradingResults:a,editorTabs:[{value:r,prependValue:o,postpendValue:c,highlightedLines:[],breakpoints:[]}],editorTestcases:l})),w(Object(I.changeExecTime)(null!==(t=i.library.execTimeMs)&&void 0!==t?t:O.l.assessment.execTime,Ie)),w(Object(I.beginClearContext)(Ie,i.library,!0)),e.handleUpdateHasUnsavedChanges(!1),r&&e.handleEditorValueChange(r)},R=(e,t)=>{var n,s,i,a,r,o,c;const l=void 0!==e.assessment.questions[t].grader,d=(t,n)=>{e.handleEditorValueChange(n)},u="voting"===(null===(n=e.assessment.questions[t])||void 0===n?void 0:n.type)?[{label:`Question ${t+1}`,iconName:C.a.NINJA,body:Object(ne.jsx)(ee.a,{content:e.assessment.questions[t].content}),id:Se.b.questionOverview},{label:"Contest Voting Briefing",iconName:C.a.BRIEFCASE,body:Object(ne.jsx)(ee.a,{content:e.assessment.longSummary}),id:Se.b.briefing},{label:"Contest Voting",iconName:C.a.NEW_LAYERS,body:Object(ne.jsx)(je,{canSave:e.canSave,handleSave:n=>{var s;return e.handleSave((null===(s=e.assessment)||void 0===s?void 0:s.questions[t]).id,n)},handleContestEntryClick:d,contestEntries:null!==(s=null===(i=e.assessment)||void 0===i||null===(a=i.questions[t])||void 0===a?void 0:a.contestEntries)&&void 0!==s?s:[]}),id:Se.b.contestVoting},{label:"Contest Leaderboard",iconName:C.a.CROWN,body:Object(ne.jsx)(ge,{handleContestEntryClick:d,orderedContestEntries:null!==(r=null===(o=e.assessment)||void 0===o||null===(c=o.questions[t])||void 0===c?void 0:c.contestLeaderboard)&&void 0!==r?r:[]}),id:Se.b.contestLeaderboard}]:[{label:`Question ${t+1}`,iconName:C.a.NINJA,body:Object(ne.jsx)(ee.a,{className:"sidecontent-overview",content:e.assessment.questions[t].content}),id:Se.b.questionOverview},{label:"Briefing",iconName:C.a.BRIEFCASE,body:Object(ne.jsx)(ee.a,{className:"sidecontent-overview",content:e.assessment.longSummary}),id:Se.b.briefing},{label:"Autograder",iconName:C.a.AIRPLANE,body:Object(ne.jsx)(de,{testcases:e.editorTestcases,autogradingResults:l||!e.assessmentConfiguration.isManuallyGraded?e.autogradingResults:[],handleTestcaseEval:e=>w(Object(I.evalTestcase)(Ie,e)),workspaceLocation:"assessment"}),id:Se.b.autograder}];l&&u.push({label:"Report Card",iconName:C.a.TICK,body:Object(ne.jsx)(_e,{graderName:e.assessment.questions[t].grader.name,gradedAt:e.assessment.questions[t].gradedAt,xp:e.assessment.questions[t].xp,maxXp:e.assessment.questions[t].maxXp,comments:e.assessment.questions[t].comments}),id:Se.b.grading});e.assessment.questions[t].library.external.symbols.includes("get_matrix")&&u.push({label:"Tone Matrix",iconName:C.a.GRID_VIEW,body:Object(ne.jsx)(Oe,{}),id:Se.b.toneMatrix});return{selectedTabId:v,tabs:{beforeDynamicTabs:u,afterDynamicTabs:[]},onChange:(e,t,n)=>{e!==t&&y(e)},workspaceLocation:"assessment"}},M=t=>{var n;const s=`/courses/${e.courseId}/${Object(Ee.a)(e.assessment.type)}`,i=s+`/${e.assessment.id.toString()}`,a=[t+1,e.assessment.questions.length],r=()=>{Ce.a.push(i+`/${(t+1).toString()}`),y(Se.b.questionOverview)},o=()=>Ce.a.push(s),c=n=>()=>{const s=e.assessment.questions.filter((e=>null!==e.answer)).length-1;if(t<s)return n();const i=e.assessment.questions[t];if(i.type===H.d.mcq){if(null===i.answer)return Object(me.e)("Please select an option!",750);if(void 0===i.solution)return n();if(i.answer!==i.solution)return Object(me.e)("Your MCQ solution is incorrect!",750)}else if(i.type===H.d.programming){if(!e.editorTestcases.reduce(((e,t)=>e&&Object(P.stringify)(t.result)===t.answer),!0))return Object(me.e)("Your solution has not passed all testcases!",750)}return n()},l=Object(ne.jsx)(X.a,{onClickNext:e.assessment.questions[t].blocking?c(r):r,onClickReturn:e.assessment.questions[t].blocking?c(o):o,questionProgress:a},"next_question"),u=Object(ne.jsx)(q.a,{onClick:()=>{Ce.a.push(i+`/${(t-1).toString()}`),y(Se.b.questionOverview)},questionProgress:a},"previous_question"),h=Object(ne.jsx)(z.a,{questionProgress:a},"question_view"),p=e.assessment.questions[t].type!==H.d.mcq?Object(ne.jsx)(Y.a,{onClick:()=>{d(!0)}},"reset_template"):null,g=Object(ne.jsx)(K.a,{handleEditorEval:A},"run"),m=e.canSave&&e.assessment.questions[t].type===H.d.programming?Object(ne.jsx)(Q.a,{hasUnsavedChanges:e.hasUnsavedChanges,onClickSave:()=>e.handleSave(e.assessment.questions[t].id,e.editorTabs[0].value)},"save"):null,b=Object(ne.jsx)(V.a,{handleChapterSelect:()=>{},sourceChapter:N.Chapter.CALC,sourceVariant:null!==(n=e.assessment.questions[t].library.variant)&&void 0!==n?n:we.b.defaultSourceVariant,disabled:!0},"chapter");return{editorButtons:S?[m,p]:[g,m,p,b],flowButtons:[u,h,l]}};if(void 0===e.assessment||0===e.assessment.questions.length)return Object(ne.jsx)(h.G,{className:j()("WorkspaceParent",p.a.DARK),description:"Getting mission ready...",icon:Object(ne.jsx)(h.R,{size:h.S.LARGE})});const L=Object(ne.jsx)(h.h,{className:"assessment-briefing",isOpen:o,children:Object(ne.jsxs)(h.e,{children:[Object(ne.jsx)(ee.a,{content:e.assessment.longSummary}),Object(ne.jsx)(h.b,{className:"assessment-briefing-button",onClick:()=>c(!1),text:"Continue"})]})}),U=()=>d(!1),G=Object(ne.jsxs)(h.h,{className:"assessment-reset",icon:C.a.ERROR,isCloseButtonShown:!0,isOpen:l,onClose:U,title:"Confirmation: Reset editor?",children:[Object(ne.jsxs)("div",{className:p.a.DIALOG_BODY,children:[Object(ne.jsx)(ee.a,{content:"Are you sure you want to reset the template?"}),Object(ne.jsx)(ee.a,{content:"*Note this will not affect the saved copy of your program, unless you save over it.*"})]}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)(h.c,{children:[Object(ne.jsx)(J.a,{label:"Cancel",onClick:U,options:{minimal:!1}}),Object(ne.jsx)(J.a,{label:"Confirm",onClick:()=>{U(),e.handleEditorValueChange(e.assessment.questions[se].solutionTemplate),e.handleUpdateHasUnsavedChanges(!0)},options:{minimal:!1,intent:g.a.DANGER}})]})})]}),se=e.questionId>=e.assessment.questions.length?e.assessment.questions.length-1:e.questionId,ie=e.assessment.questions[se],ae=ie.type===H.d.programming||ie.type===H.d.voting?{editorVariant:"normal",editorTabs:e.editorTabs.map(Z.a),editorSessionId:"",sourceChapter:N.Chapter.CALC,sourceVariant:null!==(n=ie.library.variant)&&void 0!==n?n:N.Variant.DEFAULT,externalLibraryName:ie.library.external.name||"NONE",handleDeclarationNavigate:e=>w(Object(I.navigateToDeclaration)(Ie,e)),handleEditorEval:A,handleEditorCheck:()=>{},handleEditorValueChange:e.handleEditorValueChange,handleUpdateHasUnsavedChanges:e.handleUpdateHasUnsavedChanges,handleEditorUpdateBreakpoints:e.handleEditorUpdateBreakpoints,handlePromptAutocomplete:(e,t,n)=>w(Object(I.promptAutocomplete)(Ie,e,t,n)),isEditorAutorun:!1,onChange:(t,n)=>{e.handleUpdateHasUnsavedChanges&&e.handleUpdateHasUnsavedChanges(!0),e.handleEditorValueChange(t);const s={time:Date.now(),type:"codeDelta",data:n};E(s)},onCursorChange:e=>{const t={time:Date.now(),type:"cursorPositionChange",data:e.getCursor()};E(t)},onSelectionChange:e=>{const t=e.getRange(),n=e.isBackwards();if(!Object(T.isEqual)(t.start,t.end)){const e={time:Date.now(),type:"selectionRangeData",data:{range:t,isBackwards:n}};E(e)}}}:void 0,re={mcq:ie,handleMCQSubmit:t=>e.handleSave(e.assessment.questions[se].id,t)},oe={handleBrowseHistoryDown:()=>w(Object(I.browseReplHistoryDown)(Ie)),handleBrowseHistoryUp:()=>w(Object(I.browseReplHistoryUp)(Ie)),handleReplEval:e.handleReplEval,handleReplValueChange:e=>w(Object(I.updateReplValue)(e,Ie)),output:e.output,replValue:e.replValue,sourceChapter:N.Chapter.CALC,sourceVariant:null!==(s=ie.library.variant)&&void 0!==s?s:N.Variant.DEFAULT,externalLibrary:(null===ie||void 0===ie||null===(i=ie.library)||void 0===i||null===(a=i.external)||void 0===a?void 0:a.name)||"NONE",replButtons:(()=>{const t=Object(ne.jsx)(W.a,{handleReplOutputClear:()=>w(Object(I.clearReplOutput)(Ie))},"clear_repl");return[Object(ne.jsx)($.a,{handleReplEval:e.handleReplEval,isRunning:e.isRunning},"eval_repl"),t]})()},ce={tabs:[]},le={controlBarProps:M(se),editorContainerProps:ae,handleSideContentHeightChange:e=>w(Object(I.changeSideContentHeight)(e,Ie)),hasUnsavedChanges:e.hasUnsavedChanges,mcqProps:re,sideBarProps:ce,sideContentHeight:e.sideContentHeight,sideContentProps:R(e,se),replProps:oe},ue={editorContainerProps:ae,hasUnsavedChanges:e.hasUnsavedChanges,mcqProps:re,replProps:oe,sideBarProps:ce,mobileSideContentProps:(t=>({mobileControlBarProps:{...M(t)},...R(e,t),onChange:(e,t,n)=>{e!==t&&(t===Se.b.autograder&&e===Se.b.mobileEditorRun||y(e))},selectedTabId:v,handleEditorEval:A}))(se)};return Object(ne.jsxs)("div",{className:j()("WorkspaceParent",p.a.DARK),children:[L,G,S?Object(ne.jsx)(te.a,{...ue}):Object(ne.jsx)(Te.a,{...le})]})};const Pe="assessment";var Re=Object(r.b)(((e,t)=>({courseId:e.session.courseId,assessment:e.session.assessments.get(t.assessmentId),autogradingResults:e.workspaces.assessment.autogradingResults,activeEditorTabIndex:e.workspaces.assessment.activeEditorTabIndex,editorTabs:e.workspaces.assessment.editorTabs,editorTestcases:e.workspaces.assessment.editorTestcases,hasUnsavedChanges:e.workspaces.assessment.hasUnsavedChanges,isRunning:e.workspaces.assessment.isRunning,isDebugging:e.workspaces.assessment.isDebugging,enableDebugging:e.workspaces.assessment.enableDebugging,output:e.workspaces.assessment.output,replValue:e.workspaces.assessment.replValue,sideContentHeight:e.workspaces.assessment.sideContentHeight,storedAssessmentId:e.workspaces.assessment.currentAssessment,storedQuestionId:e.workspaces.assessment.currentQuestion})),(e=>Object(c.b)({handleEditorValueChange:e=>Object(I.updateEditorValue)(e,Pe),handleEditorUpdateBreakpoints:e=>Object(I.setEditorBreakpoint)(e,Pe),handleReplEval:()=>Object(I.evalRepl)(Pe),handleSave:u.submitAnswer,handleUpdateHasUnsavedChanges:e=>Object(I.updateHasUnsavedChanges)(Pe,e)},e)))(Ne),Me=n(89),Le=n(329);function De(e){return t=>t.filter((t=>!t.submission_id&&t.assessment_id===e))}function Be(e){return t=>t.filter((t=>t.submission_id===e))}function Ue(e){return t=>t.filter((t=>"Grading"===e?void 0!==t.submission_id:!t.submission_id&&e===t.assessment_type))}var Ge=n(99);const Fe=e=>{switch(e){case Ge.a.new:return"This assessment is new.";case Ge.a.deadline:return"This assessment is closing soon.";case Ge.a.autograded:return"This assessment has been autograded.";case Ge.a.submitted:return"This submission is new.";case Ge.a.unsubmitted:return"This assessment has been unsubmitted.";case Ge.a.graded:return"This assessment has been manually graded.";case Ge.a.new_message:return"There are new messages.";default:return"Unknown notification"}};var He=e=>{const t=e.notificationFilter?e.notificationFilter(e.notifications):e.notifications;if(!t.length)return null;const n=Object(ne.jsx)(h.W,{intent:g.a.DANGER,round:!0,large:e.large,children:t.length});if(!e.disableHover){const s=t=>Object(ne.jsx)(h.W,{className:"row badge-tag",minimal:!0,multiline:!0,onRemove:()=>{return e.handleAcknowledgeNotifications((n=t.id,e=>e.filter((e=>e.id===n))));var n},children:Fe(t.type)},`${t.id}`),i=Object(ne.jsx)("div",{className:"col",children:t.map(s)});return Object(ne.jsx)(Le.a,{className:e.className,content:i,interactionKind:h.K.HOVER,placement:w.a.RIGHT,hoverOpenDelay:50,hoverCloseDelay:50,lazy:!0,children:n})}return n};var Ve=Object(r.b)((e=>({notifications:e.session.notifications})),(e=>Object(c.b)({handleAcknowledgeNotifications:u.acknowledgeNotifications},e)))(He);var We=()=>Object(ne.jsx)("div",{className:j()("NoPage",p.a.DARK),children:Object(ne.jsx)(h.G,{icon:C.a.ERROR,title:"Assessment Not Found",description:"Please check the top right dropdown menu to see if you are in the right course."})});const $e=e=>{let t,n,s;switch(e){case H.c.graded:t=C.a.TICK,n=g.a.SUCCESS,s="Fully graded";break;case H.c.grading:t=C.a.TIME,n=g.a.WARNING,s="Grading in progress";break;case H.c.none:t=C.a.CROSS,n=g.a.DANGER,s="Not graded yet";break;default:t=C.a.DISABLE,n=g.a.PRIMARY,s="Not applicable"}return Object(ne.jsx)(E.a,{className:"listing-title-tooltip",content:s,placement:w.a.RIGHT,children:Object(ne.jsx)(h.w,{icon:t,intent:n})})},Xe=(e,t,n)=>Object(ne.jsx)(J.a,{label:e,icon:t?C.a.CARET_DOWN:C.a.CARET_RIGHT,onClick:n,options:{minimal:!0,className:"collapse-button"}});var qe=e=>{const t=Object(o.j)(),{isMobileBreakpoint:n}=Object(x.e)(),[s,i]=f.useState(null),[a,r]=f.useState(!1),[c,l]=f.useState(!0),[d,u]=f.useState(!0),m=()=>r(!a),b=()=>l(!c),v=()=>u(!d),y=()=>i(null),j=e=>Object(T.sortBy)(e,[e=>-e.id]),O=(e,t)=>Object(ne.jsxs)(h.b,{disabled:e.status!==H.a.attempted,icon:C.a.CONFIRM,intent:e.status===H.a.attempted?g.a.DANGER:g.a.NONE,minimal:!0,onClick:()=>i(e),children:[Object(ne.jsx)("span",{className:"custom-hidden-xxxs",children:"Finalize"}),Object(ne.jsx)("span",{className:"custom-hidden-xxs",children:" Submission"})]}),w=t=>{let n,s,i="";switch(t.status){case H.a.not_attempted:n=C.a.PLAY,s="Attempt";break;case H.a.attempting:n=C.a.PLAY,s="Continue",i=" Attempt";break;case H.a.attempted:n=C.a.EDIT,s="Review",i=" Attempt";break;case H.a.submitted:n=C.a.EYE_OPEN,s="Review",i=" Submission";break;default:n=C.a.PLAY,s="Review"}return Object(ne.jsx)(A.b,{to:`/courses/${e.courseId}/${Object(Ee.a)(t.type)}/${t.id.toString()}/${we.b.defaultQuestionId}`,children:Object(ne.jsxs)(h.b,{icon:n,minimal:!0,onClick:()=>e.handleAcknowledgeNotifications(De(t.id)),children:[Object(ne.jsx)("span",{className:"custom-hidden-xxxs",children:s}),Object(ne.jsx)("span",{className:"custom-hidden-xxs",children:i})]})})},k=(t,s,i,a)=>{const r="graded"===t.gradingStatus||!e.assessmentConfiguration.isManuallyGraded,o=n?5:3;return Object(ne.jsx)("div",{children:Object(ne.jsxs)(h.e,{className:"row listing",elevation:S.a.ONE,children:[Object(ne.jsxs)("div",{className:`col-xs-${String(o)} listing-picture`,children:[Object(ne.jsx)(Ve,{className:"badge",notificationFilter:De(t.id),large:!0}),Object(ne.jsx)("img",{alt:"Assessment",className:`cover-image-${t.status}`,src:t.coverImage?t.coverImage:_.a})]}),Object(ne.jsxs)("div",{className:`col-xs-${String(12-o)} listing-text`,children:[I(t,s,a),Object(ne.jsx)("div",{className:"listing-xp",children:Object(ne.jsx)(h.t,{children:r?`XP: ${t.xp} / ${t.maxXp}`:`Max XP: ${t.maxXp}`})}),Object(ne.jsx)("div",{className:"listing-description",children:Object(ne.jsx)(ee.a,{content:t.shortSummary})}),Object(ne.jsxs)("div",{className:"listing-footer",children:[Object(ne.jsxs)("div",{children:[Object(ne.jsxs)(h.Y,{className:"listing-due-date",children:[Object(ne.jsx)(h.w,{className:"listing-due-icon",iconSize:12,icon:C.a.CALENDAR}),`${ke(t.openAt)?"Opened":"Opens"}: ${Ae(t.openAt)}`]}),ke(t.openAt)&&Object(ne.jsxs)(h.Y,{className:"listing-due-date",children:[Object(ne.jsx)(h.w,{className:"listing-due-icon",iconSize:12,icon:C.a.TIME}),`Due: ${Ae(t.closeAt)}`]})]}),Object(ne.jsx)("div",{className:"listing-button",children:i?w(t):null})]})]})]})},s)},I=(e,t,n)=>Object(ne.jsxs)("div",{className:"listing-header",children:[Object(ne.jsx)(h.Y,{ellipsize:!0,children:Object(ne.jsxs)(h.r,{className:"listing-title",children:[e.title,e.private?Object(ne.jsx)(E.a,{className:"listing-title-tooltip",content:"This assessment is password-protected.",children:Object(ne.jsx)(h.w,{icon:"lock"})}):null,n?$e(e.gradingStatus):null]})}),Object(ne.jsx)("div",{className:"listing-button",children:O(e)})]}),{assessmentOverviews:N,isStudent:P}=e,R=f.useMemo((()=>null===N||void 0===N?void 0:N.filter((t=>t.type===e.assessmentConfiguration.type))),[N,e.assessmentConfiguration.type]),M=Object(Ee.b)(t.assessmentId),L=Object(Ee.b)(t.questionId)||we.b.defaultQuestionId;if(null!==M&&void 0!==R){const t=R.filter((e=>e.id===M))[0];if(!t)return Object(ne.jsx)(We,{});const n={assessmentId:M,questionId:L,notAttempted:t.status===H.a.not_attempted,canSave:!e.isStudent||t.status!==H.a.submitted&&!ke(t.closeAt),assessmentConfiguration:e.assessmentConfiguration};return Object(ne.jsx)(Re,{...n})}let D;if(void 0===R)D=Object(ne.jsx)(h.G,{description:"Fetching assessment...",icon:Object(ne.jsx)(h.R,{})});else if(0===R.length)D=Object(ne.jsx)(h.G,{title:"There are no assessments.",icon:C.a.FLAME});else{const e=e=>!ke(e.closeAt)&&!ke(e.openAt),t=j(R.filter(e)).map(((e,t)=>k(e,t,!P,!1))),n=e=>!ke(e.closeAt)&&ke(e.openAt)&&e.status!==H.a.submitted,s=j(R.filter((e=>n(e)))).map(((e,t)=>k(e,t,!0,!1))),i=j(R.filter((t=>!n(t)&&!e(t)))).map(((e,t)=>k(e,t,!0,!0))),r=Object(ne.jsxs)(ne.Fragment,{children:[Xe("Upcoming",d,v),Object(ne.jsx)(h.g,{isOpen:d,children:t})]}),o=Object(ne.jsxs)(ne.Fragment,{children:[Xe("Open",c,b),Object(ne.jsx)(h.g,{isOpen:c,children:s})]}),l=Object(ne.jsxs)(ne.Fragment,{children:[Xe("Closed",a,m),Object(ne.jsx)(h.g,{isOpen:a,children:i})]});D=Object(ne.jsxs)(ne.Fragment,{children:[t.length>0?r:null,s.length>0?o:null,i.length>0?l:null]})}const B=s?Object(ne.jsxs)("p",{children:["You are about to finalise your submission for the ",s.type.toLowerCase()," ",Object(ne.jsxs)("i",{children:['"',s.title,'"']}),"."]}):Object(ne.jsx)("p",{children:"You are about to finalise your submission."}),U=Object(ne.jsxs)(ne.Fragment,{children:[B,Object(ne.jsxs)("p",{children:["Finalising your submission early grants you additional XP, but"," ",Object(ne.jsx)("span",{className:"warning",children:"this action is irreversible."})]})]}),G=Object(ne.jsxs)(h.h,{className:"betcha-dialog",icon:C.a.ERROR,isCloseButtonShown:!0,isOpen:null!==s,onClose:y,title:"Finalise submission?",children:[Object(ne.jsx)("div",{className:p.a.DIALOG_BODY,children:Object(ne.jsx)(h.Y,{children:U})}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)(h.c,{children:[Object(ne.jsx)(J.a,{label:"Cancel",onClick:y,options:{minimal:!1}}),Object(ne.jsx)(J.a,{label:"Finalise",onClick:()=>{s&&(e.handleSubmitAssessment(s.id),y())},options:{minimal:!1,intent:g.a.DANGER}})]})})]});return Object(ne.jsxs)("div",{className:"Assessment",children:[Object(ne.jsx)(Me.a,{display:D,loadContentDispatch:e.handleAssessmentOverviewFetch}),G]})};var ze=Object(r.b)(((e,t)=>({assessmentOverviews:e.session.assessmentOverviews,isStudent:!e.session.role||e.session.role===O.a.Student,courseId:e.session.courseId})),(e=>Object(c.b)({handleAcknowledgeNotifications:u.acknowledgeNotifications,handleAssessmentOverviewFetch:u.fetchAssessmentOverviews,handleSubmitAssessment:u.submitAssessment},e)))(qe),Ye=n(121);var Ke=()=>Object(ne.jsx)("div",{className:j()("NoPage",p.a.DARK),children:Object(ne.jsx)(h.G,{icon:C.a.ERROR,title:"404 Not Found",description:"The requested resource could not be found"})}),Qe=n(155),Je=n(93),Ze=n(39);const et={coverImage:`${Ze.d}/default.png`,description:"",completionText:""},tt={uuid:"",title:"Achievement Title Here",xp:0,isVariableXp:!1,isTask:!1,position:0,prerequisiteUuids:[],goalUuids:[],cardBackground:`${Ze.c}/default.png`,view:et};var nt=function(e){const{allowNewUuid:t,setNewUuid:n}=e,s=Object(f.useContext)(Ze.a);return Object(ne.jsx)(h.b,{className:"command-button",disabled:!t,icon:C.a.NEW_OBJECT,onClick:()=>n(s.insertAchievement(tt)),text:"Create Achievement"})},st=n(68);var it=function(e){const{deleteItem:t,item:n}=e;return Object(ne.jsx)(E.a,{content:"Delete",children:Object(ne.jsx)(h.b,{icon:C.a.TRASH,intent:"danger",onClick:async()=>{await Object(st.b)({contents:`Are you sure you want to delete '${n}' ?`,negativeLabel:"No",positiveIntent:"danger",positiveLabel:"Yes, delete"})&&t()}})})};var at=function(e){const{discardChanges:t,saveChanges:n}=e;return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(E.a,{content:"Save Changes",children:Object(ne.jsx)(h.b,{icon:C.a.FLOPPY_DISK,intent:"primary",onClick:()=>{n(),Object(me.d)("Saved changes locally")}})}),Object(ne.jsx)(E.a,{content:"Discard Changes",children:Object(ne.jsx)(h.b,{icon:C.a.CROSS,intent:"danger",onClick:()=>{t(),Object(me.e)("Discarded changes")}})})]})},rt=n(1168);var ot=function(e){const{changeGoalUuids:t,goalUuids:n}=e,s=Object(f.useContext)(Ze.a),i=s.getAllGoalUuids(),a=n.filter((e=>!s.isInvalidGoal(s.getGoal(e)))),r=rt.a.ofType(),o=new Set(a),c=new Set(Object(T.without)(i,...n)),l=e=>{void 0!==l&&(o.delete(e),c.add(e),t([...o]))};return Object(ne.jsx)(r,{itemRenderer:(e,t)=>{let{handleClick:n}=t;return Object(ne.jsx)(h.B,{onClick:n,text:e.text},e.uuid)},items:[...c].map((e=>s.getGoal(e))),noResults:Object(ne.jsx)(h.B,{disabled:!0,text:"No available goal"}),onItemSelect:e=>{return n=e.uuid,o.add(n),c.delete(n),void t([...o]);var n},selectedItems:[...o].map((e=>s.getGoal(e))),tagInputProps:{onRemove:e=>l((e=>s.getUuidByText(e))(e.toString()))},tagRenderer:e=>e.text,itemPredicate:(e,t)=>t.text.toLowerCase().includes(e.toLowerCase()),resetOnSelect:!0})},ct=n(331);var lt=function(e){const{changePosition:t,position:n}=e,s=Object(f.useContext)(Ze.a).listTaskUuids().length+1,i=[...Array(s+1).keys()],a=ct.a.ofType();return Object(ne.jsx)(a,{filterable:!1,itemRenderer:(e,t)=>{let{handleClick:n}=t;return Object(ne.jsx)(h.B,{onClick:n,text:e},e)},items:i,onItemSelect:t,children:Object(ne.jsx)(h.b,{text:n})})};var dt=function(e){const{changePrerequisiteUuids:t,uuid:n,prerequisiteUuids:s}=e,i=Object(f.useContext)(Ze.a),a=[],r=s.filter((e=>!i.isInvalidAchievement(i.getAchievement(e)))),o=rt.a.ofType(),c=new Set(r),l=new Set(Object(T.without)(a,...r));return Object(ne.jsx)(o,{itemRenderer:(e,t)=>{let{handleClick:n}=t;return Object(ne.jsx)(h.B,{onClick:n,text:e.title},e.uuid)},items:[...l].map((e=>i.getAchievement(e))),noResults:Object(ne.jsx)(h.B,{disabled:!0,text:"No available achievement"}),onItemSelect:e=>{return n=e.uuid,c.add(n),l.delete(n),void t([...c]);var n},selectedItems:[...c].map((e=>i.getAchievement(e))),tagInputProps:{onRemove:e=>{var n;void 0!==(n=(e=>i.getUuidByTitle(e))(e.toString()))&&(c.delete(n),l.add(n),t([...c]))}},tagRenderer:e=>e.title,itemPredicate:(e,t)=>t.title.toLowerCase().includes(e.toLowerCase()),resetOnSelect:!0})};var ut=function(e){const{changeCardBackground:t,changeGoalUuids:n,changePosition:s,changePrerequisiteUuids:i,changeIsVariableXp:a,editableAchievement:r}=e,{uuid:o,cardBackground:c,goalUuids:l,position:d,prerequisiteUuids:u,isVariableXp:p}=r,[g,m]=Object(f.useState)(!1),b=()=>m(!g);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(E.a,{content:"More Settings",children:Object(ne.jsx)(h.b,{icon:C.a.WRENCH,onClick:b})}),Object(ne.jsx)(h.h,{title:"More Settings",icon:C.a.WRENCH,isOpen:g,onClose:b,children:Object(ne.jsxs)("div",{style:{padding:"0 0.5em"},children:[Object(ne.jsx)("h3",{children:"Card Background"}),Object(ne.jsx)(h.l,{multiline:!0,onChange:t,placeholder:"Enter card background URL here",value:c}),Object(ne.jsx)("h3",{children:"Position"}),Object(ne.jsx)("p",{children:"Note: Select position 0 to hide achievement"}),Object(ne.jsx)(lt,{changePosition:s,position:d}),Object(ne.jsx)("h3",{children:"Prerequisites"}),Object(ne.jsx)(dt,{changePrerequisiteUuids:i,uuid:o,prerequisiteUuids:u}),Object(ne.jsx)("h3",{children:"Goals"}),Object(ne.jsx)(ot,{changeGoalUuids:n,goalUuids:l}),Object(ne.jsx)("h3",{children:"Variable XP"}),Object(ne.jsx)(h.f,{label:"The rewarded XP will be equal to the sum of 'count' of goals",checked:p,onChange:a})]})})]})};var ht=function(e){const{uuid:t}=e;return Object(ne.jsx)(ne.Fragment,{children:Object(ne.jsx)(E.a,{content:"Click to copy achievement UUID",children:Object(ne.jsx)(h.b,{icon:C.a.CLIPBOARD,onClick:()=>{navigator.clipboard.writeText(t),Object(me.d)("UUID copied to clipboard")}})})})};let pt;!function(e){e.CHANGE_CARD_BACKGROUND="CHANGE_CARD_BACKGROUND",e.CHANGE_DEADLINE="CHANGE_DEADLINE",e.CHANGE_GOAL_UUIDS="CHANGE_GOAL_UUIDS",e.CHANGE_POSITION="CHANGE_POSITION",e.CHANGE_PREREQUISITE_UUIDS="CHANGE_PREREQUISITE_UUIDS",e.CHANGE_RELEASE="CHANGE_RELEASE",e.CHANGE_TITLE="CHANGE_TITLE",e.CHANGE_IS_VARIABLE_XP="CHANGE_VARIABLE_XP",e.CHANGE_VIEW="CHANGE_VIEW",e.CHANGE_XP="CHANGE_XP",e.DELETE_ACHIEVEMENT="DELETE_ACHIEVEMENT",e.DISCARD_CHANGES="DISCARD_CHANGES",e.SAVE_CHANGES="SAVE_CHANGES"}(pt||(pt={}));var gt=n(457),mt=n(73);var bt=function(e){const{type:t,date:n,changeDate:s}=e,[i,a]=Object(f.useState)(!1),r=()=>a(!i),o=void 0===n?`No ${t}`:`${Object(mt.d)(n)}`;return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(E.a,{content:o,children:Object(ne.jsx)(h.b,{minimal:!0,onClick:r,outlined:!0,children:`${t}`})}),Object(ne.jsxs)(h.h,{isCloseButtonShown:!1,isOpen:i,onClose:r,style:{background:"#fff",maxWidth:"max-content",padding:"0.25em",textAlign:"center"},title:`${t}`,children:[Object(ne.jsx)(gt.a,{onChange:s,timePickerProps:{showArrowButtons:!0},value:n}),Object(ne.jsx)(h.b,{onClick:()=>s(void 0),text:`Remove ${t}`})]})]})};var ft=function(e){const{changeView:t,view:n}=e,{coverImage:s,description:i,completionText:a}=n,[r,o]=Object(f.useState)(!1),c=()=>o(!r);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(E.a,{content:"Edit View",children:Object(ne.jsx)(h.b,{icon:C.a.WIDGET_HEADER,onClick:c})}),Object(ne.jsx)(h.h,{title:"Edit View",icon:C.a.WIDGET_HEADER,isOpen:r,onClose:c,children:Object(ne.jsxs)("div",{style:{padding:"0 0.5em"},children:[Object(ne.jsx)("h3",{children:"Cover Image"}),Object(ne.jsx)(h.l,{multiline:!0,onChange:e=>t({...n,coverImage:e}),placeholder:"Enter cover image URL here",value:s}),Object(ne.jsx)("h3",{children:"Description"}),Object(ne.jsx)(h.l,{multiline:!0,onChange:e=>t({...n,description:e}),placeholder:"Enter description here",value:i}),Object(ne.jsx)("h3",{children:"Completion Text"}),Object(ne.jsx)(h.l,{multiline:!0,onChange:e=>t({...n,completionText:e}),placeholder:"Enter completion text here",value:a})]})})]})};const vt=e=>({editableAchievement:e,isDirty:!1}),yt=(e,t)=>{switch(t.type){case pt.SAVE_CHANGES:return{...e,isDirty:!1};case pt.DISCARD_CHANGES:return vt(t.payload);case pt.DELETE_ACHIEVEMENT:return{...e,isDirty:!1};case pt.CHANGE_CARD_BACKGROUND:return{editableAchievement:{...e.editableAchievement,cardBackground:t.payload},isDirty:!0};case pt.CHANGE_DEADLINE:return{editableAchievement:{...e.editableAchievement,deadline:t.payload},isDirty:!0};case pt.CHANGE_GOAL_UUIDS:return{editableAchievement:{...e.editableAchievement,goalUuids:t.payload},isDirty:!0};case pt.CHANGE_POSITION:return{editableAchievement:{...e.editableAchievement,isTask:0!==t.payload,position:t.payload},isDirty:!0};case pt.CHANGE_PREREQUISITE_UUIDS:return{editableAchievement:{...e.editableAchievement,prerequisiteUuids:t.payload},isDirty:!0};case pt.CHANGE_RELEASE:return{editableAchievement:{...e.editableAchievement,release:t.payload},isDirty:!0};case pt.CHANGE_TITLE:return{editableAchievement:{...e.editableAchievement,title:t.payload},isDirty:!0};case pt.CHANGE_VIEW:return{editableAchievement:{...e.editableAchievement,view:t.payload},isDirty:!0};case pt.CHANGE_XP:return{editableAchievement:{...e.editableAchievement,xp:t.payload},isDirty:!0};case pt.CHANGE_IS_VARIABLE_XP:return{editableAchievement:{...e.editableAchievement,isVariableXp:!e.editableAchievement.isVariableXp},isDirty:!0};default:return e}};var jt=function(e){const{uuid:t,isNewAchievement:n,releaseUuid:s,removeCard:i,requestPublish:a}=e,r=Object(f.useContext)(Ze.a),o=r.getAchievement(t),c=Object(f.useMemo)((()=>Object(T.cloneDeep)(o)),[o]),[l,d]=Object(f.useReducer)(yt,c,vt),[u,p]=Object(f.useState)(n),{editableAchievement:g,isDirty:m}=l,{cardBackground:b,deadline:v,release:y,title:j,view:x,xp:O}=g;return Object(ne.jsxs)("li",{className:"editable-card",style:{background:`url(${b}) center/cover`},children:[Object(ne.jsx)("div",{className:"action-button",children:m?Object(ne.jsx)(at,{discardChanges:()=>d({type:pt.DISCARD_CHANGES,payload:c}),saveChanges:()=>{d({type:pt.SAVE_CHANGES}),r.modifyAchievement(g),u&&(s(),p(!1)),a()}}):Object(ne.jsx)(it,{deleteItem:()=>{d({type:pt.DELETE_ACHIEVEMENT}),r.removeAchievement(t),u&&(s(),p(!1)),i(t),a()},item:j})}),Object(ne.jsxs)("div",{className:"content",children:[Object(ne.jsx)("h3",{className:"title",children:Object(ne.jsx)(h.l,{onChange:e=>d({type:pt.CHANGE_TITLE,payload:e}),placeholder:"Enter your title here",value:j})}),Object(ne.jsx)("div",{className:"xp",children:Object(ne.jsx)(E.a,{content:"XP",children:Object(ne.jsx)(h.H,{value:O,min:0,allowNumericCharactersOnly:!0,leftIcon:C.a.TRENDING_UP,placeholder:"XP",onValueChange:e=>d({type:pt.CHANGE_XP,payload:e})})})}),Object(ne.jsxs)("div",{className:"details",children:[Object(ne.jsx)(bt,{changeDate:e=>d({type:pt.CHANGE_RELEASE,payload:e}),date:y,type:"Release"}),Object(ne.jsx)(bt,{changeDate:e=>d({type:pt.CHANGE_DEADLINE,payload:e}),date:v,type:"Deadline"}),Object(ne.jsx)(ht,{uuid:t})]})]}),Object(ne.jsxs)("div",{className:"content-button",children:[Object(ne.jsx)(ft,{changeView:e=>d({type:pt.CHANGE_VIEW,payload:e}),view:x}),Object(ne.jsx)(ut,{changeCardBackground:e=>d({type:pt.CHANGE_CARD_BACKGROUND,payload:e}),changeGoalUuids:e=>{d({type:pt.CHANGE_GOAL_UUIDS,payload:e})},changePosition:e=>d({type:pt.CHANGE_POSITION,payload:e}),changePrerequisiteUuids:e=>d({type:pt.CHANGE_PREREQUISITE_UUIDS,payload:e}),changeIsVariableXp:()=>d({type:pt.CHANGE_IS_VARIABLE_XP}),editableAchievement:g})]})]})};let xt=[];var Ot=function(e){const{requestPublish:t}=e,n=Object(f.useContext)(Ze.a),[s,i]=Object(f.useState)(""),a=""===s,r=()=>i(""),o=e=>{let t=0;for(;xt[t].key!==e&&t<xt.length;)t++;xt.splice(t,1)},c=(e,n)=>Object(ne.jsx)(jt,{uuid:e,isNewAchievement:n,releaseUuid:r,removeCard:o,requestPublish:t},e);return 0===xt.length&&(xt=n.listSortedAchievementUuids().map((e=>c(e,!1)))),Object(ne.jsxs)("div",{className:"achievement-editor",children:[Object(ne.jsx)("div",{className:"command",children:Object(ne.jsx)(nt,{allowNewUuid:a,setNewUuid:e=>{i(e),xt[xt.length]=xt[0],xt[0]=c(e,!0)}})}),Object(ne.jsx)("ul",{className:"achievement-container",children:xt})]})},St=n(25);var wt=function(e){const{filterState:t,icon:n,ownStatus:s}=e,[i,a]=t;return Object(ne.jsxs)("div",{className:"filter",onClick:()=>a(s),style:{color:Object(Ze.h)(i,s)},children:[Object(ne.jsx)(h.w,{icon:n,iconSize:30}),Object(ne.jsx)("p",{children:s})]})},Ct=n(255),Et=n(15);var Tt=function(e){const{studentXp:t}=e;return Object(ne.jsxs)("div",{className:"milestone",children:[Object(ne.jsx)("h3",{children:"Your Total XP"}),Object(ne.jsxs)("div",{className:"user-xp",children:[t," XP"]}),Object(ne.jsx)("h3",{children:"CA Achievement Level"}),Object(ne.jsxs)("div",{className:"details",children:[Object(ne.jsxs)("div",{className:"level-badge",children:[Object(ne.jsx)("span",{className:"level-icon"}),Object(ne.jsx)("p",{children:we.b.caFulfillmentLevel})]}),Object(ne.jsx)("p",{className:"description",children:"Complete CS1101S CA Component"})]}),Object(ne.jsxs)("div",{className:"details",children:[Object(ne.jsxs)("div",{className:"level-badge",children:[Object(ne.jsx)("span",{className:"level-icon"}),Object(ne.jsxs)("p",{children:[we.b.caFulfillmentLevel,"+"]})]}),Object(ne.jsx)("p",{className:"description",children:"Counts towards CS1010R"})]}),Object(ne.jsx)("div",{className:"footer",children:Object(ne.jsxs)("p",{children:["Full CA level of ",we.b.caFulfillmentLevel," is subjected to change."]})})]})};var kt=function(e){const{studentXp:t}=e,[n,s]=Object(f.useState)(!1),i=Math.floor(t/Ze.j)+1,a=t%Ze.j,r=a/Ze.j;return Object(ne.jsxs)("div",{className:"level",onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[Object(ne.jsxs)("div",{className:"level-badge",children:[Object(ne.jsx)("span",{className:"level-icon"}),Object(ne.jsx)("p",{children:`Level ${i}`})]}),Object(ne.jsxs)("span",{className:"level-progress",children:[Object(ne.jsx)(h.N,{animate:!1,className:"progress-bar",stripes:!1,value:r}),Object(ne.jsxs)("p",{children:[a," / ",Ze.j," XP"]})]}),0!==we.b.caFulfillmentLevel&&n&&Object(ne.jsx)(Tt,{studentXp:t})]})};var At=function(e){const{name:t,userState:n}=e,[s]=n,i=null===s||void 0===s?void 0:s.courseRegId,a=Object(x.f)((e=>e.session.courseRegId)),o=Object(r.c)();Object(f.useEffect)((()=>{o(i&&i!==a?{type:Et.p,payload:i}:{type:Et.o})}),[i,a,o]);const c=Object(x.f)((e=>e.session.xp));return Object(ne.jsxs)("div",{className:"achievement-overview",children:[Object(ne.jsx)(kt,{studentXp:c}),Object(ne.jsx)("h3",{children:t})]})};const _t=new Date(0,0,2).getTime()-new Date(0,0,0).getTime();var It=function(e){const{deadline:t}=e,n=void 0!==t&&!Object(mt.a)(t)&&Object(mt.g)(t)<=_t?Ze.b.RED:Ze.b.BLACK;return Object(ne.jsxs)("div",{className:"deadline",children:[Object(ne.jsx)(h.w,{color:n,icon:C.a.STOPWATCH}),Object(ne.jsx)("p",{style:{color:n},children:Object(mt.e)(t)})]})};const Nt=(e,t)=>(t?"Total ":"")+e+" XP";var Pt=function(e){const{isBonus:t,xp:n}=e;return Object(ne.jsx)("div",{className:"xp",children:0!==n&&Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(h.w,{icon:C.a.BANK_ACCOUNT}),Object(ne.jsx)("p",{children:Nt(n,t)})]})})};var Rt=function(e){const{uuid:t,focusState:n,isDropdownOpen:s,shouldRender:i,toggleDropdown:a}=e,r=Object(f.useContext)(Ze.a),[o,c]=n,{cardBackground:l,title:d}=r.getAchievement(t),u=r.getDisplayDeadline(t),p=r.getDescendantXp(t),m=r.getProgressFrac(t),b=r.getStatus(t),v=void 0!==s&&0!==r.getImmediateChildren(t).size;return Object(ne.jsxs)("div",{className:"achievement-card",onClick:()=>c(t),onClickCapture:a,style:{...Object(Ze.i)(t,o),opacity:i?"100%":"20%",background:`url(${l}) center/cover`},children:[Object(ne.jsx)("div",{className:"dropdown-button",children:v&&Object(ne.jsx)(h.w,{icon:s?C.a.CARET_DOWN:C.a.CARET_RIGHT})}),Object(ne.jsxs)("div",{className:"content",children:[Object(ne.jsxs)("div",{className:"heading",children:[Object(ne.jsx)("h3",{children:d.toUpperCase()}),b===St.b.COMPLETED&&Object(ne.jsx)(h.w,{icon:C.a.CONFIRM,intent:g.a.SUCCESS,style:{padding:"1em"}})]}),Object(ne.jsxs)("div",{className:"details",children:[Object(ne.jsx)(It,{deadline:u}),Object(ne.jsx)(Pt,{isBonus:v,xp:p})]}),Object(ne.jsx)(h.N,{animate:!1,className:"progress",intent:1===m?"success":"primary",stripes:!1,value:m})]})]})};var Mt=e=>{let{uuid:t,filterStatus:n,focusState:s}=e;const i=Object(f.useContext)(Ze.a),a=[...i.getImmediateChildren(t)],r=Object(Ze.f)(),[o,c]=Object(f.useState)(!1),l=e=>{const t=i.getStatus(e);switch(n){case St.f.ALL:return!0;case St.f.ACTIVE:return t===St.b.ACTIVE;case St.f.COMPLETED:return t===St.b.COMPLETED;default:return!1}};return Object(ne.jsx)(ne.Fragment,{children:(e=>(e=>!i.isPrerequisite(e)&&l(e))(e)||(e=>[...i.getImmediateChildren(e)].reduce(((e,t)=>e||l(t)),!1))(e))(t)&&Object(ne.jsxs)("li",{className:"task",children:[Object(ne.jsx)(Rt,{uuid:t,focusState:s,isDropdownOpen:o,shouldRender:l(t),toggleDropdown:()=>c(!o)}),Object(ne.jsx)(h.g,{isOpen:o,keepChildrenMounted:!0,children:Object(ne.jsx)("div",{className:"prerequisite-container",children:a.map((e=>Object(ne.jsxs)("div",{className:"prerequisite",children:[Object(ne.jsx)("div",{className:"dropdown-lines",style:{borderBottom:`1px solid ${r}`,borderLeft:`1px solid ${r}`}}),Object(ne.jsx)(Rt,{uuid:e,focusState:s,shouldRender:l(e)})]},e)))})})]})})};var Lt=e=>{let{assessment:t,showToQuestion:n}=e;const s=Object(x.f)((e=>e.session.courseId)),i=Object(f.useMemo)((()=>e=>{if(!s)return void Object(me.e)("Course ID not found");const n=`/courses/${s}/${Object(Ee.a)(null===t||void 0===t?void 0:t.type)}`+`/${null===t||void 0===t?void 0:t.id.toString()}`;Ce.a.push(n+`/${e}`)}),[null===t||void 0===t?void 0:t.id,null===t||void 0===t?void 0:t.type,s]);return Object(ne.jsxs)("div",{children:[Object(ne.jsx)("h1",{className:"assessment-feedback",children:"Feedback"}),Object(ne.jsx)("div",{className:"feedback-list",children:t&&t.questions.map(((e,t)=>Object(ne.jsxs)("div",{className:"assessment-comments",children:[Object(ne.jsx)("span",{children:Object(ne.jsx)("h2",{className:"question-header",children:"Q"+(t+1)})}),Object(ne.jsxs)("div",{className:"box-comment",children:[Object(ne.jsx)("p",{children:null===e.comments?"No Comments":e.comments}),Object(ne.jsx)("p",{className:"xp",children:"XP: "+e.xp+"/"+e.maxXp})]}),n&&Object(ne.jsx)("button",{className:"to-assessment-button",onClick:()=>i(t),children:"To Question"})]},t)))})]})};var Dt=function(e){const{awardedXp:t,completionText:n}=e,s=n?n.split("\n"):[""];return Object(ne.jsxs)("div",{className:"completion",children:[t>0&&Object(ne.jsx)("h1",{children:`AWARDED ${t}XP`}),s.map(((e,t)=>Object(ne.jsxs)("p",{children:[e,Object(ne.jsx)("br",{})]},t)))]})};var Bt=function(e){const{goals:t}=e;return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("h1",{className:"progress-header",children:"Progress"}),t.map((e=>(e=>{const{uuid:t,text:n,targetCount:s,count:i,completed:a}=e,r=Math.min(0===s?0:i/s,1);return Object(ne.jsxs)("div",{className:"goal",children:[Object(ne.jsxs)("div",{className:"goal-badge",children:[Object(ne.jsx)("span",{className:"goal-icon"}),Object(ne.jsxs)("p",{children:[i," / ",s]})]}),Object(ne.jsxs)("div",{className:"goal-progress",children:[Object(ne.jsx)("p",{children:n}),Object(ne.jsx)(h.N,{animate:!1,className:"progress",intent:a?"success":void 0,stripes:!1,value:r})]})]},t)})(e)))]})};var Ut=function(e){var t;let{focusUuid:n,userState:s}=e;const i=Number.isNaN(+n)||0===+n?void 0:+n;let a;if(s){const[e]=s;a=null===e||void 0===e?void 0:e.courseRegId}const o=Object(x.f)((e=>e.session.courseRegId)),c=void 0!==a&&a!==o,l=Object(r.c)();Object(f.useEffect)((()=>{l({type:H.b}),i&&l(c?{type:Et.g,payload:{assessmentId:i,courseRegId:a}}:{type:Et.f,payload:i})}),[l,i,a,c]);const d=Object(f.useContext)(Ze.a),u=Object(x.f)((e=>e.session.assessments)).get(i),p=(null!==(t=Object(x.f)((e=>e.session.assessmentOverviews)))&&void 0!==t?t:[]).find((e=>e.id===i));if(""===n)return Object(ne.jsxs)("div",{className:"no-view",children:[Object(ne.jsx)(h.w,{icon:C.a.MOUNTAIN,iconSize:60}),Object(ne.jsx)("h2",{children:"Select an achievement"})]});const g=d.getAchievement(n),{deadline:m,title:b,view:v}=g,{coverImage:y,completionText:j,description:O}=v,S=d.getAchievementXp(n),w=d.listGoals(n),E=d.getStatus(n),T=O?O.split("\n"):[""];return Object(ne.jsxs)("div",{className:"view",style:{...Object(Ze.g)(),...Object(Ze.e)()},children:[Object(ne.jsxs)("div",{className:"cover",style:{background:`rgba(0, 0, 0, 0.5) url(${y}) center/cover`,backgroundBlendMode:"darken"},children:[Object(ne.jsx)("h1",{children:b.toUpperCase()}),m&&Object(ne.jsx)("p",{children:`Deadline: ${Object(mt.d)(m)}`}),Object(ne.jsx)("span",{className:"description",children:T.map(((e,t)=>Object(ne.jsxs)("p",{children:[e,Object(ne.jsx)("br",{})]},t)))})]}),E===St.b.COMPLETED&&u&&p&&p.isManuallyGraded&&Object(ne.jsx)(Lt,{assessment:u,showToQuestion:!c}),w.length>0&&Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(Bt,{goals:w}),E===St.b.COMPLETED&&Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("hr",{}),Object(ne.jsx)(Dt,{awardedXp:S,completionText:j})]})]})]})};function Gt(e){return"graded"===e.gradingStatus||!e.isManuallyGraded&&"submitted"===e.status}var Ft=function(e,t,n){const s=[...e].sort(((e,t)=>b()(e.closeAt).diff(b()(t.closeAt)))),i=e.length,a=t.map((e=>e.type)),r=a.map((e=>[]));s.forEach(((e,t)=>{if(!Object(mt.b)(new Date(e.openAt))||Object(mt.a)(new Date(e.closeAt))&&"submitted"!==e.status)return;const s=e.id.toString();n.hasAchievement(s)||(n.insertFakeGoalDefinition({uuid:s+"0",text:`Submitted ${e.title}`,achievementUuids:[s],meta:{type:St.l.ASSESSMENT,assessmentNumber:e.id,requiredCompletionFrac:0}},"submitted"===e.status),e.isManuallyGraded&&n.insertFakeGoalDefinition({uuid:s+"1",text:`Graded ${e.title}`,achievementUuids:[s],meta:{type:St.l.ASSESSMENT,assessmentNumber:e.id,requiredCompletionFrac:0}},"graded"===e.gradingStatus),n.insertFakeAchievement({uuid:s,title:e.title,xp:Gt(e)?e.xp:e.maxXp,isVariableXp:!1,deadline:new Date(e.closeAt),release:new Date(e.openAt),isTask:void 0!==e.isPublished&&e.isPublished,position:t-i-100,prerequisiteUuids:[],goalUuids:e.isManuallyGraded?[s+"0",s+"1"]:[s+"0"],cardBackground:`${Ze.c}/default.png`,view:{coverImage:e.coverImage,description:e.shortSummary,completionText:`XP: ${e.xp} / ${e.maxXp}`}}),Gt(e)&&a.forEach(((t,n)=>{t===e.type&&r[n].push(s)})))})),r.forEach(((e,t)=>{const s=a[t];e.length>0&&n.insertFakeAchievement({uuid:s,title:"Completed "+s,xp:0,isVariableXp:!1,deadline:void 0,release:void 0,isTask:!0,position:-1-t,prerequisiteUuids:e,goalUuids:[],cardBackground:`${Ze.c}/default.png`,view:{coverImage:`${Ze.d}/default.png`,description:"Your completed "+s+" are listed here!",completionText:""}})}))};const Ht=(e,t,n)=>e.map((e=>Object(ne.jsx)(Mt,{uuid:e,filterStatus:t,focusState:n},e)));var Vt=function(e){const{getAchievements:t,getOwnGoals:n,getGoals:s,getUserAssessmentOverviews:i,getUsers:a,updateGoalProgress:r,fetchAssessmentOverviews:o,group:c,inferencer:l,name:d,role:u,assessmentConfigs:h,assessmentOverviews:p,achievementAssessmentOverviews:g,users:m}=e,b=Object(f.useState)(void 0),[v]=b;Object(f.useEffect)((()=>{v?s(v.courseRegId):n(),v?i(v.courseRegId):o(),t()}),[v,t,s,n,i,o]);const y=v?g:p;y&&h&&Ft(y,h,l);const j=Object(f.useState)(St.f.ALL),[x]=j,S=Object(f.useState)(""),[w,E]=S,T=Object(f.useState)(!1),[k]=T;return Object(f.useEffect)((()=>{E("")}),[v,E]),Object(ne.jsx)(Ze.a.Provider,{value:l,children:Object(ne.jsxs)("div",{className:"AchievementDashboard",children:[Object(ne.jsx)(At,{name:v?v.name||v.username:d||"User",userState:b}),u&&u!==O.a.Student&&Object(ne.jsx)(Ct.a,{userState:b,hiddenState:T,studio:c||"Staff",users:m,getUsers:a,updateGoalProgress:r}),Object(ne.jsxs)("div",{className:"achievement-main",children:[Object(ne.jsxs)("div",{className:"filter-container",children:[Object(ne.jsx)(wt,{filterState:j,icon:C.a.GLOBE,ownStatus:St.f.ALL}),Object(ne.jsx)(wt,{filterState:j,icon:C.a.LOCATE,ownStatus:St.f.ACTIVE}),Object(ne.jsx)(wt,{filterState:j,icon:C.a.ENDORSED,ownStatus:St.f.COMPLETED})]}),Object(ne.jsx)("ul",{className:"task-container",children:Ht(u!==O.a.Student&&k?l.listAllSortedAchievementUuids():l.listSortedReleasedTaskUuids(),x,S)}),Object(ne.jsx)("div",{className:"view-container",children:Object(ne.jsx)(Ut,{focusUuid:w,userState:b})})]})]})})};var Wt=function(e){const{awaitPublish:t,publishChanges:n}=e,s=Object(f.useContext)(Ze.a),[i,a]=Object(f.useReducer)((e=>!e),!1),r=Object(f.useState)(""),[o]=r;return Object(ne.jsxs)("div",{className:"achievement-preview",children:[Object(ne.jsxs)("div",{className:"command",children:[Object(ne.jsx)(h.b,{className:"command-button",icon:i&&C.a.ARROW_LEFT,rightIcon:!i&&C.a.ARROW_RIGHT,text:i?"Task":"View",onClick:a}),t&&Object(ne.jsx)(h.b,{className:"command-button",icon:C.a.CLOUD_UPLOAD,intent:"primary",text:"Publish Changes",onClick:n})]}),i?Object(ne.jsx)("div",{className:"preview-container",children:Object(ne.jsx)(Ut,{focusUuid:o})}):Object(ne.jsx)("ul",{className:"preview-container",children:Ht(s.listSortedTaskUuids(),St.f.ALL,r)})]})};let $t;!function(e){e.CHANGE_META="CHANGE_META",e.CHANGE_TEXT="CHANGE_TEXT",e.DELETE_GOAL="DELETE_GOAL",e.DISCARD_CHANGES="DISCARD_CHANGES",e.SAVE_CHANGES="SAVE_CHANGES"}($t||($t={}));const Xt=e=>{switch(e){case St.l.ASSESSMENT:return{type:St.l.ASSESSMENT,assessmentNumber:0,requiredCompletionFrac:0};case St.l.BINARY:return{type:St.l.BINARY,condition:!1,targetCount:1};case St.l.MANUAL:return{type:St.l.MANUAL,targetCount:1};case St.l.EVENT:return{type:St.l.EVENT,eventNames:[St.e.RUN_CODE],targetCount:1,release:void 0,deadline:void 0,observeFrom:void 0,observeTo:void 0}}},qt={uuid:"",text:"Goal Text Here",achievementUuids:[],meta:Xt(St.l.MANUAL)};var zt=function(e){const{assessmentMeta:t,changeMeta:n}=e,{assessmentNumber:s,requiredCompletionFrac:i}=t;return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(E.a,{content:"Assessment Number",children:Object(ne.jsx)(h.H,{allowNumericCharactersOnly:!0,onValueChange:e=>n({...t,assessmentNumber:e}),placeholder:"Enter assessment number here",value:s})}),Object(ne.jsx)(E.a,{content:"Required Completion Percentage",children:Object(ne.jsx)(h.H,{allowNumericCharactersOnly:!0,max:100,min:0,onValueChange:e=>{const s=e/100;n({...t,requiredCompletionFrac:s})},placeholder:"Enter required completion percentage here",rightElement:Object(ne.jsx)("p",{children:"%"}),value:100*i})})]})};let Yt;function Kt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{type:"AND",operands:t}}function Qt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{type:"OR",operands:t}}!function(e){e.ACHIEVEMENT="achievement",e.ASSESSMENT_GRADING="assessment-grading",e.ASSESSMENT_SUBMISSION="assessment-submission"}(Yt||(Yt={}));const Jt=ct.a.ofType(),Zt=(e,t)=>{let{handleClick:n}=t;return Object(ne.jsx)(h.B,{onClick:n,text:e},e)},en=e=>{if("object"===typeof e&&"type"in e){const{type:t,operands:n}=e,s=n.length,i=[];for(let e=0;e<s;e++)i.push(en(n[e])),e!==s-1&&i.push(t);return i.flat()}return[JSON.stringify(e)]};var tn=function(e){const{binaryMeta:t,changeMeta:n}=e,{condition:s,targetCount:i}=t,a=[],r=[],o=en(s);for(let l=0;l<o.length;l++)l%2===0?r[r.length]=o[l]:a[a.length]=o[l];const c=()=>{let e=JSON.parse(r[0]);for(let t=1;t<r.length;t++)e="AND"===a[t-1]?Kt(e,JSON.parse(r[t])):Qt(e,JSON.parse(r[t]));n({...t,condition:e})};return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(E.a,{content:"Target Count",children:Object(ne.jsx)(h.H,{allowNumericCharactersOnly:!0,leftIcon:C.a.BANK_ACCOUNT,min:0,onValueChange:e=>n({...t,targetCount:e}),placeholder:"Enter target count here",value:i})}),o.map(((e,t)=>Object(ne.jsx)("div",{children:t%2===0?Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(E.a,{content:"Condition",children:Object(ne.jsx)(h.l,{onChange:e=>((e,t)=>{r[t]=e,c()})(e,t/2),multiline:!0,placeholder:"Enter condition here",value:e})}),r.length>1&&Object(ne.jsx)(E.a,{content:"Delete Condition",children:Object(ne.jsx)(h.b,{intent:"danger",icon:"trash",onClick:()=>(e=>{for(let t=e;t<r.length-1;t++)r[t]=r[t+1],a[t]=a[t+1];r.length=r.length-1,a.length=a.length-1,c()})(t)})})]}):Object(ne.jsx)(E.a,{content:"And/Or",children:Object(ne.jsx)(Jt,{filterable:!1,itemRenderer:Zt,items:["AND","OR"],onItemSelect:e=>((e,t)=>{a[t]=e,c()})(e,(t-1)/2),children:Object(ne.jsx)(h.b,{minimal:!0,outlined:!0,text:e})})})},t))),Object(ne.jsx)("br",{}),Object(ne.jsx)(h.b,{minimal:!0,outlined:!0,text:"Add Condition",onClick:()=>{a.push("AND"),r.push('{"event":"", "restriction":""}'),c()}})]})};var nn=function(e){const{type:t,date:n,changeDate:s}=e,[i,a]=Object(f.useState)(!1),r=()=>a(!i),o=void 0===n?`No ${t}`:`${Object(mt.d)(n)}`;return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(E.a,{content:o,children:Object(ne.jsx)(h.b,{minimal:!0,onClick:r,outlined:!0,children:`${t}`})}),Object(ne.jsxs)(h.h,{isCloseButtonShown:!1,isOpen:i,onClose:r,style:{background:"#fff",maxWidth:"max-content",padding:"0.25em",textAlign:"center"},title:`${t}`,children:[Object(ne.jsx)(gt.a,{onChange:s,timePickerProps:{showArrowButtons:!0},value:n}),Object(ne.jsx)(h.b,{onClick:()=>s(void 0),text:`Remove ${t}`})]})]})},sn=n(460);var an=function(e){const{type:t,time:n,changeTime:s}=e,[i,a]=Object(f.useState)(!1),r=()=>a(!i),o=void 0===n?`No ${t}`:`${Object(mt.f)(n)}`;return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(E.a,{content:o,children:Object(ne.jsx)(h.b,{minimal:!0,onClick:r,outlined:!0,children:`${t}`})}),Object(ne.jsxs)(h.h,{isCloseButtonShown:!1,isOpen:i,onClose:r,style:{background:"#fff",maxWidth:"max-content",padding:"0.25em",textAlign:"center"},title:`${t}`,children:[Object(ne.jsx)(sn.a,{onChange:s,showArrowButtons:!0,value:n}),Object(ne.jsx)(h.b,{onClick:()=>s(void 0),text:`Remove ${t}`})]})]})};const rn=ct.a.ofType(),on=(e,t)=>{let{handleClick:n}=t;return Object(ne.jsx)(h.B,{onClick:n,text:e},e)};var cn=function(e){const{changeMeta:t,eventMeta:n}=e,{eventNames:s,targetCount:i,release:a,deadline:r,observeFrom:o,observeTo:c}=n,l=e=>i=>((e,i)=>{e===St.e.NONE?t({...n,eventNames:s.filter(((e,t)=>t!==i))}):(s[i]=e,t({...n,eventNames:s}))})(i,e);return Object(ne.jsxs)(ne.Fragment,{children:[s.map(((e,t)=>Object(ne.jsx)(E.a,{content:"Change event type "+t,children:Object(ne.jsx)(rn,{filterable:!1,items:Object.values(St.e),itemRenderer:on,onItemSelect:l(t),children:Object(ne.jsx)(h.b,{outlined:!0,text:e})})},t))),Object(ne.jsx)(E.a,{content:"Add Event",children:Object(ne.jsx)(h.b,{outlined:!0,text:"Add Event",onClick:()=>{s[s.length]=St.e.RUN_CODE,t({...n,eventNames:s})}})}),Object(ne.jsx)(E.a,{content:"Target Count",children:Object(ne.jsx)(h.H,{allowNumericCharactersOnly:!0,leftIcon:C.a.LOCATE,min:0,onValueChange:e=>t({...n,targetCount:e}),placeholder:"Enter target count here",value:i})}),Object(ne.jsx)("br",{}),Object(ne.jsx)(nn,{type:"Release",date:a,changeDate:e=>{t({...n,release:e})}}),Object(ne.jsx)(nn,{type:"Deadline",date:r,changeDate:e=>{t({...n,deadline:e})}}),Object(ne.jsx)(an,{type:"Observe From",time:o,changeTime:e=>{t({...n,observeFrom:e})}}),Object(ne.jsx)(an,{type:"Observe To",time:c,changeTime:e=>{t({...n,observeTo:e})}})]})};var ln=function(e){const{changeMeta:t,manualMeta:n}=e,{targetCount:s}=n;return Object(ne.jsx)(E.a,{content:"Target Count",children:Object(ne.jsx)(h.H,{allowNumericCharactersOnly:!0,leftIcon:C.a.BANK_ACCOUNT,min:0,onValueChange:e=>t({...n,targetCount:e}),placeholder:"Enter target count here",value:s})})};var dn=function(e){const{changeMeta:t,meta:n}=e,{type:s}=n,i=ct.a.ofType();return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(E.a,{content:"Change Goal Type",children:Object(ne.jsx)(i,{filterable:!1,itemRenderer:(e,t)=>{let{handleClick:n}=t;return Object(ne.jsx)(h.B,{onClick:n,text:e},e)},items:Object.values(St.l),onItemSelect:e=>t(Xt(e)),children:Object(ne.jsx)(h.b,{minimal:!0,outlined:!0,text:s})})}),(e=>{switch(e){case St.l.ASSESSMENT:return Object(ne.jsx)(zt,{assessmentMeta:n,changeMeta:t});case St.l.BINARY:return Object(ne.jsx)(tn,{binaryMeta:n,changeMeta:t});case St.l.MANUAL:return Object(ne.jsx)(ln,{changeMeta:t,manualMeta:n});case St.l.EVENT:return Object(ne.jsx)(cn,{eventMeta:n,changeMeta:t});default:return null}})(s)]})};const un=e=>({editableGoal:e,isDirty:!1}),hn=(e,t)=>{switch(t.type){case $t.SAVE_CHANGES:return{...e,isDirty:!1};case $t.DISCARD_CHANGES:return un(t.payload);case $t.DELETE_GOAL:return{...e,isDirty:!1};case $t.CHANGE_META:return{editableGoal:{...e.editableGoal,meta:t.payload},isDirty:!0};case $t.CHANGE_TEXT:return{editableGoal:{...e.editableGoal,text:t.payload},isDirty:!0};default:return e}};var pn=function(e){const{uuid:t,isNewGoal:n,releaseUuid:s,removeCard:i,requestPublish:a}=e,r=Object(f.useContext)(Ze.a),o=r.getGoalDefinition(t),c=Object(f.useMemo)((()=>Object(T.cloneDeep)(o)),[o]),[l,d]=Object(f.useReducer)(hn,c,un),[u,p]=Object(f.useState)(n),{editableGoal:g,isDirty:m}=l,{meta:b,text:v}=g;return Object(ne.jsxs)("li",{className:"editable-goal",id:t,children:[Object(ne.jsx)("div",{className:"action-button",children:m?Object(ne.jsx)(at,{discardChanges:()=>d({type:$t.DISCARD_CHANGES,payload:c}),saveChanges:()=>{d({type:$t.SAVE_CHANGES}),r.modifyGoalDefinition(g),u&&(s(),p(!1)),a()}}):Object(ne.jsx)(it,{deleteItem:()=>{d({type:$t.DELETE_GOAL}),r.removeGoalDefinition(t),u&&(s(),p(!1)),i(t),a()},item:v})}),Object(ne.jsx)("h3",{children:Object(ne.jsx)(h.l,{onChange:e=>d({type:$t.CHANGE_TEXT,payload:e}),placeholder:"Enter goal text here",value:v})}),Object(ne.jsx)("div",{className:"meta",children:Object(ne.jsx)(dn,{changeMeta:e=>d({type:$t.CHANGE_META,payload:e}),meta:b})})]})};var gn=function(e){const{allowNewUuid:t,setNewUuid:n}=e,s=Object(f.useContext)(Ze.a);return Object(ne.jsx)(h.b,{className:"command-button",disabled:!t,icon:C.a.NEW_OBJECT,onClick:()=>n(s.insertGoalDefinition(qt)),text:"Create Goal"})};let mn=[];var bn=function(e){const{requestPublish:t}=e,n=Object(f.useContext)(Ze.a),[s,i]=Object(f.useState)(""),a=""===s,r=()=>i(""),o=e=>{let t=0;for(;mn[t].key!==e&&t<mn.length;)t++;mn.splice(t,1)},c=(e,n)=>Object(ne.jsx)(pn,{uuid:e,isNewGoal:n,releaseUuid:r,requestPublish:t,removeCard:o},e);return 0===mn.length&&(mn=n.getAllGoalUuids().map((e=>c(e,!1)))),Object(ne.jsxs)("div",{className:"goal-editor",children:[Object(ne.jsx)("div",{className:"command",children:Object(ne.jsx)(gn,{allowNewUuid:a,setNewUuid:e=>{i(e),mn[mn.length]=mn[0],mn[0]=c(e,!0)}})}),Object(ne.jsx)("ul",{className:"goal-container",children:mn})]})};var fn=function(e){const{bulkUpdateAchievements:t,bulkUpdateGoals:n,getAchievements:s,getOwnGoals:i,removeAchievement:a,removeGoal:r,inferencer:c}=e;Object(f.useEffect)((()=>{s(),i()}),[s,i]);const[l,d]=Object(f.useState)(!1),u=()=>{d(!0),h()},[,h]=Object(f.useReducer)((e=>e+1),0);return Object(ne.jsxs)(Ze.a.Provider,{value:c,children:[Object(ne.jsx)(o.a,{message:"You have unpublished changes. Are you sure you want to leave?",when:l}),Object(ne.jsxs)("div",{className:"AchievementControl",children:[Object(ne.jsx)(Wt,{awaitPublish:l,publishChanges:()=>{n(c.getAllGoals()),t(c.getAllAchievements()),c.getGoalsToDelete().forEach(r),c.getAchievementsToDelete().forEach(a),c.resetToDelete(),d(!1)}}),Object(ne.jsx)(Ot,{requestPublish:u}),Object(ne.jsx)(bn,{requestPublish:u})]})]})};var vn=Object(r.b)((e=>({inferencer:new Qe.a(e.achievement.achievements,e.achievement.goals)})),(e=>Object(c.b)({bulkUpdateAchievements:Je.bulkUpdateAchievements,bulkUpdateGoals:Je.bulkUpdateGoals,getAchievements:Je.getAchievements,getOwnGoals:Je.getOwnGoals,removeAchievement:Je.removeAchievement,removeGoal:Je.removeGoal},e)))(fn);var yn=Object(r.b)((e=>({group:e.session.group,inferencer:new Qe.a(e.achievement.achievements,e.achievement.goals),name:e.session.name,role:e.session.role,assessmentOverviews:e.session.assessmentOverviews,achievementAssessmentOverviews:e.achievement.assessmentOverviews,users:e.achievement.users,assessmentConfigs:e.session.assessmentConfigurations})),(e=>Object(c.b)({fetchAssessmentOverviews:u.fetchAssessmentOverviews,getAchievements:Je.getAchievements,getGoals:Je.getGoals,getOwnGoals:Je.getOwnGoals,getUserAssessmentOverviews:Je.getUserAssessmentOverviews,getUsers:Je.getUsers,updateGoalProgress:Je.updateGoalProgress},e)))(Vt);var jn=function(e){const{role:t}=e,n=t===O.a.Admin||t===O.a.Staff?vn:Ke;return Object(ne.jsxs)(o.e,{children:[Object(ne.jsx)(o.c,{exact:!0,path:"/courses/:courseId/achievements",component:yn}),Object(ne.jsx)(o.c,{path:"/courses/:courseId/achievements/control",component:n}),Object(ne.jsx)(o.c,{component:Ke})]})};var xn=Object(r.b)((e=>({role:e.session.role})),(e=>Object(c.b)({},e)))(jn),On=n(92),Sn=n(67),wn=n(193);const Cn=e=>{const t=!e.isDebugging&&Object(ne.jsx)(K.a,{handleEditorEval:e.handleEditorEval,color:e.isRunning?"#39FF14":void 0,className:e.isRunning?"WaitingCursor":void 0},"run"),n=e.isEditorAutorun&&Object(ne.jsx)(J.a,{label:"Auto",icon:C.a.AUTOMATIC_UPDATES}),s=!e.pauseDisabled&&e.isRunning&&!e.isDebugging&&Object(ne.jsx)(J.a,{label:"Pause",icon:C.a.STOP,onClick:e.handleDebuggerPause}),i=!e.isRunning&&e.isDebugging&&Object(ne.jsx)(J.a,{label:"Resume",icon:C.a.CHEVRON_RIGHT,onClick:e.handleDebuggerResume}),a=t=>e.isDebugging&&Object(ne.jsx)(J.a,{label:t,icon:C.a.STOP,onClick:e.handleDebuggerReset}),{isMobileBreakpoint:r}=Object(x.e)();return r?Object(ne.jsxs)(ne.Fragment,{children:[false,s,i,a("Stop")]}):Object(ne.jsxs)(ne.Fragment,{children:[!e.autorunDisabled&&Object(ne.jsx)("div",{className:"Switch",children:Object(ne.jsx)(h.T,{label:"",checked:e.isEditorAutorun,onChange:e.handleToggleEditorAutorun})}),n||t,s,i,a("Stop Debugger")]})};var En=n(129),Tn=n(195);const kn={PREVIOUS_STEP:"left",NEXT_STEP:"right"};class An extends f.Component{constructor(e){super(e),this.onPrevButtonClick=()=>{this.setState((e=>({currentStep:e.currentStep-1})))},this.onNextButtonClick=()=>{this.setState((e=>({currentStep:e.currentStep+1})))},this.state={steps:[],currentStep:0},Tn.a.init((e=>{if(this.state.steps.length>0){const e=document.getElementById("data_visualizer-icon");null===e||void 0===e||e.classList.add("side-content-tab-alert")}this.setState({steps:e,currentStep:0})}))}render(){const e=()=>0===this.state.currentStep,t=()=>!this.state.steps||this.state.currentStep===this.state.steps.length-1,n={PREVIOUS_STEP:this.onPrevButtonClick,NEXT_STEP:this.onNextButtonClick};Object(En.configure)({ignoreEventsCondition:n=>"ArrowLeft"===n.key&&e()||"ArrowRight"===n.key&&t(),ignoreRepeatedEventsWhenKeyHeldDown:!1,stopEventPropagationAfterIgnoring:!1});const s=this.state.steps[this.state.currentStep];return Object(ne.jsx)(En.GlobalHotKeys,{keyMap:kn,handlers:n,children:Object(ne.jsxs)("div",{className:j()("sa-data-visualizer",p.a.DARK),children:[this.state.steps.length>1?Object(ne.jsxs)("div",{style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",marginBottom:10},children:[Object(ne.jsx)(h.b,{style:{position:"absolute",left:0},large:!0,outlined:!0,icon:C.a.ARROW_LEFT,onClick:this.onPrevButtonClick,disabled:e(),children:"Previous"}),Object(ne.jsxs)("h3",{className:"bp4-text-large",children:["Call ",this.state.currentStep+1,"/",this.state.steps.length]}),Object(ne.jsx)(h.b,{style:{position:"absolute",right:0},large:!0,outlined:!0,icon:C.a.ARROW_RIGHT,onClick:this.onNextButtonClick,disabled:t(),children:"Next"})]}):null,this.state.steps.length>0?Object(ne.jsx)("div",{style:{display:"flex",flexDirection:"row",overflowX:"auto"},children:null===s||void 0===s?void 0:s.map(((e,t)=>Object(ne.jsxs)("div",{style:{margin:s.length>1?0:"0 auto"},children:[" ",Object(ne.jsxs)(h.e,{style:{background:"#1a2530",padding:10},children:[s.length>1&&Object(ne.jsxs)("h5",{className:"bp4-heading bp4-monospace-text",style:{marginTop:0,marginBottom:20,whiteSpace:"nowrap"},children:["Structure ",t+1]}),e]})]},t)))},s.length):Object(ne.jsxs)("p",{id:"data-visualizer-default-text",className:p.a.RUNNING_TEXT,children:["The data visualizer helps you to visualize data structures.",this.state.steps,Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),"It is activated by calling the function"," ",Object(ne.jsxs)("code",{children:["draw_data(x",Object(ne.jsx)("sub",{children:"1"}),", x",Object(ne.jsx)("sub",{children:"2"}),", ... x",Object(ne.jsx)("sub",{children:"n"}),")"]}),", where"," ",Object(ne.jsxs)("code",{children:["x",Object(ne.jsx)("sub",{children:"k"})]})," ","would be the"," ",Object(ne.jsxs)("code",{children:["k",Object(ne.jsx)("sup",{children:"th"})]})," ","data structure that you want to visualize and ",Object(ne.jsx)("code",{children:"n"})," is the number of structures.",Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),"The data visualizer uses box-and-pointer diagrams, as introduced in"," ",Object(ne.jsx)("a",{href:we.a.textbookChapter2_2,rel:"noopener noreferrer",target:"_blank",children:Object(ne.jsx)("i",{children:"Structure and Interpretation of Computer Programs, JavaScript Edition, Chapter 2, Section 2"})}),"."]})]})})}}var _n=An,In=n(158);class Nn extends f.Component{constructor(e){super(e),this.handleResize=Object(T.debounce)((()=>{const e=this.calculateWidth(this.props.editorWidth),t=this.calculateHeight(this.props.sideContentHeight);e===this.state.width&&t===this.state.height||(this.setState({height:t,width:e}),In.a.updateDimensions(e,t))}),300),this.state={visualization:null,width:this.calculateWidth(e.editorWidth),height:this.calculateHeight(e.sideContentHeight)},In.a.init((e=>this.setState({visualization:e})),this.state.width,this.state.height)}calculateWidth(e){let t;return t=void 0===e?window.innerWidth-50:Math.min(5e3,window.innerWidth*(100-parseFloat(e))/100-50),Math.min(t,5e3)}calculateHeight(e){let t;return t=window.innerWidth<we.b.mobileBreakpoint||void 0===e?window.innerHeight-150:e-150,Math.min(t,5e3)}componentDidMount(){this.handleResize(),window.addEventListener("resize",this.handleResize),In.a.redraw()}componentWillUnmount(){this.handleResize.cancel(),window.removeEventListener("resize",this.handleResize)}componentDidUpdate(e){e.sideContentHeight===this.props.sideContentHeight&&e.editorWidth===this.props.editorWidth||this.handleResize()}render(){return Object(ne.jsx)("div",{className:p.a.DARK,children:this.state.visualization||Object(ne.jsxs)("p",{id:"env-visualizer-default-text",className:p.a.RUNNING_TEXT,children:["The environment model visualizer generates environment model diagrams following a notation introduced in"," ",Object(ne.jsx)("a",{href:we.a.textbookChapter3_2,rel:"noopener noreferrer",target:"_blank",children:Object(ne.jsx)("i",{children:"Structure and Interpretation of Computer Programs, JavaScript Edition, Chapter 3, Section 2"})}),".",Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),"It is activated by setting breakpoints before you run the program. You can set a breakpoint by clicking on the gutter of the editor (where all the line numbers are, on the left). When the program runs into a breakpoint, the visualizer displays the state of the environments before the statement is evaluated, which starts in the line in which you set the breakpoint. Every breakpoint must be at the beginning of a statement."]})})}}var Pn=Nn;class Rn extends f.PureComponent{constructor(e){super(e),this.audio=void 0,this.handleSeeked=()=>{this.stopPreviousPlaybackAndApplyFromStart(this.props.playbackData)},this.handleAudioLoaded=()=>{this.props.handleSetSourcecastDuration(this.audio.current.duration)},this.applyDeltas=e=>{this.props.handleSetCodeDeltasToApply(e)},this.stopPreviousPlaybackAndApplyFromStart=e=>{this.setState({currentDeltaRevision:this.state.currentDeltaRevision+1},(()=>this.applyPlaybackDataFromStart(e)))},this.applyPlaybackDataFromStart=async e=>{const t=e=>new Promise((t=>setTimeout(t,e))),n=this.state.currentDeltaRevision;let s=1e3*this.audio.current.currentTime;this.props.handleEditorValueChange(e.init.editorValue),this.props.handleExternalSelect(e.init.externalLibrary),this.props.handleChapterSelect(e.init.chapter);const i=e.inputs.filter((e=>e.time<=s&&"codeDelta"===e.type)).map((e=>e.data));this.applyDeltas(i);const a=e.inputs.filter((e=>e.time>s)),r=a.length;let o=0;for(;o<r&&this.state.currentDeltaRevision===n;)s=1e3*this.audio.current.currentTime,a[o].time<s?(this.props.handleSetInputToApply(a[o]),o++):await t(20)},this.handlePlayerPausing=()=>{this.audio.current.pause(),this.props.handleSetIsEditorReadonly(!1),this.props.handleSetSourcecastStatus(F.b.paused),this.stopCurrentPlayback()},this.handlePlayerPlaying=()=>{this.audio.current.play(),this.props.handleSetIsEditorReadonly(!0),this.props.handleSetSourcecastStatus(F.b.playing),this.stopPreviousPlaybackAndApplyFromStart(this.props.playbackData),this.props.setSelectedTab&&this.props.setSelectedTab(Se.b.mobileEditor)},this.handlePlayerStopping=()=>{this.props.handleSetIsEditorReadonly(!1),this.props.handleSetSourcecastStatus(F.b.paused),this.props.handleSetCurrentPlayerTime(0),this.setState({currentPlayerProgress:0})},this.updatePlayerTime=e=>{const{currentTime:t}=e.target;this.props.handleSetCurrentPlayerTime(t),this.setState({currentPlayerProgress:t/this.props.duration}),this.props.playbackStatus===F.b.forcedPaused&&this.handlePlayerPausing()},this.handlePlayerProgressBarChange=e=>{if(this.audio.current){const t=this.props.duration*e;this.audio.current.currentTime=t,this.props.handleSetCurrentPlayerTime(t),this.setState({currentPlayerProgress:e})}},this.renderLabel=e=>{if(this.props.duration){const t=this.props.duration*e,n=Math.floor(t/60),s=Math.floor(t-60*n);return(n<10?"0"+n:n)+":"+(s<10?"0"+s:s)}return"00:00"},this.audio=f.createRef(),this.state={currentDeltaRevision:0,currentPlayerProgress:0,currentSourcecastItem:null,duration:0}}render(){const e=Object(ne.jsx)(J.a,{label:"Play",icon:C.a.PLAY,onClick:this.handlePlayerPlaying,isDisabled:!this.props.duration}),t=Object(ne.jsx)(J.a,{label:"Pause",icon:C.a.PAUSE,onClick:this.handlePlayerPausing});return Object(ne.jsxs)("div",{className:"SourcecastControlBar",children:[Object(ne.jsx)("audio",{src:this.props.audioUrl,ref:this.audio,onEnded:this.handlePlayerStopping,onLoadedMetadata:this.handleAudioLoaded,onSeeked:this.handleSeeked,onTimeUpdate:this.updatePlayerTime,preload:"metadata"}),Object(ne.jsx)("br",{}),Object(ne.jsxs)("div",{className:"PlayerControl",children:[Object(ne.jsxs)(h.c,{className:"PlayerControlButton",children:[this.props.playbackStatus===F.b.paused&&e,this.props.playbackStatus===F.b.playing&&t]}),Object(ne.jsx)("div",{className:"Slider",children:Object(ne.jsx)(h.Q,{min:0,max:1,stepSize:1e-4,onChange:this.handlePlayerProgressBarChange,value:this.state.currentPlayerProgress,labelRenderer:this.renderLabel})})]})]})}stopCurrentPlayback(){this.setState({currentDeltaRevision:this.state.currentDeltaRevision+1})}}var Mn=Rn,Ln=(n(177),n(101));var Dn=e=>{const[t,n]=Object(f.useState)(!1),s=()=>n(!1);return Object(ne.jsxs)("div",{children:[Object(ne.jsx)(J.a,{icon:C.a.TRASH,onClick:()=>n(!0)}),Object(ne.jsxs)(h.h,{icon:"info-sign",isOpen:t,onClose:s,title:"Delete Sourcecast",canOutsideClickClose:!0,children:[Object(ne.jsx)("div",{className:p.a.DIALOG_BODY,children:Object(ne.jsx)("p",{children:"Are you sure to delete this sourcecast entry?"})}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)("div",{className:p.a.DIALOG_FOOTER_ACTIONS,children:[Object(ne.jsx)(J.a,{label:"Confirm Delete",icon:C.a.TRASH,onClick:()=>{const{data:t}=e;e.handleDeleteSourcecastEntry(t.id)}}),Object(ne.jsx)(J.a,{label:"Cancel",icon:C.a.CROSS,onClick:s})]})})]})]})};class Bn extends f.Component{constructor(e){super(e),this.handleSelect=()=>{const{data:e}=this.props;this.props.handleSetSourcecastData(e.title,e.description,e.uid,e.url,JSON.parse(e.playbackData))}}render(){return Object(ne.jsx)(E.a,{content:"Load Sourcecast Recording",children:Object(ne.jsx)(J.a,{label:`${this.props.data.title}`,icon:C.a.PAPERCLIP,onClick:this.handleSelect})})}}var Un=Bn,Gn=n(165);class Fn extends f.Component{constructor(e){super(e),this.shareInputElem=void 0,this.shareInputElem=f.createRef(),this.selectShareInputText=this.selectShareInputText.bind(this);const t=`${window.location.protocol}//${window.location.host}/courses/${e.courseId}/sourcecast/${e.data.uid}`;this.state={shareURL:t}}render(){const e=Object(ne.jsxs)("div",{children:[Object(ne.jsx)("input",{defaultValue:this.state.shareURL,readOnly:!0,ref:this.shareInputElem}),Object(ne.jsx)(E.a,{content:"Copy link to clipboard",children:Object(ne.jsx)(Gn,{text:this.state.shareURL,children:Object(ne.jsx)(J.a,{icon:C.a.DUPLICATE,onClick:this.selectShareInputText})})})]},this.state.shareURL);return Object(ne.jsx)(Le.a,{popoverClassName:"Popover-share",inheritDarkTheme:!1,content:e,children:Object(ne.jsx)(E.a,{content:"Get shareable link",children:Object(ne.jsx)(J.a,{icon:C.a.SHARE})})})}selectShareInputText(){null!==this.shareInputElem.current&&(this.shareInputElem.current.focus(),this.shareInputElem.current.select())}}var Hn=Fn;class Vn extends f.Component{constructor(e){super(e),this.defaultColumnDefs=void 0,this.gridApi=void 0,this.handleFilterChange=e=>{const t=e.target.value;this.setState({filterValue:t}),this.gridApi&&this.gridApi.setQuickFilter(t)},this.onGridReady=e=>{this.gridApi=e.api,this.gridApi.sizeColumnsToFit(),window.onresize=()=>this.gridApi.sizeColumnsToFit()},this.state={columnDefs:[{headerName:"Title",field:"title",cellRendererFramework:Un,cellRendererParams:{handleSetSourcecastData:this.props.handleSetSourcecastData},minWidth:200,suppressMovable:!0,suppressMenu:!0,cellStyle:{"text-align":"left"},hide:!this.props.handleSetSourcecastData},{headerName:"Title",field:"title",minWidth:100,suppressMovable:!0,suppressMenu:!0,hide:!!this.props.handleSetSourcecastData},{headerName:"Uploader",field:"uploader.name",minWidth:150,suppressMovable:!0,suppressMenu:!0,cellStyle:{"text-align":"center"}},{headerName:"Date",valueGetter:e=>{return t=e.data.inserted_at,b()(t).format("MMMM Do YYYY");var t},minWidth:150,suppressMovable:!0,suppressMenu:!0},{headerName:"Share",field:"uid",cellRendererFramework:Hn,cellRendererParams:{courseId:this.props.courseId},minWidth:80,suppressMovable:!0,suppressMenu:!0},{headerName:"Delete",field:"",cellRendererFramework:Dn,cellRendererParams:{handleDeleteSourcecastEntry:this.props.handleDeleteSourcecastEntry},minWidth:100,maxWidth:100,sortable:!1,suppressMovable:!0,suppressMenu:!0,cellStyle:{"text-align":"center"},hide:!this.props.handleDeleteSourcecastEntry},{headerName:"description",field:"description",hide:!0},{headerName:"inserted_at",field:"inserted_at",hide:!0},{headerName:"updated_at",field:"updated_at",hide:!0},{headerName:"audio",field:"audio",hide:!0},{headerName:"playbackData",field:"playbackData",hide:!0},{headerName:"url",field:"url",hide:!0}],filterValue:"",groupFilterEnabled:!1},this.defaultColumnDefs={filter:!0,resizable:!0,sortable:!0}}render(){const e=Object(ne.jsx)(h.G,{className:"Sourcecast",description:"Fetching sourcecast index...",icon:Object(ne.jsx)(h.R,{size:h.S.LARGE})}),t=Object(T.sortBy)(this.props.sourcecastIndex,[e=>-e.id]),n=Object(ne.jsxs)("div",{className:"SourcecastContainer",children:[Object(ne.jsx)("br",{}),Object(ne.jsx)("div",{children:Object(ne.jsx)(h.n,{label:"",labelFor:"text-input",children:Object(ne.jsx)(h.y,{id:"searchBar",large:!1,leftIcon:"search",placeholder:"Search",value:this.state.filterValue,onChange:this.handleFilterChange})})}),Object(ne.jsx)(h.i,{}),Object(ne.jsx)("div",{className:"SourcecastTable",children:Object(ne.jsx)("div",{className:"ag-grid-parent",children:Object(ne.jsx)(Ln.AgGridReact,{domLayout:"autoHeight",columnDefs:this.state.columnDefs,defaultColDef:this.defaultColumnDefs,onGridReady:this.onGridReady,rowData:t,rowHeight:30,pagination:!1,paginationPageSize:50})})}),Object(ne.jsx)("br",{})]});return Object(ne.jsx)("div",{children:void 0===this.props.sourcecastIndex?e:n})}}var Wn=Vn;const $n="sourcecast",Xn="Welcome to Sourcecast!",qn={label:"Data Visualizer",iconName:C.a.EYE_OPEN,body:Object(ne.jsx)(_n,{}),id:Se.b.dataVisualizer},zn={label:"Env Visualizer",iconName:C.a.GLOBE,body:Object(ne.jsx)(Pn,{}),id:Se.b.envVisualizer};var Yn=e=>{const{isMobileBreakpoint:t}=Object(x.e)(),n=Object(r.c)(),[s,i]=f.useState(Se.b.introduction),a=f.useCallback((()=>{const t=e.match.params.sourcecastId;if(t&&t!==e.uid&&e.sourcecastIndex){const n=e.sourcecastIndex.find((e=>e.uid===t));n&&e.handleSetSourcecastData(n.title,n.description,n.uid,n.url,JSON.parse(n.playbackData))}}),[e]);f.useEffect((()=>{n(Object(wn.fetchSourcecastIndex)($n))}),[]),f.useEffect((()=>{a();const{inputToApply:t}=e;if(t)switch(t.type){case"activeTabChange":i(t.data);break;case"chapterSelect":e.handleChapterSelect(t.data);break;case"externalLibrarySelect":e.handleExternalSelect(t.data);break;case"forcePause":e.handleSetSourcecastStatus(F.b.forcedPaused)}}),[a,e.inputToApply]),f.useEffect((()=>{t||s!==Se.b.mobileEditor&&s!==Se.b.mobileEditorRun||i(Se.b.introduction)}),[t,e,s]);const o=Object(ne.jsx)(Cn,{handleDebuggerPause:()=>n(Object(Sn.beginDebuggerPause)($n)),handleDebuggerReset:()=>n(Object(Sn.debuggerReset)($n)),handleDebuggerResume:()=>n(Object(Sn.debuggerResume)($n)),handleEditorEval:e.handleEditorEval,handleInterruptEval:()=>n(Object(Sn.beginInterruptExecution)($n)),handleToggleEditorAutorun:()=>n(Object(I.toggleEditorAutorun)($n)),isDebugging:e.isDebugging,isEditorAutorun:e.isEditorAutorun,isRunning:e.isRunning},"autorun"),c=Object(ne.jsx)(V.a,{handleChapterSelect:(t,n)=>{let{chapter:s}=t;return e.handleChapterSelect(s)},sourceChapter:e.sourceChapter,sourceVariant:e.sourceVariant},"chapter"),l=Object(ne.jsx)(W.a,{handleReplOutputClear:()=>n(Object(I.clearReplOutput)($n))},"clear_repl"),d=Object(ne.jsx)($.a,{handleReplEval:e.handleReplEval,isRunning:e.isRunning},"eval_repl"),u=[{label:"Sourcecast Table",iconName:C.a.HOME,body:Object(ne.jsxs)("div",{children:[Object(ne.jsx)("span",{className:"Multi-line",children:Object(ne.jsx)(h.M,{children:e.title?"Title: "+e.title+"\nDescription: "+e.description:Xn})}),Object(ne.jsx)(Wn,{handleSetSourcecastData:e.handleSetSourcecastData,sourcecastIndex:e.sourcecastIndex,courseId:e.courseId})]}),id:Se.b.introduction},qn,zn],g=(e,t,n)=>{e!==t&&i(e)},m={editorVariant:"sourcecast",editorTabs:e.editorTabs.map(Z.a),codeDeltasToApply:e.codeDeltasToApply,isEditorReadonly:e.isEditorReadonly,editorSessionId:"",handleDeclarationNavigate:e=>n(Object(I.navigateToDeclaration)($n,e)),handleEditorEval:e.handleEditorEval,handleEditorValueChange:e.handleEditorValueChange,isEditorAutorun:e.isEditorAutorun,inputToApply:e.inputToApply,isPlaying:e.playbackStatus===F.b.playing,handleEditorUpdateBreakpoints:e=>n(Object(I.setEditorBreakpoint)(e,$n))},b={output:e.output,replValue:e.replValue,handleBrowseHistoryDown:()=>n(Object(I.browseReplHistoryDown)($n)),handleBrowseHistoryUp:()=>n(Object(I.browseReplHistoryUp)($n)),handleReplEval:e.handleReplEval,handleReplValueChange:e=>n(Object(I.updateReplValue)(e,$n)),sourceChapter:e.sourceChapter,sourceVariant:e.sourceVariant,externalLibrary:e.externalLibraryName,replButtons:[d,l]},v={tabs:[]},y={controlBarProps:{editorButtons:[o,c]},editorContainerProps:m,handleSideContentHeightChange:e=>n(Object(I.changeSideContentHeight)(e,$n)),replProps:b,sideBarProps:v,sideContentHeight:e.sideContentHeight,sideContentProps:{selectedTabId:s,onChange:g,tabs:{beforeDynamicTabs:u,afterDynamicTabs:[]},workspaceLocation:"sourcecast",sideContentHeight:e.sideContentHeight}},O={editorContainerProps:m,replProps:b,sideBarProps:v,mobileSideContentProps:{mobileControlBarProps:{editorButtons:[o,c]},selectedTabId:s,onChange:g,tabs:{beforeDynamicTabs:u,afterDynamicTabs:[]},workspaceLocation:"sourcecast"}},S={handleEditorValueChange:e.handleEditorValueChange,handlePromptAutocomplete:(e,t,s)=>n(Object(I.promptAutocomplete)($n,e,t,s)),handleSetCurrentPlayerTime:e=>n(Object(On.setCurrentPlayerTime)(e,$n)),handleSetCodeDeltasToApply:e=>n(Object(On.setCodeDeltasToApply)(e,$n)),handleSetIsEditorReadonly:e=>n(Object(I.setIsEditorReadonly)($n,e)),handleSetInputToApply:e=>n(Object(On.setInputToApply)(e,$n)),handleSetSourcecastDuration:e=>n(Object(On.setSourcecastDuration)(e,$n)),handleSetSourcecastStatus:e.handleSetSourcecastStatus,audioUrl:e.audioUrl,currentPlayerTime:e.currentPlayerTime,duration:e.playbackDuration,playbackData:e.playbackData,playbackStatus:e.playbackStatus,handleChapterSelect:e.handleChapterSelect,handleExternalSelect:e.handleExternalSelect,setSelectedTab:i};return Object(ne.jsxs)("div",{className:j()("Sourcecast",p.a.DARK),children:[Object(ne.jsx)(Mn,{...S}),t?Object(ne.jsx)(te.a,{...O}):Object(ne.jsx)(Te.a,{...y})]})};const Kn="sourcecast";var Qn=Object(o.l)(Object(r.b)((e=>({audioUrl:e.workspaces.sourcecast.audioUrl,currentPlayerTime:e.workspaces.sourcecast.currentPlayerTime,codeDeltasToApply:e.workspaces.sourcecast.codeDeltasToApply,title:e.workspaces.sourcecast.title,description:e.workspaces.sourcecast.description,activeEditorTabIndex:e.workspaces.sourcecast.activeEditorTabIndex,editorTabs:e.workspaces.sourcecast.editorTabs,externalLibraryName:e.workspaces.sourcecast.externalLibrary,isEditorAutorun:e.workspaces.sourcecast.isEditorAutorun,isEditorReadonly:e.workspaces.sourcecast.isEditorReadonly,inputToApply:e.workspaces.sourcecast.inputToApply,isRunning:e.workspaces.sourcecast.isRunning,isDebugging:e.workspaces.sourcecast.isDebugging,enableDebugging:e.workspaces.sourcecast.enableDebugging,output:e.workspaces.sourcecast.output,playbackDuration:e.workspaces.sourcecast.playbackDuration,playbackData:e.workspaces.sourcecast.playbackData,playbackStatus:e.workspaces.sourcecast.playbackStatus,replValue:e.workspaces.sourcecast.replValue,sideContentHeight:e.workspaces.sourcecast.sideContentHeight,sourcecastIndex:e.workspaces.sourcecast.sourcecastIndex,sourceChapter:N.Chapter.CALC,sourceVariant:e.workspaces.sourcecast.context.variant,uid:e.workspaces.sourcecast.uid,courseId:e.session.courseId})),(e=>Object(c.b)({handleChapterSelect:e=>Object(I.chapterSelect)(e,N.Variant.DEFAULT,Kn),handleEditorEval:()=>Object(I.evalEditor)(Kn),handleEditorValueChange:e=>Object(I.updateEditorValue)(e,Kn),handleExternalSelect:e=>Object(I.externalLibrarySelect)(e,Kn),handleReplEval:()=>Object(I.evalRepl)(Kn),handleSetSourcecastData:(e,t,n,s,i)=>Object(On.setSourcecastData)(e,t,n,s,i,Kn),handleSetSourcecastStatus:e=>Object(On.setSourcecastStatus)(e,Kn)},e)))(Yn)),Jn=(n(212),n(445));var Zn=e=>{const[t,n]=v.a.useState([]),[s,i]=v.a.useState(""),a=v.a.useRef(),{CSVReader:r}=Object(Jn.a)(),o=Object(ne.jsx)("div",{className:"Grid ag-grid-parent ag-theme-balham",children:Object(ne.jsx)(Ln.AgGridReact,{domLayout:"autoHeight",columnDefs:[{headerName:"Username",field:"username"},{headerName:"Role",field:"role"},{headerName:"Group",field:"group"}],defaultColDef:{filter:!0,resizable:!0,sortable:!0},onGridReady:e=>{a.current=e.api},onGridSizeChanged:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.sizeColumnsToFit()},rowData:t,rowHeight:36,suppressCellSelection:!0,suppressMovableColumns:!0,pagination:!0})}),c=[...we.b.authProviders.entries()].map((e=>{let[t,n]=e;return t})),[l,d]=v.a.useState(c[0]);return Object(ne.jsxs)("div",{className:"add-users",children:[Object(ne.jsx)(h.p,{children:"Add Users"}),o,Object(ne.jsx)(h.r,{children:"Upload a CSV file to mass insert or update users in your course."}),Object(ne.jsx)("div",{className:"upload-container",children:Object(ne.jsxs)("div",{children:[Object(ne.jsxs)("div",{className:"upload-settings",children:[Object(ne.jsx)("div",{className:"file-input",children:Object(ne.jsx)(r,{onUploadAccepted:e=>(e=>{const{data:s,errors:a}=e;if(a.length)return void i("Error detected while uploading the CSV file! Please recheck the file and try again.");const r=[...t];if(s.length+t.length>1e3)i("Please limit each upload to 1000 entries!");else{for(let e=0;e<s.length;e++){if(2!==s[e].length&&3!==s[e].length)return void i(Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsxs)("div",{children:["Invalid format (line ",e,")! Please ensure that the username and role is specified for each row entry!"]}),Object(ne.jsx)("br",{}),Object(ne.jsxs)("div",{children:["Format: ",Object(ne.jsx)("i",{children:"username,role"})," ",Object(ne.jsx)("b",{children:"OR"})," ",Object(ne.jsx)("i",{children:"username,role,group"})]}),Object(ne.jsx)("br",{}),Object(ne.jsx)("div",{children:"(please hover over the question mark above for more details)"})]}));if(!Object.values(O.a).includes(s[e][1]))return void i(`Invalid role (line ${e})! Please ensure that the second column of each entry contains one of the following: 'admin, staff, student'`)}s.forEach((e=>{r.push({username:e[0],role:e[1],group:e[2]})})),Object(T.uniqBy)(r,(e=>e.username)).length===r.length?(n(r),i("")):i("There are duplicate usernames in the uploaded CSV(s)!")}})(e),config:{delimiter:",",skipEmptyLines:!0},children:e=>{let{getRootProps:t,acceptedFile:n,ProgressBar:s,getRemoveFileProps:i}=e;return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(h.m,{text:"Upload CSV",inputProps:t()}),Object(ne.jsx)(Le.a,{content:Object(ne.jsxs)("div",{children:[Object(ne.jsxs)("p",{children:[Object(ne.jsx)("u",{children:"CSV Format"}),": \xa0",Object(ne.jsx)("b",{children:Object(ne.jsx)("i",{children:"username,role"})}),"\xa0\xa0OR\xa0\xa0",Object(ne.jsx)("b",{children:Object(ne.jsx)("i",{children:"username,role,group"})})]}),Object(ne.jsxs)("p",{children:[Object(ne.jsx)("b",{children:Object(ne.jsx)("i",{children:"username"})}),": the username of the learner in the corresponding authentication provider"]}),Object(ne.jsxs)("p",{children:[Object(ne.jsx)("b",{children:Object(ne.jsx)("i",{children:"role"})}),": the role of the learner in this course"," ",Object(ne.jsx)("i",{children:"(admin | staff | student)"})]}),Object(ne.jsxs)("p",{children:[Object(ne.jsx)("b",{children:Object(ne.jsx)("i",{children:"group (optional)"})}),": the group name that the learner belongs to in this course"]}),Object(ne.jsx)("p",{children:Object(ne.jsx)("i",{children:"(*Note that staff or admin will automatically be assigned as group leader and each group"})}),Object(ne.jsx)("p",{children:Object(ne.jsx)("i",{children:"can only have one leader. If there are duplicates the latest entry will take effect)"})}),Object(ne.jsx)("p",{children:"\xa0"}),Object(ne.jsx)("p",{children:Object(ne.jsx)("u",{children:"Examples:"})}),Object(ne.jsx)("p",{children:Object(ne.jsx)("i",{children:"(Luminus): \xa0e1234567,student \xa0\u2022\xa0 e1234567,student,Group1"})}),Object(ne.jsx)("p",{children:Object(ne.jsx)("i",{children:"(Google): \xa0learner@gmail.com,staff \xa0\u2022\xa0 learner@gmail.com,staff,Group1"})}),Object(ne.jsx)("p",{children:Object(ne.jsx)("i",{children:"(GitHub): \xa0ghusername,admin \xa0\u2022\xa0 ghusername,admin,Group1"})})]}),interactionKind:"hover",position:w.a.TOP,popoverClassName:"file-input-popover",children:Object(ne.jsx)(h.w,{icon:C.a.HELP,className:"file-input-icon"})})]})}})}),Object(ne.jsx)(h.n,{className:"html-select",label:Object(ne.jsxs)("div",{className:"html-select-label",children:[Object(ne.jsx)("div",{children:"Authentication Provider"}),Object(ne.jsx)(Le.a,{content:"The authentication provider your learners will use to log in with",interactionKind:"hover-target",position:w.a.TOP,popoverClassName:"html-select-popover",children:Object(ne.jsx)(h.w,{icon:C.a.HELP,className:"html-select-label-icon"})})]}),inline:!0,children:Object(ne.jsx)(h.u,{options:c,value:l,onChange:e=>d(e.target.value)})})]}),s&&Object(ne.jsx)(h.d,{intent:g.a.DANGER,title:"Invalid CSV file provided!",children:s})]})}),Object(ne.jsx)(h.b,{className:"add-button",text:"Add Users",intent:0===t.length?g.a.NONE:g.a.WARNING,onClick:()=>{e.handleAddNewUsersToCourse(t,l),n([]),d(c[0])}})]})};var es=e=>{const{data:t}=e,n=t[e.field],s=v.a.useCallback((()=>{e.setStateHandler(e.rowIndex,!n)}),[e,n]);return Object(ne.jsx)(h.T,{checked:n,onChange:s})};var ts=e=>{const[t,n]=v.a.useState(!1),s=v.a.useCallback((()=>{e.deleteRowHandler(e.rowIndex),n(!1)}),[e]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(h.b,{icon:C.a.CROSS,onClick:()=>{n(!0)}}),Object(ne.jsxs)(h.h,{icon:C.a.WARNING_SIGN,isOpen:t,onClose:()=>n(!1),title:"Warning",children:[Object(ne.jsxs)("div",{className:p.a.DIALOG_BODY,children:[Object(ne.jsxs)("p",{children:["Are you sure you want to ",Object(ne.jsx)("b",{children:"delete"})," the assessment type ",Object(ne.jsx)("i",{children:e.data.type}),"?"]}),Object(ne.jsx)("p",{children:Object(ne.jsx)("b",{children:"All related assessments, submissions and answers will be deleted as well upon clicking the main save button."})})]}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)("div",{className:p.a.DIALOG_FOOTER_ACTIONS,children:[Object(ne.jsx)(J.a,{label:"Cancel",icon:C.a.CROSS,onClick:()=>n(!1),options:{minimal:!1}}),Object(ne.jsx)(J.a,{label:"Ok",icon:C.a.TICK,onClick:s,options:{minimal:!1,intent:g.a.WARNING}})]})})]})]})};var ns=e=>{const{data:t}=e,n=v.a.useCallback((t=>{e.setStateHandler(e.rowIndex,t)}),[e]);return Object(ne.jsx)(h.H,{value:t[e.field],min:0,clampValueOnBlur:!0,onValueChange:n})};function ss(e,t){for(let n=0;n<e.length;n++)if(Object(T.isEqual)(e[n],t))return n;return-1}var is=e=>{const{assessmentConfig:t,setAssessmentConfig:n,setAssessmentConfigsToDelete:s}=e,i=v.a.useRef(),a=[{headerName:"Assessment Type",field:"type",rowDrag:!0,editable:!0},{headerName:"Is Manually Graded",field:"isManuallyGraded",cellRendererFramework:es,cellRendererParams:{setStateHandler:(e,s)=>{var a,r;const o=[...t.current];o[e]={...o[e],isManuallyGraded:s},n(o),null===(a=i.current)||void 0===a||null===(r=a.getDisplayedRowAtIndex(e))||void 0===r||r.setDataValue("isManuallyGraded",s)},field:"isManuallyGraded"}},{headerName:"Display in Dashboard",field:"displayInDashboard",cellRendererFramework:es,cellRendererParams:{setStateHandler:(e,s)=>{var a,r;const o=[...t.current];o[e]={...o[e],displayInDashboard:s},n(o),null===(a=i.current)||void 0===a||null===(r=a.getDisplayedRowAtIndex(e))||void 0===r||r.setDataValue("displayInDashboard",s)},field:"displayInDashboard"}},{headerName:"Max Bonus XP",field:"earlySubmissionXp",cellRendererFramework:ns,cellRendererParams:{setStateHandler:(e,s)=>{var a,r;const o=[...t.current];o[e]={...o[e],earlySubmissionXp:s},n(o),null===(a=i.current)||void 0===a||null===(r=a.getDisplayedRowAtIndex(e))||void 0===r||r.setDataValue("earlySubmissionXp",s)},field:"earlySubmissionXp"}},{headerName:"Early Hours Before Decay",field:"hoursBeforeEarlyXpDecay",cellRendererFramework:ns,cellRendererParams:{setStateHandler:(e,s)=>{var a,r;const o=[...t.current];o[e]={...o[e],hoursBeforeEarlyXpDecay:s},n(o),null===(a=i.current)||void 0===a||null===(r=a.getDisplayedRowAtIndex(e))||void 0===r||r.setDataValue("hoursBeforeEarlyXpDecay",s)},field:"hoursBeforeEarlyXpDecay"}},{headerName:"Delete Row",field:"placeholderToPreventColumnRerender",cellRendererFramework:ts,cellRendererParams:{deleteRowHandler:e=>{var a;if(t.current.length<=1)return void Object(me.e)("You must have at least 1 assessment type!");const r=[...t.current],o=r.splice(e,1);null===(a=i.current)||void 0===a||a.setRowData(r),n(r),s(o[0])}},maxWidth:120,resizable:!1}],r=v.a.useCallback((e=>{const n=e.node,s=e.overNode;if(n!==s){const e=n.data,i=null===s||void 0===s?void 0:s.data,a=ss(t.current,e),r=ss(t.current,i),o=[...t.current];!function(e,t,n){const s=e[t];e.splice(t,1),e.splice(n,0,s)}(o,a,r),t.current=o}}),[t]),o=n=>{var s;null===(s=i.current)||void 0===s||s.setRowData(t.current),e.setHasChangesAssessmentConfig(!0)},c=Object(ne.jsx)("div",{className:"Grid ag-grid-parent ag-theme-balham",children:Object(ne.jsx)(Ln.AgGridReact,{domLayout:"autoHeight",columnDefs:a,defaultColDef:{filter:!1,resizable:!0,sortable:!1},onGridReady:e=>{i.current=e.api,e.api.sizeColumnsToFit()},onGridSizeChanged:()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.sizeColumnsToFit()},rowData:e.assessmentConfig.current,rowHeight:36,rowDragManaged:!0,suppressCellSelection:!0,suppressMovableColumns:!0,suppressPaginationPanel:!0,onRowDragMove:r,onRowDragLeave:o,onRowDragEnd:o,onCellValueChanged:n=>{if("type"===n.colDef.field){const s=[...t.current];s[n.rowIndex]={...s[n.rowIndex],type:n.value},t.current=s,e.setHasChangesAssessmentConfig(!0)}}})});return Object(ne.jsxs)("div",{className:"assessment-configuration",children:[Object(ne.jsxs)("div",{className:"assessment-configuration-header-container",children:[Object(ne.jsx)(h.p,{children:"Assessment Configuration"}),Object(ne.jsx)(h.b,{text:"Add Row",onClick:()=>{var e;if(t.current.length>=8)return void Object(me.e)("You can have at most 8 assessment types!");const s=[...t.current];s.push({assessmentConfigId:-1,type:"untitled",isManuallyGraded:!0,displayInDashboard:!0,hoursBeforeEarlyXpDecay:0,earlySubmissionXp:0}),n(s),null===(e=i.current)||void 0===e||e.setRowData(s)},className:"add-row-button"})]}),c]})};let as;!function(e){e.WRITE="WRITE",e.PREVIEW="PREVIEW"}(as||(as={}));var rs=e=>{const{isMobileBreakpoint:t}=Object(x.e)(),[n,s]=f.useState(as.WRITE),{courseName:i,courseShortName:a,viewable:r,enableGame:o,enableAchievements:c,enableSourcecast:l,moduleHelpText:d}=e.courseConfiguration,u=Object(ne.jsx)(h.Z,{id:"moduleHelpText",className:"input-textarea",fill:!0,value:d||"",onChange:t=>e.setCourseConfiguration({...e.courseConfiguration,moduleHelpText:t.target.value})}),p=Object(ne.jsx)("div",{className:"input-markdown",children:Object(ne.jsx)(ee.a,{content:d||"",openLinksInNewWindow:!0})}),g=f.useCallback(((e,t,n)=>{e!==t&&s(e)}),[s]);return Object(ne.jsxs)("div",{className:"course-configuration",children:[Object(ne.jsx)(h.p,{children:i}),Object(ne.jsx)(h.q,{children:a}),Object(ne.jsxs)("div",{className:"inputs",children:[Object(ne.jsxs)("div",{className:"text",children:[Object(ne.jsx)(h.n,{helperText:"Please enter the course name that will be used for course selection.",inline:!0,label:"Course Name",labelFor:"courseName",children:Object(ne.jsx)(h.y,{id:"courseName",defaultValue:i,onChange:t=>e.setCourseConfiguration({...e.courseConfiguration,courseName:t.target.value})})}),Object(ne.jsx)(h.n,{helperText:"Please enter the course short name. This will be displayed on the top left.",inline:!0,label:"Course Short Name",labelFor:"courseShortName",children:Object(ne.jsx)(h.y,{id:"courseShortName",defaultValue:a,onChange:t=>e.setCourseConfiguration({...e.courseConfiguration,courseShortName:t.target.value})})}),Object(ne.jsxs)(h.n,{helperText:"Please enter the module help text that will be used in the course help dialog.",inline:!0,label:"Module Help Text",labelFor:"moduleHelpText",children:[Object(ne.jsxs)(h.V,{selectedTabId:n,onChange:g,className:"module-help-text-tabs",children:[Object(ne.jsx)(h.U,{id:as.WRITE,title:"Write"}),Object(ne.jsx)(h.U,{id:as.PREVIEW,title:"Preview"})]}),n===as.WRITE&&u,n===as.PREVIEW&&p]})]}),!t&&Object(ne.jsx)(h.i,{}),Object(ne.jsxs)("div",{className:"booleans",children:[Object(ne.jsx)(h.T,{checked:r,label:"Viewable",onChange:t=>e.setCourseConfiguration({...e.courseConfiguration,viewable:t.target.checked})}),Object(ne.jsx)(h.T,{checked:o,label:"Enable Game",onChange:t=>e.setCourseConfiguration({...e.courseConfiguration,enableGame:t.target.checked})}),Object(ne.jsx)(h.T,{checked:c,label:"Enable Achievements",onChange:t=>e.setCourseConfiguration({...e.courseConfiguration,enableAchievements:t.target.checked})}),Object(ne.jsx)(h.T,{checked:l,label:"Enable Sourcecast",onChange:t=>e.setCourseConfiguration({...e.courseConfiguration,enableSourcecast:t.target.checked})})]})]})]})};var os=e=>{const{data:t}=e,n=v.a.useCallback((n=>{e.handleUpdateUserRole(t.courseRegId,n.target.value)}),[t,e]),s=[{label:"Student",value:O.a.Student},{label:"Staff",value:O.a.Staff},{label:"Admin",value:O.a.Admin}];return Object(ne.jsx)(Le.a,{content:"You cannot downgrade yourself from an admin role!",interactionKind:"click",position:w.a.TOP,disabled:e.courseRegId!==t.courseRegId,children:Object(ne.jsx)(h.u,{options:s,onChange:n,fill:!0,minimal:!0,style:{textAlign:"center"},value:t.role,disabled:e.courseRegId===t.courseRegId})})};var cs=e=>{const[t,n]=v.a.useState(!1),s=v.a.useCallback((()=>{e.handleDeleteUserFromCourse(e.data.courseRegId),n(!1)}),[e]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(Le.a,{content:"You cannot delete an admin!",interactionKind:"click",position:w.a.TOP,disabled:e.data.role!==O.a.Admin,children:Object(ne.jsx)(h.b,{text:"Delete User",icon:C.a.CROSS,onClick:()=>{e.data.role!==O.a.Admin?n(!0):Object(me.e)("You cannot delete an admin user!")},disabled:e.data.role===O.a.Admin})}),Object(ne.jsxs)(h.h,{icon:C.a.WARNING_SIGN,isOpen:t,onClose:()=>n(!1),title:"Deleting User From Course",canOutsideClickClose:!0,children:[Object(ne.jsxs)("div",{className:p.a.DIALOG_BODY,children:[Object(ne.jsxs)("p",{children:["Are you sure you want to ",Object(ne.jsx)("b",{children:"delete"})," the user"," ",Object(ne.jsxs)("i",{children:[e.data.name," (",e.data.username,")"]}),"?"]}),Object(ne.jsx)("p",{children:Object(ne.jsx)("b",{children:"All their assessment answers will be deleted as well."})})]}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)("div",{className:p.a.DIALOG_FOOTER_ACTIONS,children:[Object(ne.jsx)(J.a,{label:"Cancel",icon:C.a.CROSS,onClick:()=>n(!1),options:{minimal:!1}}),Object(ne.jsx)(J.a,{label:"Confirm",icon:C.a.TRASH,onClick:s,options:{minimal:!1,intent:g.a.DANGER}})]})})]})]})};var ls=e=>{var t;const n=v.a.useRef(),s=null===(t=e.userCourseRegistrations)||void 0===t?void 0:t.map((e=>e.name?e:{...e,name:"(user has yet to log in)"})),i=[{headerName:"Name",field:"name",sort:"asc"},{headerName:"Username",field:"username"},{headerName:"Group",field:"group"},{headerName:"Role",field:"role",cellRendererFramework:os,cellRendererParams:{courseRegId:e.courseRegId,handleUpdateUserRole:e.handleUpdateUserRole},width:110},{headerName:"Actions",field:"actions",cellRendererFramework:cs,cellRendererParams:{handleDeleteUserFromCourse:e.handleDeleteUserFromCourse},width:120,filter:!1,resizable:!1}],a=Object(ne.jsx)("div",{className:"Grid ag-grid-parent ag-theme-balham",children:Object(ne.jsx)(Ln.AgGridReact,{domLayout:"autoHeight",columnDefs:i,defaultColDef:{filter:!0,resizable:!0,sortable:!0},onGridReady:e=>{n.current=e.api},onGridSizeChanged:()=>{var e;return null===(e=n.current)||void 0===e?void 0:e.sizeColumnsToFit()},rowData:s,rowHeight:36,suppressCellSelection:!0,suppressMovableColumns:!0,pagination:!0})});return Object(ne.jsxs)("div",{className:"users-configuration",children:[Object(ne.jsxs)("div",{className:"users-header-container",children:[Object(ne.jsx)(h.p,{children:"Users"}),Object(ne.jsx)(h.b,{text:"Export as CSV",className:"export-csv-button",onClick:()=>{n.current&&n.current.exportDataAsCsv({fileName:`SA Users (${(new Date).toISOString()}).csv`,columnKeys:["name","username","group","role"]})}})]}),a]})};var ds=e=>{const[t,n]=v.a.useState(!1),[s,i]=v.a.useState(!1),[a,r]=v.a.useState({courseName:"",courseShortName:"",viewable:!0,enableGame:!0,enableAchievements:!0,enableSourcecast:!0,moduleHelpText:""}),o=v.a.useRef(e.assessmentConfigurations),[c,l]=v.a.useState([]);v.a.useEffect((()=>{e.handleFetchCourseConfiguration(),e.handleFetchAssessmentConfigs(),e.handleFetchUserCourseRegistrations()}),[]),v.a.useEffect((()=>{r({courseName:e.courseName,courseShortName:e.courseShortName,viewable:e.viewable,enableGame:e.enableGame,enableAchievements:e.enableAchievements,enableSourcecast:e.enableSourcecast,moduleHelpText:e.moduleHelpText}),o.current=Object(T.cloneDeep)(e.assessmentConfigurations)}),[e]);const d={courseConfiguration:a,setCourseConfiguration:e=>{r(e),n(!0)}},u=v.a.useMemo((()=>({assessmentConfig:o,setAssessmentConfig:e=>{o.current=e,i(!0)},setAssessmentConfigsToDelete:e=>{if(-1!==e.assessmentConfigId){const t=[...c];t.push(e),l(t)}},setHasChangesAssessmentConfig:i})),[c]),p={courseRegId:e.courseRegId,userCourseRegistrations:e.userCourseRegistrations,handleUpdateUserRole:e.handleUpdateUserRole,handleDeleteUserFromCourse:e.handleDeleteUserFromCourse},m={handleAddNewUsersToCourse:e.handleAddNewUsersToCourse},b=Object(ne.jsxs)("div",{className:"admin-panel",children:[Object(ne.jsx)(h.o,{children:"Admin Panel"}),Object(ne.jsxs)(h.V,{id:"admin-panel",renderActiveTabPanelOnly:!0,children:[Object(ne.jsx)(h.U,{id:"configuration",title:"Configuration",panel:Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(rs,{...d}),Object(ne.jsx)(h.i,{}),Object(ne.jsx)(is,{...u}),Object(ne.jsx)(h.b,{text:"Save",style:{marginTop:"15px"},intent:t||s?g.a.WARNING:g.a.NONE,onClick:()=>{t&&(e.handleUpdateCourseConfig(a),n(!1)),c.length>0&&(c.forEach((t=>{e.handleDeleteAssessmentConfig(t)})),l([])),s&&(e.setAssessmentConfigurations([]),e.handleUpdateAssessmentConfigs(o.current),i(!1))}})]})}),Object(ne.jsx)(h.U,{id:"users",title:"Users",panel:Object(ne.jsx)(ls,{...p})}),Object(ne.jsx)(h.U,{id:"add-users",title:"Add Users",panel:Object(ne.jsx)(Zn,{...m})})]})]});return Object(ne.jsx)(Me.a,{loadContentDispatch:()=>{},display:b,fullWidth:!1})};var us=Object(r.b)((e=>({courseRegId:e.session.courseRegId,courseName:e.session.courseName,courseShortName:e.session.courseShortName,viewable:e.session.viewable,enableGame:e.session.enableGame,enableAchievements:e.session.enableAchievements,enableSourcecast:e.session.enableSourcecast,moduleHelpText:e.session.moduleHelpText,assessmentConfigurations:e.session.assessmentConfigurations,userCourseRegistrations:e.session.userCourseRegistrations})),(e=>Object(c.b)({handleFetchCourseConfiguration:u.fetchCourseConfig,handleFetchAssessmentConfigs:u.fetchAssessmentConfigs,handleFetchUserCourseRegistrations:u.fetchAdminPanelCourseRegistrations,handleUpdateCourseConfig:u.updateCourseConfig,handleUpdateAssessmentConfigs:u.updateAssessmentConfigs,setAssessmentConfigurations:u.setAssessmentConfigurations,handleDeleteAssessmentConfig:u.deleteAssessmentConfig,handleUpdateUserRole:u.updateUserRole,handleDeleteUserFromCourse:u.deleteUserCourseRegistration,handleAddNewUsersToCourse:l.addNewUsersToCourse},e)))(ds),hs=n(256);const ps={filter:!0,resizable:!0,sortable:!0};var gs=e=>{let t;const n=e.gradingSummary.cols.map((e=>({headerName:Object(T.startCase)(e),field:e}))),s=Object(ne.jsx)("div",{className:"Dashboard",children:Object(ne.jsx)("div",{className:"Grid ag-grid-parent ag-theme-balham",children:Object(ne.jsx)(Ln.AgGridReact,{domLayout:"autoHeight",columnDefs:n,defaultColDef:ps,onGridReady:e=>{t=e.api},onGridSizeChanged:()=>{t&&t.sizeColumnsToFit()},rowData:e.gradingSummary.rows,rowHeight:30,suppressCellSelection:!0,suppressMovableColumns:!0})})});return Object(ne.jsx)("div",{children:Object(ne.jsx)(Me.a,{display:s,loadContentDispatch:e.handleFetchGradingSummary})})};var ms=Object(r.b)((e=>({gradingSummary:e.dashboard.gradingSummary})),(e=>Object(c.b)({handleFetchGradingSummary:hs.fetchGroupGradingSummary},e)))(gs),bs=n(149);var fs={zektonFont:{key:"zekton",pngPath:"../../assets/zekton.png",fntPath:"../../assets/zekton.fnt"},zektonDarkFont:{key:"zektonDark",pngPath:"../../assets/zekton_dark.png",fntPath:"../../assets/zekton.fnt"},alienCowsFont:{key:"alienAndCows",pngPath:"../../assets/alien_and_cows.png",fntPath:"../../assets/alien_and_cows.fnt"},alienLeagueFont:{key:"alienLeague",pngPath:"../../assets/alien_league.png",fntPath:"../../assets/alien_league.fnt"},pixelFont:{key:"pixel",pngPath:"../../assets/pixel.png",fntPath:"../../assets/pixel.fnt"}};const vs={assetsFolder:we.a.sourceAcademyAssets,fadeDuration:600,nullFunction:()=>{},nullInteractionId:"",nullSequenceNumber:-1,popUpDuration:1e3,defaultAssetPath:"/ui/wristDeviceButton.png",defaultFontStyle:{key:fs.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},defaultCursor:""},ys={x:1920,y:1080},js={x:ys.x/2,y:ys.y/2},xs={navy:"#03092c",lightBlue:"#ece1fb",offWhite:"#bbc1c9",white:"#ffffff",darkGrey:"#333333",lightGrey:"#555555",blue:"#1133ff",darkBlue:"#0d2440",orange:"#ff9933",yellow:"#ffee33",red:"0#ff0000",maroon:"#142B2E",black:"#000000",purple:"#dd33dd",paleYellow:"#f6ffbd"},Os=T.mapValues(xs,(e=>parseInt(e.slice(1),16)));let Ss;function ws(e){let{direction:t=Ss.Row,numOfItems:n,maxXSpace:s=ys.x,maxYSpace:i=ys.y,numItemLimit:a=0,redistributeLast:r=!0}=e,o=a||n;const c=Math.ceil(n/o);return T.times(n,(e=>{const a=e%o,l=Math.floor(e/o);return r&&l===c-1&&(o=n%c||o),t===Ss.Row?[Cs(ys.x,s,a,o),Cs(ys.y,i,l,c)]:[Cs(ys.x,s,l,c),Cs(ys.y,i,a,o)]}))}function Cs(e,t,n,s){const i=t/s;return(e-t+i)/2+i*n}function Es(e){let{numOfItems:t,xSpacing:n=30,ySpacing:s=30}=e;const i=new Array;for(let a=0;a<t;a++)i.push([a*n,a*s]);return i}!function(e){e.Row="Row",e.Column="Column"}(Ss||(Ss={}));const Ts={fontFamily:"Verdana",fontSize:"15px",fill:xs.lightBlue,align:"left",wordWrap:{width:290}};class ks extends Phaser.GameObjects.Container{constructor(e,t,n,s){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:300;super(e,t,n),this.renderTextHover(s,i)}renderTextHover(e,t){const n=parseInt(Ts.fontSize.substring(0,Ts.fontSize.length-2)),s=e.length*n*.75,i=Math.min(s,t),a=new Phaser.GameObjects.Text(this.scene,30,10,e,{...Ts,wordWrap:{width:i-10}}),r=new Phaser.GameObjects.Rectangle(this.scene,20,0,i,a.getBounds().bottom+10,Os.darkBlue).setOrigin(0,0).setAlpha(.8);this.add([r,a]),this.setDepth(1),this.setVisible(!1)}}var As=ks;const _s=(e,t,n,s)=>{let{x:i,y:a,oriX:r,oriY:o}=n;return new Phaser.GameObjects.BitmapText(e,i,a,s.key,t,s.size,s.align).setOrigin(r,o)},Is={key:fs.zektonFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT},Ns={key:fs.alienLeagueFont.key,size:50,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Ps={key:fs.zektonFont.key,size:18,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT},Rs={fontFamily:"Verdana",fontSize:"18px",fill:xs.lightBlue,align:"center",lineSpacing:10,wordWrap:{width:500}},Ms={id:"default-award",assetKey:vs.nullInteractionId,assetPath:vs.nullInteractionId,title:vs.nullInteractionId,description:"There is no asset associated with this award.",completed:!1},Ls=.3*-ys.x,Ds=.05*-ys.y,Bs=Ds+275;var Us={arrow:{x:.08*ys.x,y:.34*ys.y,xOffset:80,xScale:.4,yScale:.3},itemsPerPage:7,list:{yStart:.31*-ys.y,ySpace:100},listTextConfig:{x:.09*-ys.x,y:0,oriX:0,oriY:.55},noPreviewTextConfig:{x:Ls,y:-40,oriX:.5,oriY:.5},preview:{descText:{yOffset:320},rect:{dim:430,x:Ls,y:Ds,xOffset:30,yOffset:15},key:{x:Ls,y:Bs,width:430,height:35},keyTagTextConfig:{x:Ls-205,y:Bs,oriX:0,oriY:.5},keyTextConfig:{x:Ls-90,y:Bs,oriX:0,oriY:.5},explanation:{x:Ls-150,y:Ds+200},titleTextConfig:{x:Ls+20,y:Ds-275,oriX:.5,oriY:.5}}};const Gs=e=>e.map((e=>Fs(e))),Fs=e=>{const t=zo.getInstance().getAwardsMapping().get(e);return t||{...Ms,title:e}};let Hs,Vs;!function(e){e.Image="Image",e.Sprite="Sprite"}(Hs||(Hs={})),function(e){e.Background="Background",e.Object="Object"}(Vs||(Vs={}));var Ws={spaceshipBg:{type:Hs.Image,key:"spaceship-bg",path:"/locations/spaceshipBackground.png"},saBanner:{type:Hs.Image,key:"sa-banner",path:"/ui/sourceAcadBannerOneLine.png"},shortButton:{type:Hs.Image,key:"short-button",path:"/ui/shortButton.png"},mediumButton:{type:Hs.Image,key:"med-button",path:"/ui/mediumButton.png"},longButton:{type:Hs.Image,key:"long-button",path:"/ui/longButton.png"},topButton:{type:Hs.Image,key:"top-button",path:"/ui/topButton.png"},speechBox:{type:Hs.Image,key:"speechBox",path:"/ui/speechbox.png"},speakerBox:{type:Hs.Image,key:"speakerBox",path:"/ui/speakerBox.png"},defaultLocationImg:{type:Hs.Image,key:"loc-default",path:"/ui/defaultLocation.jpg"},locationPreviewFrame:{type:Hs.Image,key:"loc-preview-frame",path:"/ui/locationPreviewFrame.png"},locationPreviewFill:{type:Hs.Image,key:"loc-preview-fill",path:"/ui/locationPreviewFill.png"},talkOptButton:{type:Hs.Image,key:"talk-opt-button",path:"/ui/talkOptButton.png"},talkOptCheck:{type:Hs.Image,key:"talk-opt-check",path:"/ui/talkOptCheck.png"},modeMenuBanner:{type:Hs.Image,key:"mode-banner",path:"/ui/modeMenuBanner.png"},popUpFrame:{type:Hs.Image,key:"pop-up-frame",path:"/ui/popUpFrame.png"},mediumBox:{type:Hs.Image,key:"medium-box",path:"/ui/mediumBox.png"},diamond:{type:Hs.Image,key:"diamond",path:"/ui/zircon.png"},arrow:{type:Hs.Image,key:"arrow",path:"/ui/arrow.png"},cookies:{type:Hs.Image,key:"cookies",path:"/images/cookies.png"},scrollFrame:{type:Hs.Image,key:"scroll-frame",path:"/ui/scrollFrame.png"},messageBar:{type:Hs.Image,key:"message-bar",path:"/ui/messageBg.png"},escapeMenuBackground:{type:Hs.Image,key:"escape-bg",path:"/ui/escapeMenu.png"},awardsMenu:{type:Hs.Image,key:"award-bg",path:"/ui/collectiblesBg.png"},awardsBanner:{type:Hs.Image,key:"award-banner",path:"/ui/awardsBanner.png"},awardsPageChosen:{type:Hs.Image,key:"award-pg-chosen",path:"/ui/collectiblesPageOptChosen.png"},awardsPage:{type:Hs.Image,key:"award-pg-opt",path:"/ui/collectiblesPageOpt.png"},awardsBackground:{type:Hs.Image,key:"award-hall-bg",path:"/ui/awardsHall.png"},gear:{type:Hs.Image,key:"gear",path:"/ui/settings.png"},journal:{type:Hs.Image,key:"journal",path:"/ui/journal.png"},chapterRepeatButton:{type:Hs.Image,key:"chapter-repeat",path:"/ui/chapterRepeat.png"},chapterContinueButton:{type:Hs.Image,key:"chapter-continue",path:"/ui/chapterContinue.png"},StarGold:{type:Hs.Image,key:"StarGold",path:"/ui/StarGold.png"},StarSilver:{type:Hs.Image,key:"StarSilver",path:"/ui/StarSilver.png"},StarBronze:{type:Hs.Image,key:"StarBronze",path:"/ui/StarBronze.png"},chapterSelectFrame:{type:Hs.Image,key:"chapter-select-frame",path:"/ui/chapterSelectionFrame.png"},chapterSelectBorder:{type:Hs.Image,key:"chapter-select-border",path:"/ui/chapterSelectionBorder.png"},chapterSelectArrow:{type:Hs.Image,key:"chapter-select-arrow",path:"/ui/chapSelectArrow.png"},mainMenuOptBanner:{type:Hs.Image,key:"menu-option",path:"/ui/menuOption.png"},settingBanner:{type:Hs.Image,key:"settings-bg",path:"/ui/settingsBg.png"},settingOption:{type:Hs.Image,key:"settings-opt",path:"/ui/settingsOption.png"},verifiedFrame:{type:Hs.Image,key:"verified-frame",path:"/ui/verifiedFrame.png"},sourceCrashedPod:{type:Hs.Image,key:"source-crashed-pod",path:"/locations/sourceCrashedPod.png"},squareKeyboardIcon:{type:Hs.Image,key:"keyboard-key-square",path:"/ui/keyboardKeyIcon.png"},medKeyboardIcon:{type:Hs.Image,key:"keyboard-key-medium",path:"/ui/TabIcon.png"}};const $s={volume:0,ease:"Power2"};let Xs;!function(e){e[e.SFX=0]="SFX",e[e.BGM=1]="BGM"}(Xs||(Xs={}));var qs={buttonHover:{key:"btn-hover",path:"/sfx/buttonHover.mp3",config:{volume:.1},soundType:Xs.SFX},buttonClick:{key:"btn-click",path:"/sfx/buttonClick.mp3",config:{volume:.1},soundType:Xs.SFX},radioButtonClick:{key:"radio-btn-click",path:"/sfx/radioButtonClick.mp3",config:{volume:.15},soundType:Xs.SFX},dialogueAdvance:{key:"dialogue-advance",path:"/sfx/dialogueAdvance.mp3",config:{volume:.3},soundType:Xs.SFX},popUpEnter:{key:"pop-up-enter",path:"/sfx/popUpEnter.mp3",config:{volume:.35},soundType:Xs.SFX},popUpExit:{key:"pop-up-exit",path:"/sfx/popUpExit.mp3",config:{volume:.35},soundType:Xs.SFX},menuEnter:{key:"menu-enter",path:"/sfx/menuEnter.mp3",config:{volume:.5},soundType:Xs.SFX},menuExit:{key:"menu-exit",path:"/sfx/menuExit.mp3",config:{volume:.5},soundType:Xs.SFX},modeEnter:{key:"mode-enter",path:"/sfx/modeEnter.mp3",config:{volume:.1},soundType:Xs.SFX},notifEnter:{key:"notif-enter",path:"/sfx/notifEnter.mp3",config:{volume:.25},soundType:Xs.SFX},notifExit:{key:"notif-exit",path:"/sfx/notifExit.mp3",config:{volume:.25},soundType:Xs.SFX},radioStatic:{key:"radio-static",path:"/sfx/radioStatic.mp3",config:{volume:.1},soundType:Xs.SFX},galacticHarmony:{key:"galactic-harmony",path:"/bgm/GalacticHarmony.mp3",config:{volume:.25,loop:!0},soundType:Xs.BGM}};let zs;!function(e){e[e.Effects=0]="Effects",e[e.Background=1]="Background",e[e.Character=2]="Character",e[e.Speaker=3]="Speaker",e[e.PopUp=4]="PopUp",e[e.Dialogue=5]="Dialogue",e[e.SpeakerBox=6]="SpeakerBox",e[e.UI=7]="UI",e[e.Objects=8]="Objects",e[e.BBox=9]="BBox",e[e.Escape=10]="Escape",e[e.Selector=11]="Selector",e[e.Dashboard=12]="Dashboard",e[e.WorkerMessage=13]="WorkerMessage"}(zs||(zs={}));const Ys=[zs.Background,zs.Selector,zs.Objects,zs.BBox,zs.Character,zs.Speaker,zs.PopUp,zs.Dialogue,zs.SpeakerBox,zs.Effects,zs.Dashboard,zs.Escape,zs.UI,zs.WorkerMessage];var Ks=n(85);function Qs(e){return new Promise((t=>setTimeout(t,e)))}function Js(e,t,n){return Math.min(Math.max(e,t),n)}function Zs(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.startsWith("/")&&(e=e.substr(1)),vs.assetsFolder+(t?ni()+e:e)}function ei(e,t){if(void 0===e)throw new Error(t||"Object not found");return e}const ti=()=>Ks.a.getState().session.courseId,ni=()=>Ks.a.getState().session.assetsPrefix||"",si=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vs.fadeDuration;return{alpha:0,targets:e,duration:t,ease:"Power2"}},ii=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vs.fadeDuration;return{alpha:1,targets:e,duration:t,ease:"Power2"}};function ai(e,t){let{fadeDuration:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t&&(e.add.tween(si([t],n||vs.fadeDuration)),setTimeout((()=>t.destroy()),n||vs.fadeDuration))}function ri(e){return new Phaser.GameObjects.Rectangle(e,js.x,js.y,ys.x,ys.y,0)}function oi(e,t){let n=0;const s=setInterval((()=>{n%2!==0?(t.setAlpha(0),e.tweens.add(ii([t],250))):(t.setAlpha(1),e.tweens.add(si([t],250))),n++}),500);return function(){n=0,clearInterval(s)}}const ci={y:0,duration:300,ease:"Power2"},li={y:-ys.y,duration:250,ease:"Power2"},di=(ys.x,{x:0,duration:500,ease:"Power2"}),ui={x:ys.x,duration:500,ease:"Power2"},hi={x:1900,y:100,oriX:1,oriY:.5},pi={key:fs.zektonDarkFont.key,size:24,align:Phaser.GameObjects.BitmapText.ALIGN_RIGHT},gi=(()=>{let e=Promise.resolve();return(t,n)=>{e=e.then((()=>async function(e,t){const n=new Phaser.GameObjects.Container(e,0,0),s=new Phaser.GameObjects.Sprite(e,ys.x,100,Ws.messageBar.key);s.setScale(-1.5,.8);const i=_s(e,t,hi,pi);n.add([s,i]),e.getLayerManager().addToLayer(zs.Effects,n),n.setPosition(ys.x,0),n.setAlpha(0),zo.getInstance().getSoundManager().playSound(qs.notifEnter.key),e.add.tween({targets:n,alpha:1,...di}),await Qs(di.duration+3e3),zo.getInstance().getSoundManager().playSound(qs.notifExit.key),e.add.tween({targets:n,alpha:1,...ui}),await Qs(ui.duration),ai(e,n,{fadeDuration:vs.fadeDuration})}(t,n)))}})();const mi={prompt:{x:30,y:60,xPad:30,yPad:10},rect:{x:10,y:760,width:ys.x-20},text:{xPad:100,yPad:70},speakerTextConfig:{x:320,y:745,oriX:.5,oriY:.5}},bi={fontFamily:"Verdana",fontSize:"30px",fill:xs.lightBlue,align:"left",lineSpacing:10,wordWrap:{width:mi.rect.width-2*mi.text.xPad-2*mi.rect.x}},fi={key:fs.zektonFont.key,size:36,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var vi=mi;var yi=function(e,t){let{x:n=0,y:s=0,textStyle:i={},typeWriterInterval:a=1}=t;const r=new Phaser.GameObjects.Text(e,n,s,"",i);let o,c="",l=0;const d=()=>{o&&clearInterval(o)};return{container:r,changeLine:e=>{e&&(c=e,r.text="",l=0,d(),o=setInterval((()=>{r.text+=c[l++],l===c.length&&clearInterval(o)}),a))},clearTyping:d}};var ji=class{constructor(e){this.typewriter=void 0,this.dialogueBox=void 0,this.blinkingDiamond=void 0;const t=Ii.getInstance().getGameManager();var n;this.dialogueBox=(n=t,new Phaser.GameObjects.Image(n,js.x,js.y,Ws.speechBox.key).setAlpha(.9)).setInteractive({useHandCursor:!0,pixelPerfect:!0}),this.typewriter=function(e,t){return yi(e,{x:vi.rect.x+vi.text.xPad,y:vi.rect.y+vi.text.yPad,textStyle:t})}(t,e),this.blinkingDiamond=this.drawDiamond(t)}getDialogueContainer(){const e=Ii.getInstance().getGameManager(),t=new Phaser.GameObjects.Container(e,0,0);return t.add([this.dialogueBox,this.blinkingDiamond.container,this.typewriter.container]),t}drawDiamond(e){const t=new Phaser.GameObjects.Image(e,ys.x-vi.prompt.x-vi.prompt.xPad,ys.y-vi.prompt.y-vi.prompt.yPad,Ws.diamond.key).setDisplaySize(vi.prompt.x,vi.prompt.y);return{container:t,clearBlink:oi(e,t)}}getDialogueBox(){return this.dialogueBox}destroy(){const e=Ii.getInstance().getGameManager();this.typewriter.clearTyping(),this.blinkingDiamond.clearBlink(),this.getDialogueBox().off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP),ai(e,this.getDialogueContainer())}changeText(e){this.typewriter.changeLine(e)}};const xi={key:fs.alienLeagueFont.key,size:100,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Oi={x:js.x,y:vi.rect.y+2*xi.size,oriX:.5,oriY:.9};function Si(e,t){let{assetKey:n,message:s="",textConfig:i={x:0,y:0,oriX:0,oriY:0},bitMapTextStyle:a=vs.defaultFontStyle,onDown:r=vs.nullFunction,onUp:o=vs.nullFunction,onHover:c=vs.nullFunction,onOut:l=vs.nullFunction,onPointerMove:d=vs.nullFunction,onHoverEffect:u=!0,onClickSound:h=qs.buttonClick.key,onHoverSound:p=qs.buttonHover.key}=t;const g=new Phaser.GameObjects.Container(e,0,0),m=new Phaser.GameObjects.Sprite(e,0,0,n);m.setInteractive({pixelPerfect:!0,useHandCursor:!0}),m.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(()=>{zo.getInstance().getSoundManager().playSound(h),o()})),m.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OVER,(()=>{zo.getInstance().getSoundManager().playSound(p),u&&g.setAlpha(1),c()})),m.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(()=>{u&&g.setAlpha(.9),l()})),m.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(()=>{r()})),m.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_MOVE,((e,t,n)=>{d(e,t,n)}));const b=_s(e,s,i,a);return g.add([m,b]),u&&g.setAlpha(.9),g}const wi={textPad:20,textConfig:{x:15,y:-15,oriX:.5,oriY:.5},y:100,width:450,yInterval:100},Ci={fontFamily:"Verdana",fontSize:"20px",fill:xs.offWhite,align:"right",lineSpacing:10,wordWrap:{width:wi.width-2*wi.textPad}},Ei={key:fs.zektonFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};async function Ti(e,t,n){const s=new Phaser.GameObjects.Container(e,0,0),i=new Phaser.GameObjects.Text(e,ys.x-wi.textPad,wi.y,t,Ci).setOrigin(1,0),a=new Phaser.GameObjects.Rectangle(e,ys.x,wi.y-wi.textPad,wi.width,.5*i.getBounds().bottom+wi.textPad,Os.darkBlue,.8).setOrigin(1,0),r=new Phaser.GameObjects.Rectangle(e,ys.x,wi.y-wi.textPad,wi.width,.5*a.getBounds().bottom+(n.length+.5)*wi.yInterval,Os.lightBlue,.2).setOrigin(1,0);s.add([r,a,i]);const o=Es({numOfItems:n.length,xSpacing:0,ySpacing:wi.yInterval});Ii.getInstance().addToLayer(zs.UI,s);const c=new Promise((t=>{s.add(n.map(((n,i)=>Si(e,{assetKey:Ws.mediumButton.key,message:n,textConfig:wi.textConfig,bitMapTextStyle:Ei,onUp:()=>{s.destroy(),t(i)}}).setPosition(ys.x-wi.width/2,o[i][1]+a.getBounds().bottom+75))))}));s.setPosition(ys.x,0),zo.getInstance().getSoundManager().playSound(qs.notifEnter.key),e.add.tween({targets:s,alpha:1,...di}),await Qs(di.duration);const l=await c;return zo.getInstance().getSoundManager().playSound(qs.notifExit.key),e.add.tween({targets:s,alpha:1,...ui}),await Qs(ui.duration),ai(e,s,{fadeDuration:vs.fadeDuration}),l}let ki,Ai;!function(e){e.Move="Move",e.Explore="Explore",e.Talk="Talk",e.Menu="Menu",e.EscapeMenu="EscapeMenu",e.None="None",e.Sequence="Sequence",e.Dashboard="Dashboard"}(ki||(ki={})),function(e){e[e.EscapeMenu=ki.EscapeMenu]="EscapeMenu",e[e.Dashboard=ki.Dashboard]="Dashboard"}(Ai||(Ai={}));class _i{constructor(){this.gameManager=void 0,this.getGameManager=()=>ei(this.gameManager),this.gameManager=void 0}static getInstance(){return _i.instance||(_i.instance=new _i),_i.instance}setGameManager(e){this.gameManager=e}getCurrLocId(){return this.getGameManager().currentLocationId}getLocationAtId(e){return this.getGameManager().getStateManager().getGameMap().getLocationAtId(e)}async changeLocationTo(e){await this.getGameManager().changeLocationTo(e)}getLocationModes(e){return this.getGameManager().getStateManager().getLocationModes(e)}addLocationMode(e,t){this.getGameManager().getStateManager().addLocationMode(e,t)}removeLocationMode(e,t){this.getGameManager().getStateManager().removeLocationMode(e,t)}hasTriggeredInteraction(e){return this.getGameManager().getStateManager().hasTriggeredInteraction(e)}triggerStateChangeAction(e){this.getGameManager().getStateManager().triggerStateChangeAction(e)}triggerInteraction(e){this.getGameManager().getStateManager().triggerInteraction(e)}watchGameItemType(e,t){this.getGameManager().getStateManager().watchGameItemType(e,t)}getGameMap(){return this.getGameManager().getStateManager().getGameMap()}getGameItemsInLocation(e,t){return this.getGameManager().getStateManager().getGameItemsInLocation(e,t)}addItem(e,t,n){this.getGameManager().getStateManager().addItem(e,t,n)}removeItem(e,t,n){return this.getGameManager().getStateManager().removeItem(e,t,n)}makeObjectGlow(e,t){this.getGameManager().getObjectManager().makeObjectGlow(e,t)}makeObjectBlink(e,t){this.getGameManager().getObjectManager().makeObjectBlink(e,t)}setObjProperty(e,t){this.getGameManager().getStateManager().setObjProperty(e,t)}renderObjectLayerContainer(e){this.getGameManager().getObjectManager().renderObjectsLayerContainer(e)}getAllActivatables(){return[...this.getGameManager().getObjectManager().getActivatables(),...this.getGameManager().getBBoxManager().getActivatables()]}setBBoxProperty(e,t){this.getGameManager().getStateManager().setBBoxProperty(e,t)}renderBBoxLayerContainer(e){this.getGameManager().getBBoxManager().renderBBoxLayerContainer(e)}areAllObjectivesComplete(){return this.getGameManager().getStateManager().areAllObjectivesComplete()}isObjectiveComplete(e){return this.getGameManager().getStateManager().isObjectiveComplete(e)}areObjectivesComplete(e){return this.getGameManager().getStateManager().areObjectivesComplete(e)}completeObjective(e){this.getGameManager().getStateManager().completeObjective(e)}isTaskComplete(e){return this.getGameManager().getStateManager().isTaskComplete(e)}areTasksComplete(e){return this.getGameManager().getStateManager().areTasksComplete(e)}completeTask(e){this.getGameManager().getStateManager().completeTask(e),gi(this.getGameManager(),"Task completed!")}showTask(e){this.getGameManager().getStateManager().showTask(e),gi(this.getGameManager(),"New task added")}getAllVisibleTaskData(){return this.getGameManager().getStateManager().getAllVisibleTaskData()}addCollectible(e){zo.getInstance().getUserStateManager().addCollectible(e)}async isInUserState(e,t){return zo.getInstance().getUserStateManager().isInUserState(e,t)}clearSeveralLayers(e){this.getGameManager().getLayerManager().clearSeveralLayers(e)}addToLayer(e,t){this.getGameManager().getLayerManager().addToLayer(e,t)}showLayer(e){this.getGameManager().getLayerManager().showLayer(e)}hideLayer(e){this.getGameManager().getLayerManager().hideLayer(e)}async fadeInLayer(e,t){await this.getGameManager().getLayerManager().fadeInLayer(e,t)}async fadeOutLayer(e,t){await this.getGameManager().getLayerManager().fadeOutLayer(e,t)}async bringUpUpdateNotif(e){await async function(e,t){const n=new ji({}),s=n.getDialogueContainer();e.getLayerManager().addToLayer(zs.Effects,s),e.getLayerManager().fadeInLayer(zs.Effects);const i=_s(e,t,Oi,xi).setAlpha(0);s.add(i),zo.getInstance().getSoundManager().playSound(qs.notifEnter.key),e.add.tween(ii([i],2*vs.fadeDuration)),await Qs(2*vs.fadeDuration);const a=new Promise((t=>{n.getDialogueBox().on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(()=>{zo.getInstance().getSoundManager().playSound(qs.notifExit.key),ai(e,i,{fadeDuration:vs.fadeDuration/4}),n.destroy(),t()}))}));await a}(this.getGameManager(),e)}async processGameActions(e){await this.getGameManager().getPhaseManager().pushPhase(ki.Sequence),await this.getGameManager().getActionManager().processGameActions(e),await this.getGameManager().getPhaseManager().popPhase()}async processGameActionsInSamePhase(e){await this.getGameManager().getActionManager().processGameActions(e)}async showDialogue(e){await this.getGameManager().getPhaseManager().pushPhase(ki.Sequence),await this.getGameManager().getDialogueManager().showDialogue(e),await this.getGameManager().getPhaseManager().popPhase()}async showDialogueInSamePhase(e){await this.getGameManager().getDialogueManager().showDialogue(e)}storeDialogueLine(e,t){this.getGameManager().getDialogueStorageManager().storeLine(e,t)}getDialogueStorage(){return this.getGameManager().getDialogueStorageManager().getDialogueStorage()}async obtainCollectible(e){gi(this.getGameManager(),`Obtained ${Fs(e).title}`),zo.getInstance().getUserStateManager().addCollectible(e)}displayPopUp(e,t,n,s){this.getGameManager().getPopupManager().displayPopUp(e,t,n,s)}destroyAllPopUps(){this.getGameManager().getPopupManager().destroyAllPopUps()}async destroyPopUp(e){this.getGameManager().getPopupManager().destroyPopUp(e)}async saveGame(){await this.getGameManager().getSaveManager().saveGame()}async saveSettings(e){await this.getGameManager().getSaveManager().saveSettings(e)}getLoadedUserState(){return this.getGameManager().getSaveManager().getLoadedUserState()}getSoundManager(){return zo.getInstance().getSoundManager()}playSound(e){zo.getInstance().getSoundManager().playSound(e)}playBgMusic(e){zo.getInstance().getSoundManager().playBgMusic(e)}async stopAllSound(){zo.getInstance().getSoundManager().stopAllSound()}pauseCurrBgMusic(){zo.getInstance().getSoundManager().pauseCurrBgMusic()}continueCurrBgMusic(){zo.getInstance().getSoundManager().continueCurrBgMusic()}applySoundSettings(e){zo.getInstance().getSoundManager().applyUserSettings(e)}loadSounds(e){zo.getInstance().getSoundManager().loadSounds(e)}startAnimation(e,t,n){const s=this.getAssetByKey(this.getGameMap().getAssetKeyFromId(e));this.getGameManager().getAnimationManager().displayAnimation(s,t,n)}stopAnimation(e){const t=this.getAssetByKey(this.getGameMap().getAssetKeyFromId(e));this.getGameManager().getAnimationManager().stopAnimation(t)}setDefaultCursor(e){this.getGameManager().getInputManager().setDefaultCursor(e)}enableKeyboardInput(e){this.getGameManager().getInputManager().enableKeyboardInput(e)}enableMouseInput(e){this.getGameManager().getInputManager().enableMouseInput(e)}enableSprite(e,t){t?this.getGameManager().input.enable(e):this.getGameManager().input.disable(e)}async popPhase(){await this.getGameManager().getPhaseManager().popPhase()}async pushPhase(e){await this.getGameManager().getPhaseManager().pushPhase(e)}async swapPhase(e){await this.getGameManager().getPhaseManager().swapPhase(e)}isCurrentPhase(e){return this.getGameManager().getPhaseManager().isCurrentPhase(e)}renderBackgroundLayerContainer(e){this.getGameManager().getBackgroundManager().renderBackgroundLayerContainer(e)}async promptNavigateToAssessment(e){0===await Ti(_i.getInstance().getGameManager(),"Are you ready for the challenge?",["Yes","No"])&&(window.open(`/courses/${ti()}/missions/${e}/0`,"blank"),window.focus())}async updateAssessmentState(){await zo.getInstance().getUserStateManager().loadAssessments()}createCharacterSprite(e,t,n){return this.getGameManager().getCharacterManager().createCharacterSprite(e,t,n)}moveCharacter(e,t,n){this.getGameManager().getStateManager().moveCharacter(e,t,n)}updateCharacter(e,t){this.getGameManager().getStateManager().updateCharacter(e,t)}getDialogueById(e){return ei(this.getGameMap().getDialogueMap().get(e))}getCharacterById(e){return ei(this.getGameMap().getCharacterMap().get(e))}getActionById(e){return ei(this.getGameMap().getActionMap().get(e))}getObjectById(e){return ei(this.getGameMap().getObjectPropMap().get(e))}getBBoxById(e){return ei(this.getGameMap().getBBoxPropMap().get(e))}getAssetByKey(e){return this.getGameMap().getAssetByKey(e)}}_i.instance=void 0;var Ii=_i;let Ni,Pi,Ri,Mi;!function(e){e.UserState="UserState",e.ChecklistState="ChecklistState",e.TasklistState="TasklistState"}(Ni||(Ni={})),function(e){e.collectibles="collectibles",e.assessments="assessments",e.achievements="achievements"}(Pi||(Pi={}));class Li{static async checkAllConditionsSatisfied(e){return(await Promise.all(e.map((async e=>await this.checkConditionSatisfied(e))))).every((e=>!0===e))}static async checkConditionSatisfied(e){const{state:t,conditionParams:n,boolean:s}=e;switch(t){case Ni.UserState:return await Ii.getInstance().isInUserState(n.userStateType,n.id)===s;case Ni.ChecklistState:return Ii.getInstance().isObjectiveComplete(n.id)===s;case Ni.TasklistState:return Ii.getInstance().isTaskComplete(n.id)===s;default:return!0}}}!function(e){e.MoveCharacter="MoveCharacter",e.UpdateCharacter="UpdateCharacter",e.ObtainCollectible="ObtainCollectible",e.CompleteObjective="CompleteObjective",e.CompleteTask="CompleteTask",e.ShowTask="ShowTask",e.PreviewLocation="PreviewLocation",e.AddItem="AddItem",e.RemoveItem="RemoveItem",e.ShowDialogue="ShowDialogue",e.ChangeBackground="ChangeBackground",e.StartAnimation="StartAnimation",e.StopAnimation="StopAnimation",e.RemoveLocationMode="RemoveLocationMode",e.AddLocationMode="AddLocationMode",e.AddPopup="AddPopup",e.MakeObjectBlink="MakeObjectBlink",e.MakeObjectGlow="MakeObjectGlow",e.PlayBGM="PlayBGM",e.PlaySFX="PlaySFX",e.ShowObjectLayer="ShowObjectLayer",e.NavigateToAssessment="NavigateToAssessment",e.UpdateAssessmentStatus="UpdateAssessmentStatus",e.Delay="Delay"}(Ri||(Ri={}));class Di{static async executeGameAction(e,t){const n=Ii.getInstance();switch(e){case Ri.AddItem:return void n.addItem(t.gameItemType,t.locationId,t.id);case Ri.RemoveItem:return void n.removeItem(t.gameItemType,t.locationId,t.id);case Ri.AddLocationMode:return void n.addLocationMode(t.locationId,t.mode);case Ri.RemoveLocationMode:return void n.removeLocationMode(t.locationId,t.mode);case Ri.MoveCharacter:return void n.moveCharacter(t.id,t.locationId,t.position);case Ri.UpdateCharacter:return void n.updateCharacter(t.id,t.expression);case Ri.ChangeBackground:return void n.renderBackgroundLayerContainer(t.id);case Ri.StartAnimation:return void n.startAnimation(t.id,t.startFrame,t.frameRate);case Ri.StopAnimation:return void n.stopAnimation(t.id);case Ri.PreviewLocation:return n.renderBackgroundLayerContainer(t.id),n.renderObjectLayerContainer(t.id),void n.renderBBoxLayerContainer(t.id);case Ri.ObtainCollectible:return void n.obtainCollectible(t.id);case Ri.CompleteObjective:return void n.completeObjective(t.id);case Ri.CompleteTask:return void n.completeTask(t.id);case Ri.ShowTask:return void n.showTask(t.id);case Ri.ShowDialogue:return void(n.isCurrentPhase(ki.Sequence)?await n.showDialogueInSamePhase(t.id):await n.showDialogue(t.id));case Ri.AddPopup:return void await n.displayPopUp(t.id,t.position,t.duration,t.size);case Ri.MakeObjectBlink:return void await n.makeObjectBlink(t.id,t.turnOn);case Ri.MakeObjectGlow:return void await n.makeObjectGlow(t.id,t.turnOn);case Ri.PlayBGM:return void zo.getInstance().getSoundManager().playBgMusic(t.id);case Ri.PlaySFX:return void await zo.getInstance().getSoundManager().playSound(t.id);case Ri.ShowObjectLayer:return void(t.show?n.showLayer(zs.Objects):n.hideLayer(zs.Objects));case Ri.NavigateToAssessment:return void await n.promptNavigateToAssessment(t.assessmentId);case Ri.UpdateAssessmentStatus:return void await n.updateAssessmentState();case Ri.Delay:return void await Qs(t.duration);default:return}}static isStateChangeAction(e){switch(e){case Ri.AddItem:case Ri.RemoveItem:case Ri.AddLocationMode:case Ri.RemoveLocationMode:case Ri.MoveCharacter:case Ri.UpdateCharacter:return!0;case Ri.NavigateToAssessment:case Ri.UpdateAssessmentStatus:case Ri.PreviewLocation:case Ri.ChangeBackground:case Ri.StartAnimation:case Ri.StopAnimation:case Ri.ObtainCollectible:case Ri.CompleteObjective:case Ri.CompleteTask:case Ri.ShowTask:case Ri.ShowDialogue:case Ri.AddPopup:case Ri.MakeObjectBlink:case Ri.MakeObjectGlow:case Ri.PlayBGM:case Ri.PlaySFX:case Ri.ShowObjectLayer:case Ri.Delay:return!1}}}class Bi{async fastForwardGameActions(e){if(e)for(const t of e){const{actionType:e,actionParams:n}=Ii.getInstance().getActionById(t);await Di.executeGameAction(e,n)}}async processGameActions(e){if(e){for(const t of e)await this.processGameAction(t);await Ii.getInstance().saveGame()}}async processGameAction(e){const{actionType:t,actionParams:n,actionConditions:s,isRepeatable:i,interactionId:a}=Ii.getInstance().getActionById(e);await this.checkCanPlayAction(i,a,s)&&(await Di.executeGameAction(t,n),Di.isStateChangeAction(t)&&Ii.getInstance().triggerStateChangeAction(e),Ii.getInstance().triggerInteraction(e))}async checkCanPlayAction(e,t,n){return(e||!Ii.getInstance().hasTriggeredInteraction(t))&&await Li.checkAllConditionsSatisfied(n)}}!function(e){e.navigation="navigation",e.locations="locations",e.talkTopics="talkTopics",e.dialogues="dialogues",e.objects="objects",e.boundingBoxes="boundingBoxes",e.characters="characters",e.actions="actions",e.bgmKey="bgmKey",e.collectibles="collectibles"}(Mi||(Mi={}));class Ui{constructor(){this.game=Ii.getInstance().getGameManager(),this.animationInstanceMap=new Map,this.isSprite=e=>e.type===Hs.Sprite}createImage(e,t){var n,s,i,a;switch(e.type){case Hs.Sprite:return this.createAnimation(e,(null===(n=e.config)||void 0===n?void 0:n.start)||0,(null===(s=e.config)||void 0===s?void 0:s.frameRate)||20),this.getAnimation(e);case Hs.Image:return new Phaser.GameObjects.Image(this.game,(null===e||void 0===e||null===(i=e.config)||void 0===i?void 0:i.centreX)||0,(null===e||void 0===e||null===(a=e.config)||void 0===a?void 0:a.centreY)||0,t)}}displayAnimation(e,t,n){var s;const i=Ii.getInstance().getAssetByKey(e.path);switch(i&&i.config&&(i.config.start=t,i.config.frameRate=n),null===(s=i.config)||void 0===s?void 0:s.animType){case Vs.Object:const t=Ii.getInstance().getCurrLocId();Ii.getInstance().addItem(Mi.objects,t,e.key);break;case Vs.Background:Ii.getInstance().renderBackgroundLayerContainer(e.key)}}createAnimation(e,t,n){if(this.isSprite(e)){var s,i,a;this.removeAnimation(e);const r=new Phaser.GameObjects.Sprite(this.game,(null===(s=e.config)||void 0===s?void 0:s.centreX)||0,(null===(i=e.config)||void 0===i?void 0:i.centreY)||0,e.path),o={key:e.path,frames:this.game.anims.generateFrameNumbers(e.path,{start:t,end:(null===(a=e.config)||void 0===a?void 0:a.endFrame)||0,first:0}),frameRate:n,repeat:-1};this.game.anims.create(o),this.animationInstanceMap.set(e.key,r)}}startAnimation(e){if(this.isSprite(e)){const t=this.getAnimation(e);t.play(e.path,!1),this.game.add.existing(t)}}stopAnimation(e){const t=this.animationInstanceMap.get(e.key);this.isSprite(e)&&t&&t.anims&&t.anims.stop()}removeAnimation(e){const t=this.animationInstanceMap.get(e.key);t&&(this.game.anims.remove(e.path),t.destroy(),this.animationInstanceMap.delete(e.key))}getAnimation(e){return ei(this.animationInstanceMap.get(e.key),`Image: ${e.path} not found`)}}function Gi(e,t,n){const s=e.displayHeight/e.displayWidth;t?(e.displayWidth=t,e.displayHeight=n||t*s):(e.displayWidth=n/s,e.displayHeight=n)}function Fi(e,t,n){e.displayWidth>e.displayHeight?Gi(e,0,n):Gi(e,t)}function Hi(e,t,n){e.displayWidth>e.displayHeight?Gi(e,t):Gi(e,0,n)}var Vi=class{constructor(e,t){this.scene=void 0,this.awardsGetter=void 0,this.uiContainer=void 0,this.previewContainer=void 0,this.itemsContainer=void 0,this.activePageNumber=void 0,this.scene=e,this.awardsGetter=t,this.activePageNumber=0}createUIContainer(){const e=new Phaser.GameObjects.Container(this.scene,0,0);this.uiContainer=e;const t=Si(this.scene,{assetKey:Ws.arrow.key,onUp:()=>this.nextPage(!1)}).setScale(Us.arrow.yScale,Us.arrow.yScale).setRotation(-90*Math.PI/180).setPosition(Us.arrow.x-Us.arrow.xOffset,Us.arrow.y),n=Si(this.scene,{assetKey:Ws.arrow.key,onUp:()=>this.nextPage(!0)}).setScale(Us.arrow.xScale,Us.arrow.yScale).setRotation(90*Math.PI/180).setPosition(Us.arrow.x+Us.arrow.xOffset,Us.arrow.y);e.add([t,n]);const s=new Phaser.GameObjects.Sprite(this.scene,Us.preview.rect.x,Us.preview.rect.y,Ws.popUpFrame.key).setScale(1.2);return e.add(s),e.add(function(e){const t=new Phaser.GameObjects.Container(e,Us.preview.rect.xOffset,Us.preview.rect.yOffset),n=Us.preview.key,s=new Phaser.GameObjects.Rectangle(e,n.x,n.y,n.width,n.height,Os.lightBlue,.1),i=new Phaser.GameObjects.Rectangle(e,n.x-n.width*s.originX*.75,n.y,n.width/4,n.height,Os.lightBlue,.2),a=_s(e,"asset key",Us.preview.keyTagTextConfig,Ps),r=new As(e,Us.preview.explanation.x,Us.preview.explanation.y,"Asset key can be used to include the asset into your room by using 'create_award' function.");return i.setInteractive(),i.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OVER,(()=>r.setVisible(!0))),i.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(()=>r.setVisible(!1))),t.add([s,i,a,r]),t}(this.scene)),this.setPage(),e}setPage(){this.uiContainer&&(this.itemsContainer&&this.itemsContainer.destroy(),this.itemsContainer=this.createItemsContainer(),this.uiContainer.add(this.itemsContainer),this.setPreview())}setPreview(e){if(this.uiContainer){if(this.previewContainer&&this.previewContainer.destroy(),!e)return;let t;if(this.previewContainer=new Phaser.GameObjects.Container(this.scene,Us.preview.rect.xOffset,Us.preview.rect.yOffset),e.assetKey===vs.nullInteractionId)t=_s(this.scene,"No preview available",Us.noPreviewTextConfig,Ps);else{const n=Us.preview.rect;t=new Phaser.GameObjects.Sprite(this.scene,0,0,e.assetKey),Hi(t,n.dim,n.dim),t.setPosition(n.x,n.y)}const n=_s(this.scene,e.title,Us.preview.titleTextConfig,Ns),s=new Phaser.GameObjects.Text(this.scene,Us.preview.rect.x,Us.preview.rect.y+Us.preview.descText.yOffset,e.description,Rs).setOrigin(.5,0),i=!1===e.completed?"":e.assetKey,a=_s(this.scene,i,Us.preview.keyTextConfig,Ps),r=new Phaser.GameObjects.Rectangle(this.scene,Us.preview.rect.x,Us.preview.rect.y,Us.preview.rect.dim,Us.preview.rect.dim,0).setAlpha(e.completed?0:.8);this.previewContainer.add([t,r,n,s,a]),this.uiContainer.add(this.previewContainer)}}nextPage(e){const t=this.activePageNumber,n=Js(e?t+1:t-1,0,Number.MAX_SAFE_INTEGER);this.getItems(n).length>0&&(this.activePageNumber=n,this.setPage())}createItemsContainer(){const e=new Phaser.GameObjects.Container(this.scene,0,0),t=this.getItems(this.activePageNumber),n=Es({numOfItems:t.length,xSpacing:0,ySpacing:Us.list.ySpace});return e.add(t.map(((e,t)=>this.createItemButton(e.title,n[t][0],n[t][1]+Us.list.yStart,(()=>this.setPreview(e)),!1!==e.completed)))),e}createItemButton(e,t,n,s,i){const a=Si(this.scene,{assetKey:Ws.awardsBanner.key,message:e,textConfig:Us.listTextConfig,bitMapTextStyle:Is,onUp:s,onHoverEffect:i}).setPosition(t,n);return i||a.setAlpha(.5),a}getItems(e){const t=this.awardsGetter(),n=Gs(t),s=e*Us.itemsPerPage;return n.slice(s,s+Us.itemsPerPage)}};class Wi{constructor(){this.currentBackground=void 0}renderBackgroundLayerContainer(e){const t=Ii.getInstance().getLocationAtId(e).assetKey;this.renderBackgroundImage(t)}renderBackgroundImage(e){Ii.getInstance().clearSeveralLayers([zs.Background]),this.currentBackground=Ii.getInstance().getAssetByKey(e);const t=Ii.getInstance().getGameManager().getAnimationManager();let n;this.currentBackground&&(n=t.createImage(this.currentBackground,e),t.startAnimation(this.currentBackground),Fi(n,ys.x,ys.y),Ii.getInstance().addToLayer(zs.Background,n),Ii.getInstance().fadeInLayer(zs.Background))}}var $i=class{constructor(){this.bboxes=void 0,this.bboxes=new Map,Ii.getInstance().watchGameItemType(Mi.boundingBoxes,this)}renderBBoxLayerContainer(e){Ii.getInstance().clearSeveralLayers([zs.BBox]);const t=Ii.getInstance().getGameItemsInLocation(Mi.boundingBoxes,e);this.bboxes.clear(),t.map((e=>this.handleAdd(e)))}createBBox(e){const t=Ii.getInstance().getGameManager(),{x:n,y:s,width:i,height:a,actionIds:r,interactionId:o}=e,c=new Phaser.GameObjects.Rectangle(t,n,s,i,a,0,0);return e.isInteractive&&c.setInteractive(),{sprite:c,clickArea:c,actionIds:r,interactionId:o}}handleAdd(e){const t=Ii.getInstance().getBBoxById(e),n=this.createBBox(t);return Ii.getInstance().addToLayer(zs.BBox,n.sprite),this.bboxes.set(e,n),!0}handleMutate(e){return this.handleDelete(e)&&this.handleAdd(e)}handleDelete(e){const t=this.bboxes.get(e);return!!t&&(this.bboxes.delete(e),t.sprite.destroy(),!0)}getActivatables(){return Array.from(this.bboxes.values())}};var Xi={charWidth:600,charRect:{x:{Left:350,Middle:js.x,Right:ys.x-350}}};class qi{constructor(){this.characterSpriteMap=void 0,this.characterSpriteMap=new Map,Ii.getInstance().watchGameItemType(Mi.characters,this)}renderCharacterLayerContainer(e){const t=Ii.getInstance().getGameItemsInLocation(Mi.characters,e);this.characterSpriteMap.clear(),t.map((e=>this.handleAdd(e)))}createCharacterSprite(e,t,n){const s=Ii.getInstance().getCharacterById(e),{defaultPosition:i,defaultExpression:a,expressions:r,scale:o}=s,c=Xi.charRect.x[n||i],l=r.get(t||a),d=new Phaser.GameObjects.Image(Ii.getInstance().getGameManager(),c,ys.y,l).setOrigin(.5,1);return Gi(d,Xi.charWidth*o),d}handleAdd(e){const t=this.createCharacterSprite(e);return Ii.getInstance().addToLayer(zs.Character,t),this.characterSpriteMap.set(e,t),!0}handleMutate(e){return this.handleDelete(e)&&this.handleAdd(e)}handleDelete(e){const t=this.characterSpriteMap.get(e);return!!t&&(this.characterSpriteMap.delete(e),t.destroy(),!0)}}const zi={key:fs.alienLeagueFont.key,size:35,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT};var Yi={backButton:{y:.3*ys.y},page:{yStart:.3*-ys.y,ySpace:150},pageTextConfig:{x:.3*ys.x,y:0,oriX:.1,oriY:.5},pageArea:{x:-869,y:-412,width:.72*ys.x,height:.77*ys.y}};let Ki;!function(e){e.Log="Log",e.Tasks="Tasks",e.Collectibles="Collectibles",e.Achievements="Achievements"}(Ki||(Ki={}));var Qi=class{constructor(e,t,n){this.scene=void 0,this.pages=void 0,this.pageManagers=void 0,this.pageMask=void 0,this.uiContainer=void 0,this.pageChosenContainer=void 0,this.pageUIContainers=void 0,this.currPageIndex=void 0,this.getSoundManager=()=>zo.getInstance().getSoundManager(),this.scene=e,this.pages=t,this.pageManagers=n,this.pageMask=this.createPageMask(),this.pageUIContainers=new Array(t.length),this.currPageIndex=0,this.scene.getPhaseManager().addPhaseToMap(ki.Dashboard,this)}createPageMask(){const e=new Phaser.GameObjects.Graphics(this.scene),{x:t,y:n,width:s,height:i}=Yi.pageArea;return e.fillRect(t,n,s,i),e.createGeometryMask()}setPage(e){if(this.uiContainer){this.pageChosenContainer&&this.pageChosenContainer.destroy();const t=this.pageUIContainers[this.currPageIndex];t&&t.setVisible(!1),this.currPageIndex=e;let n=this.pageUIContainers[this.currPageIndex];n?n.setVisible(!0):(n=this.pageManagers[this.currPageIndex].createUIContainer(),n.setMask(this.pageMask),this.pageUIContainers[this.currPageIndex]=n,this.uiContainer.add(n));const s=this.getPageOptPositions(),i=this.currPageIndex,a=new Phaser.GameObjects.Sprite(this.scene,s[i][0],s[i][1]+Yi.page.yStart,Ws.awardsPageChosen.key);this.pageChosenContainer=new Phaser.GameObjects.Container(this.scene,0,0,[a]),this.uiContainer.add(this.pageChosenContainer)}}createUIContainer(){const e=new Phaser.GameObjects.Container(this.scene,0,0),t=new Phaser.GameObjects.Rectangle(this.scene,0,0,ys.x,4*ys.y,0).setAlpha(.7).setInteractive(),n=new Phaser.GameObjects.Image(this.scene,0,0,Ws.awardsMenu.key);e.add([t,n]);const s=this.pages.map(((e,t)=>({text:e,callback:()=>this.setPage(t)}))),i=this.getPageOptPositions();e.add(s.map(((e,t)=>this.createPageOpt(e.text,i[t][0],i[t][1]+Yi.page.yStart,e.callback))));const a=this.createPageOpt("Back",0,Yi.backButton.y,(async()=>{this.scene.getPhaseManager().isCurrentPhase(ki.Dashboard)&&await this.scene.getPhaseManager().popPhase()}));return e.add(a),e}getPageOptPositions(){return Es({numOfItems:Object.keys(Ki).length,xSpacing:0,ySpacing:Yi.page.ySpace})}createPageOpt(e,t,n,s){return Si(this.scene,{assetKey:Ws.awardsPage.key,message:e,textConfig:Yi.pageTextConfig,bitMapTextStyle:zi,onUp:s}).setPosition(t,n)}async activateUI(){this.uiContainer=this.createUIContainer(),this.scene.getLayerManager().addToLayer(zs.Dashboard,this.uiContainer),this.getSoundManager().playSound(qs.menuEnter.key),this.setPage(this.currPageIndex),this.uiContainer.setPosition(js.x,-ys.y),this.pageMask.geometryMask.setPosition(js.x,-ys.y),this.scene.tweens.add({targets:[this.uiContainer,this.pageMask.geometryMask],...ci,y:js.y})}async deactivateUI(){this.uiContainer&&(this.pageUIContainers=new Array(this.pages.length),this.uiContainer.setPosition(this.uiContainer.x,this.uiContainer.y),this.getSoundManager().playSound(qs.menuExit.key),this.scene.tweens.add({targets:[this.uiContainer,this.pageMask.geometryMask],...li}),await Qs(li.duration),ai(this.scene,this.uiContainer,{fadeDuration:50}))}};class Ji{constructor(e){this.currPart=void 0,this.currLineNum=void 0,this.dialogueContent=void 0,this.dialogueContent=e,this.currPart=e.keys().next().value,this.currLineNum=0}async generateNextLine(){const e=this.dialogueContent.get(this.currPart)[this.currLineNum];if(!e||!e.line)return{line:""};if(e.goto){let t=e.goto.part;if(await Li.checkAllConditionsSatisfied(e.goto.conditions)||(t=e.goto.altPart),t){if(!this.dialogueContent.get(t))return{line:""};this.currPart=t,this.currLineNum=0}else this.currLineNum++}else this.currLineNum++;return e}updateCurrPart(e){this.currPart=e,this.currLineNum=0}}let Zi,ea;!function(e){e.Left="Left",e.Middle="Middle",e.Right="Right"}(Zi||(Zi={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(ea||(ea={}));class ta{static splitToParagraph(e){const t=[];return e.forEach((e=>{if(e.startsWith("\t")||e.startsWith("    ")){const n=e.startsWith("\t")?e.slice(1):e.slice(4);if(0===t.length)return void console.error("Unexpected tabs");t[t.length-1][1].push(n)}else t.push([e.trim(),[]])})),t}static mapByHeader(e,t){const n=new Map;if(!t(e[0]))return n.set("0",e),n;let s="";return e.forEach((e=>{if(t(e))return s=e,void n.set(e,[]);n.get(s).push(e)})),n}static splitWithLimit(e,t,n){if(n>=0){const s=e.split(t),i=s.slice(0,n);return i.push(s.slice(n).join(t)),i.map((e=>e.trim()))}return ta.splitByChar(e,t)}static splitByChar(e,t){return e.split(t).map((e=>e.trim()))}static splitToLines(e){return e.split("\n").map((e=>e.trimRight())).filter((e=>""!==e))}static splitToLinesAndRemoveComments(e){return this.removeMultiLineComments(e.split("\n"),"/*","*/").map((e=>this.removeSingleLineComment(e,"//"))).map((e=>e.trimRight())).filter((e=>""!==e))}static removeSingleLineComment(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s=e.indexOf(t);return-1===s?e:n?e.slice(0,s):e.slice(s+t.length)}static removeMultiLineComments(e,t,n){const s=[];let i=!1;for(let a=0;a<e.length;a++){const r=e[a],o=[],c=this.findAllInstances(r,t),l=this.findAllInstances(r,n);let d=-1,u=0,h=0,p=i?[0]:[];for(;u<c.length||h<l.length;){const e=d;d=i?l[h++]+n.length:c[u++],d<=e?(console.error(`Comment mismatch: Line ${a+1},  Pos ${d+1}`),d=e):(p.push(d),i=!i),2===p.length&&(o.push([p[0],p[1]]),p=[])}1===p.length&&o.push([p[0],r.length]),s.push(this.removeCommentRegions(r,o))}return s}static removeCommentRegions(e,t){let n="",s=0;return t.forEach((t=>{n+=e.slice(s,t[0]),s=t[1]})),n+=e.slice(s,e.length),n}static findAllInstances(e,t){const n=[];let s=e.indexOf(t);for(;-1!==s;)n.push(s),s=e.indexOf(t,s+1);return n}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static toCapitalizedWords(e){return(e.match(/[A-Za-z][a-z]*/g)||[]).map(ta.capitalize).join(" ")}static toIntString(e){return Math.floor(e).toString()}static isEmptyString(e){return e===vs.nullInteractionId}}class na{constructor(){this.currentSpeakerId=void 0,this.getUsername=()=>zo.getInstance().getAccountInfo().name}changeSpeakerTo(e){void 0!==e&&(this.currentSpeakerId&&Ii.getInstance().clearSeveralLayers([zs.Speaker,zs.SpeakerBox]),this.showNewSpeaker(e))}showNewSpeaker(e){e&&(this.drawSpeakerSprite(e),this.drawSpeakerBox(e.speakerId))}drawSpeakerBox(e){if("narrator"===e)return;const t="you"===e?this.createSpeakerBox(this.getUsername(),Zi.Right):this.createSpeakerBox(Ii.getInstance().getCharacterById(e).name,Zi.Left);Ii.getInstance().addToLayer(zs.SpeakerBox,t)}drawSpeakerSprite(e){let{speakerId:t,speakerPosition:n,expression:s}=e;if(this.currentSpeakerId=t,"you"===t||"narrator"===t)return;const i=Ii.getInstance().createCharacterSprite(t,s,n);Ii.getInstance().addToLayer(zs.Speaker,i)}createSpeakerBox(e,t){const n=Ii.getInstance().getGameManager(),s=new Phaser.GameObjects.Container(n,0,0),i=new Phaser.GameObjects.Image(n,js.x,js.y,Ws.speakerBox.key).setAlpha(.8),a=_s(n,"",vi.speakerTextConfig,fi);return t===Zi.Right&&(i.displayWidth*=-1,a.x=ys.x-a.x),s.add([i,a]),a.text=ta.capitalize(e),s}}class sa{constructor(){this.speakerRenderer=void 0,this.dialogueRenderer=void 0,this.dialogueGenerator=void 0,this.getDialogueGenerator=()=>this.dialogueGenerator,this.getDialogueRenderer=()=>this.dialogueRenderer,this.getSpeakerRenderer=()=>this.speakerRenderer,this.getUsername=()=>zo.getInstance().getAccountInfo().name}async showDialogue(e){const t=Ii.getInstance().getDialogueById(e);this.dialogueRenderer=new ji(bi),this.dialogueGenerator=new Ji(t.content),this.speakerRenderer=new na,Ii.getInstance().addToLayer(zs.Dialogue,this.dialogueRenderer.getDialogueContainer()),Ii.getInstance().fadeInLayer(zs.Dialogue),await new Promise((e=>this.playWholeDialogue(e))),this.getDialogueRenderer().destroy(),this.getSpeakerRenderer().changeSpeakerTo(null)}async playWholeDialogue(e){await this.showNextLine(e),this.getDialogueRenderer().getDialogueBox().on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(async()=>await this.showNextLine(e)))}async showNextLine(e){Ii.getInstance().playSound(qs.dialogueAdvance.key);const{line:t,speakerDetail:n,actionIds:s,prompt:i}=await this.getDialogueGenerator().generateNextLine(),a=t.replace("{name}",this.getUsername());if(this.getDialogueRenderer().changeText(a),this.getSpeakerRenderer().changeSpeakerTo(n),Ii.getInstance().storeDialogueLine(a,n),Ii.getInstance().enableSprite(this.getDialogueRenderer().getDialogueBox(),!1),i){const e=await Ti(Ii.getInstance().getGameManager(),i.promptTitle,i.choices.map((e=>e[0])));this.getDialogueGenerator().updateCurrPart(i.choices[e][1])}await Ii.getInstance().processGameActionsInSamePhase(s),Ii.getInstance().enableSprite(this.getDialogueRenderer().getDialogueBox(),!0),t||e()}}class ia{constructor(){this.dialogueStorage=void 0,this.getUsername=()=>zo.getInstance().getAccountInfo().name}storeLine(e,t){if(!t)return;this.dialogueStorage||(this.dialogueStorage=new Array);const n={speaker:this.getSpeakerName(t),line:e};this.dialogueStorage.push(n)}getSpeakerName(e){const t=null===e||void 0===e?void 0:e.speakerId;return t?"you"===t?this.getUsername():"narrator"===t?"Narrator":Ii.getInstance().getCharacterById(t).name:""}clearDialogueStorage(){this.dialogueStorage=new Array}getDialogueStorage(){return this.dialogueStorage?this.dialogueStorage.map((e=>`${e.speaker}:\n${e.line}`)):new Array}}const aa=js.x-160,ra=js.y,oa=aa+10,ca=ra+10;function la(e){let t,n,s;e.load.on("start",(()=>{s=e.add.existing(ri(e)),t=e.add.graphics(),n=e.add.graphics(),n.fillStyle(2236962,.8),n.fillRect(aa,ra,320,50)})),e.load.on("progress",(e=>{t.clear(),t.fillStyle(16777215,1),t.fillRect(oa,ca,300*e,30)})),e.load.on("complete",(function(){t.destroy(),n.destroy(),s.destroy()}))}class da extends Phaser.GameObjects.Container{constructor(e,t,n,s){let{choices:i,defaultChoiceIdx:a=0,maxXSpace:r=ys.x,radioChoiceConfig:o={circleDim:20,checkedDim:10,outlineThickness:5},choiceTextConfig:c={x:0,y:0,oriX:.5,oriY:.5},bitmapTextStyle:l=vs.defaultFontStyle}=t,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qs.radioButtonClick.key;super(e,n,s),this.buttonClickSoundKey=void 0,this.activeChoice=void 0,this.activeChoiceIdx=void 0,this.choices=void 0,this.buttonPositions=void 0,this.radioChoiceConfig=void 0,this.choiceTextConfig=void 0,this.bitmapTextStyle=void 0,this.activeChoiceIdx=a,this.choices=i,this.choiceTextConfig=c,this.bitmapTextStyle=l,this.radioChoiceConfig=o,this.buttonClickSoundKey=d;const u=this.getRadioButtons(i);this.buttonPositions=ws({numOfItems:u.length,maxXSpace:r}),this.renderRadioButtons(u,this.buttonPositions,this.radioChoiceConfig),this.activate(a)}getRadioButtons(e){return e.map(((e,t)=>({text:e,callback:()=>this.activate(t)})))}renderRadioButtons(e,t,n){this.add(e.map(((e,s)=>this.createRadioButton(t[s][0],t[s][1],e.callback,n))))}createRadioButton(e,t,n,s){return new Phaser.GameObjects.Ellipse(this.scene,e,t,s.circleDim,s.circleDim,Os.lightBlue).setStrokeStyle(s.outlineThickness,Os.darkBlue).setInteractive({useHandCursor:!0}).addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(()=>{zo.getInstance().getSoundManager().playSound(this.buttonClickSoundKey),n()}))}activate(e){this.activeChoiceIdx=e,this.activeChoice&&this.activeChoice.destroy(),this.activeChoice=new Phaser.GameObjects.Container(this.scene,this.buttonPositions[e][0],this.buttonPositions[e][1]);const t=_s(this.scene,this.choices[e],this.choiceTextConfig,this.bitmapTextStyle),n=new Phaser.GameObjects.Ellipse(this.scene,0,0,this.radioChoiceConfig.checkedDim,this.radioChoiceConfig.checkedDim,Os.darkBlue);this.activeChoice.add([t,n]),this.add(this.activeChoice)}getValueIdx(){return this.activeChoiceIdx}getChoices(){return this.choices}getChosenChoice(){return this.activeChoiceIdx<this.choices.length?this.choices[this.activeChoiceIdx]:vs.nullInteractionId}}var ua=da;const ha={key:fs.zektonFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},pa={key:fs.zektonFont.key,size:35,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},ga={key:fs.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var ma={optHeaderTextConfig:{x:.25*ys.x,y:0,oriX:.5,oriY:.75},opt:{x:140,xSpace:.4*ys.x,ySpace:.7*ys.y},radioButtonsTextConfig:{x:0,y:-50,oriX:.5,oriY:.25},volContainerOpts:["0","0.25","0.5","1.0","1.5","2.0"]};const ba={key:fs.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},fa={key:fs.zektonFont.key,size:20,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},va={key:fs.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var ya={button:{y:.15*ys.y},escapeOptTextConfig:{x:0,y:0,oriX:.37,oriY:.75},settings:{yOffset:.1*-js.y,ySpace:.3*ys.y},settingsTextConfig:{x:.38*ys.x,y:.1*-js.y,oriX:0,oriY:.5},radioButtons:{xSpace:.2*ys.x},radioChoiceTextConfig:{x:0,y:-45,oriX:.5,oriY:.25},volOpt:{x:.05*ys.x}};var ja=class{constructor(e){this.bgmVolumeRadioButtons=void 0,this.sfxVolumeRadioButtons=void 0,this.scene=void 0,this.getSoundManager=()=>zo.getInstance().getSoundManager(),this.getSettingsSaveManager=()=>zo.getInstance().getSaveManager(),this.scene=e,this.scene.getPhaseManager().addPhaseToMap(ki.EscapeMenu,this)}createUIContainer(){const e=new Phaser.GameObjects.Container(this.scene,0,0),t=new Phaser.GameObjects.Image(this.scene,js.x,js.y,Ws.escapeMenuBackground.key).setDisplaySize(ys.x,ys.y).setInteractive({pixelPerfect:!0});e.add(t);const n=this.getSettings(),s=ws({direction:Ss.Column,numOfItems:n.length,maxYSpace:ya.settings.ySpace});e.add(n.map(((e,t)=>_s(this.scene,e,{...ya.settingsTextConfig,y:s[t][1]+ya.settingsTextConfig.y},va))));const{bgmVolume:i,sfxVolume:a}=this.getSettingsSaveManager().getSettings(),r=ma.volContainerOpts.findIndex((e=>parseFloat(e)===a)),o=ma.volContainerOpts.findIndex((e=>parseFloat(e)===i));this.sfxVolumeRadioButtons=this.createSettingsRadioOptions(r,s[0][1]),this.bgmVolumeRadioButtons=this.createSettingsRadioOptions(o,s[1][1]),e.add([this.sfxVolumeRadioButtons,this.bgmVolumeRadioButtons]);const c=this.getOptButtons(),l=ws({numOfItems:c.length});return e.add(c.map(((e,t)=>this.createEscapeOptButton(e.text,l[t][0],l[t][1]+ya.button.y,e.callback)))),e}getSettings(){return["SFX","BGM"]}createSettingsRadioOptions(e,t){return new ua(this.scene,{choices:ma.volContainerOpts,defaultChoiceIdx:e,maxXSpace:ya.radioButtons.xSpace,radioChoiceConfig:{circleDim:15,checkedDim:10,outlineThickness:3},choiceTextConfig:ya.radioChoiceTextConfig,bitmapTextStyle:fa},ya.volOpt.x,-js.y+t+ya.settings.yOffset)}getOptButtons(){return[{text:"Main Menu",callback:()=>{this.cleanUp(),zo.getInstance().isGameType(qo.Simulator)?this.scene.scene.start("StorySimulatorMenu"):this.scene.scene.start("MainMenu")}},{text:"Continue",callback:async()=>{this.scene.getPhaseManager().isCurrentPhase(ki.EscapeMenu)&&await this.scene.getPhaseManager().popPhase()}},{text:"Apply Settings",callback:()=>this.applySettings()}]}createEscapeOptButton(e,t,n,s){return Si(this.scene,{assetKey:Ws.mediumButton.key,message:e,textConfig:ya.escapeOptTextConfig,bitMapTextStyle:ba,onUp:s}).setPosition(t,n)}async applySettings(){const e=this.sfxVolumeRadioButtons?parseFloat(this.sfxVolumeRadioButtons.getChosenChoice()):1,t={bgmVolume:this.bgmVolumeRadioButtons?parseFloat(this.bgmVolumeRadioButtons.getChosenChoice()):1,sfxVolume:e};await this.getSettingsSaveManager().saveSettings(t),zo.getInstance().getSoundManager().applyUserSettings(t)}cleanUp(){this.scene.getInputManager().clearListeners(),this.scene.getLayerManager().clearAllLayers()}activateUI(){const e=this.createUIContainer();this.getSoundManager().playSound(qs.menuEnter.key),this.scene.getLayerManager().addToLayer(zs.Escape,e)}deactivateUI(){this.getSoundManager().playSound(qs.menuExit.key),this.scene.getLayerManager().clearSeveralLayers([zs.Escape])}};var xa=class{constructor(e){this.scene=void 0,this.keyboardListeners=void 0,this.eventListeners=void 0,this.keyboardListeners=[],this.eventListeners=[],this.scene=e}setDefaultCursor(e){this.scene.input.setDefaultCursor(e)}enableMouseInput(e){this.scene.input.mouse.enabled=e}enableKeyboardInput(e){this.scene.input.keyboard.enabled=e}registerKeyboardListener(e,t,n){const s=this.scene.input.keyboard.addKey(e).addListener(t,n);this.keyboardListeners.push(s)}registerEventListener(e,t){const n=this.scene.input.addListener(e,t);this.eventListeners.concat(n)}clearListeners(){this.keyboardListeners.forEach((e=>e.removeAllListeners())),this.eventListeners.forEach((e=>e.removeAllListeners()))}};var Oa=class{constructor(e){this.layers=void 0,this.layers=new Map(Ys.map((t=>[t,new Phaser.GameObjects.Container(e,0,0)]))),this.layers.forEach((t=>e.add.existing(t)))}getLayer(e){return this.layers.get(e)}hideLayer(e){const t=this.layers.get(e);t&&t.setVisible(!1)&&t.setAlpha(0)}showLayer(e){const t=this.layers.get(e);t&&t.setVisible(!0)&&t.setAlpha(1)}async fadeInLayer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vs.fadeDuration;const n=Ii.getInstance().getGameManager(),s=this.layers.get(e);s.setVisible(!0),s.setAlpha(0),n.tweens.add(ii([s],t)),await Qs(t)}async fadeOutLayer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vs.fadeDuration;const n=Ii.getInstance().getGameManager(),s=this.layers.get(e);s.setVisible(!0),s.setAlpha(1),n.tweens.add(si([s],t)),await Qs(t)}addToLayer(e,t){const n=this.layers.get(e);n&&n.add(t)}clearSeveralLayers(e){e.forEach((e=>this.clearLayerContents(e)))}clearAllLayers(){this.layers.forEach(((e,t)=>this.clearLayerContents(t)))}clearLayerContents(e){const t=this.layers.get(e);if(t)for(;t.list.length;)t.list[0].destroy()}};const Sa={key:fs.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT},wa=.251*ys.x;var Ca={logTextConfig:{x:-.44*ys.x,y:-.378*ys.y,oriX:0,oriY:0},textMaxWidth:.68*ys.x,logHeight:.7632*ys.y,scrollbarTrack:{x:wa,y:.005*ys.y,width:7,height:.73*ys.y,color:5592405},scrollbarThumb:{x:wa,width:7,color:8947848},scrollSpeed:.5};var Ea=class{constructor(e){this.scene=void 0,this.scene=e}createUIContainer(){const e=new Phaser.GameObjects.Container(this.scene,0,0),t=Ii.getInstance().getDialogueStorage();if(0===t.length)return e;const n=_s(this.scene,t.join("\n\n"),Ca.logTextConfig,Sa).setMaxWidth(Ca.textMaxWidth),s=Ca.logTextConfig.y-Math.max(n.height-Ca.logHeight,0);n.y=s,e.add(n);const i=new Phaser.GameObjects.Rectangle(this.scene,Ca.scrollbarTrack.x,Ca.scrollbarTrack.y,Ca.scrollbarTrack.width,Ca.scrollbarTrack.height,Ca.scrollbarTrack.color),a=Math.max(Ca.logHeight/n.height*Ca.scrollbarTrack.height,4*Ca.scrollbarThumb.width),r=Ca.scrollbarTrack.y+Ca.scrollbarTrack.height/2-a/2,o=(Ca.scrollbarTrack.height-a)/(Ca.logTextConfig.y-s),c=new Phaser.GameObjects.Rectangle(this.scene,Ca.scrollbarThumb.x,r,Ca.scrollbarThumb.width,a,Ca.scrollbarThumb.color);e.add(i),e.add(c),n.height<=Ca.logHeight&&(i.setVisible(!1),c.setVisible(!1));const{x:l,y:d,width:u,height:h}=Yi.pageArea,p=new Phaser.GameObjects.Zone(this.scene,l+u/2,d+h/2,u,h);return p.setInteractive(),p.on("wheel",((e,t,i,a)=>{n.y=Js(n.y-i*Ca.scrollSpeed,s,Ca.logTextConfig.y),c.y=r-(n.y-s)*o})),e.add(p),e}};class Ta{constructor(e,t,n,s,i,a){this.scene=void 0,this.container=void 0,this.imageGlow=void 0,this.clickArea=void 0,this.glowClearer=void 0,this.blinkClearer=void 0,this.scene=e,this.container=new Phaser.GameObjects.Container(e,t,n),this.imageGlow=new Phaser.GameObjects.Image(e,0,0,s).setAlpha(0).setBlendMode(Phaser.BlendModes.ADD),this.clickArea=new Phaser.GameObjects.Image(e,0,0,s).setAlpha(.01).setInteractive({pixelPerfect:!0});const r=Ii.getInstance().getGameMap().getMapAssets().get(s),o=Ii.getInstance().getGameManager().getAnimationManager();if(r){const e=o.createImage(r,s);switch(null===r||void 0===r?void 0:r.type){case Hs.Sprite:this.clickArea.setAlpha(0),o.startAnimation(r);break;case Hs.Image:i&&(Gi(e,i,a),Gi(this.imageGlow,i,a),Gi(this.clickArea,i,a))}this.container.add([e,this.imageGlow,this.clickArea])}}startGlow(){this.glowClearer&&this.glowClearer(),this.glowClearer=oi(this.scene,this.imageGlow),this.imageGlow.setAlpha(1)}clearGlow(){this.glowClearer&&this.glowClearer(),this.imageGlow.setAlpha(0)}startBlink(){this.blinkClearer=oi(this.scene,this.getContainer())}clearBlink(){this.getContainer().setAlpha(1),this.blinkClearer&&this.blinkClearer()}getContainer(){return this.container}getClickArea(){return this.clickArea}}var ka=class{constructor(){this.objects=void 0,this.objects=new Map,Ii.getInstance().watchGameItemType(Mi.objects,this)}renderObjectsLayerContainer(e){Ii.getInstance().clearSeveralLayers([zs.Objects]);const t=Ii.getInstance().getGameItemsInLocation(Mi.objects,e);this.objects.clear(),t.map((e=>this.handleAdd(e)))}makeObjectGlow(e,t){const n=this.objects.get(e);n&&(t?n.sprite.startGlow():n.sprite.clearGlow())}makeObjectBlink(e,t){const n=this.objects.get(e);n&&(t?n.sprite.startBlink():n.sprite.clearBlink())}createObject(e){const t=Ii.getInstance().getGameManager(),{assetKey:n,x:s,y:i,width:a,height:r,actionIds:o,interactionId:c}=e,l=new Ta(t,s,i,n,a,r);return{sprite:l,clickArea:l.getClickArea(),actionIds:o,interactionId:c}}handleAdd(e){const t=Ii.getInstance().getObjectById(e),n=this.createObject(t);return Ii.getInstance().addToLayer(zs.Objects,n.sprite.getContainer()),this.objects.set(e,n),!0}handleMutate(e){return this.handleDelete(e)&&this.handleAdd(e)}handleDelete(e){const t=this.objects.get(e);return!!t&&(this.objects.delete(e),t.sprite.getContainer().destroy(),!0)}getActivatables(){return Array.from(this.objects.values())}};class Aa{constructor(e,t){this.phaseMap=void 0,this.phaseStack=void 0,this.inputManager=void 0,this.interruptCheckCallback=void 0,this.interruptTransitionCallback=void 0,this.transitionCallback=void 0,this.phaseStack=[ki.None],this.phaseMap=e,this.interruptCheckCallback=()=>!1,this.interruptTransitionCallback=async()=>vs.nullFunction(),this.transitionCallback=vs.nullFunction,this.inputManager=t}addPhaseToMap(e,t){this.phaseMap.set(e,t)}setInterruptCheckCallback(e){this.interruptCheckCallback=e}setInterruptCallback(e){this.interruptTransitionCallback=e}setCallback(e){this.transitionCallback=e}async popPhase(){const e=this.phaseStack.pop();await this.executePhaseTransition(e,this.getCurrentPhase())}async pushPhase(e){const t=this.getCurrentPhase();e!==t&&(this.phaseStack.push(e),await this.executePhaseTransition(t,e))}async swapPhase(e){const t=this.getCurrentPhase();e!==t&&(this.phaseStack.pop(),this.phaseStack.push(e),await this.executePhaseTransition(t,e))}async executePhaseTransition(e,t){if(this.inputManager.enableKeyboardInput(!1),this.inputManager.enableMouseInput(!1),await this.phaseMap.get(e).deactivateUI(),this.interruptCheckCallback(e,t))return this.inputManager.enableMouseInput(!0),this.inputManager.enableKeyboardInput(!0),void await this.interruptTransitionCallback(e,t);this.transitionCallback(e,t),await this.phaseMap.get(t).activateUI(),this.inputManager.enableMouseInput(!0),this.inputManager.enableKeyboardInput(!0)}isCurrentPhase(e){return this.getCurrentPhase()===e}isCurrentPhaseTerminal(){return Object.values(Ai).includes(this.getCurrentPhase())}getCurrentPhase(){return this.phaseStack.length||(this.phaseStack=[ki.None]),this.phaseStack[this.phaseStack.length-1]}}var _a={image:{xOffset:20,yOffset:20},rect:{x:{Left:400,Middle:js.x,Right:ys.x-400},y:{Small:325,Medium:350,Large:420},scale:{Small:.7,Medium:1,Large:1.5},width:280,height:280},tweenDuration:300};var Ia=class{constructor(){this.currPopUp=void 0,this.currPopUp=new Map}async displayPopUp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vs.popUpDuration,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ea.Medium;this.destroyPopUp(t);const i=Ii.getInstance().getGameManager(),a=new Phaser.GameObjects.Container(i,0,0),r=new Phaser.GameObjects.Image(i,_a.rect.x[t],_a.rect.y[s],Ws.popUpFrame.key).setScale(_a.rect.scale[s]),o=this.getAssetKey(e);if(!o)return;const c=new Phaser.GameObjects.Image(i,_a.rect.x[t]+_a.image.xOffset,_a.rect.y[s]+_a.image.yOffset,o);Hi(c,_a.rect.width*_a.rect.scale[s],_a.rect.height*_a.rect.scale[s]),a.add([r,c]),this.currPopUp.set(t,a),Ii.getInstance().addToLayer(zs.PopUp,a),Ii.getInstance().playSound(qs.popUpEnter.key),a.setActive(!0),a.setVisible(!0),a.setScale(1,0),i.tweens.add(function(e){return{scaleY:1,targets:e,duration:arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,ease:"Power1"}}([a],_a.tweenDuration)),await Qs(_a.tweenDuration),setTimeout((()=>this.destroyPopUp(t)),n)}destroyAllPopUps(){this.currPopUp.forEach(((e,t,n)=>{this.destroyPopUp(t)}))}async destroyPopUp(e){const t=this.currPopUp.get(e);t&&(Ii.getInstance().getGameManager().tweens.add(function(e){return{scaleY:0,targets:e,duration:arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,ease:"Power1"}}([t],_a.tweenDuration)),await Qs(_a.tweenDuration),t.setVisible(!1),t.setActive(!1),t.destroy(),this.currPopUp.delete(e),Ii.getInstance().playSound(qs.popUpExit.key))}getAssetKey(e){const t=Ii.getInstance().getGameMap().getObjectPropMap().get(e);if(t)return t.assetKey}};const Na=()=>({lastCheckpointPlayed:0,currentLocation:void 0,currentPhase:ki.Menu,chapterNewlyCompleted:!1,incompleteTasks:[],completedTasks:[],completedObjectives:[],triggeredInteractions:[],triggeredStateChangeActions:[]});function Pa(e){return Array.from(e).filter((e=>{let[t,n]=e;return n})).map((e=>{let[t]=e;return t}))}var Ra=class{constructor(e){this.subscribers=void 0,this.gameMap=void 0,this.checkpointObjective=void 0,this.checkpointTask=void 0,this.chapterNewlyCompleted=void 0,this.updatedLocations=void 0,this.triggeredInteractions=void 0,this.triggeredStateChangeActions=void 0,this.getGameMap=()=>this.gameMap,this.getCharacterAtId=e=>ei(this.gameMap.getCharacterMap().get(e)),this.getSaveManager=()=>zo.getInstance().getSaveManager(),this.getChapterNewlyCompleted=()=>this.chapterNewlyCompleted,this.subscribers=new Map,this.gameMap=e.map,this.checkpointObjective=e.objectives,this.checkpointTask=e.tasks,this.chapterNewlyCompleted=!1,this.updatedLocations=new Set(this.gameMap.getLocationIds()),this.triggeredInteractions=new Map,this.triggeredStateChangeActions=[],this.loadStatesFromSaveManager()}loadStatesFromSaveManager(){this.triggeredStateChangeActions=this.getSaveManager().getTriggeredStateChangeActions(),this.getSaveManager().getTriggeredInteractions().forEach((e=>this.triggerInteraction(e))),this.getSaveManager().getCompletedObjectives().forEach((e=>this.checkpointObjective.setObjective(e,!0))),this.getSaveManager().getCompletedTasks().forEach((e=>{this.checkpointTask.setTask(e,!0),this.checkpointTask.showTask(e)})),this.getSaveManager().getIncompleteTasks().forEach((e=>{this.checkpointTask.setTask(e,!1),this.checkpointTask.showTask(e)})),this.chapterNewlyCompleted=this.getSaveManager().getChapterNewlyCompleted()}watchGameItemType(e,t){this.subscribers.set(e,t)}getSubscriberForItemType(e){return this.subscribers.get(e)}triggerInteraction(e){this.triggeredInteractions.set(e,!0)}triggerStateChangeAction(e){this.triggeredStateChangeActions.push(e)}hasTriggeredInteraction(e){return this.triggeredInteractions.get(e)}addLocationNotif(e){this.updatedLocations.add(e)}removeLocationNotif(e){this.updatedLocations.delete(e)}hasLocationNotif(e){return this.updatedLocations.has(e)}isCurrentLocation(e){return e===Ii.getInstance().getCurrLocId()}getLocationModes(e){return Array.from(this.gameMap.getLocationAtId(e).modes)||[]}addLocationMode(e,t){this.gameMap.getLocationAtId(e).modes.add(t),!this.isCurrentLocation(e)&&this.addLocationNotif(e)}removeLocationMode(e,t){this.gameMap.getLocationAtId(e).modes.delete(t),!this.isCurrentLocation(e)&&this.addLocationNotif(e)}getGameItemsInLocation(e,t){return Array.from(this.gameMap.getLocationAtId(t)[e])||[]}addItem(e,t,n){var s,i;null===(s=this.gameMap.getLocationAtId(t)[e])||void 0===s||s.add(n),this.isCurrentLocation(t)?null===(i=this.getSubscriberForItemType(e))||void 0===i||i.handleAdd(n):this.addLocationNotif(t)}removeItem(e,t,n){var s,i;null===(s=this.gameMap.getLocationAtId(t)[e])||void 0===s||s.delete(n),this.isCurrentLocation(t)?null===(i=this.getSubscriberForItemType(e))||void 0===i||i.handleDelete(n):this.addLocationNotif(t)}setObjProperty(e,t){this.gameMap.setItemInMap(Mi.objects,e,t),this.gameMap.getLocations().forEach(((t,n)=>{var s;t.objects.has(e)&&(this.isCurrentLocation(n)?null===(s=this.getSubscriberForItemType(Mi.objects))||void 0===s||s.handleMutate(e):this.addLocationNotif(n))}))}setBBoxProperty(e,t){this.gameMap.setItemInMap(Mi.boundingBoxes,e,t),this.gameMap.getLocations().forEach(((t,n)=>{var s;t.boundingBoxes.has(e)&&(this.isCurrentLocation(n)?null===(s=this.getSubscriberForItemType(Mi.boundingBoxes))||void 0===s||s.handleMutate(e):this.addLocationNotif(n))}))}moveCharacter(e,t,n){this.getCharacterAtId(e).defaultPosition=n,this.gameMap.getLocations().forEach(((t,n)=>{t.characters.has(e)&&this.removeItem(Mi.characters,n,e)})),this.addItem(Mi.characters,t,e)}updateCharacter(e,t){this.getCharacterAtId(e).defaultExpression=t,this.gameMap.getLocations().forEach(((t,n)=>{var s;t.characters.has(e)&&(this.isCurrentLocation(n)?null===(s=this.getSubscriberForItemType(Mi.characters))||void 0===s||s.handleMutate(e):this.addLocationNotif(n))}))}areAllObjectivesComplete(){return this.checkpointObjective.isAllComplete()}isObjectiveComplete(e){return this.checkpointObjective.getObjectiveState(e)}areObjectivesComplete(e){let t=!0;return e.forEach((e=>t=t&&this.isObjectiveComplete(e))),t}completeObjective(e){this.checkpointObjective.setObjective(e,!0)}isTaskComplete(e){return this.checkpointTask.getTaskState(e)}areTasksComplete(e){let t=!0;return e.forEach((e=>t=t&&this.isTaskComplete(e))),t}completeTask(e){this.checkpointTask.setTask(e,!0)}showTask(e){this.checkpointTask.showTask(e)}getAllVisibleTaskData(){return this.checkpointTask.getAllVisibleTaskData()}getCompletedObjectives(){return Pa(this.checkpointObjective.getObjectives())}getCompletedTasks(){return Pa(this.checkpointTask.getAllTasks())}getIncompleteTasks(){return this.checkpointTask.getAllIncompleteTasks()}getTriggeredInteractions(){return Pa(this.triggeredInteractions)}getTriggeredStateChangeActions(){return this.triggeredStateChangeActions}};const Ma={key:fs.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT},La=.251*ys.x;var Da={taskTextConfig:{x:-.42*ys.x,y:-.378*ys.y,oriX:0,oriY:0},textMaxWidth:.66*ys.x,checkMark:{x:-.202*ys.x,y:-.369*ys.y,imageUrl:Ws.talkOptCheck.key},logHeight:.7632*ys.y,scrollbarTrack:{x:La,y:.005*ys.y,width:7,height:.73*ys.y,color:5592405},scrollbarThumb:{x:La,width:7,color:8947848},scrollSpeed:.5};var Ba=class{constructor(e){this.scene=void 0,this.scene=e}createUIContainer(){const e=new Phaser.GameObjects.Container(this.scene,0,0),t=Ii.getInstance().getAllVisibleTaskData(),n=new Phaser.GameObjects.Container(this.scene,0,0);let s=0;if(0===t.length){const e=_s(this.scene,"No tasks available.",Da.taskTextConfig,Ma).setMaxWidth(Da.textMaxWidth);n.add(e),s=e.height}else for(let m=0;m<t.length;m++){const e=t[m][0];if(t[m][1]){const e=new Phaser.GameObjects.Image(this.scene,Da.checkMark.x,Da.checkMark.y+s,Da.checkMark.imageUrl);n.add(e)}const i=_s(this.scene,e.title,{...Da.taskTextConfig,y:Da.taskTextConfig.y+s},Ma).setMaxWidth(Da.textMaxWidth),a=_s(this.scene,"_",{...Da.taskTextConfig,y:Da.taskTextConfig.y+s},Ma);a.setScale(i.width/a.width,1),n.add(i),n.add(a),s+=i.height;const r=_s(this.scene,e.description+(m<t.length-1?"\n ":""),{...Da.taskTextConfig,y:Da.taskTextConfig.y+s},Ma).setMaxWidth(Da.textMaxWidth);n.add(r),s+=r.height}const i=-Math.max(s-Da.logHeight,0);n.y=i,e.add(n);const a=new Phaser.GameObjects.Rectangle(this.scene,Da.scrollbarTrack.x,Da.scrollbarTrack.y,Da.scrollbarTrack.width,Da.scrollbarTrack.height,Da.scrollbarTrack.color),r=Math.max(Da.logHeight/s*Da.scrollbarTrack.height,4*Da.scrollbarThumb.width),o=Da.scrollbarTrack.y+Da.scrollbarTrack.height/2-r/2,c=(Da.scrollbarTrack.height-r)/-i,l=new Phaser.GameObjects.Rectangle(this.scene,Da.scrollbarThumb.x,o,Da.scrollbarThumb.width,r,Da.scrollbarThumb.color);e.add(a),e.add(l),s<=Da.logHeight&&(a.setVisible(!1),l.setVisible(!1));const{x:d,y:u,width:h,height:p}=Yi.pageArea,g=new Phaser.GameObjects.Zone(this.scene,d+h/2,u+p/2,h,p);return g.setInteractive(),g.on("wheel",((e,t,s,a)=>{n.y=Js(n.y-s*Da.scrollSpeed,i,0),l.y=o-(n.y-i)*c})),e.add(g),e}};const Ua=[{assetKey:Ws.gear.key,onUp:e=>async()=>{const t=e.getPhaseManager();t.isCurrentPhase(ki.EscapeMenu)?await t.popPhase():t.isCurrentPhaseTerminal()?await t.swapPhase(ki.EscapeMenu):await t.pushPhase(ki.EscapeMenu)}},{assetKey:Ws.journal.key,onUp:e=>async()=>{const t=e.getPhaseManager();t.isCurrentPhase(ki.Dashboard)?await t.popPhase():t.isCurrentPhaseTerminal()?await t.swapPhase(ki.Dashboard):await t.pushPhase(ki.Dashboard)}}];var Ga={firstButton:{x:ys.x-37,y:37},xOffset:64,buttonConfigs:Ua};var Fa=class{constructor(e){this.uiContainer=void 0,this.scene=void 0,this.scene=e}createUIContainer(){const e=new Phaser.GameObjects.Container(this.scene,0,0);return e.add(Ga.buttonConfigs.map(((e,t)=>this.createToolbarButton(Ga.firstButton.x-Ga.xOffset*t,Ga.firstButton.y,e)))),e}createToolbarButton(e,t,n){return Si(this.scene,{assetKey:n.assetKey,onUp:n.onUp(this.scene)}).setPosition(e,t)}async renderToolbarContainer(){this.uiContainer=this.createUIContainer(),this.scene.getLayerManager().addToLayer(zs.UI,this.uiContainer)}};const Ha=.975*-js.y,Va={key:fs.zektonDarkFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};class Wa extends Phaser.GameObjects.Container{constructor(e,t){super(e,0,0),this.renderBackButton(t)}renderBackButton(e){const t=Si(this.scene,{assetKey:Ws.topButton.key,message:"Back",textConfig:{x:0,y:Ha,oriX:.5,oriY:.25},bitMapTextStyle:Va,onUp:e}).setPosition(js.x,js.y);this.add(t)}}var $a=Wa;var Xa={normal:`url(${Zs("/ui/magnifying.png",!1)}), pointer`,hover:`url(${Zs("/ui/magnifying_trigg.png",!1)}), pointer`,checked:`url(${Zs("/ui/magnifying_check.png",!1)}), pointer`};var qa=class{constructor(){this.uiContainer=void 0}createUIContainer(){const e=Ii.getInstance().getGameManager(),t=new Phaser.GameObjects.Container(e,0,0),n=new $a(e,(async()=>await Ii.getInstance().swapPhase(ki.Menu)));return t.add(n),t}async activateUI(){const e=Ii.getInstance().getGameManager();this.uiContainer=this.createUIContainer(),Ii.getInstance().addToLayer(zs.UI,this.uiContainer),this.uiContainer.setPosition(this.uiContainer.x,-ys.y),this.enableInteractions(),e.tweens.add({targets:this.uiContainer,...ci}),Ii.getInstance().setDefaultCursor(Xa.normal),Ii.getInstance().playSound(qs.modeEnter.key)}async deactivateUI(){const e=Ii.getInstance().getGameManager();Ii.getInstance().setDefaultCursor(vs.defaultCursor),this.disableInteractions(),this.uiContainer&&(this.uiContainer.setPosition(this.uiContainer.x,0),e.tweens.add({targets:this.uiContainer,...li}),await Qs(500),ai(e,this.uiContainer))}enableInteractions(){Ii.getInstance().getAllActivatables().forEach((e=>{e.actionIds&&e.actionIds.length&&(e.clickArea.on("pointerout",(()=>this.explorePointerOut())),e.clickArea.on("pointerover",(()=>this.explorePointerOver(e.interactionId))),e.clickArea.on("pointerup",(async()=>{this.explorePointerUp(e.interactionId),await Ii.getInstance().processGameActions(e.actionIds)})))}))}disableInteractions(){Ii.getInstance().getAllActivatables().forEach((e=>{e.clickArea.off("pointerout"),e.clickArea.off("pointerover"),e.clickArea.off("pointerup")}))}explorePointerOver(e){Ii.getInstance().hasTriggeredInteraction(e)?Ii.getInstance().setDefaultCursor(Xa.checked):Ii.getInstance().setDefaultCursor(Xa.hover)}explorePointerOut(){Ii.getInstance().setDefaultCursor(Xa.normal)}explorePointerUp(e){Ii.getInstance().setDefaultCursor(vs.defaultCursor),Ii.getInstance().triggerInteraction(e),Ii.getInstance().setDefaultCursor(Xa.normal)}};let za;!function(e){e.Move="Move",e.Explore="Explore",e.Talk="Talk",e.Menu="Menu"}(za||(za={}));const Ya={Move:ki.Move,Explore:ki.Explore,Talk:ki.Talk,Menu:ki.Menu},Ka={key:fs.zektonFont.key,size:45,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var Qa={button:{yOffset:.3*ys.y},entryTweenProps:{y:0,duration:500,ease:"Power2"},exitTweenProps:{y:.4*ys.y,duration:300,ease:"Power2"}};var Ja=class{constructor(){this.uiContainer=void 0}getLatestLocationModes(){const e=Ii.getInstance().getCurrLocId();let t=Ii.getInstance().getLocationModes(e);return 0===Ii.getInstance().getGameItemsInLocation(Mi.talkTopics,e).length&&(t=t.filter((e=>e!==za.Talk))),t}createUIContainer(){const e=Ii.getInstance().getGameManager(),t=new Phaser.GameObjects.Container(e,0,0),n=new Phaser.GameObjects.Image(e,js.x,js.y,Ws.modeMenuBanner.key);t.add(n);const s=this.getLatestLocationModes(),i=this.getModeButtons(s),a=ws({numOfItems:i.length});return t.add(i.map(((e,t)=>this.createModeButton(e.text,a[t][0],a[t][1]+Qa.button.yOffset,e.callback)))),t}getModeButtons(e){return e.sort().map((e=>({text:e,callback:async()=>await Ii.getInstance().swapPhase(Ya[e])})))}createModeButton(e,t,n,s){return Si(Ii.getInstance().getGameManager(),{assetKey:Ws.shortButton.key,message:e,textConfig:{x:0,y:0,oriX:.5,oriY:.25},bitMapTextStyle:Ka,onUp:s}).setPosition(t,n)}async activateUI(){const e=Ii.getInstance().getGameManager();this.uiContainer=this.createUIContainer(),Ii.getInstance().addToLayer(zs.UI,this.uiContainer),this.uiContainer.setPosition(this.uiContainer.x,ys.y),e.tweens.add({targets:this.uiContainer,...Qa.entryTweenProps}),await Qs(500),Ii.getInstance().playSound(qs.modeEnter.key)}async deactivateUI(){const e=Ii.getInstance().getGameManager();this.uiContainer&&(this.uiContainer.setPosition(this.uiContainer.x,0),e.tweens.add({targets:this.uiContainer,...Qa.exitTweenProps}),await Qs(500),ai(e,this.uiContainer))}};const Za={key:fs.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var er={button:{xOffSet:.25*ys.x,ySpace:.8*ys.y},preview:{rect:{x:.3125*ys.x,y:.515*ys.y,width:.473*ys.x,height:.56*ys.y},frame:{x:.3*ys.x}}};var tr=class{constructor(){this.uiContainer=void 0}setPreview(e,t){e.setTexture(t).setDisplaySize(er.preview.rect.width,er.preview.rect.height).setPosition(er.preview.rect.x,er.preview.rect.y)}getLatestNavigations(){return Ii.getInstance().getGameItemsInLocation(Mi.navigation,Ii.getInstance().getCurrLocId())}createUIContainer(){const e=Ii.getInstance().getGameManager(),t=new Phaser.GameObjects.Container(e,0,0),n=new Phaser.GameObjects.Sprite(e,er.preview.frame.x,js.y,Ws.locationPreviewFrame.key),s=new Phaser.GameObjects.Sprite(e,js.x,js.y,Ws.locationPreviewFill.key);t.add([n,s]);const i=this.getLatestNavigations(),a=this.getMoveButtons(i,s),r=ws({numOfItems:a.length,numItemLimit:1,maxYSpace:er.button.ySpace});t.add(a.map(((e,t)=>this.createMoveButton(e.text,r[t][0]+er.button.xOffSet,r[t][1],e.callback,e.onHover,e.onOut))));const o=new $a(e,(async()=>await Ii.getInstance().swapPhase(ki.Menu)));return t.add(o),this.setPreview(s,Ws.defaultLocationImg.key),t}getMoveButtons(e,t){const n=e=>this.setPreview(t,e),s=()=>this.setPreview(t,Ws.defaultLocationImg.key);return e.map((e=>{const t=Ii.getInstance().getLocationAtId(e);return{text:t.name,callback:async()=>{await Ii.getInstance().swapPhase(ki.Sequence),await Ii.getInstance().changeLocationTo(e)},onHover:()=>n(t.previewKey||t.assetKey),onOut:()=>s()}}))}createMoveButton(e,t,n,s,i,a){return Si(Ii.getInstance().getGameManager(),{assetKey:Ws.longButton.key,message:e,textConfig:{x:0,y:0,oriX:.4,oriY:.15},bitMapTextStyle:Za,onUp:s,onHover:i,onOut:a}).setPosition(t,n)}async activateUI(){const e=Ii.getInstance().getGameManager();this.uiContainer=this.createUIContainer(),Ii.getInstance().addToLayer(zs.UI,this.uiContainer),this.uiContainer.setPosition(this.uiContainer.x,-ys.y),e.tweens.add({targets:this.uiContainer,...ci}),Ii.getInstance().playSound(qs.modeEnter.key)}async deactivateUI(){const e=Ii.getInstance().getGameManager();this.uiContainer&&(this.uiContainer.setPosition(this.uiContainer.x,0),e.tweens.add({targets:this.uiContainer,...li}),await Qs(500),ai(e,this.uiContainer))}};var nr=class{activateUI(){}deactivateUI(){}};const sr={key:fs.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var ir={button:{ySpace:.7*ys.y}};var ar=class{constructor(){this.uiContainer=void 0}getLatestTalkTopics(){return Ii.getInstance().getGameItemsInLocation(Mi.talkTopics,Ii.getInstance().getCurrLocId())}createUIContainer(){const e=Ii.getInstance().getGameManager(),t=new Phaser.GameObjects.Container(e,0,0),n=this.getLatestTalkTopics(),s=this.getTalkTopicButtons(n),i=ws({direction:Ss.Column,numOfItems:s.length,maxYSpace:ir.button.ySpace});t.add(s.map(((e,t)=>this.createTalkTopicButton(e.text,i[t][0],i[t][1],e.callback)))),s.forEach(((n,s)=>{const a=new Phaser.GameObjects.Sprite(e,i[s][0],i[s][1],Ws.talkOptCheck.key);!!n.interactionId&&Ii.getInstance().hasTriggeredInteraction(n.interactionId)&&t.add(a)}));const a=new $a(e,(async()=>await Ii.getInstance().swapPhase(ki.Menu)));return t.add(a),t}getTalkTopicButtons(e){return e.map((e=>({text:ei(Ii.getInstance().getDialogueById(e)).title,callback:async()=>{Ii.getInstance().triggerInteraction(e),await Ii.getInstance().showDialogue(e)},interactionId:e})))}createTalkTopicButton(e,t,n,s){return Si(Ii.getInstance().getGameManager(),{assetKey:Ws.talkOptButton.key,message:e,textConfig:{x:0,y:0,oriX:.5,oriY:.2},bitMapTextStyle:sr,onUp:s}).setPosition(t,n)}async activateUI(){const e=Ii.getInstance().getGameManager();this.uiContainer=this.createUIContainer(),Ii.getInstance().addToLayer(zs.UI,this.uiContainer),this.uiContainer.setPosition(this.uiContainer.x,-ys.y),e.tweens.add({targets:this.uiContainer,...ci}),Ii.getInstance().playSound(qs.modeEnter.key)}async deactivateUI(){const e=Ii.getInstance().getGameManager();this.uiContainer&&(this.uiContainer.setPosition(this.uiContainer.x,0),e.tweens.add({targets:this.uiContainer,...li}),await Qs(500),ai(e,this.uiContainer))}};class rr extends Phaser.Scene{constructor(){super("GameManager"),this.currentLocationId=void 0,this.hasTransitioned=void 0,this.stateManager=void 0,this.layerManager=void 0,this.objectManager=void 0,this.characterManager=void 0,this.dialogueManager=void 0,this.actionManager=void 0,this.boundingBoxManager=void 0,this.popUpManager=void 0,this.phaseManager=void 0,this.backgroundManager=void 0,this.animationManager=void 0,this.inputManager=void 0,this.escapeManager=void 0,this.collectibleManager=void 0,this.achievementManager=void 0,this.logManager=void 0,this.dialogueStorageManager=void 0,this.toolbarManager=void 0,this.taskLogManager=void 0,this.dashboardManager=void 0,this.getSaveManager=()=>zo.getInstance().getSaveManager(),this.getStateManager=()=>ei(this.stateManager),this.getObjectManager=()=>ei(this.objectManager),this.getDialogueManager=()=>ei(this.dialogueManager),this.getCharacterManager=()=>ei(this.characterManager),this.getBBoxManager=()=>ei(this.boundingBoxManager),this.getActionManager=()=>ei(this.actionManager),this.getInputManager=()=>ei(this.inputManager),this.getLayerManager=()=>ei(this.layerManager),this.getPhaseManager=()=>ei(this.phaseManager),this.getBackgroundManager=()=>ei(this.backgroundManager),this.getAnimationManager=()=>ei(this.animationManager),this.getPopupManager=()=>ei(this.popUpManager),this.getEscapeManager=()=>ei(this.escapeManager),this.getCollectibleManager=()=>ei(this.collectibleManager),this.getAchievementManager=()=>ei(this.achievementManager),this.getLogManager=()=>ei(this.logManager),this.getDialogueStorageManager=()=>ei(this.dialogueStorageManager),this.getToolbarManager=()=>ei(this.toolbarManager),this.getTaskLogManager=()=>ei(this.taskLogManager),this.getDashboardManager=()=>ei(this.dashboardManager),this.currentLocationId=vs.nullInteractionId,this.hasTransitioned=!1}init(e){let{gameCheckpoint:t,continueGame:n,chapterNum:s,checkpointNum:i}=e;Ii.getInstance().setGameManager(this),zo.getInstance().setCurrentSceneRef(this),this.getSaveManager().registerGameInfo(s,i,n),this.currentLocationId=this.getSaveManager().getLoadedLocation()||t.startingLoc,this.hasTransitioned=!1,this.stateManager=new Ra(t),this.layerManager=new Oa(this),this.inputManager=new xa(this),this.phaseManager=new Aa(new Map([[ki.Menu,new Ja],[ki.Move,new tr],[ki.Explore,new qa],[ki.Talk,new ar],[ki.Sequence,new nr],[ki.None,new nr]]),this.inputManager),this.characterManager=new qi,this.objectManager=new ka,this.dialogueManager=new sa,this.actionManager=new Bi,this.boundingBoxManager=new $i,this.backgroundManager=new Wi,this.animationManager=new Ui,this.popUpManager=new Ia,this.escapeManager=new ja(this),this.collectibleManager=new Vi(this,zo.getInstance().getUserStateManager().getCollectibles),this.achievementManager=new Vi(this,zo.getInstance().getUserStateManager().getAchievements),this.logManager=new Ea(this),this.dialogueStorageManager=new ia,this.toolbarManager=new Fa(this),this.taskLogManager=new Ba(this),this.dashboardManager=new Qi(this,[Ki.Log,Ki.Tasks,Ki.Collectibles,Ki.Achievements],[this.logManager,this.taskLogManager,this.collectibleManager,this.achievementManager])}preload(){la(this),this.getPhaseManager().setInterruptCheckCallback(((e,t)=>this.transitionChecker(e,t))),this.getPhaseManager().setInterruptCallback((async(e,t)=>await this.checkpointTransition())),this.getPhaseManager().setCallback((async(e,t)=>await this.handleCharacterLayer(e,t))),this.preloadLocationsAssets(),this.bindKeyboardTriggers()}preloadLocationsAssets(){const e=this.getStateManager().getGameMap();Ii.getInstance().loadSounds(e.getSoundAssets()),e.getMapAssets().forEach(((e,t)=>{this.loadImage(e,t)}))}loadImage(e,t){switch(e.type){case Hs.Image:this.load.image(t,Zs(e.path,!0));break;case Hs.Sprite:this.load.spritesheet(t,Zs(e.path,!0),e.config)}}async create(){Ii.getInstance().hideLayer(zs.Character),await this.changeLocationTo(this.currentLocationId,!0),await Ii.getInstance().saveGame()}async renderLocation(e,t){const n=Ii.getInstance().getLocationAtId(e);this.getToolbarManager().renderToolbarContainer(),await Ii.getInstance().playBgMusic(n.bgmKey),this.getBackgroundManager().renderBackgroundLayerContainer(e),this.getObjectManager().renderObjectsLayerContainer(e),this.getBBoxManager().renderBBoxLayerContainer(e),this.getCharacterManager().renderCharacterLayerContainer(e),await this.getPhaseManager().swapPhase(ki.Sequence),t&&(await this.getActionManager().fastForwardGameActions(this.getStateManager().getTriggeredStateChangeActions()),await this.getActionManager().processGameActions(this.getStateManager().getGameMap().getGameStartActions())),await this.getActionManager().processGameActions(n.actionIds),this.getStateManager().hasLocationNotif(e)&&(await Ii.getInstance().bringUpUpdateNotif(n.name),this.getStateManager().removeLocationNotif(e)),this.getPhaseManager().isCurrentPhase(ki.Sequence)&&await this.getPhaseManager().swapPhase(ki.Menu)}async changeLocationTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.currentLocationId=e,await(async(e,t,n,s)=>{const i=ri(e);e.getLayerManager().addToLayer(zs.Effects,i),i.setAlpha(0),e.tweens.add(ii([i],t)),await Qs(t),await s(),await Qs(n),i.setAlpha(1),e.tweens.add(si([i],t)),await Qs(t),i.destroy()})(this,300,500,(async()=>{await this.getLayerManager().clearAllLayers(),await this.renderLocation(e,t)})),this.getStateManager().triggerInteraction(e)}bindKeyboardTriggers(){this.getInputManager().registerKeyboardListener(Phaser.Input.Keyboard.KeyCodes.ESC,"up",(async()=>{this.getPhaseManager().isCurrentPhaseTerminal()?await this.getPhaseManager().popPhase():await this.getPhaseManager().pushPhase(ki.EscapeMenu)})),this.getInputManager().registerKeyboardListener(Phaser.Input.Keyboard.KeyCodes.TAB,"up",(async()=>{this.getPhaseManager().isCurrentPhase(ki.Dashboard)?await this.getPhaseManager().popPhase():this.getPhaseManager().isCurrentPhaseTerminal()?await this.getPhaseManager().swapPhase(ki.Dashboard):await this.getPhaseManager().pushPhase(ki.Dashboard)}))}cleanUp(){this.getInputManager().clearListeners(),this.getLayerManager().clearAllLayers(),this.getDialogueStorageManager().clearDialogueStorage()}transitionChecker(e,t){return!this.hasTransitioned&&t!==ki.Sequence&&Ii.getInstance().areAllObjectivesComplete()&&!this.getStateManager().getChapterNewlyCompleted()}async checkpointTransition(){this.hasTransitioned=!0,await this.getActionManager().processGameActions(this.getStateManager().getGameMap().getCheckpointCompleteActions()),this.getInputManager().setDefaultCursor(vs.defaultCursor),this.getInputManager().enableMouseInput(!0),this.getInputManager().enableKeyboardInput(!0),this.tweens.add(ii([ri(this).setAlpha(0)],vs.fadeDuration)),await Qs(vs.fadeDuration),this.cleanUp(),this.scene.start("CheckpointTransition")}async handleCharacterLayer(e,t){e===ki.Menu&&Ii.getInstance().fadeOutLayer(zs.Character),t===ki.Menu&&Ii.getInstance().fadeInLayer(zs.Character)}}var or=rr;class cr{constructor(){this.fullSaveState=void 0,this.chapterNum=void 0,this.checkpointNum=void 0,this.getTriggeredStateChangeActions=()=>this.getGameSaveState().triggeredStateChangeActions,this.getTriggeredInteractions=()=>this.getGameSaveState().triggeredInteractions,this.getCompletedObjectives=()=>this.getGameSaveState().completedObjectives,this.getCompletedTasks=()=>this.getGameSaveState().completedTasks,this.getIncompleteTasks=()=>this.getGameSaveState().incompleteTasks,this.getLoadedPhase=()=>this.getGameSaveState().currentPhase,this.getChapterNewlyCompleted=()=>this.getGameSaveState().chapterNewlyCompleted,this.getChapterNum=()=>ei(this.chapterNum),this.getCheckpointNum=()=>ei(this.checkpointNum),this.getFullSaveState=()=>this.fullSaveState,this.fullSaveState={gameSaveStates:{},userSaveState:{collectibles:[],settings:{bgmVolume:1,sfxVolume:1},recentlyPlayedCheckpoint:[-1,-1],largestCompletedChapter:-1}}}async loadLastSaveState(){this.fullSaveState=await async function(){var e;const t={method:"GET",headers:Qo(zo.getInstance().getAccountInfo().accessToken)},n=await fetch(`${we.b.backendUrl}/v2/user`,t),s=await n.text(),i=null===(e=JSON.parse(s).courseRegistration)||void 0===e?void 0:e.gameStates;return k.a.isEmpty(i)?{gameSaveStates:{},userSaveState:{collectibles:[],settings:{bgmVolume:1,sfxVolume:1},recentlyPlayedCheckpoint:[-1,-1],largestCompletedChapter:-1}}:i}()}registerGameInfo(e,t,n){this.chapterNum=e,this.checkpointNum=t,n||(this.fullSaveState.gameSaveStates[e]=Na())}async saveGame(){zo.getInstance().getCurrentSceneRef()instanceof or&&(this.fullSaveState=function(e,t,n){const s=Ii.getInstance().getGameManager(),i=s.getStateManager(),a=s.getPhaseManager();return{gameSaveStates:{...e.gameSaveStates,[t]:{lastCheckpointPlayed:n,currentLocation:s.currentLocationId,currentPhase:a.getCurrentPhase(),chapterNewlyCompleted:i.getChapterNewlyCompleted(),incompleteTasks:i.getIncompleteTasks(),completedTasks:i.getCompletedTasks(),completedObjectives:i.getCompletedObjectives(),triggeredInteractions:i.getTriggeredInteractions(),triggeredStateChangeActions:i.getTriggeredStateChangeActions()}},userSaveState:{settings:e.userSaveState.settings,recentlyPlayedCheckpoint:[t,n],collectibles:zo.getInstance().getUserStateManager().getCollectibles(),largestCompletedChapter:e.userSaveState.largestCompletedChapter}}}(this.fullSaveState,this.getChapterNum(),this.getCheckpointNum()),await Ko(this.fullSaveState))}async saveChapterComplete(e){this.fullSaveState.gameSaveStates[e].chapterNewlyCompleted=!0,e>this.getLargestCompletedChapterNum()&&(this.fullSaveState.userSaveState.largestCompletedChapter=e),await Ko(this.fullSaveState)}async saveSettings(e){this.fullSaveState.userSaveState.settings=e,await Ko(this.fullSaveState)}getSettings(){return this.fullSaveState.userSaveState.settings}getLoadedUserState(){return this.fullSaveState.userSaveState}getLargestCompletedChapterNum(){return this.fullSaveState.userSaveState.largestCompletedChapter}getGameSaveState(){return this.fullSaveState.gameSaveStates[this.getChapterNum()]||Na()}getLoadedLocation(){return this.getGameSaveState().currentLocation}getChapterSaveState(e){return this.fullSaveState.gameSaveStates[e]||Na()}}const lr={key:fs.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};const dr=["Clang. Thud. One hit to the wall, one hit to my flesh.","","They told me I was to be the pillar of this","spaceship - who knew they meant it literally?","- A. Halim"],ur=["I blink synchronously with the screen;","I breathe as the machine steams on and off.","","Behind this closed space, my very blood fuels","these engines - hoping for you to find me.","- T. S. Chong"],hr=80,pr=5e3;function gr(e,t,n,s){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:50,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:50;const r=new Phaser.GameObjects.Rectangle(e,n,s,i,a,0,0),o="A"===t?dr:ur;r.setInteractive({useHandCursor:!0}),r.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(()=>mr(e,o))),e.getLayerManager().addToLayer(zs.UI,r)}async function mr(e,t){const n=ri(e).setInteractive().setAlpha(0),s=Es({numOfItems:t.length,xSpacing:0,ySpacing:hr}),i={x:js.x,y:0,oriX:.5,oriY:.5},a=js.y-t.length*hr*.5;e.getLayerManager().addToLayer(zs.WorkerMessage,n),e.add.tween(ii([n],vs.fadeDuration)),zo.getInstance().getSoundManager().playSound(qs.radioStatic.key),await Qs(vs.fadeDuration),t.forEach(((t,n)=>{const r=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0,oriX:.5,oriY:.5},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:lr,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:3;const o=[];for(let c=0;c<i;c++){const i={x:n.x+a*Math.random(),y:n.y+r*Math.random(),oriX:n.oriX,oriY:n.oriY},c=_s(e,t,i,s);c.setAlpha(.4).setBlendMode(Phaser.BlendModes.SCREEN),o.push(c)}return o.forEach((t=>{e.tweens.add({targets:t,x:t.x+a*Math.random(),y:t.y+r*Math.random(),alpha:.5,duration:20,yoyo:!0,loop:-1,loopDelay:1e3*Math.random()})})),o}(e,t,{...i,y:s[n][1]+a});r.forEach((t=>e.getLayerManager().addToLayer(zs.WorkerMessage,t))),setTimeout((()=>r.forEach((e=>e.destroy()))),pr)})),await Qs(pr),ai(e,n)}const br={scrollSpeed:20,tileDim:2048,maxAwardsPerCol:2,arrow:{xOffset:875},award:{xSpace:300,yStart:300,ySpace:js.y-50,dim:200},awardInfo:{width:300},banner:{xOffset:.28*-ys.x},bannerTextConfig:{x:30,y:0,oriX:0,oriY:.5}},fr={key:fs.alienLeagueFont.key,size:35,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT},vr={fontFamily:"Verdana",fontSize:"30px",fill:xs.lightBlue,align:"center",wordWrap:{width:br.award.dim-20}},yr={fontFamily:"Verdana",fontSize:"20px",fill:xs.lightBlue,align:"left",wordWrap:{width:br.awardInfo.width-20}},jr={fontFamily:"Verdana",fontSize:"15px",fill:xs.offWhite,align:"left",wordWrap:{width:br.awardInfo.width-20}},xr={fontFamily:"Verdana",fontSize:"15px",fill:xs.lightBlue,align:"left",wordWrap:{width:br.awardInfo.width-20}};class Or extends Phaser.Scene{constructor(){super("AwardsHall"),this.layerManager=void 0,this.inputManager=void 0,this.backgroundTile=void 0,this.awardsContainer=void 0,this.isScrollLeft=void 0,this.isScrollRight=void 0,this.scrollLim=void 0,this.awardXSpace=void 0,this.getUserStateManager=()=>zo.getInstance().getUserStateManager(),this.getInputManager=()=>ei(this.inputManager),this.getLayerManager=()=>ei(this.layerManager),zo.getInstance().setCurrentSceneRef(this),this.isScrollLeft=!1,this.isScrollRight=!1,this.scrollLim=0,this.awardXSpace=0}init(){this.layerManager=new Oa(this),this.inputManager=new xa(this)}preload(){la(this)}async create(){const e=this.getUserStateManager().getAchievements().length,t=this.getUserStateManager().getCollectibles().length;this.awardXSpace=Math.ceil(Math.max(e,t)/br.maxAwardsPerCol)*br.award.xSpace,this.scrollLim=this.awardXSpace<ys.x?0:this.awardXSpace-ys.x,this.renderBackground(),this.renderAwards(),gr(this,"A",.95*ys.x,.99*ys.y)}update(){if(!this.backgroundTile||!this.awardsContainer)return;let e=this.awardsContainer.x;this.isScrollRight?e-=br.scrollSpeed:this.isScrollLeft&&(e+=br.scrollSpeed),e=Js(e,-this.scrollLim,0),this.backgroundTile.tilePositionX=-e,this.awardsContainer.x=e}renderBackground(){this.backgroundTile&&this.backgroundTile.destroy(),this.backgroundTile=new Phaser.GameObjects.TileSprite(this,0,0,br.tileDim,br.tileDim,Ws.awardsBackground.key).setOrigin(0,.25),this.getLayerManager().addToLayer(zs.Background,this.backgroundTile);const e=["Achievements","Collectibles"],t=ws({direction:Ss.Column,numOfItems:e.length});e.forEach(((e,n)=>{const s=this.createBanner(e,t[n][1]);this.getLayerManager().addToLayer(zs.UI,s)}));const n=Si(this,{assetKey:Ws.chapterSelectArrow.key,onDown:()=>this.isScrollLeft=!0,onUp:()=>this.isScrollLeft=!1,onOut:()=>this.isScrollLeft=!1}).setPosition(js.x-br.arrow.xOffset,js.y),s=Si(this,{assetKey:Ws.chapterSelectArrow.key,onDown:()=>this.isScrollRight=!0,onUp:()=>this.isScrollRight=!1,onOut:()=>this.isScrollRight=!1}).setPosition(js.x+br.arrow.xOffset,js.y).setScale(-1,1),i=new $a(this,(()=>{this.cleanUp(),this.scene.start("MainMenu")}));this.getLayerManager().addToLayer(zs.UI,n),this.getLayerManager().addToLayer(zs.UI,s),this.getLayerManager().addToLayer(zs.UI,i)}renderAwards(){this.awardsContainer&&this.awardsContainer.destroy(),this.awardsContainer=new Phaser.GameObjects.Container(this,0,0);const e=this.getAwards(this.getUserStateManager().getAchievements()),t=ws({direction:Ss.Column,numOfItems:e.length,numItemLimit:br.maxAwardsPerCol,redistributeLast:!1,maxXSpace:this.awardXSpace,maxYSpace:br.award.ySpace});this.awardsContainer.add(e.map(((e,n)=>this.createAward(e,t[n][0],t[n][1]+br.award.yStart-js.y))));const n=this.getAwards(this.getUserStateManager().getCollectibles()),s=ws({direction:Ss.Column,numOfItems:n.length,numItemLimit:br.maxAwardsPerCol,redistributeLast:!1,maxXSpace:this.awardXSpace,maxYSpace:br.award.ySpace});this.awardsContainer.add(n.map(((e,t)=>this.createAward(e,s[t][0],s[t][1]+br.award.yStart)))),this.getLayerManager().addToLayer(zs.Objects,this.awardsContainer)}getAwards(e){return Gs(e)}createAward(e,t,n){const s=new Phaser.GameObjects.Container(this,t,n);let i;if(e.assetKey===vs.nullInteractionId){i=new Phaser.GameObjects.Rectangle(this,0,0,br.award.dim,br.award.dim,Os.darkBlue,.8),i.setInteractive();const t=new Phaser.GameObjects.Text(this,0,0,e.title,vr).setOrigin(.5,.5);s.add([i,t])}else i=new Phaser.GameObjects.Sprite(this,0,0,e.assetKey).setOrigin(.5),Hi(i,br.award.dim,br.award.dim),i.setInteractive({pixelPerfect:!0,useHandCursor:!0}),s.add(i);const a=new Phaser.GameObjects.Rectangle(this,0,0,br.award.dim,br.award.dim,0).setAlpha(e.completed?0:.8);s.add(a);const r=((e,t)=>{const n=new Phaser.GameObjects.Container(e,0,0),s=new Phaser.GameObjects.Text(e,20,20,t.title,yr),i=new Phaser.GameObjects.Text(e,20,s.getBounds().bottom+20,t.assetKey,jr),a=new Phaser.GameObjects.Text(e,20,i.getBounds().bottom+20,t.description,xr),r=new Phaser.GameObjects.Rectangle(e,0,0,br.awardInfo.width,a.getBounds().bottom+20,Os.darkBlue).setOrigin(0,0).setAlpha(.8),o=new Phaser.GameObjects.Sprite(e,br.awardInfo.width/2,0,Ws.scrollFrame.key),c=new Phaser.GameObjects.Sprite(e,br.awardInfo.width/2,r.getBounds().bottom,Ws.scrollFrame.key);return n.add([r,s,a,o,c]),t.completed&&n.add(i),n.setVisible(!1),n})(this,e);return i.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OVER,(()=>r.setVisible(!0))),i.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(()=>r.setVisible(!1))),i.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_MOVE,(e=>{r.x=e.x+10,r.y=e.y-10})),this.getLayerManager().addToLayer(zs.UI,r),s}cleanUp(){this.getInputManager().clearListeners(),this.getLayerManager().clearAllLayers()}createBanner(e,t){const n=new Phaser.GameObjects.Container(this,0,t),s=new Phaser.GameObjects.Sprite(this,br.banner.xOffset,0,Ws.awardsPage.key),i=_s(this,e,br.bannerTextConfig,fr);return n.add([s,i]),n}}var Sr=Or;const wr={keyTextConfig:{x:js.x-100,y:0,oriX:.5,oriY:.5},keyDescTextConfig:{x:js.x+100,y:0,oriX:.5,oriY:.5},key:{yStart:.9*js.y,yInterval:150},icon:{x:js.x-100}},Cr={key:fs.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Er={key:fs.zektonFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};class Tr extends Phaser.Scene{constructor(){super("Bindings"),this.layerManager=void 0,this.inputManager=void 0,this.getInputManager=()=>ei(this.inputManager),this.getLayerManager=()=>ei(this.layerManager)}init(){this.layerManager=new Oa(this),this.inputManager=new xa(this)}create(){this.renderBackground(),this.renderBindings()}renderBackground(){const e=new Phaser.GameObjects.Image(this,js.x,js.y,Ws.spaceshipBg.key),t=new Phaser.GameObjects.Rectangle(this,js.x,js.y,ys.x,ys.y,0).setAlpha(.3);this.getLayerManager().addToLayer(zs.Background,e),this.getLayerManager().addToLayer(zs.Background,t)}renderBindings(){const e=new Phaser.GameObjects.Container(this,0,0),t=this.getBindings(),n=Es({numOfItems:t.length,xSpacing:0,ySpacing:wr.key.yInterval});e.add(t.map(((e,t)=>this.createBinding(e.key,e.text,n[t][0],n[t][1]+wr.key.yStart))));const s=new $a(this,(()=>{this.getLayerManager().clearAllLayers(),this.scene.start("MainMenu")}));this.getLayerManager().addToLayer(zs.UI,e),this.getLayerManager().addToLayer(zs.UI,s)}getBindings(){return[{key:"Esc",text:"Escape Menu"},{key:"Tab",text:"Dashboard"}]}createBinding(e,t,n,s){const i=new Phaser.GameObjects.Container(this,n,s),a=new Phaser.GameObjects.Sprite(this,wr.icon.x,0,Ws.squareKeyboardIcon.key);if("Tab"===e)a.setTexture(Ws.medKeyboardIcon.key);const r=_s(this,e,wr.keyTextConfig,Cr),o=_s(this,t,wr.keyDescTextConfig,Er);return i.add([a,r,o]),i}}var kr=Tr;const Ar=(e,t,n)=>new Promise((s=>{"__MISSING"!==e.textures.get(t).key?s(t):(e.load.image(t,n),e.load.once(`filecomplete-image-${t}`,s),e.load.once("loaderror",s),e.load.start())})),_r=(e,t,n)=>new Promise((s=>{e.cache.text.exists(t)?s(t):(e.load.text(t,n),e.load.once(`filecomplete-text-${t}`,s),e.load.start())})),Ir={key:fs.zektonFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Nr={key:fs.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Pr={key:fs.zektonFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var Rr={arrow:{xOffset:875},buttons:{scale:.65},resetButton:{xOffset:135,yOffset:85},playButton:{xOffset:55,yOffset:85},frame:{xOffset:12,yOffset:-4},scrollSpeed:100,indexTextConfig:{x:0,y:-110,oriX:.5,oriY:.5},titleTextConfig:{x:0,y:-50,oriX:.5,oriY:.5},pageNumberTextConfig:{x:js.x,y:ys.y-30,oriX:.5,oriY:.5},imageRect:{width:400,height:280},imageScale:{x:.8,y:.4},chapComplete:{y:10,height:30,text:"Chapter Completed"},grid:{chapPerRow:3,chapPerCol:3,chapPerPage:9,chapGapX:50,chapGapY:50}};const Mr=e=>Zs(`/stories/${e}`,!0),Lr={defaultCheckpoint:{key:"default-chap",path:Mr("defaultCheckpoint.txt")},awardsMapping:{key:"awards-mapping",path:Mr("awardsMapping.txt")},roomPreviewMapping:{key:"room-prev-mapping",path:Mr("roomPreviewMapping.txt")}},Dr={defaultCheckpoint:{key:"mock-default-chap",path:"../../assets/mockDefaultCheckpoint.txt"},awardsMapping:{key:"mock-awards-mapping",path:"../../assets/mockAwardsMapping.txt"},roomPreviewMapping:{key:"mock-room-prev-mapping",path:"../../assets/mockRoomPreviewMapping.txt"}};var Br=Lr;var Ur=class{constructor(){this.soundAssets=void 0,this.mapAssets=void 0,this.locations=void 0,this.dialogues=void 0,this.objects=void 0,this.boundingBoxes=void 0,this.characters=void 0,this.actions=void 0,this.gameStartActions=void 0,this.checkpointCompleteActions=void 0,this.getLocationAtId=e=>ei(this.locations.get(e),`Location ${e} was not found!`),this.getAssetByKey=e=>ei(this.mapAssets.get(e),`Asset ${e} not found!`),this.soundAssets=[],this.mapAssets=new Map,this.locations=new Map,this.dialogues=new Map,this.objects=new Map,this.boundingBoxes=new Map,this.characters=new Map,this.actions=new Map,this.gameStartActions=[],this.checkpointCompleteActions=[]}addSoundAsset(e){this.soundAssets.push(e)}addMapAsset(e,t){this.mapAssets.set(e,t)}getMapAssets(){return this.mapAssets}addLocation(e,t){this.locations.set(e,t)}setModesAt(e,t){this.getLocationAtId(e).modes=new Set(t)}setNavigationFrom(e,t){this.getLocationAtId(e).navigation=new Set(t)}getNavigationFrom(e){return this.getLocationAtId(e).navigation}setGameStartActions(e){this.gameStartActions=e}setCheckpointCompleteActions(e){this.checkpointCompleteActions=e}getGameStartActions(){return this.gameStartActions}getCheckpointCompleteActions(){return this.checkpointCompleteActions}getLocations(){return this.locations}getObjectPropMap(){return this.objects}getBBoxPropMap(){return this.boundingBoxes}getDialogueMap(){return this.dialogues}getCharacterMap(){return this.characters}getActionMap(){return this.actions}getSoundAssets(){return this.soundAssets}setItemInMap(e,t,n){this[e].set(t,n)}addItemToLocation(e,t,n){this.getLocationAtId(e)[t].add(n)}setBGMusicAt(e,t){this.getLocationAtId(e).bgmKey=t}getLocationIds(){return Array.from(this.locations.keys())}getAssetKeyFromId(e){var t,n;return ei((null===(t=this.objects.get(e))||void 0===t?void 0:t.assetKey)||(null===(n=this.locations.get(e))||void 0===n?void 0:n.assetKey),`Id ${e} not found!`)}};var Gr=class{constructor(){this.objective=void 0,this.totalNumOfObjectives=void 0,this.numOfCompletedObjectives=void 0,this.objective=new Map,this.totalNumOfObjectives=0,this.numOfCompletedObjectives=0}setObjective(e,t){const n=this.objective.get(e);this.objective.set(e,t),void 0!==n&&n!==t&&this.numOfCompletedObjectives++}addObjective(e){this.objective.set(e,!1),this.totalNumOfObjectives++}addObjectives(e){e.forEach((e=>this.addObjective(e)))}isAllComplete(){return this.numOfCompletedObjectives>=this.totalNumOfObjectives}getObjectiveState(e){const t=this.objective.get(e);if(void 0===t)throw new Error(`Cannot find objective with the given task id "${e}"`);return t}getObjectives(){return this.objective}setObjectives(e){this.objective=e}};var Fr=class{constructor(){this.tasks=void 0,this.taskDetails=void 0,this.tasks=new Map,this.taskDetails=new Map}setTask(e,t){this.tasks.set(e,t)}showTask(e){const t=this.taskDetails.get(e);if(void 0!==t){const n={...t,visible:!0};this.taskDetails.set(e,n)}}addTask(e){const t=e.taskId;this.tasks.set(t,!1),this.taskDetails.set(t,e)}addTasks(e){e.forEach((e=>this.addTask(e)))}getTaskState(e){const t=this.tasks.get(e);if(void 0===t)throw new Error(`Cannot find task with the given task id "${e}"`);return t}getTaskDetail(e){const t=this.taskDetails.get(e);if(void 0===t)throw new Error(`Cannot find task with the given task id "${e}"`);return t}getAllTasks(){return this.tasks}getAllIncompleteTasks(){const e=new Array;for(const n of this.tasks.keys()){var t;!this.tasks.get(n)&&null!==(t=this.taskDetails.get(n))&&void 0!==t&&t.visible&&e.push(n)}return e}getAllVisibleTaskData(){const e=new Array;for(const t of this.tasks.keys()){const n=this.getTaskState(t),s=this.getTaskDetail(t);void 0!==n&&void 0!==s&&s.visible&&e.push([s,n])}return e}};const Hr={small:ea.Small,medium:ea.Medium,large:ea.Large},Vr={left:Zi.Left,middle:Zi.Middle,right:Zi.Right},Wr={talk:za.Talk,explore:za.Explore,move:za.Move,menu:za.Menu},$r={navigation:Mi.navigation,talkTopics:Mi.talkTopics,objects:Mi.objects,boundingBoxes:Mi.boundingBoxes,characters:Mi.characters,actions:Mi.actions,bgmKey:Mi.bgmKey,collectibles:Mi.collectibles},Xr={move_character:Ri.MoveCharacter,update_character:Ri.UpdateCharacter,obtain_collectible:Ri.ObtainCollectible,complete_objective:Ri.CompleteObjective,complete_task:Ri.CompleteTask,show_task:Ri.ShowTask,add_item:Ri.AddItem,remove_item:Ri.RemoveItem,change_background:Ri.ChangeBackground,start_animation:Ri.StartAnimation,stop_animation:Ri.StopAnimation,show_dialogue:Ri.ShowDialogue,add_mode:Ri.AddLocationMode,remove_mode:Ri.RemoveLocationMode,add_popup:Ri.AddPopup,make_object_glow:Ri.MakeObjectGlow,make_object_blink:Ri.MakeObjectBlink,play_bgm:Ri.PlayBGM,play_sfx:Ri.PlaySFX,preview_location:Ri.PreviewLocation,show_object_layer:Ri.ShowObjectLayer,navigate_to_assessment:Ri.NavigateToAssessment,update_assessment_status:Ri.UpdateAssessmentStatus,delay:Ri.Delay},qr={checklist:Ni.ChecklistState,tasklist:Ni.TasklistState,userstate:Ni.UserState},zr={assessments:Pi.assessments,achievements:Pi.achievements,collectibles:Pi.collectibles};class Yr{static stringToSize(e){return Hr[e]||ea.Medium}static stringToPosition(e){return Vr[e]||Zi.Middle}static stringToGameMode(e){return ei(Wr[e],`Invalid location mode, ${e}`)}static stringToActionType(e){return ei(Xr[e],`Invalid action type, ${e}`)}static stringToGameStateStorage(e){return ei(qr[e],`Invalid condition type, ${e}`)}static stringToGameItemType(e){return ei($r[e],`Invalid entity type, ${e}`)}static stringToBoolean(e){return"false"!==e}static stringToUserStateType(e){return ei(zr[e],`Invalid user state type ${e}`)}}let Kr;!function(e){e.locations="locations",e.objectives="objectives",e.tasks="tasks",e.bgms="bgms",e.sfxs="sfxs"}(Kr||(Kr={}));class Qr{constructor(){this.gameItemAsserts=void 0,this.gameEntityAsserts=void 0,this.gameAnimAsserts=void 0,this.gameAnimMaps=[ho.checkpoint.map.getLocations(),ho.checkpoint.map[Mi.objects]],this.allItemIds=void 0,this.gameItemAsserts=new Map,this.gameEntityAsserts=new Map,this.gameAnimAsserts=[],this.allItemIds=new Set}registerId(e){if(this.allItemIds.has(e))throw new Error(`Duplicate item id ${e}`);this.allItemIds.add(e)}verifyAssertions(){this.verifyGameItemAssert(),this.verifyGameEntityAsserts(),this.verifyGameAnimAsserts()}assertItemType(e,t,n){e===Mi.talkTopics?e=Mi.dialogues:e===Mi.navigation&&(e=Mi.locations),this.gameItemAsserts.get(e)||this.gameItemAsserts.set(e,[]),this.gameItemAsserts.get(e).push({itemId:t,actionType:n})}verifyGameItemAssert(){this.gameItemAsserts.forEach(((e,t)=>{e.forEach((e=>{const{itemId:n,actionType:s}=e;if(!ho.checkpoint.map[t].has(n))throw s&&this.actionAssertionError(n,t,s),new Error(`Cannot find id "${n}" under ${t} entity type`)}))}))}assertItemTypes(e,t,n){t.forEach((t=>this.assertItemType(e,t,n)))}assertEntityType(e,t,n){this.gameEntityAsserts.get(e)||this.gameEntityAsserts.set(e,[]),this.gameEntityAsserts.get(e).push({itemId:t,actionType:n})}verifyGameEntityAsserts(){this.gameEntityAsserts.forEach(((e,t)=>{e.forEach((e=>{const{itemId:n,actionType:s}=e;switch(t){case Kr.locations:ho.checkpoint.map.getLocationAtId(n);break;case Kr.objectives:if(void 0===ho.checkpoint.objectives.getObjectives().get(n))throw s&&this.actionAssertionError(n,t,s),new Error(`Cannot find objective id "${n}"`);break;case Kr.tasks:if(void 0===ho.checkpoint.tasks.getAllTasks().get(n))throw s&&this.actionAssertionError(n,t,s),new Error(`Cannot find task id "${n}"`);break;case Kr.bgms:const e=ho.checkpoint.map.getSoundAssets().filter((e=>e.soundType===Xs.BGM&&e.key===n)).length;if(0===e)throw new Error(`Cannot find bgm key "${n}"`);if(e>1)throw new Error(`More than 1 bgm key "${n}"`);break;case Kr.sfxs:const i=ho.checkpoint.map.getSoundAssets().filter((e=>e.soundType===Xs.SFX&&e.key===n)).length;if(0===i)throw new Error(`Cannot find sfx key "${n}"`);if(i>1)throw new Error(`More than 1 sfx key "${n}"`)}}))}))}assertAnimType(e,t){this.gameAnimAsserts.push({itemId:e,actionType:t})}verifyGameAnimAsserts(){this.gameAnimAsserts.forEach((e=>{const{itemId:t,actionType:n}=e;let s=!1;this.gameAnimMaps.forEach((e=>{e.get(t)&&(s=!0)})),s||this.actionAssertionError(t,"locationId or itemId",n)}))}actionAssertionError(e,t,n){throw new Error(`Expected type of "${t}" as argument for "${n}", obtained "${e}" which is either undefined or the wrong id.`)}}class Jr{static parse(e){const t="!"===e[0];t&&(e=e.slice(1));const[n,...s]=ta.splitByChar(e,".");switch(Yr.stringToGameStateStorage(n)){case Ni.ChecklistState:return ho.validator.assertEntityType(Kr.objectives,s[0]),{state:Ni.ChecklistState,conditionParams:{id:s[0]},boolean:!t};case Ni.TasklistState:return ho.validator.assertEntityType(Kr.tasks,s[0]),{state:Ni.TasklistState,conditionParams:{id:s[0]},boolean:!t};case Ni.UserState:return{state:Ni.UserState,conditionParams:{userStateType:Yr.stringToUserStateType(s[0]),id:s[1]},boolean:!t};default:throw new Error("Parsing error: Invalid condition param")}}}class Zr{static parseActions(e){return e.map((e=>this.parseAction(e)))}static parseAction(e){const[t,n]=ta.splitByChar(e,"if"),s=this.parseActionContent(t);return n&&(s.actionConditions=ta.splitByChar(n,"AND").map((e=>Jr.parse(e)))),ho.checkpoint.map.setItemInMap(Mi.actions,s.interactionId,s),s.interactionId}static parseActionContent(e){const[t,n]=ta.splitByChar(e,"(");let s=!1,i=t;"*"===t[t.length-1]&&(s=!0,i=i.slice(0,-1));const a=Yr.stringToActionType(i),r=ta.splitByChar(n.slice(0,-1),","),o={};switch(a){case Ri.ObtainCollectible:o.id=r[0];break;case Ri.CompleteObjective:o.id=r[0],ho.validator.assertEntityType(Kr.objectives,r[0],i);break;case Ri.CompleteTask:case Ri.ShowTask:o.id=r[0],ho.validator.assertEntityType(Kr.tasks,r[0],i);break;case Ri.PreviewLocation:case Ri.ChangeBackground:o.id=r[0],ho.validator.assertEntityType(Kr.locations,r[0],i);break;case Ri.StartAnimation:o.id=r[0],o.startFrame=+r[1],o.frameRate=+r[2],o.assetCategory=r[3],ho.validator.assertAnimType(r[0],i);break;case Ri.StopAnimation:o.id=r[0],ho.validator.assertAnimType(r[0],i);break;case Ri.ShowDialogue:o.id=r[0],ho.validator.assertItemType(Mi.dialogues,r[0],i);break;case Ri.AddItem:case Ri.RemoveItem:const e=Yr.stringToGameItemType(r[0]);o.gameItemType=e,o.locationId=r[1],ho.validator.assertEntityType(Kr.locations,r[1],i),o.id=r[2],ho.validator.assertItemType(e,r[2],i);break;case Ri.AddLocationMode:case Ri.RemoveLocationMode:ho.validator.assertEntityType(Kr.locations,r[0],i),o.locationId=r[0],o.mode=Yr.stringToGameMode(r[1]);break;case Ri.AddPopup:ho.validator.assertItemType(Mi.objects,r[0],i),o.id=r[0],o.position=Yr.stringToPosition(r[1]),r[2]&&(o.duration=1e3*parseInt(r[2])),r[3]&&(o.size=Yr.stringToSize(r[3]));break;case Ri.MakeObjectBlink:case Ri.MakeObjectGlow:ho.validator.assertItemType(Mi.objects,r[0],i),o.id=r[0],o.turnOn=Yr.stringToBoolean(r[1]);break;case Ri.PlayBGM:o.id=r[0],ho.validator.assertEntityType(Kr.bgms,r[0],i);break;case Ri.PlaySFX:o.id=r[0],ho.validator.assertEntityType(Kr.sfxs,r[0],i);break;case Ri.ShowObjectLayer:o.show=Yr.stringToBoolean(r[0]);break;case Ri.UpdateCharacter:ho.validator.assertItemType(Mi.characters,r[0],i),o.id=r[0],o.expression=r[1];break;case Ri.MoveCharacter:ho.validator.assertItemType(Mi.characters,r[0],i),ho.validator.assertEntityType(Kr.locations,r[1],i),o.id=r[0],o.locationId=r[1],o.position=Yr.stringToPosition(r[2]);break;case Ri.NavigateToAssessment:o.assessmentId=r[0];break;case Ri.Delay:o.duration=1e3*parseInt(r[0])}return{actionType:a,actionParams:o,actionConditions:[],interactionId:ho.generateActionId(),isInteractive:!1,isRepeatable:s}}}class eo{static parsePrompt(e,t){return{promptTitle:e.split("prompt:")[1].trim(),choices:t.map(this.splitChoice)}}static splitChoice(e){const t=ta.splitWithLimit(e,"->",1);return[t[0].trim(),t[1].split(" ")[1].trim()]}}class to{static parse(e,t){t.forEach((t=>this.parseCharacterDetails(e,t)))}static characterAssetKey(e,t){return e+"-"+t}static characterAssetPath(e,t){return`/avatars/${e}/${e}.${t}.png`}static parseCharacterDetails(e,t){const n="+"===t[0];n&&(t=t.slice(1));const[s,i,a,r,o]=ta.splitByChar(t,",");ho.validator.registerId(s);const c=new Map,l={id:s,name:i,expressions:c,defaultExpression:a,defaultPosition:Yr.stringToPosition(r),scale:o?parseFloat(o):1};c.set(a,this.characterAssetKey(s,a)),ho.checkpoint.map.addMapAsset(this.characterAssetKey(s,a),{type:Hs.Image,path:this.characterAssetPath(s,a),key:s}),ho.checkpoint.map.setItemInMap(Mi.characters,s,l),n&&ho.checkpoint.map.addItemToLocation(e,Mi.characters,s)}}class no{static parse(e){const[t,n,s]=ta.splitByChar(e.slice(1),","),i=Yr.stringToPosition(s);return this.addCharacterExprToMap(t,n),{speakerId:t,expression:n,speakerPosition:i}}static addCharacterExprToMap(e,t){if("you"===e||"narrator"===e)return;const n=ho.checkpoint.map.getCharacterMap().get(e);if(!n)throw new Error(`Character "${e}" not in map`);const s=t||n.defaultExpression;n.expressions.set(t,to.characterAssetKey(e,t||s)),ho.checkpoint.map.addMapAsset(to.characterAssetKey(e,s),{path:to.characterAssetPath(e,s),type:Hs.Image,key:e})}}const so=e=>new RegExp(/^[0-9]+$/).test(e),io=e=>new RegExp(/^goto [0-9]+.*$/).test(e),ao=e=>e&&("\t"===e[0]||"    "===e.slice(0,4)),ro=e=>e&&"@"===e[0],oo=e=>e.trim().startsWith("prompt:"),co=e=>new RegExp(/-> +goto/).test(e);class lo{static parse(e,t,n){t.forEach(((t,s)=>{const[i,a,r]=ta.splitByChar(t,",");ho.validator.registerId(i),ho.checkpoint.map.addSoundAsset({key:i,path:a,config:{volume:parseFloat(r),loop:n===Xs.BGM},soundType:n}),n===Xs.BGM&&0===s&&ho.checkpoint.map.setBGMusicAt(e,i)}))}}class uo{static generateActionId(){return uo.actionIdNum++,`action#${uo.actionIdNum}`}static init(){uo.actionIdNum=0,uo.checkpoint={map:new Ur,startingLoc:"",objectives:new Gr,tasks:new Fr},uo.validator=new Qr}static parse(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||uo.init();const t=ta.splitToLinesAndRemoveComments(e);ta.splitToParagraph(t).forEach((e=>{let[t,n]=e;0===n.length&&t.includes(":")?uo.parseCheckpointConfig(t):uo.parseCheckpointParagraphs(t,n)||class{static parse(e,t){const n=ho.checkpoint.map.getLocationAtId(e);ta.splitToParagraph(t).forEach((e=>{let[t,s]=e;0===s.length&&t.includes(":")?this.parseLocationConfig(n,t):this.parseLocationParagraphs(n,t,s)}))}static parseLocationConfig(e,t){const[n,s]=ta.splitByChar(t,":"),i=ta.splitByChar(s,",");switch(n){case"modes":i.forEach((t=>{const n=Yr.stringToGameMode(t);e.modes.add(n)}));break;case"nav":i.forEach((t=>{ho.validator.assertEntityType(Kr.locations,t),e.navigation.add(t)}));break;case"talkTopics":const t=i;ho.validator.assertItemTypes(Mi.dialogues,t),e.talkTopics=new Set(t);break;case"preview":const[s]=i;if(s){const t="/preview"+s;ho.checkpoint.map.addMapAsset(t,{type:Hs.Image,key:e.id+"Preview",path:s}),e.previewKey=t}break;default:throw new Error(`Invalid config key "${n}" specified under location "${e.id}"`)}}static parseLocationParagraphs(e,t,n){switch(t){case"objects":(class{static parse(e,t){ta.splitToParagraph(t).forEach((t=>{let[n,s]=t;const i=this.parseObjectConfig(e,n);s.length&&(i.isInteractive=!0,i.actionIds=Zr.parseActions(s))}))}static objectAssetKey(e){return e}static objectPath(e){return e}static parseObjectConfig(e,t){const n="+"===t[0];n&&(t=t.slice(1));const[s,i,a,r,o,c,l,d]=ta.splitByChar(t,",");ho.validator.registerId(s);const u={assetKey:this.objectAssetKey(i),x:parseInt(a),y:parseInt(r),width:parseInt(o)||void 0,height:parseInt(c)||void 0,isInteractive:!1,interactionId:s};return ho.checkpoint.map.addMapAsset(this.objectAssetKey(i),{type:Hs[l]||Hs.Image,key:s,path:this.objectPath(i),config:{frameHeight:parseInt(c)||-1,frameWidth:parseInt(o)||-1,centreX:0,centreY:0,endFrame:parseInt(d)-1||0,animType:Vs.Object}}),ho.checkpoint.map.setItemInMap(Mi.objects,s,u),n&&ho.checkpoint.map.addItemToLocation(e,Mi.objects,s),u}}).parse(e.id,n);break;case"boundingBoxes":(class{static parse(e,t){ta.splitToParagraph(t).forEach((t=>{let[n,s]=t;const i=this.parseBBoxConfig(e,n);s.length&&(i.isInteractive=!0,i.actionIds=Zr.parseActions(s))}))}static parseBBoxConfig(e,t){const n="+"===t[0];n&&(t=t.slice(1));const[s,i,a,r,o]=ta.splitByChar(t,","),c={x:parseInt(i),y:parseInt(a),width:parseInt(r),height:parseInt(o),isInteractive:!1,interactionId:s};return ho.validator.registerId(s),ho.checkpoint.map.setItemInMap(Mi.boundingBoxes,s,c),n&&ho.checkpoint.map.addItemToLocation(e,Mi.boundingBoxes,s),c}}).parse(e.id,n);break;case"characters":to.parse(e.id,n);break;case"bgm":lo.parse(e.id,n,Xs.BGM);break;case"sfx":lo.parse(e.id,n,Xs.SFX);break;case"actions":e.actionIds=Zr.parseActions(n);break;default:throw new Error(`Invalid location paragraph header "${t}"`)}}}.parse(t,n)})),uo.validator.verifyAssertions()}static parseCheckpointConfig(e){const[t,n]=ta.splitByChar(e,":");if("startingLoc"!==t)throw new Error(`Invalid checkpoint config key, "${e}"`);uo.validator.assertEntityType(Kr.locations,n),uo.checkpoint.startingLoc=n}static parseCheckpointParagraphs(e,t){switch(e){case"objectives":uo.checkpoint.objectives.addObjectives(t);break;case"tasks":(class{static parse(e){const t=[];e.forEach((e=>{const[n,s,i]=ta.splitWithLimit(e,",",2),a={taskId:n,title:s,description:i,visible:!1};t.push(a)})),ho.checkpoint.tasks.addTasks(t)}}).parse(t);break;case"locations":(class{static parse(e){e.forEach((e=>{const[t,n,s,i,a]=ta.splitByChar(e,",");ho.validator.registerId(t),ho.checkpoint.map.addLocation(t,{id:"",name:"",assetKey:"",previewKey:null,modes:new Set([]),navigation:new Set([]),talkTopics:new Set([]),objects:new Set([]),boundingBoxes:new Set([]),bgmKey:"",characters:new Set([]),id:t,name:s,assetKey:this.locationAssetKey(n)}),ho.checkpoint.map.addMapAsset(this.locationAssetKey(n),{type:Hs[i]||Hs.Image,key:t,path:this.locationPath(n),config:{frameWidth:ys.x,frameHeight:ys.y,centreX:js.x,centreY:js.y,endFrame:parseInt(a)-1||0,animType:Vs.Background}})}))}static locationAssetKey(e){return e}static locationPath(e){return e}}).parse(t);break;case"gameStartActions":uo.checkpoint.map.setGameStartActions(Zr.parseActions(t));break;case"checkpointCompleteActions":uo.checkpoint.map.setCheckpointCompleteActions(Zr.parseActions(t));break;case"dialogues":(class{static parse(e){ta.splitToParagraph(e).forEach((e=>{let[t,n]=e;0!==n.length?this.parseDialogue(t,n):console.error("No dialogue found for dialogueId")}))}static parseDialogue(e,t){const[n,s]=ta.splitWithLimit(e,",",1);ho.validator.registerId(n);const i={title:s,content:this.parseDialogueContent(t)};i.title||(i.title=ta.toCapitalizedWords(n)),ho.checkpoint.map.setItemInMap(Mi.dialogues,n,i)}static parseDialogueContent(e){return function(e,t){const n=new Map;return e.forEach(((e,s)=>{const i=t(e,s);n.set(s,i)})),n}(ta.mapByHeader(e,so),this.createDialogueLines)}static createDialogueLines(e){const t=[];let n=0;for(;n!==e.length;){const s=e[n];switch(!0){case io(s):const[i,a]=ta.splitByChar(s,"if"),[r,o]=a?ta.splitByChar(a,"else"):[null,null],c=r?ta.splitByChar(r,"AND").map((e=>Jr.parse(e))):[];t[t.length-1].goto={conditions:c,part:i.split(" ")[1],altPart:o};break;case oo(s):const l=s,d=[];for(;e[n+1]&&co(e[n+1]);)n++,d.push(e[n].trim());const u=eo.parsePrompt(l,d);t[t.length-1].prompt=u;break;case ao(s):const h=t[t.length-1];!h.actionIds&&(h.actionIds=[]),h.actionIds.push(Zr.parseAction(s));break;case ro(s):n++;const p=e[n];if(!p)throw new Error("Parsing error: Cannot change speaker without next line");t.push({line:p}),t[t.length-1].speakerDetail=no.parse(s);break;default:t.push({line:s}),t[t.length-1].speakerDetail=no.parse("@narrator")}n++}return t}}).parse(t);break;default:return!1}return!0}}uo.checkpoint=void 0,uo.actionIdNum=void 0,uo.validator=void 0;var ho=uo;async function po(e,t,n){const s=zo.getInstance().getIsUsingMock()?Dr:Br,i=zo.getInstance().getCurrentSceneRef(),a=zo.getInstance().getGameChapters()[t].filenames[n];if(!a)return;await _r(i,a,a),await _r(i,s.defaultCheckpoint.key,s.defaultCheckpoint.path);const r=i.cache.text.get(a),o=i.cache.text.get(s.defaultCheckpoint.key);ho.parse(o),ho.parse(r,!0);const c=ho.checkpoint;i.scene.start("GameManager",{gameCheckpoint:c,continueGame:e,chapterNum:t,checkpointNum:n})}async function go(){const e=zo.getInstance().getCurrentSceneRef(),t=zo.getInstance().getSSChapterSimFilenames();if(!t.length)return void e.scene.start("StorySimulatorMenu");const n=t.pop();await _r(e,n,Mr(n)),await _r(e,Br.defaultCheckpoint.key,Br.defaultCheckpoint.path);const s=e.cache.text.get(n),i=e.cache.text.get(Br.defaultCheckpoint.key);ho.parse(i),ho.parse(s,!0);const a=ho.checkpoint;return e.scene.start("GameManager",{gameCheckpoint:a,chapterNum:-1,checkpointNum:-1}),!0}function mo(e,t,n){let{title:s,imageUrl:i}=t;const[a,r]=function(e){const t=Math.floor(e/Rr.grid.chapPerPage);e%=Rr.grid.chapPerPage;const n=Math.floor(e/Rr.grid.chapPerRow),s=e%Rr.grid.chapPerRow,i=(Rr.grid.chapPerRow-1)/2,a=(Rr.grid.chapPerCol-1)/2;let r=t*ys.x+js.x;r+=(s-i)*(Rr.imageRect.width+Rr.grid.chapGapX);let o=js.y;return o+=(n-a)*(Rr.imageRect.height+Rr.grid.chapGapY),[r,o]}(n),o=new Phaser.GameObjects.Container(e,a,r),c=n<=zo.getInstance().getSaveManager().getLargestCompletedChapterNum(),l=new Phaser.GameObjects.Image(e,0,0,i).setDisplaySize(Rr.imageRect.width,Rr.imageRect.height),d=new Phaser.GameObjects.Sprite(e,Rr.frame.xOffset,Rr.frame.yOffset,Ws.chapterSelectFrame.key).setScale(.99*Rr.imageScale.x,.99*Rr.imageScale.y),u=new Phaser.GameObjects.Rectangle(e,0,Rr.chapComplete.y,Rr.imageRect.width,Rr.chapComplete.height,0).setOrigin(.5).setAlpha(.7).setInteractive().setVisible(c),h=_s(e,Rr.chapComplete.text,{x:0,y:Rr.chapComplete.y,oriX:.5,oriY:.5},Ir).setVisible(c),p=new As(e,Rr.resetButton.xOffset+8,Rr.resetButton.yOffset-20,"Reset progress"),g=new As(e,Rr.playButton.xOffset+8,Rr.playButton.yOffset-20,"Play/Continue"),m=Si(e,{assetKey:Ws.chapterRepeatButton.key,onUp:async()=>await po(!1,n,0),onHover:()=>p.setVisible(!0),onOut:()=>p.setVisible(!1)}).setPosition(Rr.resetButton.xOffset,Rr.resetButton.yOffset).setScale(Rr.buttons.scale),b=zo.getInstance().getSaveManager().getChapterSaveState(n).lastCheckpointPlayed,f=Si(e,{assetKey:Ws.chapterContinueButton.key,onUp:async()=>await po(!0,n,b),onHover:()=>g.setVisible(!0),onOut:()=>g.setVisible(!1)}).setPosition(Rr.playButton.xOffset,Rr.playButton.yOffset).setScale(Rr.buttons.scale),v=_s(e,`Chapter ${n}`,Rr.indexTextConfig,Ir),y=_s(e,s,Rr.titleTextConfig,Nr),j=n<=zo.getInstance().getSaveManager().getLargestCompletedChapterNum()+1,x=new Phaser.GameObjects.Rectangle(e,0,0,Rr.imageRect.width,Rr.imageRect.height,0).setOrigin(.5).setAlpha(j?0:.8).setInteractive();return o.add([l,d,u,h,m,f,p,g,v,y,x]),o}class bo extends Phaser.Scene{constructor(){super("ChapterSelect"),this.layerManager=void 0,this.chaptersContainer=void 0,this.backButtonContainer=void 0,this.pageNumberText=void 0,this.targetPage=void 0,this.getGameChapters=()=>zo.getInstance().getGameChapters(),this.getLayerManager=()=>ei(this.layerManager),this.chaptersContainer=void 0,this.backButtonContainer=void 0,this.pageNumberText=void 0,this.targetPage=0}preload(){la(this)}async create(){zo.getInstance().setCurrentSceneRef(this),this.layerManager=new Oa(this),await this.preloadChapterAssets(),this.renderBackground(),this.renderChapters()}update(){if(!this.chaptersContainer)return;const e=-this.targetPage*ys.x;if(this.chaptersContainer.x>e){const t=this.chaptersContainer.x-Rr.scrollSpeed;this.chaptersContainer.x=Math.max(t,e)}else if(e>this.chaptersContainer.x){const t=this.chaptersContainer.x+Rr.scrollSpeed;this.chaptersContainer.x=Math.min(t,e)}}cleanUp(){this.getLayerManager().clearAllLayers()}async preloadChapterAssets(){await Promise.all(this.getGameChapters().map((async e=>await Ar(this,e.imageUrl,Zs(e.imageUrl,!0)))))}renderBackground(){const e=new Phaser.GameObjects.Image(this,js.x,js.y,Ws.spaceshipBg.key),t=new Phaser.GameObjects.Rectangle(this,js.x,js.y,ys.x,ys.y,0).setAlpha(.3);this.getLayerManager().addToLayer(zs.Background,e),this.getLayerManager().addToLayer(zs.Background,t)}renderChapters(){this.backButtonContainer=new $a(this,(()=>{this.cleanUp(),this.scene.start("MainMenu")})),this.chaptersContainer=this.createChaptersContainer(),this.pageNumberText=_s(this,`1 / ${this.numPages()}`,Rr.pageNumberTextConfig,Pr);const e=Math.min(zo.getInstance().getSaveManager().getLargestCompletedChapterNum()+1,this.getGameChapters().length-1);this.targetPage=Math.floor(e/Rr.grid.chapPerPage),this.targetPage<0&&(this.targetPage=0),this.pageNumberText.setText(`${this.targetPage+1} / ${this.numPages()}`);const t=new Phaser.GameObjects.Image(this,js.x,js.y,Ws.chapterSelectBorder.key),n=Si(this,{assetKey:Ws.chapterSelectArrow.key,onUp:()=>this.scrollPrevPage()}).setPosition(js.x-Rr.arrow.xOffset,js.y),s=Si(this,{assetKey:Ws.chapterSelectArrow.key,onUp:()=>this.scrollNextPage()}).setPosition(js.x+Rr.arrow.xOffset,js.y).setScale(-1,1);this.getLayerManager().addToLayer(zs.UI,this.chaptersContainer),this.getLayerManager().addToLayer(zs.UI,this.backButtonContainer),this.getLayerManager().addToLayer(zs.UI,this.pageNumberText),this.getLayerManager().addToLayer(zs.UI,t),this.getLayerManager().addToLayer(zs.UI,n),this.getLayerManager().addToLayer(zs.UI,s)}createChaptersContainer(){const e=new Phaser.GameObjects.Container(this,0,0);return e.add(this.getGameChapters().map(((e,t)=>mo(this,e,t)))).sort("depth").reverse(),e}numPages(){const e=Math.ceil(this.getGameChapters().length/Rr.grid.chapPerPage);return Math.max(e,1)}scrollPrevPage(){var e;this.targetPage=Math.max(this.targetPage-1,0),null===(e=this.pageNumberText)||void 0===e||e.setText(`${this.targetPage+1} / ${this.numPages()}`)}scrollNextPage(){var e;const t=this.numPages();this.targetPage=Math.min(this.targetPage+1,t-1),null===(e=this.pageNumberText)||void 0===e||e.setText(`${this.targetPage+1} / ${t}`)}}var fo=bo;const vo={key:fs.alienCowsFont.key,size:80,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},yo=1500;var jo={text:{chapter:"Chapter completed.",checkpoint:"Checkpoint reached."},transitionTextConfig:{x:js.x,y:js.y,oriX:.5,oriY:.5},tweenDuration:yo,entryTween:{alpha:1,duration:yo,ease:"Power2"},exitTween:{alpha:0,duration:yo,ease:"Power2"}};class xo extends Phaser.Scene{constructor(){super("CheckpointTransition")}preload(){zo.getInstance().setCurrentSceneRef(this)}async create(){if(zo.getInstance().isGameType(qo.Simulator))return await this.showTransitionText(jo.text.checkpoint),void await go();const e=zo.getInstance().getSaveManager().getFullSaveState(),t=zo.getInstance().getGameChapters(),[n,s]=e.userSaveState.recentlyPlayedCheckpoint;return this.isLastCheckpoint(t,n,s)?(await zo.getInstance().getSaveManager().saveChapterComplete(n),await this.showTransitionText(jo.text.chapter),this.isLastChapter(t,n)?void this.scene.start("ChapterSelect"):void await po(!0,n+1,0)):(await this.showTransitionText(jo.text.checkpoint),void await po(!1,n,s+1))}async showTransitionText(e){const t=_s(this,e,jo.transitionTextConfig,vo).setAlpha(0);this.add.existing(t),this.tweens.add({targets:t,...jo.entryTween}),await Qs(2*jo.tweenDuration),this.tweens.add({targets:t,...jo.exitTween}),await Qs(jo.tweenDuration)}isLastCheckpoint(e,t,n){return n>=e[t].filenames.length-1}isLastChapter(e,t){return t>=e.length-1}}var Oo=xo;const So={key:fs.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_RIGHT};var wo={text:{chapterSelect:"Play Chapter",studentRoom:"Go to My Room",awards:"Awards Hall",settings:"Settings",bindings:"Key Bindings"},button:{ySpace:.5*ys.y},buttonTextConfig:{x:600,y:0,oriX:1,oriY:.1},banner:{xHide:300},onFocusTween:{x:js.x+200,duration:200,ease:"Power2"},outFocusTween:{x:js.x+300,duration:200,ease:"Power2"},saBanner:{x:.3*ys.x,y:.9*ys.y}};class Co extends Phaser.Scene{constructor(){super("MainMenu"),this.layerManager=void 0,this.getLayerManager=()=>ei(this.layerManager)}async create(){zo.getInstance().setCurrentSceneRef(this),this.layerManager=new Oa(this),this.renderBackground(),this.renderOptionButtons(),gr(this,"T",1.12*js.x,1.1*js.y),zo.getInstance().getSoundManager().playBgMusic(qs.galacticHarmony.key)}renderBackground(){const e=new Phaser.GameObjects.Image(this,js.x,js.y,Ws.spaceshipBg.key).setDisplaySize(ys.x,ys.y),t=ri(this).setAlpha(.15),n=new Phaser.GameObjects.Image(this,wo.saBanner.x,wo.saBanner.y,Ws.saBanner.key).setAlpha(.7);this.getLayerManager().addToLayer(zs.Background,e),this.getLayerManager().addToLayer(zs.Background,t),this.getLayerManager().addToLayer(zs.Background,n)}renderOptionButtons(){const e=new Phaser.GameObjects.Container(this,0,0),t=this.getOptionButtons(),n=ws({direction:Ss.Column,numOfItems:t.length,maxYSpace:wo.button.ySpace});e.add(t.map(((e,t)=>this.createOptionButton(e.text,n[t][0]+wo.banner.xHide,n[t][1],e.callback)))),this.getLayerManager().addToLayer(zs.UI,e)}createOptionButton(e,t,n,s){const i=e=>{this.tweens.add({targets:e,...wo.onFocusTween})},a=e=>{this.tweens.add({targets:e,...wo.outFocusTween})},r=Si(this,{assetKey:Ws.mainMenuOptBanner.key,message:e,textConfig:wo.buttonTextConfig,bitMapTextStyle:So,onUp:s,onHover:()=>i(r),onOut:()=>a(r),onHoverEffect:!1}).setPosition(t,n);return r}getOptionButtons(){return[{text:wo.text.chapterSelect,callback:()=>{this.getLayerManager().clearAllLayers(),this.scene.start("ChapterSelect")}},{text:wo.text.awards,callback:()=>{this.getLayerManager().clearAllLayers(),this.scene.start("AwardsHall")}},{text:wo.text.studentRoom,callback:()=>{this.getLayerManager().clearAllLayers(),this.scene.start("RoomPreview")}},{text:wo.text.settings,callback:()=>{this.getLayerManager().clearAllLayers(),this.scene.start("Settings")}},{text:wo.text.bindings,callback:()=>{this.getLayerManager().clearAllLayers(),this.scene.start("Bindings")}}]}}var Eo=Co,To=n(91),ko=n(96);const Ao='\nimport { prepend_remote_url, get_screen_width, get_screen_height, load_image, create_image, create_text, create_rect, add, set_display_size, set_alpha, set_origin } from \'game\';\n\nfunction preload() {\n    load_image("galaxy", prepend_remote_url("/locations/galaxy/normal.png"));\n}\n\nfunction create() {\n    const width = get_screen_width();\n    const height = get_screen_height();\n    const centre_x = width / 2;\n    const centre_y = height / 2;\n\n    const image = create_image(centre_x, centre_y, "galaxy");\n    const image_resized = set_display_size(image, width, height);\n\n    const black_tint = create_rect(centre_x, centre_y, width, height, 0x000011);\n    const black_tint_alpha = set_alpha(black_tint, 0.5);\n\n    const text = create_text(centre_x, centre_y, "Unable to fetch mission!");\n    const text_repos = set_origin(text, 0.5, 0.5);\n\n    add(image_resized);\n    add(black_tint_alpha);\n    add(text_repos);\n}\n\nfunction update() {}\n',_o={key:fs.pixelFont.key,size:20,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Io={assessmentNumber:"MYROOM",verifiedText:"VERIFIED",tag:{width:128,height:50},hoverTagTextConfig:{x:64,y:0,oriX:.5,oriY:.55},refreshButton:{x:.95*ys.x,y:.92*ys.y}};var No=n(30);async function Po(){const e=await async function(){const e=(await Object(No.k)(zo.getInstance().getAccountInfo())||[]).find((e=>e.number===Io.assessmentNumber));return e?e.id:null}();if(!e)return Ro(null);return Ro(await Object(No.i)(e,zo.getInstance().getAccountInfo()))}function Ro(e){if(e){const t=e.questions[0],n=t.answer;return n||t.solutionTemplate}return Ao}class Mo extends Phaser.Scene{constructor(){super("RoomPreview"),this.layerManager=void 0,this.inputManager=void 0,this.phaseManager=void 0,this.escapeManager=void 0,this.collectibleManager=void 0,this.achievementManager=void 0,this.toolbarManager=void 0,this.dashboardManager=void 0,this.studentCode=void 0,this.preloadImageMap=void 0,this.preloadSoundMap=void 0,this.preloadSpritesheetMap=void 0,this.verifCont=void 0,this.context=void 0,this.getVerifCont=()=>ei(this.verifCont),this.getUserStateManager=()=>zo.getInstance().getUserStateManager(),this.getInputManager=()=>ei(this.inputManager),this.getLayerManager=()=>ei(this.layerManager),this.getPhaseManager=()=>ei(this.phaseManager),this.getEscapeManager=()=>ei(this.escapeManager),this.getCollectibleManager=()=>ei(this.collectibleManager),this.getAchievementManager=()=>ei(this.achievementManager),this.getToolbarManager=()=>ei(this.toolbarManager),this.getDashboardManager=()=>ei(this.dashboardManager),this.preloadImageMap=new Map,this.preloadSoundMap=new Map,this.preloadSpritesheetMap=new Map,this.studentCode=Ao}init(){zo.getInstance().setCurrentSceneRef(this),this.studentCode=zo.getInstance().getRoomCode(),this.createContext()}preload(){la(this),this.verifCont=(e=>{const t=new Phaser.GameObjects.Container(e,0,0),n=new Phaser.GameObjects.Rectangle(e,0,0,Io.tag.width,Io.tag.height,Os.darkBlue).setOrigin(0,.5).setAlpha(.8),s=new Phaser.GameObjects.Sprite(e,0,0,Ws.verifiedFrame.key).setOrigin(0,.5),i=new Phaser.GameObjects.Rectangle(e,0,.5*-n.height,n.width,.05*n.height,Os.offWhite).setOrigin(0,0),a=_s(e,Io.verifiedText,Io.hoverTagTextConfig,_o).setBlendMode(Phaser.BlendModes.DIFFERENCE);return e.tweens.add({targets:i,alpha:.2,y:.35*n.height,duration:2e3,ease:"Power0",yoyo:!0,loop:-1}),t.add([n,a,i,s]),t.setVisible(!1),t})(this)}async create(){await this.eval(this.studentCode),this.renderDefaultBackground(),await this.eval("preload();"),await Promise.all(Array.from(this.preloadImageMap).map((async e=>{let[t,n]=e;await Ar(this,t,n)}))),await Promise.all(Array.from(this.preloadSoundMap).map((async e=>{let[t,n]=e;var s,i,a;await(s=this,i=t,a=n,new Promise((e=>{null!==s.sound.get(i)?e(i):(s.load.audio(i,a).on("filecomplete",e),s.load.start())})))}))),await Promise.all(Array.from(this.preloadSpritesheetMap).map((async e=>{let[t,[n,s]]=e;await((e,t,n,s)=>new Promise((i=>{"__MISSING"!==e.textures.get(t).key?i(t):(e.load.spritesheet(t,n,s),e.load.once(`filecomplete-spritesheet-${t}`,i),e.load.once("loaderror",i),e.load.start())})))(this,t,n,s)})));const e=new As(this,Io.refreshButton.x-200,Io.refreshButton.y-30,"Refresh Room"),t=Si(this,{assetKey:Ws.chapterRepeatButton.key,onUp:async()=>{await zo.getInstance().loadRoomCode(),this.studentCode=zo.getInstance().getRoomCode(),this.getLayerManager().clearAllLayers(),this.sound.stopAll(),this.scene.restart()},onHover:()=>e.setVisible(!0),onOut:()=>e.setVisible(!1)}).setPosition(Io.refreshButton.x,Io.refreshButton.y);await this.eval("create();"),zo.getInstance().getSoundManager().playBgMusic(vs.nullInteractionId),this.initialiseManagers(),this.bindKeyboardTriggers(),this.getLayerManager().addToLayer(zs.UI,this.getVerifCont()),this.getLayerManager().addToLayer(zs.UI,t),this.getLayerManager().addToLayer(zs.UI,e),this.getToolbarManager().renderToolbarContainer()}update(){this.eval("update();")}createContext(){this.context=Object(ko.a)([],"playground",N.Variant.DEFAULT),this.context.moduleContexts.game={tabs:null,state:{scene:this,preloadImageMap:this.preloadImageMap,preloadSoundMap:this.preloadSoundMap,preloadSpritesheetMap:this.preloadSpritesheetMap,remotePath:e=>Zs(e,!0),screenSize:ys,createAward:(e,t,n)=>this.createAward(e,t,n)}}}async eval(e){await Object(To.runInContext)(e,this.context)}bindKeyboardTriggers(){this.getInputManager().registerKeyboardListener(Phaser.Input.Keyboard.KeyCodes.ESC,"up",(async()=>{this.getPhaseManager().isCurrentPhaseTerminal()?await this.getPhaseManager().popPhase():await this.getPhaseManager().pushPhase(ki.EscapeMenu)})),this.getInputManager().registerKeyboardListener(Phaser.Input.Keyboard.KeyCodes.TAB,"up",(async()=>{this.getPhaseManager().isCurrentPhase(ki.Dashboard)?await this.getPhaseManager().popPhase():this.getPhaseManager().isCurrentPhaseTerminal()?await this.getPhaseManager().swapPhase(ki.Dashboard):await this.getPhaseManager().pushPhase(ki.Dashboard)}))}cleanUp(){this.getInputManager().clearListeners(),this.getLayerManager().clearAllLayers()}createAward(e,t,n){const s=this.getUserStateManager().getAchievements(),i=this.getUserStateManager().getCollectibles(),a=new Phaser.GameObjects.Sprite(this,e,t,Ws.cookies.key);if(!s.includes(n)&&!i.includes(n))return a;const r=Fs(n);if(!r.completed)return a;const o=new Phaser.GameObjects.Sprite(this,e,t,r.assetKey);return this.attachVerificationTag(o)}attachVerificationTag(e){const t=this.getVerifCont();return e.setInteractive({pixelPerfect:!0,useHandCursor:!0}),e.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OVER,(()=>t.setVisible(!0))),e.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(()=>t.setVisible(!1))),e.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_MOVE,(e=>{t.x=e.x+10,t.y=e.y-10})),e}renderDefaultBackground(){const e=new Phaser.GameObjects.Image(this,js.x,js.y,this.getDefaultBackgroundKey());Fi(e,ys.x,ys.y),this.add.existing(e)}getDefaultBackgroundKey(){const e=this.getUserStateManager().getAssessments().reverse(),t=zo.getInstance().getRoomPreviewMapping();for(let n=0;n<e.length;n++)if(t.has(e[n]))return e[n];return Ws.sourceCrashedPod.key}initialiseManagers(){this.layerManager=new Oa(this),this.inputManager=new xa(this),this.phaseManager=new Aa(new Map([[ki.None,new nr]]),this.inputManager),this.escapeManager=new ja(this),this.collectibleManager=new Vi(this,zo.getInstance().getUserStateManager().getCollectibles),this.achievementManager=new Vi(this,zo.getInstance().getUserStateManager().getAchievements),this.toolbarManager=new Fa(this),this.dashboardManager=new Qi(this,[Ki.Collectibles,Ki.Achievements],[this.collectibleManager,this.achievementManager])}}class Lo extends Phaser.Scene{constructor(){super("Settings"),this.bgmVolumeRadioButtons=void 0,this.sfxVolumeRadioButtons=void 0,this.layerManager=void 0,this.getSaveManager=()=>zo.getInstance().getSaveManager(),this.getLayerManager=()=>ei(this.layerManager)}async create(){zo.getInstance().setCurrentSceneRef(this),this.layerManager=new Oa(this),this.renderBackground(),this.renderOptions()}renderBackground(){const e=new Phaser.GameObjects.Image(this,js.x,js.y,Ws.spaceshipBg.key),t=new Phaser.GameObjects.Image(this,js.x,js.y,Ws.settingBanner.key);this.getLayerManager().addToLayer(zs.Background,e),this.getLayerManager().addToLayer(zs.Background,t)}renderOptions(){const e=new Phaser.GameObjects.Container(this,0,0),t=this.getSettingsHeader(),n=ws({direction:Ss.Column,numOfItems:t.length,maxYSpace:ma.opt.ySpace});e.add(t.map(((e,t)=>this.createOptionHeader(e,n[t][1]))));const{bgmVolume:s,sfxVolume:i}=this.getSaveManager().getSettings(),a=ma.volContainerOpts.findIndex((e=>parseFloat(e)===i)),r=ma.volContainerOpts.findIndex((e=>parseFloat(e)===s));this.sfxVolumeRadioButtons=this.createOptRadioOptions(a,n[0][1]),this.bgmVolumeRadioButtons=this.createOptRadioOptions(r,n[1][1]);const o=Si(this,{assetKey:Ws.mediumButton.key,message:"Apply Settings",textConfig:{x:0,y:0,oriX:.33,oriY:.85},bitMapTextStyle:ga,onUp:()=>this.applySettings()}).setPosition(js.x,.925*ys.y),c=new $a(this,(()=>{this.getLayerManager().clearAllLayers(),this.scene.start("MainMenu")}));this.getLayerManager().addToLayer(zs.UI,e),this.getLayerManager().addToLayer(zs.UI,this.sfxVolumeRadioButtons),this.getLayerManager().addToLayer(zs.UI,this.bgmVolumeRadioButtons),this.getLayerManager().addToLayer(zs.UI,o),this.getLayerManager().addToLayer(zs.UI,c)}getSettingsHeader(){return["SFX","BGM"]}createOptionHeader(e,t){const n=new Phaser.GameObjects.Container(this,0,t),s=new Phaser.GameObjects.Image(this,js.x,0,Ws.settingOption.key),i=_s(this,e,ma.optHeaderTextConfig,pa);return n.add([s,i]),n}createOptRadioOptions(e,t){return new ua(this,{choices:ma.volContainerOpts,defaultChoiceIdx:e,maxXSpace:ma.opt.xSpace,choiceTextConfig:ma.radioButtonsTextConfig,bitmapTextStyle:ha},ma.opt.x,-js.y+t)}async applySettings(){const e=this.sfxVolumeRadioButtons?parseFloat(this.sfxVolumeRadioButtons.getChosenChoice()):1,t=this.bgmVolumeRadioButtons?parseFloat(this.bgmVolumeRadioButtons.getChosenChoice()):1;await this.getSaveManager().saveSettings({bgmVolume:t,sfxVolume:e}),zo.getInstance().getSoundManager().applyUserSettings(this.getSaveManager().getSettings())}}var Do=Lo;var Bo=class{constructor(){this.soundAssetMap=void 0,this.bgmVol=void 0,this.sfxVol=void 0,this.currBgMusicKey=void 0,this.currBgMusic=void 0,this.getBaseSoundManager=()=>this.getCurrentScene().sound,this.getCurrentScene=()=>ei(zo.getInstance().getCurrentSceneRef()),this.soundAssetMap=new Map,this.bgmVol=1,this.sfxVol=1,this.currBgMusicKey=vs.nullInteractionId}applyUserSettings(e){if(this.bgmVol=void 0!==e.bgmVolume?e.bgmVolume:1,this.sfxVol=void 0!==e.sfxVolume?e.sfxVolume:1,this.currBgMusic&&this.currBgMusic.isPlaying){const e=ei(this.getSoundAsset(this.currBgMusicKey)),t=void 0!==e.config.volume?e.config.volume:1;this.currBgMusic.setVolume(t*this.bgmVol)}}addSoundAsset(e){this.soundAssetMap.set(e.key,e)}getSoundAsset(e){return this.soundAssetMap.get(e)}loadSounds(e){e.forEach((e=>{this.addSoundAsset(e),this.loadSound(e.key,Zs(e.path,!0))}))}loadSoundAssetMap(e){Object.values(e).forEach((e=>{this.addSoundAsset(e),this.loadSound(e.key,Zs(e.path,!1))}))}loadSound(e,t){this.getCurrentScene().load.audio(e,t)}playSound(e){const t=this.getSoundAsset(e);if(t){const e=void 0!==t.config.volume?t.config.volume:1;this.getBaseSoundManager().play(t.key,{...t.config,volume:e*this.sfxVol})}}playBgMusic(e,t){if(!zo.getInstance().isMounted)return;if(this.currBgMusicKey===e)return;if(e===vs.nullInteractionId&&this.currBgMusic)return this.fadeOutAndDestroyMusic(this.currBgMusic,t),this.currBgMusic=void 0,void(this.currBgMusicKey=e);this.currBgMusic&&this.fadeOutAndDestroyMusic(this.currBgMusic);const n=ei(this.getSoundAsset(e)),s=void 0!==n.config.volume?n.config.volume:1;this.currBgMusic=this.getBaseSoundManager().add(n.key,{...n.config,volume:s*this.bgmVol}),this.currBgMusicKey=n.key,this.currBgMusic.play()}fadeOutAndDestroyMusic(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.getCurrentScene().tweens.add({targets:e,...$s,duration:t}),setTimeout((()=>e.destroy()),2*t)}stopAllSound(){this.getBaseSoundManager().stopAll()}pauseCurrBgMusic(){this.getCurrentScene()&&this.currBgMusic&&this.currBgMusic.isPlaying&&this.currBgMusic.pause()}continueCurrBgMusic(){this.getCurrentScene()&&this.currBgMusic&&this.currBgMusic.isPaused&&this.currBgMusic.play()}};var Uo=[{title:"Spaceship Emergency",imageUrl:"/locations/planet-y-orbit/crashing.png",filenames:["../../assets/mockChapter0.txt","../../assets/mockChapter0.1.txt"]},{title:"Alien Attack",imageUrl:"/locations/telebay/emergency.png",filenames:["../../assets/mockChapter1.txt"]},{title:"Jedi Master",imageUrl:"/locations/classroom/normal.png",filenames:["../../assets/mockChapter2.txt"]}];class Go{static parse(e){Go.awardsMapping=new Map;const t=ta.splitToLines(e);return ta.splitToParagraph(t).forEach((e=>{let[,t]=e;Go.parseAwardParagraphs(t)})),this.awardsMapping}static parseAwardParagraphs(e){ta.splitToParagraph(e).forEach((e=>{let[t,n]=e;const[s,i,a,r]=ta.splitWithLimit(n[0],",",3);Go.awardsMapping.set(t,{id:t,assetKey:s,assetPath:Zs(i,!0),title:a,description:r,completed:!0})}))}}Go.awardsMapping=void 0;var Fo=Go;class Ho{static parse(e){Ho.backgroundMapping=new Map;const t=ta.splitToLines(e);return ta.splitToParagraph(t).forEach((e=>{let[t,n]=e;Ho.backgroundMapping.set(t,Zs(n[0],!0))})),Ho.backgroundMapping}}Ho.backgroundMapping=void 0;var Vo=Ho;class Wo extends Phaser.Scene{constructor(){super("Entry")}async preload(){zo.getInstance().setCurrentSceneRef(this),this.preloadAssets(),la(this),await zo.getInstance().loadGameChapters(),await zo.getInstance().loadRoomCode(),await zo.getInstance().getSaveManager().loadLastSaveState()}async create(){await this.preloadAwards(),await zo.getInstance().getUserStateManager().loadUserState(),await this.preloadRoomPreviewBackgrounds(),this.applyLoadedSettings(),this.scene.start("MainMenu")}applyLoadedSettings(){const e=zo.getInstance().getSaveManager().getSettings();zo.getInstance().getSoundManager().applyUserSettings(e)}async preloadAwards(){const e=this.cache.text.get(Br.awardsMapping.key)||"",t=Fo.parse(e);zo.getInstance().setAwardsMapping(t),await Promise.all(Array.from(t.values()).map((async e=>await Ar(this,e.assetKey,e.assetPath))))}async preloadRoomPreviewBackgrounds(){const e=this.cache.text.get(Br.roomPreviewMapping.key)||"",t=Vo.parse(e);zo.getInstance().setRoomPreviewMapping(t),await Promise.all(Array.from(t.entries()).map((async e=>{let[t,n]=e;return await Ar(this,t,n)})))}preloadAssets(){zo.getInstance().getSoundManager().loadSoundAssetMap(qs),Object.values(Ws).forEach((e=>this.load.image(e.key,Zs(e.path,!1)))),Object.values(fs).forEach((e=>this.load.bitmapFont(e.key,e.pngPath,e.fntPath))),Object.values(Br).forEach((e=>this.load.text(e.key,e.path)))}}var $o=Wo;class Xo{constructor(){this.collectibles=void 0,this.achievements=void 0,this.assessments=void 0,this.getCollectibles=()=>Array.from(this.collectibles),this.getAchievements=()=>Array.from(this.achievements),this.getAssessments=()=>Array.from(this.assessments),this.collectibles=new Set([]),this.achievements=new Set([]),this.assessments=new Set([])}async loadUserState(){zo.getInstance().isGameType(qo.Simulator)||(await this.loadAchievements(),await this.loadAssessments(),this.collectibles=new Set(zo.getInstance().getSaveManager().getLoadedUserState().collectibles))}addCollectible(e){this.collectibles.add(e)}async loadAssessments(){const e=await Object(No.k)(zo.getInstance().getAccountInfo());this.assessments=new Set((e||[]).filter((e=>"submitted"===e.status)).sort(((e,t)=>e.closeAt<=t.closeAt?-1:1)).map((e=>e.id.toString())))}async isInUserState(e,t){if(zo.getInstance().isGameType(qo.Game))return this[e].has(t);return 0===await Ti(Ii.getInstance().getGameManager(),`${ta.capitalize(e)} ${t}?`,["Yes","No"])}async loadAchievements(){const e=zo.getInstance().getAwardsMapping(),t=zo.getInstance().getAchievements(),n=zo.getInstance().getGoals(),s=new Map;n.forEach((e=>s.set(e.uuid,e))),t.forEach((t=>{const n=t.uuid.toString(),i=t.goalUuids.reduce(((e,t)=>{var n;return e&&!(null===(n=s.get(t))||void 0===n||!n.completed)}),!0),a=e.get(n);if(a){const e={...a,completed:i};zo.getInstance().addAwardMapping(e.assetKey,e),this.achievements.add(e.assetKey)}}))}}let qo;!function(e){e.Simulator="Simulator",e.Game="Game"}(qo||(qo={}));class zo extends bs.Game{constructor(e,t){super(e),this.global=void 0,this.isMounted=void 0,this.getAwardsMapping=()=>ei(this.global.awardsMapping),this.getAccountInfo=()=>ei(this.global.accountInfo),this.getAchievements=()=>ei(this.global.achievements),this.getSoundManager=()=>ei(this.global.soundManager),this.getGoals=()=>ei(this.global.goals),this.getRoomPreviewMapping=()=>ei(this.global.roomPreviewMapping),this.getUserStateManager=()=>ei(this.global.userStateManager),this.getSaveManager=()=>ei(this.global.saveManager),this.getCurrentSceneRef=()=>ei(this.global.currentSceneRef),this.isGameType=e=>this.global.gameType===e,this.getSSChapterSimFilenames=()=>this.global.ssChapterSimFilenames,this.getIsUsingMock=()=>this.global.isUsingMock,this.getRoomCode=()=>this.global.roomCode,this.getGameChapters=()=>this.global.isUsingMock?Uo:this.global.gameChapters,zo.instance=this,this.isMounted=!0,this.global={awardsMapping:new Map,accountInfo:void 0,achievements:void 0,currentSceneRef:void 0,gameChapters:[],gameType:t,goals:void 0,isUsingMock:!1,roomCode:"",roomPreviewMapping:new Map,saveManager:new cr,setStorySimState:vs.nullFunction,soundManager:new Bo,ssChapterSimFilenames:[],userStateManager:new Xo}}stopAllSounds(){this.sound.stopAll()}setAccountInfo(e){this.global.accountInfo=e}setAchievements(e){this.global.achievements=e}setAwardsMapping(e){this.global.awardsMapping=e}addAwardMapping(e,t){this.global.awardsMapping.set(e,t)}setGoals(e){this.global.goals=e}setStorySimStateSetter(e){this.setStorySimState=e}setRoomPreviewMapping(e){this.global.roomPreviewMapping=e}async loadGameChapters(){this.global.gameChapters=await async function(){const e=Ks.a.getState().session.courseId,t=await Object(No.U)(`courses/${e}/stories`,"GET",{accessToken:zo.getInstance().getAccountInfo().accessToken,refreshToken:zo.getInstance().getAccountInfo().refreshToken,shouldAutoLogout:!1,shouldRefresh:!0});if(!t)return[];const n=200===t.status?await t.json():[],s=k.a.sortBy(n,(e=>new Date(e.openAt)));return s.forEach((e=>e.filenames=e.filenames.map(Mr))),s}()}async loadRoomCode(){this.global.roomCode=await Po()}setStorySimState(e){this.global.setStorySimState(e)}setCurrentSceneRef(e){this.global.currentSceneRef=e}toggleUsingMock(e){this.global.isUsingMock=void 0===e?!this.global.isUsingMock:e}setChapterSimStack(e){this.global.ssChapterSimFilenames=e.reverse()}}zo.instance=void 0,zo.getInstance=()=>ei(zo.instance);const Yo={debug:!0,type:bs.CANVAS,width:ys.x,height:ys.y,physics:{default:"arcade"},scale:{mode:bs.Scale.FIT,parent:"game-display"},fps:{target:24},scene:[$o,Eo,Do,fo,or,Oo,Sr,Mo,kr]};async function Ko(e){if("student"!==zo.getInstance().getAccountInfo().role)return;const t={method:"PUT",headers:Qo(zo.getInstance().getAccountInfo().accessToken),body:JSON.stringify({gameStates:e})},n=await fetch(`${we.b.backendUrl}/v2/courses/${ti()}/user/game_states`,t);return n&&n.ok?n:void 0}function Qo(e){const t=new Headers;return t.append("Accept","application/json"),t.append("Authorization",`Bearer ${e}`),t.append("Content-Type","application/json"),t}var Jo=function(){const e=Object(x.f)((e=>e.session)),t=Object(r.c)(),n=Object(x.f)((e=>e.achievement.achievements)),s=Object(x.f)((e=>e.achievement.goals)),[i,a]=f.useState(!1),[o,c]=f.useState(!1);return f.useEffect((()=>{t(Object(Je.getAchievements)()),t(Object(Je.getOwnGoals)())}),[t]),f.useEffect((()=>{const e=new zo(Yo,qo.Game);return()=>{e.isMounted=!1,e.stopAllSounds(),e.destroy(!0)}}),[]),f.useEffect((()=>{zo.getInstance().setAccountInfo({accessToken:e.accessToken,refreshToken:e.refreshToken,role:e.role,name:e.name}),zo.getInstance().setAchievements(n),zo.getInstance().setGoals(s)}),[e,n,s]),Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("div",{id:"game-display"}),i&&Object(ne.jsxs)("div",{className:"Horizontal",children:[Object(ne.jsx)("button",{onClick:async()=>{await Ko({}),alert("Game cleared! Please refresh")},children:"Clear data"}),Object(ne.jsx)("button",{onClick:()=>{c(!o),zo.getInstance().toggleUsingMock()},children:o?"Use Game Chapters":"Use Mock Chapters"})]})]})},Zo=n(336);function ec(e){return t=>Object(ne.jsx)(h.a,{onClick:n=>{try{e.onClick&&e.onClick(n)}catch(s){throw n.preventDefault(),s}n.defaultPrevented||0!==n.button||e.target&&"_self"!==e.target||n.metaKey||n.altKey||n.ctrlKey||n.shiftKey||(n.preventDefault(),t.navigate())},href:t.href,...e})}function tc(e){let{to:t,replace:n,...s}=e;return Object(ne.jsx)(A.a,{to:t,replace:n,component:ec(s)})}var nc=e=>{const t=e.courseRegId&&e.courseRegId===e.data.studentId,n=t||"submitted"===e.data.submissionStatus,s="submitted"===e.data.submissionStatus&&e.courseRegId&&(e.courseRegId===e.data.groupLeaderId||t||e.role===O.a.Admin);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(tc,{to:`/courses/${e.courseId}/grading/${e.data.submissionId}`,icon:"annotation",minimal:!0,title:"Grade"}),Object(ne.jsx)(h.b,{icon:"refresh",minimal:!0,onClick:async()=>{await Object(st.b)({contents:Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("p",{children:"Reautograde this submission?"}),Object(ne.jsx)("p",{children:"Note: all manual adjustments will be reset to 0."})]}),positiveIntent:"danger",positiveLabel:"Reautograde"})&&e.handleReautogradeSubmission(e.data.submissionId)},disabled:!n,title:"Reautograde"}),Object(ne.jsx)(h.b,{icon:"arrow-left",minimal:!0,onClick:async()=>{await Object(st.b)({contents:"Are you sure you want to unsubmit?",positiveIntent:"danger",positiveLabel:"Unsubmit"})&&e.handleUnsubmitSubmission(e.data.submissionId)},disabled:!s,title:"Unsubmit"})]})};var sc=e=>{let t,n,s;switch(e.data.gradingStatus){case H.c.graded:t=C.a.TICK,n=`Fully graded: ${e.data.gradedCount} of\n          ${e.data.questionCount}`,s=g.a.SUCCESS;break;case H.c.grading:t=C.a.TIME,n=`Partially graded: ${e.data.gradedCount} of\n          ${e.data.questionCount}`,s=g.a.WARNING;break;case H.c.none:t=C.a.CROSS,n=`Not graded: ${e.data.gradedCount} of\n          ${e.data.questionCount}`,s=g.a.DANGER;break;default:t=C.a.DISABLE,n="Not applicable",s=g.a.PRIMARY}return Object(ne.jsx)("div",{children:Object(ne.jsx)(E.a,{content:n,placement:w.a.LEFT,hoverOpenDelay:10,lazy:!0,children:Object(ne.jsx)(h.w,{icon:t,intent:s})})})},ic=n(322),ac=n.n(ic);const rc="grading-editor-button",oc={header:[C.a.HEADER,"Header Styles"],bold:[C.a.BOLD,"Bold"],italic:[C.a.ITALIC,"Italic"],strikethrough:[C.a.STRIKETHROUGH,"Strikethrough"],link:[C.a.LINK,"Link"],quote:[C.a.CITATION,"Quote"],code:[C.a.CODE,"Monospaced"],image:[C.a.MEDIA,"Image"],"unordered-list":[C.a.UNGROUP_OBJECTS,"Bullets"],"ordered-list":[C.a.NUMBERED_LIST,"Numbering"],"checked-list":[C.a.SQUARE,"Checkboxes"]},cc=e=>{switch(e){case"header":case"bold":case"italic":case"strikethrough":case"link":case"quote":case"code":case"image":case"unordered-list":case"ordered-list":case"checked-list":const[t,n]=oc[e];return{iconName:t,title:n};default:return{iconName:C.a.HELP}}};var lc=e=>{const[t,n]=Object(f.useState)(e.xpAdjustment.toString()),[s,i]=Object(f.useState)(e.comments),[a,r]=Object(f.useState)("write"),[c,l]=Object(f.useState)(!1);Object(f.useEffect)((()=>{d()}),[e.submissionId,e.questionId]);const d=()=>{n(e.xpAdjustment.toString()),i(e.comments),r("write"),l(!1)};const u=n=>()=>{const i=Object(Ee.b)(t||void 0)||void 0,a=e.initialXp+(i||0);a<0||a>e.maxXp?Object(me.e)(`XP ${a.toString()} is out of bounds. Maximum xp is ${e.maxXp.toString()}.`):n(e.submissionId,e.questionId,i,s)},p=()=>{const n=Object(Ee.b)(t||void 0);return e.xpAdjustment!==n||e.comments!==s},m=p(),b={intent:m?g.a.WARNING:g.a.NONE,minimal:!m,className:rc},v={intent:m?g.a.DANGER:g.a.NONE,minimal:!m,className:rc},y={intent:m?g.a.SUCCESS:g.a.NONE,minimal:!m,className:rc},j=e.initialXp+(Object(Ee.b)(t||void 0)||0),x=`${e.initialXp>0?"-":""}${e.initialXp} to ${e.maxXp-e.initialXp}`;return Object(ne.jsxs)("div",{className:"GradingEditor",children:[!c&&m?Object(ne.jsx)(o.a,{message:"You have unsaved changes. Are you sure you want to leave?"}):null,Object(ne.jsx)("div",{className:"grading-editor-header",children:Object(ne.jsxs)(h.q,{children:["Currently Grading: ",e.studentName]})}),null!==e.solution?Object(ne.jsx)("div",{className:"grading-editor-marking-scheme",children:Object(ne.jsxs)(h.M,{children:[e.solution.toString()," "]})}):null,Object(ne.jsx)("div",{className:"grading-editor-container",children:Object(ne.jsxs)("div",{className:"grading-editor-xp",children:[Object(ne.jsxs)("div",{className:"autograder-xp",children:[Object(ne.jsx)("div",{children:"Autograder XP:"}),Object(ne.jsxs)("div",{children:[`${e.initialXp} / ${e.maxXp}`," ",Object(ne.jsx)(h.b,{icon:"refresh",small:!0,minimal:!0,onClick:async()=>{await Object(st.b)({contents:Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("p",{children:"Reautograde this answer?"}),Object(ne.jsx)("p",{children:"Note: manual adjustments will be reset to 0."})]}),positiveLabel:"Reautograde",positiveIntent:"danger"})&&e.handleReautogradeAnswer(e.submissionId,e.questionId)}})]})]}),Object(ne.jsxs)("div",{className:"xp-adjustment",children:[Object(ne.jsx)("div",{children:"XP adjustment:"}),Object(ne.jsx)("div",{children:Object(ne.jsx)(h.H,{className:"adjustment-input",onValueChange:(e,t)=>{n(t)},value:t||"",buttonPosition:w.a.RIGHT,fill:!0,placeholder:x,intent:j<0||j>e.maxXp?g.a.DANGER:g.a.NONE,min:0-e.initialXp,max:e.maxXp>e.initialXp?e.maxXp-e.initialXp:void 0,stepSize:50,minorStepSize:25,majorStepSize:100})})]}),Object(ne.jsxs)("div",{className:"final-xp",children:[Object(ne.jsx)("div",{children:"Final XP:"}),Object(ne.jsx)("div",{children:`${j} / ${e.maxXp}`})]})]})}),Object(ne.jsx)("div",{className:"react-mde-parent",children:Object(ne.jsx)(ac.a,{value:s,onChange:i,selectedTab:a,onTabChange:e=>r(e),generateMarkdownPreview:e=>Promise.resolve(Object(ne.jsx)(ee.a,{content:e,simplifiedAutoLink:!0,strikethrough:!0,tasklists:!0,openLinksInNewWindow:!0})),minEditorHeight:200,maxEditorHeight:1e3,minPreviewHeight:240,getIcon:function(e){const t=cc(e);return Object(ne.jsx)(h.w,{icon:t.iconName,htmlTitle:t.title})}})}),"write"===a&&Object(ne.jsxs)("div",{className:"grading-editor-draft-buttons",children:[Object(ne.jsx)("div",{className:"grading-editor-save-button",children:Object(ne.jsx)(J.a,{label:"Save Changes",icon:C.a.FLOPPY_DISK,onClick:u(e.handleGradingSave),options:b})}),Object(ne.jsx)("div",{className:"grading-editor-discard-button",children:Object(ne.jsx)(J.a,{label:"Discard Changes",icon:C.a.TRASH,onClick:()=>{p()&&!window.confirm("This will reset the editor. Are you sure?")||(n(e.xpAdjustment.toString()),i(e.comments),Object(me.d)("Discarded!",1e3))},options:v})})]}),Object(ne.jsx)("div",{className:"grading-editor-save-continue-button",children:Object(ne.jsx)(J.a,{label:"Save and Continue",icon:C.a.UPDATED,onClick:u(((t,n,s,i)=>{l(!0),e.handleGradingSaveAndContinue(t,n,s,i)})),options:y})}),e.graderName&&e.gradedAt&&Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(h.i,{}),Object(ne.jsxs)("div",{className:"grading-editor-last-graded-details",children:["Last edited by ",Object(ne.jsx)("b",{children:e.graderName})," on ",Ae(e.gradedAt)]})]})]})};var dc=Object(r.b)(null,(e=>Object(c.b)({handleGradingSave:u.submitGrading,handleGradingSaveAndContinue:u.submitGradingAndContinue,handleReautogradeAnswer:u.reautogradeAnswer},e)))(lc);class uc extends f.Component{constructor(e){super(e),this.sideContentProps=(e,t)=>{var n;const s=[{label:`Grading: Question ${t+1}`,iconName:C.a.TICK,body:Object(ne.jsx)(dc,{solution:e.grading[t].question.solution,questionId:e.grading[t].question.id,submissionId:e.submissionId,initialXp:e.grading[t].grade.xp,xpAdjustment:e.grading[t].grade.xpAdjustment,maxXp:e.grading[t].question.maxXp,studentName:e.grading[t].student.name,comments:null!==(n=e.grading[t].grade.comments)&&void 0!==n?n:"",graderName:e.grading[t].grade.grader?e.grading[t].grade.grader.name:void 0,gradedAt:e.grading[t].grade.grader?e.grading[t].grade.gradedAt:void 0}),id:Se.b.grading},{label:`Question ${t+1}`,iconName:C.a.NINJA,body:Object(ne.jsx)(ee.a,{content:e.grading[t].question.content}),id:Se.b.questionOverview},{label:"Autograder",iconName:C.a.AIRPLANE,body:Object(ne.jsx)(de,{testcases:e.editorTestcases,autogradingResults:e.autogradingResults,handleTestcaseEval:this.props.handleTestcaseEval,workspaceLocation:"grading"}),id:Se.b.autograder}];e.grading[t].question.library.external.symbols.includes("get_matrix")&&s.push({label:"Tone Matrix",iconName:C.a.GRID_VIEW,body:Object(ne.jsx)(Oe,{}),id:Se.b.toneMatrix});return{onChange:(e,t,n)=>{e!==t&&this.setState({selectedTab:e})},tabs:{beforeDynamicTabs:s,afterDynamicTabs:[]},workspaceLocation:"grading"}},this.controlBarProps=e=>{const t=`/courses/${this.props.courseId}/grading`,n=t+`/${this.props.submissionId}`,s=[e+1,this.props.grading.length],i=Object(ne.jsx)(X.a,{onClickNext:()=>Ce.a.push(n+`/${(e+1).toString()}`),onClickReturn:()=>Ce.a.push(t),questionProgress:s},"next_question"),a=Object(ne.jsx)(q.a,{onClick:()=>Ce.a.push(n+`/${(e-1).toString()}`),questionProgress:s},"previous_question"),r=Object(ne.jsx)(z.a,{questionProgress:s},"question_view");return{editorButtons:[Object(ne.jsx)(K.a,{handleEditorEval:this.handleEval},"run")],flowButtons:[a,r,i]}},this.state={selectedTab:Se.b.grading},this.handleEval=this.handleEval.bind(this)}componentDidMount(){if(this.props.handleGradingFetch(this.props.submissionId),!this.props.grading)return;let e=this.props.questionId;this.props.questionId>=this.props.grading.length&&(e=this.props.grading.length-1);const t=this.props.grading[e].question;let n="";t.type===H.d.programming&&(n=t.answer?t.answer:t.solutionTemplate||""),this.props.handleEditorValueChange(n)}componentDidUpdate(){if(void 0===this.props.grading)return;const e=this.props.questionId;void 0===this.props.grading[e]?Ce.a.push(`/courses/${this.props.courseId}/grading`):this.checkWorkspaceReset(this.props)}render(){var e,t,n,s,i,a,r,o;if(void 0===this.props.grading)return Object(ne.jsx)(h.G,{className:j()("WorkspaceParent",p.a.DARK),description:"Getting assessment ready...",icon:Object(ne.jsx)(h.R,{size:h.S.LARGE})});const c=this.props.questionId>=this.props.grading.length?this.props.grading.length-1:this.props.questionId,l=this.props.grading[c].question,d={controlBarProps:this.controlBarProps(c),editorContainerProps:l.type===H.d.programming||l.type===H.d.voting?{editorVariant:"normal",editorTabs:this.props.editorTabs.map(Z.a),editorSessionId:"",handleDeclarationNavigate:this.props.handleDeclarationNavigate,handleEditorEval:this.handleEval,handleEditorCheck:()=>{},handleEditorValueChange:this.props.handleEditorValueChange,handleEditorUpdateBreakpoints:this.props.handleEditorUpdateBreakpoints,handlePromptAutocomplete:this.props.handlePromptAutocomplete,isEditorAutorun:!1,sourceChapter:N.Chapter.CALC,sourceVariant:null!==(e=null===l||void 0===l||null===(t=l.library)||void 0===t?void 0:t.variant)&&void 0!==e?e:N.Variant.DEFAULT,externalLibraryName:(null===l||void 0===l||null===(n=l.library)||void 0===n||null===(s=n.external)||void 0===s?void 0:s.name)||"NONE"}:void 0,handleSideContentHeightChange:this.props.handleSideContentHeightChange,mcqProps:{mcq:l,handleMCQSubmit:e=>{}},sideBarProps:{tabs:[]},sideContentHeight:this.props.sideContentHeight,sideContentProps:this.sideContentProps(this.props,c),replProps:{handleBrowseHistoryDown:this.props.handleBrowseHistoryDown,handleBrowseHistoryUp:this.props.handleBrowseHistoryUp,handleReplEval:this.props.handleReplEval,handleReplValueChange:this.props.handleReplValueChange,output:this.props.output,replValue:this.props.replValue,sourceChapter:N.Chapter.CALC,sourceVariant:null!==(i=null===l||void 0===l||null===(a=l.library)||void 0===a?void 0:a.variant)&&void 0!==i?i:N.Variant.DEFAULT,externalLibrary:(null===l||void 0===l||null===(r=l.library)||void 0===r||null===(o=r.external)||void 0===o?void 0:o.name)||"NONE",replButtons:this.replButtons()}};return Object(ne.jsx)("div",{className:j()("WorkspaceParent",p.a.DARK),children:Object(ne.jsx)(Te.a,{...d})})}checkWorkspaceReset(e){var t;const n=e.submissionId,s=e.questionId;if(e.storedSubmissionId===n&&e.storedQuestionId===s)return;const i=e.grading[s].question;let a=[],r="",o="",c="",l=[];if(i.type===H.d.programming){const e=i;a=e.autogradingResults,o=e.prepend,c=e.postpend,l=e.testcases,r=e.answer,r||(r=e.solutionTemplate)}e.handleEditorUpdateBreakpoints([]),e.handleUpdateCurrentSubmissionId(n,s),e.handleResetWorkspace({autogradingResults:a,editorTabs:[{value:r,prependValue:o,postpendValue:c,highlightedLines:[],breakpoints:[]}],editorTestcases:l}),e.handleChangeExecTime(null!==(t=i.library.execTimeMs)&&void 0!==t?t:O.l.grading.execTime),e.handleClearContext(i.library,!0),e.handleUpdateHasUnsavedChanges(!1),r&&e.handleEditorValueChange(r)}replButtons(){const e=Object(ne.jsx)(W.a,{handleReplOutputClear:this.props.handleReplOutputClear},"clear_repl");return[Object(ne.jsx)($.a,{handleReplEval:this.props.handleReplEval,isRunning:this.props.isRunning},"eval_repl"),e]}handleEval(){this.props.handleEditorEval(),this.state.selectedTab===Se.b.autograder&&this.props.handleRunAllTestcases()}}var hc=uc;const pc="grading";var gc=Object(r.b)(((e,t)=>({autogradingResults:e.workspaces.grading.autogradingResults,activeEditorTabIndex:e.workspaces.grading.activeEditorTabIndex,editorTabs:e.workspaces.grading.editorTabs,editorTestcases:e.workspaces.grading.editorTestcases,grading:e.session.gradings.get(t.submissionId),hasUnsavedChanges:e.workspaces.grading.hasUnsavedChanges,isRunning:e.workspaces.grading.isRunning,isDebugging:e.workspaces.grading.isDebugging,enableDebugging:e.workspaces.grading.enableDebugging,output:e.workspaces.grading.output,replValue:e.workspaces.grading.replValue,sideContentHeight:e.workspaces.grading.sideContentHeight,storedSubmissionId:e.workspaces.grading.currentSubmission,storedQuestionId:e.workspaces.grading.currentQuestion,courseId:e.session.courseId})),(e=>Object(c.b)({handleBrowseHistoryDown:()=>Object(I.browseReplHistoryDown)(pc),handleBrowseHistoryUp:()=>Object(I.browseReplHistoryUp)(pc),handleClearContext:(e,t)=>Object(I.beginClearContext)(pc,e,t),handleDeclarationNavigate:e=>Object(I.navigateToDeclaration)(pc,e),handleEditorEval:()=>Object(I.evalEditor)(pc),handleEditorValueChange:e=>Object(I.updateEditorValue)(e,pc),handleEditorUpdateBreakpoints:e=>Object(I.setEditorBreakpoint)(e,pc),handleGradingFetch:u.fetchGrading,handleInterruptEval:()=>Object(Sn.beginInterruptExecution)(pc),handleReplEval:()=>Object(I.evalRepl)(pc),handleReplOutputClear:()=>Object(I.clearReplOutput)(pc),handleReplValueChange:e=>Object(I.updateReplValue)(e,pc),handleSendReplInputToOutput:e=>Object(I.sendReplInputToOutput)(e,pc),handleResetWorkspace:e=>Object(I.resetWorkspace)(pc,e),handleChangeExecTime:e=>Object(I.changeExecTime)(e,pc),handleSideContentHeightChange:e=>Object(I.changeSideContentHeight)(e,pc),handleTestcaseEval:e=>Object(I.evalTestcase)(pc,e),handleRunAllTestcases:()=>Object(I.runAllTestcases)(pc),handleUpdateCurrentSubmissionId:I.updateCurrentSubmissionId,handleUpdateHasUnsavedChanges:e=>Object(I.updateHasUnsavedChanges)(pc,e),handleDebuggerPause:()=>Object(Sn.beginDebuggerPause)(pc),handleDebuggerResume:()=>Object(Sn.debuggerResume)(pc),handleDebuggerReset:()=>Object(Sn.debuggerReset)(pc),handlePromptAutocomplete:(e,t,n)=>Object(I.promptAutocomplete)(pc,e,t,n)},e)))(hc);var mc=e=>{if(e.data.maxXp||e.data.xpBonus){const t=`Initial XP: ${e.data.initialXp}\n        (${e.data.xpBonus>0?`+${e.data.xpBonus} bonus `:""}\n        ${e.data.xpAdjustment>=0?"+":""}${e.data.xpAdjustment} adj.)`;return Object(ne.jsx)("div",{children:Object(ne.jsx)(E.a,{content:t,placement:w.a.LEFT,hoverOpenDelay:10,lazy:!0,children:`${e.data.currentXp+e.data.xpBonus} / ${e.data.maxXp}`})})}return Object(ne.jsx)("div",{children:"No Exp"})};class bc extends f.Component{constructor(e){super(e),this.columnDefs=void 0,this.defaultColumnDefs=void 0,this.gridApi=void 0,this.GradingStatus=e=>Object(ne.jsx)(sc,{data:e.data}),this.NotificationBadgeCell=e=>Object(ne.jsx)(Ve,{notificationFilter:Be(e.data.submissionId)}),this.GradingExp=e=>Object(ne.jsx)(mc,{data:e.data}),this.resizeGrid=()=>{this.gridApi&&this.gridApi.sizeColumnsToFit()},this.updatePaginationState=()=>{if(this.gridApi){const e=this.gridApi.paginationGetTotalPages(),t=0===e?0:this.gridApi.paginationGetCurrentPage()+1;this.setState({currPage:t,maxPages:e,rowCountString:this.formatRowCountString(25,t,e,this.gridApi.paginationGetRowCount()),isBackDisabled:0===e||1===t,isForwardDisabled:0===e||t===e})}},this.formatRowCountString=(e,t,n,s)=>0===n?"(none)":t!==n?`(#${e*t-24} - #${e*t})`:`(#${e*t-24} - #${s})`,this.handleFilterKeypress=e=>{"Enter"===e.key&&this.applyFilter(e.currentTarget.value)},this.handleApplyFilter=e=>{this.applyFilter(e.target.value)},this.handleGroupsFilter=()=>{this.gridApi&&(this.setState({groupFilterEnabled:!this.state.groupFilterEnabled}),this.props.handleFetchGradingOverviews(this.state.groupFilterEnabled))},this.applyFilter=e=>{var t;null===(t=this.gridApi)||void 0===t||t.setQuickFilter(e)},this.onGridReady=e=>{this.gridApi=e.api,this.gridApi.sizeColumnsToFit(),this.updatePaginationState()},this.exportCSV=()=>{this.gridApi&&this.gridApi.exportDataAsCsv({fileName:`SA submissions (${(new Date).toISOString()}).csv`,columnKeys:["assessmentName","assessmentCategory","studentName","groupName","submissionStatus","gradingStatus","questionCount","gradedCount","initialGrade","gradeAdjustment","currentGrade","maxGrade","initialXp","xpAdjustment","currentXp","maxXp","xpBonus"]})},this.changePaginationView=e=>()=>{if(this.gridApi)switch(e){case"first":return this.gridApi.paginationGoToFirstPage();case"prev":return this.gridApi.paginationGoToPreviousPage();case"next":return this.gridApi.paginationGoToNextPage();case"last":return this.gridApi.paginationGoToLastPage()}},this.sortSubmissionsByNotifications=()=>this.props.gradingOverviews?this.props.gradingOverviews.map((e=>({...e,notifications:Be(e.submissionId)(this.props.notifications)}))).sort(((e,t)=>t.notifications.length-e.notifications.length)):[],this.columnDefs=[{headerName:"",field:"notifications",cellRendererFramework:this.NotificationBadgeCell,width:30,filter:!1,resizable:!1,sortable:!1,suppressSizeToFit:!0},{headerName:"Assessment Name",field:"assessmentName"},{headerName:"Category",field:"assessmentType",maxWidth:100},{headerName:"Student Name",field:"studentName"},{headerName:"Group",field:"groupName",maxWidth:100},{headerName:"Status",field:"submissionStatus",maxWidth:100,valueFormatter:e=>{const t=e.value;return t.charAt(0).toUpperCase()+t.slice(1)},cellStyle:e=>"submitted"===e.data.submissionStatus?{backgroundColor:Zo.Colors.GREEN5}:{backgroundColor:Zo.Colors.RED5}},{headerName:"Grading",field:"gradingStatus",cellRendererFramework:this.GradingStatus,maxWidth:110},{headerName:"XP",field:"",cellRendererFramework:this.GradingExp,maxWidth:100,comparator:(e,t,n,s,i)=>n&&s?n.data.currentXp-s.data.currentXp:e-t},{headerName:"Actions",colId:"Actions",width:120,field:"",cellRendererFramework:nc,cellRendererParams:{courseId:this.props.courseId,courseRegId:this.props.courseRegId,handleUnsubmitSubmission:this.props.handleUnsubmitSubmission,handleReautogradeSubmission:this.props.handleReautogradeSubmission,role:this.props.role},filter:!1,resizable:!1,sortable:!1,suppressSizeToFit:!0,cellStyle:{padding:0}},{headerName:"Question Count",field:"questionCount",hide:!0},{headerName:"Questions Graded",field:"gradedCount",hide:!0},{headerName:"Initial Grade",field:"initialGrade",hide:!0},{headerName:"Grade Adjustment",field:"gradeAdjustment",hide:!0},{headerName:"Initial XP",field:"initialXp",hide:!0},{headerName:"XP Adjustment",field:"xpAdjustment",hide:!0},{headerName:"Current Grade",field:"currentGrade",hide:!0},{headerName:"Max Grade",field:"maxGrade",hide:!0},{headerName:"Current XP (excl. bonus)",field:"currentXp",hide:!0},{headerName:"Max XP",field:"maxXp",hide:!0},{headerName:"Bonus XP",field:"xpBonus",hide:!0}],this.defaultColumnDefs={filter:!0,resizable:!0,sortable:!0},this.state={groupFilterEnabled:!1,currPage:1,maxPages:1,rowCountString:"(none)",isBackDisabled:!0,isForwardDisabled:!0}}render(){const e=Object(Ee.b)(this.props.match.params.submissionId),t=Object(Ee.b)(this.props.match.params.questionId)||0;if(null!==e){const n={submissionId:e,questionId:t};return Object(ne.jsx)(gc,{...n})}const n=Object(ne.jsx)(h.G,{className:"Grading",description:"Fetching submissions...",icon:Object(ne.jsx)(h.R,{size:h.S.LARGE})}),s=this.sortSubmissionsByNotifications().map((e=>e.studentName?e:{...e,studentName:"(user has yet to log in)"})),i=Object(ne.jsxs)("div",{className:"grading-controls",children:[Object(ne.jsx)(h.n,{label:"Filter:",labelFor:"text-input",inline:!0,children:Object(ne.jsx)(h.y,{id:"filterBar",large:!1,leftIcon:"filter",placeholder:"Enter any text (e.g. mission)",onKeyPress:this.handleFilterKeypress,onBlur:this.handleApplyFilter})}),Object(ne.jsxs)("div",{className:"GridControls ag-grid-controls",children:[Object(ne.jsx)("div",{className:"left-controls",children:Object(ne.jsx)(h.b,{active:this.state.groupFilterEnabled,icon:C.a.GIT_REPO,intent:this.state.groupFilterEnabled?g.a.PRIMARY:g.a.NONE,onClick:this.handleGroupsFilter,children:Object(ne.jsx)("span",{className:"hidden-xs",children:"Show all groups"})})}),Object(ne.jsxs)("div",{className:"centre-controls",children:[Object(ne.jsx)(h.b,{icon:C.a.CHEVRON_BACKWARD,onClick:this.changePaginationView("first"),minimal:!0,disabled:this.state.isBackDisabled}),Object(ne.jsx)(h.b,{icon:C.a.CHEVRON_LEFT,onClick:this.changePaginationView("prev"),minimal:!0,disabled:this.state.isBackDisabled}),Object(ne.jsxs)(h.b,{className:"pagination-details hidden-xs",disabled:!0,minimal:!0,children:[Object(ne.jsx)("div",{children:`Page ${this.state.currPage} of ${this.state.maxPages}`}),Object(ne.jsx)("div",{children:this.state.rowCountString})]}),Object(ne.jsx)(h.b,{icon:C.a.CHEVRON_RIGHT,onClick:this.changePaginationView("next"),minimal:!0,disabled:this.state.isForwardDisabled}),Object(ne.jsx)(h.b,{icon:C.a.CHEVRON_FORWARD,onClick:this.changePaginationView("last"),minimal:!0,disabled:this.state.isForwardDisabled})]}),Object(ne.jsx)("div",{className:"right-controls",children:Object(ne.jsx)(h.b,{icon:C.a.EXPORT,onClick:this.exportCSV,children:Object(ne.jsx)("span",{className:"hidden-xs",children:"Export to CSV"})})})]})]}),a=Object(ne.jsx)("div",{className:"Grid ag-grid-parent ag-theme-balham",children:Object(ne.jsx)(Ln.AgGridReact,{domLayout:"autoHeight",columnDefs:this.columnDefs,defaultColDef:this.defaultColumnDefs,onGridReady:this.onGridReady,onGridSizeChanged:this.resizeGrid,onPaginationChanged:this.updatePaginationState,rowData:s,rowHeight:30,pagination:!0,paginationPageSize:25,suppressCellSelection:!0,suppressMovableColumns:!0,suppressPaginationPanel:!0})}),r=Object(ne.jsxs)("div",{className:"Grading",children:[i,Object(ne.jsx)(h.i,{}),a]});return Object(ne.jsx)("div",{children:Object(ne.jsx)(Me.a,{loadContentDispatch:this.props.handleFetchGradingOverviews,display:void 0===this.props.gradingOverviews?n:r,fullWidth:!1})})}componentDidUpdate(e,t){this.gridApi&&this.props.notifications.length!==e.notifications.length&&this.gridApi.setRowData(this.sortSubmissionsByNotifications())}}var fc=bc;var vc=Object(r.b)((e=>({gradingOverviews:e.session.gradingOverviews,courseRegId:e.session.courseRegId,notifications:e.session.notifications,role:e.session.role,courseId:e.session.courseId})),(e=>Object(c.b)({handleAcknowledgeNotifications:u.acknowledgeNotifications,handleFetchGradingOverviews:u.fetchGradingOverviews,handleUnsubmitSubmission:u.unsubmitSubmission,handleReautogradeSubmission:u.reautogradeSubmission},e)))(fc),yc=n(170);var jc=e=>{const{handleUpdateSublanguage:t}=e,{sourceChapter:n,sourceVariant:s}=e,[i,a]=f.useState(O.n[0]),[r,o]=f.useState(!1),c=f.useCallback((e=>{o(!0),a(e)}),[o,a]),l=f.useCallback((()=>{o(!1)}),[o]),d=f.useCallback((()=>{o(!1),t(i)}),[i,o,t]),u=f.useCallback(((e,t)=>{let{handleClick:n}=t;return Object(ne.jsx)(h.B,{onClick:n,text:e.displayName},e.displayName)}),[]),m=f.useCallback((e=>{let{itemsParentRef:t,renderItem:n}=e;const s=O.h.map(n),i=O.p.map(n);return Object(ne.jsxs)(h.A,{ulRef:t,children:[s,Object(ne.jsx)(h.B,{text:"Variants",icon:"cog",children:i},"variant-menu")]})}),[]),b=ct.a.ofType(),v=Object(ne.jsxs)(h.h,{canEscapeKeyClose:!0,canOutsideClickClose:!0,className:"change-default-lang-dialog",icon:C.a.ERROR,isCloseButtonShown:!0,isOpen:r,onClose:l,title:"Updating default Source sublanguage",children:[Object(ne.jsxs)("div",{className:p.a.DIALOG_BODY,children:["Are you sure you want to update the ",Object(ne.jsx)("b",{children:"default Playground Source sublanguage"})," from"," ",Object(O.o)(n,s)," to ",Object(ne.jsx)("b",{children:i.displayName}),"?"]}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)("div",{className:p.a.DIALOG_FOOTER_ACTIONS,children:[Object(ne.jsx)(J.a,{label:"Cancel",onClick:l,options:{minimal:!1}}),Object(ne.jsx)(J.a,{label:"Confirm",onClick:d,options:{minimal:!1,intent:g.a.DANGER}})]})})]});return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(b,{items:O.n,onItemSelect:c,itemRenderer:u,itemListRenderer:m,filterable:!1,children:Object(ne.jsxs)(h.b,{rightIcon:C.a.DOUBLE_CARET_VERTICAL,children:[Object(ne.jsx)("span",{className:"hidden-xs hidden-sm",children:"Default sublanguage: "}),Object(ne.jsx)("span",{children:Object(O.o)(n,s)})]})}),v]})};var xc=Object(r.b)((e=>({sourceChapter:e.session.sourceChapter||we.b.defaultSourceChapter,sourceVariant:e.session.sourceVariant||we.b.defaultSourceVariant})),(e=>Object(c.b)({handleUpdateSublanguage:I.changeSublanguage},e)))(jc);var Oc=e=>{const[t,n]=f.useState(!1),s=f.useCallback((()=>n(!0)),[]),i=f.useCallback((()=>n(!1)),[]),{handleDeleteAssessment:a,data:r}=e,o=f.useCallback((()=>{const{id:e}=r;a(e),i()}),[r,i,a]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(J.a,{icon:C.a.TRASH,onClick:s}),Object(ne.jsxs)(h.h,{icon:C.a.WARNING_SIGN,isOpen:t,onClose:i,title:"Deleting assessment",canOutsideClickClose:!0,children:[Object(ne.jsxs)("div",{className:p.a.DIALOG_BODY,children:[Object(ne.jsxs)("p",{children:["Are you sure you want to ",Object(ne.jsx)("b",{children:"delete"})," the assessment ",Object(ne.jsx)("i",{children:r.title}),"?"]}),Object(ne.jsx)("p",{children:Object(ne.jsx)("b",{children:"All submissions and their answers will be deleted as well."})})]}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)("div",{className:p.a.DIALOG_FOOTER_ACTIONS,children:[Object(ne.jsx)(J.a,{label:"Cancel",icon:C.a.CROSS,onClick:i,options:{minimal:!1}}),Object(ne.jsx)(J.a,{label:"Confirm",icon:C.a.TRASH,onClick:o,options:{minimal:!1,intent:g.a.DANGER}})]})})]})]})},Sc=n(456);var wc=e=>{const[t,n]=f.useState(void 0),[s,i]=f.useState(!1),[a,r]=f.useState(!1),[o,c]=f.useState(-1);f.useEffect((()=>{e.assessmentConfigurations&&-1===o&&c(e.assessmentConfigurations[0].assessmentConfigId)}),[e.assessmentConfigurations,o]);const{handleUploadAssessment:l}=e,d=f.useMemo((()=>{var t;return null===(t=e.assessmentConfigurations)||void 0===t?void 0:t.map((e=>({value:e.assessmentConfigId,label:e.type})))}),[e.assessmentConfigurations]),u=f.useCallback((()=>{-1!==o?(t&&(l(t,a,o),r(!1)),n(void 0)):Object(me.e)("Please select a valid assessment type before uploading!")}),[t,a,l,o]),p=f.useCallback((()=>n(void 0)),[n]),m=f.useCallback((e=>{n(e[0]),r(!1)}),[n]),b=f.useCallback((e=>{e.length>1&&Object(me.e)("Uploading multiple files at once is not currently supported!",2e3)}),[]),{getRootProps:v,getInputProps:y,isFocused:x,isDragActive:O,isDragAccept:w,isDragReject:E}=Object(Sc.a)({multiple:!1,onDropAccepted:m,onDropRejected:b}),T=f.useMemo((()=>j()("dropzone-base",x||O?"dropzone-active":void 0,w?"dropzone-accept":void 0,E?"dropzone-reject":void 0)),[x,O,w,E]),k=f.useCallback((()=>{a?r(!1):i(!0)}),[a,i,r]),A=f.useMemo((()=>Object(ne.jsx)("div",{className:"toggle-button-wrapper",children:Object(ne.jsx)(h.T,{checked:a,onChange:k})})),[a,k]),_=f.useCallback((()=>{r(!0),i(!1)}),[r]),I=f.useCallback((()=>{i(!1)}),[i]),N=f.useMemo((()=>Object(ne.jsxs)("div",{className:"dropzone-controls",children:[Object(ne.jsx)(J.a,{label:"Yes",icon:C.a.CONFIRM,onClick:_,options:{minimal:!1,intent:g.a.DANGER}}),Object(ne.jsx)(J.a,{label:"No",icon:C.a.CROSS,onClick:I,options:{minimal:!1}})]})),[I,_]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(h.e,{elevation:S.a.TWO,interactive:!0,children:Object(ne.jsxs)("div",{...v({className:T}),children:[Object(ne.jsx)("input",{...y()}),Object(ne.jsx)("p",{children:"Drag 'n' drop a file here, or click to select a file"})]})}),t&&Object(ne.jsxs)(h.e,{className:"dropzone-prompt",elevation:S.a.TWO,interactive:!0,children:[Object(ne.jsx)("h3",{children:null===t||void 0===t?void 0:t.name}),!s&&Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsxs)("div",{className:"dropzone-controls",children:[Object(ne.jsx)(h.u,{options:d,onChange:e=>c(parseInt(e.target.value)),value:o}),Object(ne.jsx)(J.a,{label:"Confirm Upload",icon:C.a.UPLOAD,onClick:u,options:{minimal:!1,intent:g.a.DANGER}}),Object(ne.jsx)(J.a,{label:"Cancel Upload",icon:C.a.DELETE,onClick:p,options:{minimal:!1}})]}),Object(ne.jsxs)("div",{className:"dropzone-controls",children:[Object(ne.jsx)("p",{children:"Force update opened assessment"}),A]})]}),s&&Object(ne.jsx)("p",{children:"Are you sure that you want to force update the assessment?"}),s&&N]})]})},Cc=n(1172);const Ec="YYYY-MM-DD HH:mm:ss ZZ";var Tc=e=>{const t=new Date(2010,0,0),n=new Date(2030,11,31),{data:s,forOpenDate:i}=e,a=i?s.openAt:s.closeAt,r=m(a,m.ISO_8601,!0),[o,c]=f.useState(!1),[l,d]=f.useState(r),u=f.useCallback((()=>c(!0)),[]),b=f.useCallback((()=>c(!1)),[]),{handleAssessmentChangeDate:v}=e,y=f.useCallback((()=>{if(l){const{id:e,openAt:t,closeAt:n}=s;v(e,i?l.toISOString():t,i?n:l.toISOString()),b()}else Object(me.e)("No date and time selected!",2e3),d(r)}),[l,r,s,v,i,b]),j=f.useCallback((e=>d(m(e))),[]),x=f.useCallback((()=>{Object(me.e)("Failed to parse date string! Defaulting to current date.",2e3),d(r)}),[r]),O=Object(ne.jsx)(Cc.a,{formatDate:e=>m(e).format(Ec),onChange:j,onError:x,parseDate:e=>{const t=m(e,Ec,!0);return!!t.isValid()&&t.toDate()},placeholder:`${Ec} or select a date`,value:null===l||void 0===l?void 0:l.toDate(),timePrecision:"second",fill:!0,minDate:t,maxDate:n,closeOnSelection:!1});return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("span",{className:"date-cell-text",children:r.format(Ec)}),Object(ne.jsx)(J.a,{icon:C.a.EDIT,onClick:u}),Object(ne.jsxs)(h.h,{icon:C.a.INFO_SIGN,isOpen:o,onClose:b,title:"Updating assessment settings",canOutsideClickClose:!0,children:[Object(ne.jsxs)("div",{className:p.a.DIALOG_BODY,children:[Object(ne.jsxs)("p",{children:[i?"Opening":"Closing"," date and time:"]}),O]}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)("div",{className:p.a.DIALOG_FOOTER_ACTIONS,children:[Object(ne.jsx)(J.a,{label:"Cancel",icon:C.a.CROSS,onClick:b,options:{minimal:!1}}),Object(ne.jsx)(J.a,{label:"Confirm",icon:C.a.TICK,onClick:y,options:{minimal:!1,intent:g.a.DANGER}})]})})]})]})};var kc=e=>{const{data:t}=e,[n,s]=f.useState(!1),[i]=f.useState(!!t.isPublished),a=f.useCallback((()=>s(!0)),[]),r=f.useCallback((()=>s(!1)),[]),{handlePublishAssessment:o}=e,c=f.useCallback((()=>{const{id:e}=t;o(!i,e),r()}),[t,i,r,o]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(h.T,{className:"publish-cell",checked:i,onChange:a}),Object(ne.jsxs)(h.h,{icon:C.a.WARNING_SIGN,isOpen:n,onClose:r,title:(i?"Unpublish":"Publish")+" assessment",canOutsideClickClose:!0,children:[Object(ne.jsxs)("div",{className:p.a.DIALOG_BODY,children:[Object(ne.jsxs)("p",{children:["Are you sure you want to ",Object(ne.jsx)("b",{children:i?"unpublish":"publish"})," the assessment"," ",Object(ne.jsx)("i",{children:t.title}),"?"]}),i?Object(ne.jsx)("p",{children:Object(ne.jsx)("b",{children:"This will hide the assessment for students and prevent them from uploading new answers. Admins and staff are not affected."})}):null]}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)("div",{className:p.a.DIALOG_FOOTER_ACTIONS,children:[Object(ne.jsx)(J.a,{label:"Cancel",icon:C.a.CROSS,onClick:r,options:{minimal:!1}}),Object(ne.jsx)(J.a,{label:"Confirm",icon:C.a.CONFIRM,onClick:c,options:{minimal:!1,intent:g.a.DANGER}})]})})]})]})};class Ac extends f.Component{constructor(e){super(e),this.columnDefs=void 0,this.defaultColumnDefs=void 0,this.gridApi=void 0,this.columnApi=void 0,this.loadContent=()=>{this.props.handleAssessmentOverviewFetch(),this.props.handleFetchCourseConfigs()},this.dateFilterComparator=(e,t)=>{const n=new Date(t);return n<e?-1:n>e?1:0},this.onGridReady=e=>{this.gridApi=e.api,this.columnApi=e.columnApi,this.gridApi.sizeColumnsToFit(),this.columnApi.applyColumnState({state:[{colId:"openAt",sort:"desc"},{colId:"closeAt",sort:"desc"}]})},this.resizeGrid=()=>{this.gridApi&&this.gridApi.sizeColumnsToFit()},this.toggleDropzone=()=>{this.setState({showDropzone:!this.state.showDropzone})},this.state={showDropzone:!1},this.columnDefs=[{field:"number",headerName:"ID",width:50},{headerName:"Title",field:"title"},{headerName:"Category",field:"type",width:100},{headerName:"Open Date",field:"openAt",filter:"agDateColumnFilter",filterParams:{comparator:this.dateFilterComparator,inRangeInclusive:!0},sortingOrder:["desc","asc",null],cellRendererFramework:Tc,cellRendererParams:{handleAssessmentChangeDate:this.props.handleAssessmentChangeDate,forOpenDate:!0},width:150},{headerName:"Close Date",field:"closeAt",filter:"agDateColumnFilter",filterParams:{comparator:this.dateFilterComparator,inRangeInclusive:!0},sortingOrder:["desc","asc",null],cellRendererFramework:Tc,cellRendererParams:{handleAssessmentChangeDate:this.props.handleAssessmentChangeDate,forOpenDate:!1},width:150},{headerName:"Publish",field:"",cellRendererFramework:kc,cellRendererParams:{handlePublishAssessment:this.props.handlePublishAssessment},width:100,filter:!1,resizable:!1,sortable:!1,cellStyle:{padding:0}},{headerName:"Delete",field:"",cellRendererFramework:Oc,cellRendererParams:{handleDeleteAssessment:this.props.handleDeleteAssessment},width:100,filter:!1,resizable:!1,sortable:!1,cellStyle:{padding:0}}],this.defaultColumnDefs={filter:!0,resizable:!0,sortable:!0}}render(){const e=Object(ne.jsxs)("div",{className:"GridControls ground-control-controls",children:[Object(ne.jsx)(h.b,{active:this.state.showDropzone,icon:C.a.CLOUD_UPLOAD,intent:this.state.showDropzone?g.a.PRIMARY:g.a.NONE,onClick:this.toggleDropzone,children:Object(ne.jsx)("span",{className:"hidden-xs",children:"Upload assessment"})}),Object(ne.jsx)(xc,{}),Object(ne.jsx)(h.b,{icon:C.a.REFRESH,onClick:this.props.handleAssessmentOverviewFetch,children:Object(ne.jsx)("span",{className:"hidden-xs",children:"Refresh assessments"})})]}),t=Object(ne.jsx)(h.g,{isOpen:this.state.showDropzone,keepChildrenMounted:!0,children:Object(ne.jsx)(wc,{handleUploadAssessment:this.props.handleUploadAssessment,assessmentConfigurations:this.props.assessmentConfigurations})}),n=Object(ne.jsx)("div",{className:"Grid ag-grid-parent ag-theme-balham",children:Object(ne.jsx)(Ln.AgGridReact,{domLayout:"autoHeight",columnDefs:this.columnDefs,defaultColDef:this.defaultColumnDefs,onGridReady:this.onGridReady,onGridSizeChanged:this.resizeGrid,rowData:this.props.assessmentOverviews,rowHeight:30,suppressCellSelection:!0,suppressMovableColumns:!0,suppressPaginationPanel:!0})}),s=Object(ne.jsxs)("div",{className:"GroundControl",children:[e,t,Object(ne.jsx)(h.i,{}),n]});return Object(ne.jsx)("div",{children:Object(ne.jsx)(Me.a,{display:s,loadContentDispatch:this.loadContent})})}}var _c=Ac;var Ic=Object(r.b)((e=>({assessmentOverviews:e.session.assessmentOverviews,assessmentConfigurations:e.session.assessmentConfigurations})),(e=>Object(c.b)({handleAssessmentChangeDate:yc.changeDateAssessment,handleAssessmentOverviewFetch:u.fetchAssessmentOverviews,handleDeleteAssessment:yc.deleteAssessment,handleUploadAssessment:yc.uploadAssessment,handlePublishAssessment:yc.publishAssessment,handleFetchCourseConfigs:u.fetchCourseConfig},e)))(_c),Nc=n(114),Pc=n(327),Rc=n.n(Pc);class Mc extends f.PureComponent{constructor(e){super(e),this.recorder=void 0,this.handleCloseDialog=()=>this.setState({dialogOpen:!1}),this.handleOpenDialog=()=>this.setState({dialogOpen:!0}),this.updateTimerDuration=()=>{this.setState({duration:this.props.getTimerDuration()})},this.handleTruncatePlaybackData=()=>{const e=this.props.playbackData.inputs.filter((e=>e.time<=1e3*this.props.currentPlayerTime));this.props.handleResetInputs(e)},this.handleRecorderPausing=()=>{if(!this.recorder)return;const{handleSetIsEditorReadonly:e,handleSetSourcecastData:t,handleTimerPause:n}=this.props;clearInterval(this.state.updater),e(!0),n(),this.recorder.pause();t("","","",window.URL.createObjectURL(this.recorder.exportWAV()),this.props.playbackData)},this.handleRecorderStarting=()=>{this.recorder=new Rc.a;const{handleRecordInit:e,handleSetIsEditorReadonly:t,handleTimerStart:n}=this.props;this.recorder.start().then((()=>{e(),t(!1),n();const s=setInterval(this.updateTimerDuration,100);this.setState({updater:s})}),(e=>{alert("Microphone not found: "+e)}))},this.handleRecorderResuming=()=>{if(!this.recorder)return;const{handleSetIsEditorReadonly:e,handleTimerResume:t}=this.props;e(!1),t(-1);const n=setInterval(this.updateTimerDuration,100);this.setState({updater:n}),this.recorder.resume()},this.handleRecorderResumingFromCurrent=()=>{if(!this.recorder)return;const{currentPlayerTime:e,handleSetIsEditorReadonly:t,handleTimerResume:n}=this.props;this.handleTruncatePlaybackData(),t(!1),n(1e3*e);const s=setInterval(this.updateTimerDuration,100);this.setState({updater:s}),this.recorder.resume(e)},this.handleRecorderStopping=()=>{if(!this.recorder)return;const{handleSetIsEditorReadonly:e,handleTimerStop:t}=this.props;e(!1),t(),clearInterval(this.state.updater),this.recorder.stop(),this.setState({fileDataBlob:this.recorder.exportWAV()}),this.recorder.clear()},this.handleRecorderResetting=()=>{const{handleSetIsEditorReadonly:e,handleTimerReset:t}=this.props;e(!1),t(),clearInterval(this.state.updater),this.setState({duration:0}),this.recorder&&(this.recorder.stop(),this.recorder.clear())},this.handleRecorderSaving=()=>{this.state.fileDataBlob?this.props.handleSaveSourcecastData(this.state.saveTitle,this.state.saveDescription,this.state.saveUID,this.state.fileDataBlob,this.props.playbackData):alert("No recording found")},this.renderLabel=e=>{const t=Math.floor(e/60),n=Math.floor(e-60*t);return(t<10?"0"+t:t)+":"+(n<10?"0"+n:n)},this.handleSaveTitleInputChange=e=>{this.setState({saveTitle:e.target.value})},this.handleSaveDescriptionInputChange=e=>{this.setState({saveDescription:e.target.value})},this.handleSaveUIDInputChange=e=>{this.setState({saveUID:e.target.value})},this.state={dialogOpen:!1,duration:0,updater:void 0,saveTitle:"",saveDescription:"",saveUID:""}}async componentDidMount(){Rc.a.getPermission().then((()=>{}),(e=>{alert("Microphone not found: "+e)}))}render(){const e=Object(ne.jsx)(J.a,{label:"Record Pause",icon:C.a.SNOWFLAKE,onClick:this.props.handleRecordPause}),t=Object(ne.jsx)(J.a,{label:"Pause",icon:C.a.PAUSE,onClick:this.handleRecorderPausing}),n=Object(ne.jsx)(J.a,{label:"Resume",icon:C.a.PLAY,onClick:this.handleRecorderResuming}),s=Object(ne.jsx)(J.a,{label:"Resume Here",icon:C.a.PLAY,onClick:this.handleRecorderResumingFromCurrent}),i=Object(ne.jsx)(J.a,{label:"Record",icon:C.a.PLAY,onClick:this.handleRecorderStarting}),a=Object(ne.jsx)(J.a,{label:"Stop",icon:C.a.STOP,onClick:this.handleRecorderStopping}),r=Object(ne.jsx)(J.a,{label:"Reset",icon:C.a.REFRESH,onClick:this.handleRecorderResetting}),o=Object(ne.jsx)(J.a,{label:"Upload",icon:C.a.FLOPPY_DISK,onClick:this.handleOpenDialog});return Object(ne.jsxs)("div",{children:[Object(ne.jsxs)(h.h,{icon:"info-sign",isOpen:this.state.dialogOpen,onClose:this.handleCloseDialog,title:"Upload Sourcecast",canOutsideClickClose:!0,children:[Object(ne.jsxs)("div",{className:p.a.DIALOG_BODY,children:[Object(ne.jsx)(h.y,{id:"title",leftIcon:C.a.HEADER,onChange:this.handleSaveTitleInputChange,placeholder:"Title",value:this.state.saveTitle}),Object(ne.jsx)("br",{}),Object(ne.jsx)(h.y,{id:"description",leftIcon:C.a.LIST_DETAIL_VIEW,onChange:this.handleSaveDescriptionInputChange,placeholder:"Description",value:this.state.saveDescription}),Object(ne.jsx)("br",{}),Object(ne.jsx)(h.y,{id:"uid",leftIcon:C.a.KEY,onChange:this.handleSaveUIDInputChange,placeholder:"UID (optional, only alphanumeric, dash and underscore allowed)",value:this.state.saveUID})]}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)("div",{className:p.a.DIALOG_FOOTER_ACTIONS,children:[Object(ne.jsx)(J.a,{label:"Confirm Upload",icon:C.a.TICK,onClick:this.handleRecorderSaving}),Object(ne.jsx)(J.a,{label:"Cancel",icon:C.a.CROSS,onClick:this.handleCloseDialog})]})})]}),Object(ne.jsx)("br",{}),Object(ne.jsx)("div",{className:"Timer",children:Object(ne.jsx)(h.e,{elevation:2,style:{background:"#24323F"},children:Object(ne.jsx)(h.o,{children:this.renderLabel(this.props.recordingStatus!==F.c.paused?this.state.duration/1e3:this.props.currentPlayerTime)})})}),Object(ne.jsx)("br",{}),Object(ne.jsxs)("div",{className:"RecorderControl",children:[this.props.recordingStatus===F.c.notStarted&&i,this.props.recordingStatus===F.c.paused&&n,this.props.recordingStatus===F.c.paused&&s,this.props.recordingStatus===F.c.recording&&t,this.props.recordingStatus===F.c.recording&&e,this.props.recordingStatus===F.c.paused&&a,this.props.recordingStatus===F.c.finished&&o,this.props.recordingStatus!==F.c.notStarted&&r]}),Object(ne.jsx)("br",{})]})}}var Lc=Mc;const Dc="sourcereel",Bc="Welcome to Sourcereel!",Uc={label:"Data Visualizer",iconName:C.a.EYE_OPEN,body:Object(ne.jsx)(_n,{}),id:Se.b.dataVisualizer},Gc={label:"Env Visualizer",iconName:C.a.GLOBE,body:Object(ne.jsx)(Pn,{}),id:Se.b.envVisualizer};var Fc=e=>{const[t,n]=Object(f.useState)(Se.b.sourcereel),s=Object(r.c)();Object(f.useEffect)((()=>{Object(wn.fetchSourcecastIndex)("sourcecast")}),[]),Object(f.useEffect)((()=>{const{inputToApply:t}=e;if(t)switch(t.type){case"activeTabChange":n(t.data);break;case"chapterSelect":e.handleChapterSelect(t.data);break;case"externalLibrarySelect":e.handleExternalSelect(t.data);break;case"forcePause":e.handleSetSourcecastStatus(F.b.forcedPaused)}}),[e.inputToApply]);const i=()=>e.timeElapsedBeforePause+Date.now()-e.timeResumed,a=Object(ne.jsx)(Cn,{handleDebuggerPause:()=>s(Object(Sn.beginDebuggerPause)(Dc)),handleDebuggerResume:()=>s(Object(Sn.debuggerResume)(Dc)),handleDebuggerReset:()=>s(Object(Sn.debuggerReset)(Dc)),handleEditorEval:()=>{e.handleEditorEval(),e.recordingStatus===F.c.recording&&e.handleRecordInput({time:i(),type:"keyboardCommand",data:F.a.run})},handleInterruptEval:()=>s(Object(Sn.beginInterruptExecution)(Dc)),handleToggleEditorAutorun:()=>s(Object(I.toggleEditorAutorun)(Dc)),isDebugging:e.isDebugging,isEditorAutorun:e.isEditorAutorun,isRunning:e.isRunning},"autorun"),o=Object(ne.jsx)(V.a,{handleChapterSelect:(t,n)=>{let{chapter:s}=t;e.handleChapterSelect(s),e.recordingStatus===F.c.recording&&e.handleRecordInput({time:i(),type:"chapterSelect",data:s})},sourceChapter:e.sourceChapter,sourceVariant:e.sourceVariant},"chapter"),c=Object(ne.jsx)(W.a,{handleReplOutputClear:()=>s(Object(I.clearReplOutput)(Dc))},"clear_repl"),l=Object(ne.jsx)($.a,{handleReplEval:e.handleReplEval,isRunning:e.isRunning},"eval_repl"),d={controlBarProps:{editorButtons:[a,o]},editorContainerProps:{...k.a.pick(e,"codeDeltasToApply","handleEditorEval","handleEditorValueChange","isEditorAutorun","inputToApply","handleRecordInput","isEditorReadonly"),editorVariant:"sourcecast",editorTabs:e.editorTabs.map(Z.a),handleDeclarationNavigate:e=>s(Object(I.navigateToDeclaration)(Dc,e)),handleEditorUpdateBreakpoints:e=>s(Object(I.setEditorBreakpoint)(e,Dc)),editorSessionId:"",getTimerDuration:i,isPlaying:e.playbackStatus===F.b.playing,isRecording:e.recordingStatus===F.c.recording},handleSideContentHeightChange:e=>s(Object(I.changeSideContentHeight)(e,Dc)),replProps:{output:e.output,replValue:e.replValue,handleBrowseHistoryDown:()=>s(Object(I.browseReplHistoryDown)(Dc)),handleBrowseHistoryUp:()=>s(Object(I.browseReplHistoryUp)(Dc)),handleReplEval:e.handleReplEval,handleReplValueChange:e=>s(Object(I.updateReplValue)(e,Dc)),sourceChapter:e.sourceChapter,sourceVariant:e.sourceVariant,externalLibrary:e.externalLibraryName,replButtons:[l,c]},sideBarProps:{tabs:[]},sideContentHeight:e.sideContentHeight,sideContentProps:{onChange:t=>{n(t),e.recordingStatus===F.c.recording&&e.handleRecordInput({time:i(),type:"activeTabChange",data:t})},selectedTabId:t,tabs:{beforeDynamicTabs:[{label:"Recording Panel",iconName:C.a.COMPASS,body:Object(ne.jsxs)("div",{children:[Object(ne.jsx)("span",{className:"Multi-line",children:Object(ne.jsxs)(h.M,{children:[" ",Bc," "]})}),Object(ne.jsx)(Lc,{currentPlayerTime:e.currentPlayerTime,editorValue:e.editorTabs[0].value,getTimerDuration:i,playbackData:e.playbackData,handleRecordInit:()=>{const t={chapter:e.sourceChapter,externalLibrary:e.externalLibraryName,editorValue:e.editorTabs[0].value};s(Object(Nc.recordInit)(t,Dc))},handleRecordPause:()=>e.handleRecordInput({time:i(),type:"forcePause",data:null}),handleResetInputs:e=>s(Object(Nc.resetInputs)(e,Dc)),handleSaveSourcecastData:(e,t,n,i,a)=>s(Object(On.saveSourcecastData)(e,t,n,i,a,"sourcecast")),handleSetSourcecastData:(e,t,n,i,a)=>s(Object(On.setSourcecastData)(e,t,n,i,a,"sourcecast")),handleSetIsEditorReadonly:e.handleSetIsEditorReadonly,handleTimerPause:()=>s(Object(Nc.timerPause)(Dc)),handleTimerReset:()=>s(Object(Nc.timerReset)(Dc)),handleTimerResume:e=>s(Object(Nc.timerResume)(e,Dc)),handleTimerStart:()=>s(Object(Nc.timerStart)(Dc)),handleTimerStop:()=>s(Object(Nc.timerStop)(Dc)),recordingStatus:e.recordingStatus})]}),id:Se.b.sourcereel},{label:"Sourcecast Table",iconName:C.a.EDIT,body:Object(ne.jsx)("div",{children:Object(ne.jsx)(Wn,{handleDeleteSourcecastEntry:e=>s(Object(Nc.deleteSourcecastEntry)(e,"sourcecast")),sourcecastIndex:e.sourcecastIndex,courseId:e.courseId})}),id:Se.b.introduction},Uc,Gc],afterDynamicTabs:[]},workspaceLocation:"sourcereel"}},u={...k.a.pick(e,"handleEditorValueChange","handleSetIsEditorReadonly","handleSetSourcecastStatus","audioUrl","currentPlayerTime","playbackData","playbackStatus","handleChapterSelect","handleExternalSelect"),handleSetCurrentPlayerTime:e=>s(Object(On.setCurrentPlayerTime)(e,"sourcecast")),handleSetCodeDeltasToApply:e=>s(Object(On.setCodeDeltasToApply)(e,"sourcecast")),handleSetInputToApply:e=>s(Object(On.setInputToApply)(e,"sourcecast")),handleSetSourcecastDuration:e=>s(Object(On.setSourcecastDuration)(e,"sourcecast")),handlePromptAutocomplete:(e,t,n)=>s(Object(I.promptAutocomplete)(Dc,e,t,n)),duration:e.playbackDuration};return Object(ne.jsxs)("div",{className:j()("Sourcereel",p.a.DARK),children:[e.recordingStatus===F.c.paused?Object(ne.jsx)(Mn,{...u}):void 0,Object(ne.jsx)(Te.a,{...d})]})};const Hc="sourcereel";var Vc=Object(r.b)((e=>({audioUrl:e.workspaces.sourcecast.audioUrl,currentPlayerTime:e.workspaces.sourcecast.currentPlayerTime,codeDeltasToApply:e.workspaces.sourcecast.codeDeltasToApply,activeEditorTabIndex:e.workspaces.sourcereel.activeEditorTabIndex,editorTabs:e.workspaces.sourcereel.editorTabs,enableDebugging:e.workspaces.sourcereel.enableDebugging,externalLibraryName:e.workspaces.sourcereel.externalLibrary,inputToApply:e.workspaces.sourcecast.inputToApply,isDebugging:e.workspaces.sourcereel.isDebugging,isEditorAutorun:e.workspaces.sourcereel.isEditorAutorun,isEditorReadonly:e.workspaces.sourcereel.isEditorReadonly,isRunning:e.workspaces.sourcereel.isRunning,output:e.workspaces.sourcereel.output,playbackData:e.workspaces.sourcereel.playbackData,playbackDuration:e.workspaces.sourcecast.playbackDuration,playbackStatus:e.workspaces.sourcecast.playbackStatus,recordingStatus:e.workspaces.sourcereel.recordingStatus,replValue:e.workspaces.sourcereel.replValue,sideContentHeight:e.workspaces.sourcereel.sideContentHeight,sourcecastIndex:e.workspaces.sourcecast.sourcecastIndex,sourceChapter:N.Chapter.CALC,sourceVariant:e.workspaces.sourcereel.context.variant,timeElapsedBeforePause:e.workspaces.sourcereel.timeElapsedBeforePause,timeResumed:e.workspaces.sourcereel.timeResumed,courseId:e.session.courseId})),(e=>Object(c.b)({handleChapterSelect:e=>Object(I.chapterSelect)(e,N.Variant.DEFAULT,Hc),handleEditorEval:()=>Object(I.evalEditor)(Hc),handleEditorValueChange:e=>Object(I.updateEditorValue)(e,Hc),handleExternalSelect:e=>Object(I.externalLibrarySelect)(e,Hc),handleRecordInput:e=>Object(Nc.recordInput)(e,Hc),handleReplEval:()=>Object(I.evalRepl)(Hc),handleSetSourcecastStatus:e=>Object(On.setSourcecastStatus)(e,"sourcecast"),handleSetIsEditorReadonly:e=>Object(I.setIsEditorReadonly)(Hc,e)},e)))(Fc);let Wc;!function(e){e.Default="Default",e.ObjectPlacement="ObjectPlacement",e.AssetUploader="AssetUploader",e.CheckpointSim="CheckpointSim",e.ChapterSim="ChapterSim"}(Wc||(Wc={}));const $c=e=>async function(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{const a=Yc(zo.getInstance().getAccountInfo().accessToken||"");Object.entries(s).forEach((e=>{let[t,n]=e;a.append(t,n)}));const r={method:n,headers:a,...i};return fetch(we.b.backendUrl+`/v2/courses/${ti()}/${e}/`+t,r)}finally{}},Xc=$c("admin/assets"),qc=$c("stories"),zc=$c("admin/stories");function Yc(e){const t=new Headers;return t.append("Accept","application/json"),t.append("Authorization",`Bearer ${e}`),t}const Kc=["locations","objects","images","avatars","ui","sfx","bgm","stories"];const Qc=async()=>(await Zc("stories")).filter((e=>e.startsWith("stories")&&e.endsWith("txt"))).map((e=>e.slice(8)));async function Jc(){return(await Promise.all(Kc.map((async e=>{const t=await Zc(e);return t.length?t:[`${e}`]})))).reduce(((e,t)=>e.concat(t)),[])}async function Zc(e){const t=await Xc(e,"GET",{"Content-Type":"application/json"});return 200===t.status?t.json():[]}async function el(e,t){const n=await Promise.all(Array.from(e).map((async e=>{const n=await async function(e,t){const n=new FormData;n.set("upload",e);const s=await Xc(`${t}/${e.name}`,"POST",{},{body:n,mode:"cors"});return s?s.text():""}(e,t);return e.name+" => "+n})));return n.join("\n")}async function tl(){const e=await qc("","GET"),t=200===e.status?await e.json():[];return k.a.sortBy(t,(e=>new Date(e.openAt)))}async function nl(e,t){const n=await zc(e,"POST",{"Content-Type":"application/json"},{body:JSON.stringify(t)});return 200===n.status?"Chapter successfully created/updated":n.text()}const sl="Specify own folder...";var il=()=>{const[e,t]=v.a.useState(),[n,s]=v.a.useState(Kc[0]),[i,a]=v.a.useState(),[r,o]=v.a.useState(!1);function c(e){e.target.innerText&&(s(e.target.innerText),o(!1))}const l=Object(ne.jsxs)(h.A,{children:[Kc.map((e=>Object(ne.jsx)(h.B,{onClick:c,id:e,text:e},e))),Object(ne.jsx)(h.B,{onClick:function(e){e.target.innerText&&(s(e.target.innerText),o(!0))},id:sl,text:sl},sl)]});return Object(ne.jsxs)("div",{className:"LeftAlign",children:[Object(ne.jsx)("h4",{children:"Choose Folder"}),Object(ne.jsx)(Le.a,{placement:w.a.BOTTOM,content:l,children:Object(ne.jsx)(h.b,{text:n})}),r&&Object(ne.jsx)(h.y,{placeholder:"Or specify your own, e.g. 'locations/hallway'",onChange:function(e){a(e.target.value)}}),Object(ne.jsx)("br",{}),Object(ne.jsx)("h4",{children:"Choose File"}),Object(ne.jsx)("input",{type:"file",multiple:!0,onChange:function(e){if(!e.target.files)return;const n=e.target.files;t(n)}}),Object(ne.jsx)(h.b,{onClick:async function(){const t=i||n;if(!e||!t)return;const s=await el(e,t);alert(s)},children:"Upload"})]})};function al(e,t){e&&e.forEach((e=>{t(e),al(e.childNodes,t)}))}function rl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const s={};function i(e,n){return Object.keys(n).map((s=>{const a="/"+e.join("/")+"/"+s;return{id:a,label:s,secondaryLabel:t(a),childNodes:"FILE"===n[s]?void 0:i([...e,s],n[s])}}))}return e.forEach((e=>k.a.set(s,e.split("/"),"FILE"))),n.forEach((e=>{s[e]&&"FILE"!==s[e]||(s[e]=[])})),i([],s)}var ol=Object(f.memo)((e=>{let{assetPath:t}=e;const n=t||vs.defaultAssetPath;return Object(ne.jsx)(ne.Fragment,{children:Object(ne.jsx)("img",{alt:"asset",crossOrigin:"anonymous",src:Zs(n,!!t),width:"150px",onError:e=>{e.target.onerror=null,e.target.src=Zs(vs.defaultAssetPath,!1)}})})}));const cl=e=>Object(ne.jsx)(E.a,{content:"Delete",children:Object(ne.jsx)(h.w,{icon:"trash",onClick:ll(e)})}),ll=e=>async()=>{const t=window.confirm(`Are you sure you want to delete ${e}?\nThere is no undoing this action!`);alert(t?await async function(e){const t=await Xc(e,"DELETE");return await t.text()||"Successfully Deleted"}(e):"Whew")};var dl=()=>{const{value:e}=Object(x.d)(Jc,[]),[t,n]=v.a.useState(""),[s,i]=v.a.useState({nodes:[]});v.a.useEffect((()=>{i({nodes:rl(e,cl,Kc)})}),[e]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(ol,{assetPath:t}),Object(ne.jsx)(h.bb,{contents:s.nodes,onNodeClick:e=>{al(s.nodes,(e=>e.isSelected=!1)),e.isSelected=!e.isSelected,e.isExpanded=!e.isExpanded;const t=e.id.toString();e.childNodes||(n(t),sessionStorage.setItem("selectedAsset",t)),i({...s})}})]})},ul=n(448),hl=n(330);const pl=v.a.memo(Object(hl.b)((e=>{let{value:t}=e;return Object(ne.jsx)("div",{children:Object(ne.jsx)(h.b,{children:t})})}))),gl=v.a.memo(Object(hl.a)((e=>{let{items:t}=e;return Object(ne.jsx)("div",{children:t&&t.map(((e,t)=>Object(ne.jsx)(pl,{index:t,value:e},`item-${e}`)))})})));var ml=v.a.memo((e=>{let{chapterDetail:t,checkpointFilenames:n}=e;const{id:s}=t,{value:i,setValue:a,inputProps:r}=Object(x.b)(""),{value:o,setValue:c,inputProps:l}=Object(x.b)(""),{items:d,setItems:u,onSortEnd:p}=(()=>{const[e,t]=v.a.useState([]),n=v.a.useCallback((e=>{let{oldIndex:n,newIndex:s}=e;t((e=>Object(ul.a)(e,n,s)))}),[]);return{items:e,setItems:t,onSortEnd:n}})(),[m,f]=v.a.useState(!1),[y,j]=v.a.useState(new Date),[O,S]=v.a.useState([]),[w,C]=v.a.useState(!1);v.a.useEffect((()=>{a(t.title),c(t.imageUrl),j(new Date(t.openAt)),u(t.filenames),f(t.isPublished),S((n||[]).filter((e=>!t.filenames.includes(e))))}),[t,u,c,j,a,n,w]);const E=v.a.useCallback((e=>{u((t=>t.filter((t=>t!==e)))),S((t=>[...t,e]))}),[u]),T=v.a.useCallback((e=>{u((t=>[...t,e])),S((t=>t.filter((t=>t!==e))))}),[u]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsxs)("h4",{children:["Title: ",Object(ne.jsx)("input",{className:"bp4-input",type:"text",...r})]}),Object(ne.jsx)("b",{children:"Open date: "}),y&&(k=y.toISOString(),b()(k).format("MMMM Do YYYY, HH:mm")),Object(ne.jsx)(gt.a,{onChange:e=>{e&&j(e)}}),Object(ne.jsxs)("h4",{children:["Image url: ",Object(ne.jsx)("input",{className:"bp4-input",type:"text",...l}),Object(ne.jsx)(h.b,{onClick:e=>window.open(Zs(o,!0)),children:"View"})]}),Object(ne.jsx)("b",{children:"Checkpoint Txt Files"}),Object(ne.jsx)(gl,{items:d,onSortEnd:p}),Object(ne.jsx)("br",{}),d.length>0&&Object(ne.jsx)(h.b,{icon:"delete",onClick:()=>d.map(E),children:"Clear checkpoint files"}),Object(ne.jsx)("br",{}),Object(ne.jsx)("b",{children:"All Txt Files"}),O&&O.map((e=>Object(ne.jsx)("div",{children:Object(ne.jsx)(h.b,{onClick:()=>T(e),icon:"add",children:e})},`choice-${e}`))),Object(ne.jsx)("br",{}),Object(ne.jsx)(h.b,{icon:"play",onClick:async()=>{zo.getInstance().setChapterSimStack(d),await go()},children:"Simulate Chapter"}),Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),Object(ne.jsx)(h.T,{checked:m,labelElement:"Published",onChange:()=>f(!m)}),Object(ne.jsx)(h.b,{onClick:async()=>{const e={openAt:y.toISOString(),closeAt:bl(y).toISOString(),title:i,filenames:d,imageUrl:o,isPublished:m};if(!window.confirm(`Are you sure you want to save changes to ${JSON.stringify(e)}`))return;const t=parseInt(s)===fl?await nl("",{story:e}):await nl(s,{story:e});alert(t)},children:"Save Changes"}),Object(ne.jsx)(h.b,{intent:g.a.WARNING,onClick:()=>{window.confirm("Are you you want to clear changes for this chapter?")&&(C(!w),alert("Cleared changes"))},children:"Clear Changes"}),Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),Object(ne.jsx)(h.b,{icon:"trash",intent:g.a.DANGER,onClick:async()=>{if(window.confirm("Are you sure you want to delete this chapter?")){const e=await async function(e){const t=await zc(e,"DELETE");return 204===t.status?"Chapter successfully deleted":t.text()}(s);alert(e)}},children:"Delete Chapter"})]});var k}));const bl=e=>(e.setFullYear(e.getFullYear()+1),e),fl=-1,vl={id:fl,title:"title goes here",imageUrl:"/locations/telebay/emergency.png",openAt:(new Date).toISOString(),closeAt:bl(new Date).toISOString(),isPublished:!1,filenames:[]};var yl=v.a.memo((()=>{const{value:e}=Object(x.d)(Qc,[]),{value:t}=Object(x.d)(tl,[]),[n,s]=v.a.useState(fl);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("h3",{children:"Chapter Simulator"}),Object(ne.jsxs)("select",{className:"bp4-menu",onChange:e=>s(e.target.value),children:[t.map(((e,t)=>Object(ne.jsx)("option",{value:t,children:`Chapter ${t}: ${e.title}`},t))),Object(ne.jsx)("option",{value:fl,children:"Create new chapter"},fl)]}),Object(ne.jsx)("hr",{}),Object(ne.jsx)(ml,{chapterDetail:t[n]||vl,checkpointFilenames:e})]})}));const jl={key:fs.zektonDarkFont.key,size:35,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var xl={maxOptButtonsRow:2,optButton:{xSpace:.9*ys.x,ySpace:.5*ys.y},gameTxtStorageName:{defaultChapter:"defaultChapter",checkpointTxt:"checkpointTxt"}};n(706);const Ol=(e,t)=>{const n=new FileReader;n.readAsText(t),n.onloadend=t=>{n.result&&sessionStorage.setItem(e,n.result.toString())}};var Sl=function(e){let{storageName:t,s3TxtFiles:n}=e;const[s,i]=v.a.useState(n[0]),a=Object(ne.jsx)("input",{type:"file",onChange:function(e){if(!e.target.files)return;const[n]=e.target.files;Ol(t,n)},style:{width:"250px"}}),r=Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("select",{className:"bp4-menu",onChange:async function(e){const n=e.target.value;i(n);const s=await fetch(Zs(`/stories/${n}`,!0),{headers:wl()}),a=await s.text();sessionStorage.setItem(t,a)},children:n.map((e=>Object(ne.jsx)("option",{value:e,children:e},e)))}),Object(ne.jsx)(h.b,{icon:"download",onClick:()=>window.open(Mr(s))})]});return Object(ne.jsxs)("div",{className:"LeftAlign",children:[Object(ne.jsx)("hr",{}),Object(ne.jsxs)(h.V,{id:"Tabs",renderActiveTabPanelOnly:!0,children:[Object(ne.jsx)(h.U,{id:"own",title:"Local",panel:a}),Object(ne.jsx)(h.U,{id:"s3",title:"S3",panel:r})]},"vertical"),Object(ne.jsx)("hr",{})]})};function wl(){const e=new Headers;return e.append("Access-Control-Allow-Origin","*"),e}function Cl(){const{value:e}=Object(x.d)(Qc,[]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("h3",{children:"Checkpoint Text Loader"}),Object(ne.jsx)("b",{children:"Step 1: Choose default checkpoint"}),Object(ne.jsx)(Sl,{s3TxtFiles:e,storageName:xl.gameTxtStorageName.defaultChapter}),Object(ne.jsx)("b",{children:"Step 2: Choose checkpoint text"}),Object(ne.jsx)(Sl,{s3TxtFiles:e,storageName:xl.gameTxtStorageName.checkpointTxt}),Object(ne.jsx)("br",{}),Object(ne.jsx)(h.b,{onClick:function(){zo.getInstance().getCurrentSceneRef().simulateCheckpoint()},icon:"play",children:"Simulate Checkpoint"}),Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),Object(ne.jsx)(h.b,{onClick:El,children:"Reset All Files"}),Object(ne.jsx)("br",{})]})}function El(e){sessionStorage.setItem(xl.gameTxtStorageName.checkpointTxt,""),sessionStorage.setItem(xl.gameTxtStorageName.defaultChapter,"")}var Tl={storySimBg:{type:Hs.Image,key:"student-room",path:"/locations/deathCube_ext/shields-down.png"},shortButton:{type:Hs.Image,key:"short-button",path:"/ui/shortButton.png"},invertedButton:{type:Hs.Image,key:"inverted-button",path:"/ui/invertedColorButton.png"},blueUnderlay:{type:Hs.Image,key:"blue-underlay",path:"/ui/blueUnderlay.png"},topButton:{type:Hs.Image,key:"top-button",path:"/ui/topButton.png"},colorIcon:{type:Hs.Image,key:"color-icon",path:"/ui/colorIcon.png"},imageIcon:{type:Hs.Image,key:"image-icon",path:"/ui/imageIcon.png"},bboxIcon:{type:Hs.Image,key:"bbox-icon",path:"/ui/bboxIcon.png"},handIcon:{type:Hs.Image,key:"hand-icon",path:"/ui/handIcon.png"},listIcon:{type:Hs.Image,key:"list-icon",path:"/ui/listIcon.png"},eraseIcon:{type:Hs.Image,key:"erase-icon",path:"/ui/eraserIcon.png"},iconBg:{type:Hs.Image,key:"icon-bg",path:"/ui/modeIconBg.png"}};class kl extends Phaser.Scene{constructor(){super("StorySimulatorMenu"),this.layerManager=void 0,this.getLayerManager=()=>ei(this.layerManager)}preload(){zo.getInstance().setCurrentSceneRef(this),this.layerManager=new Oa(this),la(this),Object.values(Ws).forEach((e=>this.load.image(e.key,Zs(e.path,!1)))),Object.values(Tl).forEach((e=>this.load.image(e.key,Zs(e.path,!1)))),Object.values(fs).forEach((e=>this.load.bitmapFont(e.key,e.pngPath,e.fntPath))),zo.getInstance().getSoundManager().loadSoundAssetMap(qs)}async create(){"student"!==zo.getInstance().getAccountInfo().role?(this.renderBackground(),this.renderOptionButtons()):console.log("Students cannot use story sim")}renderOptionButtons(){const e=new Phaser.GameObjects.Container(this,0,0),t=this.getOptionButtons(),n=ws({numOfItems:t.length,maxXSpace:xl.optButton.xSpace,maxYSpace:xl.optButton.ySpace,numItemLimit:xl.maxOptButtonsRow,redistributeLast:!0});e.add(t.map(((e,t)=>this.createOptButton(e.text,n[t][0],n[t][1],e.callback)))),this.getLayerManager().addToLayer(zs.UI,e)}getOptionButtons(){return[{text:"Object Placement",callback:()=>{zo.getInstance().setStorySimState(Wc.ObjectPlacement),this.getLayerManager().clearAllLayers(),this.scene.start("ObjectPlacement")}},{text:"Checkpoint Simulator",callback:()=>{zo.getInstance().setStorySimState(Wc.CheckpointSim)}},{text:"Asset Uploader",callback:()=>{zo.getInstance().setStorySimState(Wc.AssetUploader)}},{text:"Chapter Simulator",callback:()=>{zo.getInstance().setStorySimState(Wc.ChapterSim)}}]}createOptButton(e,t,n,s){return Si(this,{assetKey:Tl.invertedButton.key,message:e,textConfig:{x:0,y:0,oriX:.5,oriY:.5},bitMapTextStyle:jl,onUp:s}).setPosition(t,n)}simulateCheckpoint(){const e=sessionStorage.getItem(xl.gameTxtStorageName.defaultChapter)||"",t=sessionStorage.getItem(xl.gameTxtStorageName.checkpointTxt)||"";if(""===e&&""===t)return;this.getLayerManager().clearAllLayers(),ho.parse(e),t&&ho.parse(t,!0);const n=ho.checkpoint;this.scene.start("GameManager",{gameCheckpoint:n,chapterNum:-1,checkpointNum:-1})}renderBackground(){const e=new Phaser.GameObjects.Image(this,js.x,js.y,Tl.storySimBg.key);e.setDisplaySize(ys.x,ys.y);const t=new Phaser.GameObjects.Image(this,js.x,js.y,Tl.blueUnderlay.key).setAlpha(.5);this.getLayerManager().addToLayer(zs.Background,e),this.getLayerManager().addToLayer(zs.Background,t)}}var Al=kl;class _l{constructor(){this.backgroundAssetPath=void 0,this.objectPlacement=void 0,this.x=void 0,this.y=void 0,this.getObjectPlacement=()=>ei(this.objectPlacement),this.x=js.x,this.y=js.y}initialise(e){this.objectPlacement=e}async loadBackground(){const e=sessionStorage.getItem("selectedAsset");if(!e||!e.startsWith("/locations/"))return;this.backgroundAssetPath=e;const t=`!${e}`;this.getObjectPlacement().addAsset(t,e);const n=await Ar(this.getObjectPlacement(),t,Zs(e,!0));this.renderBackground(n)}renderBackground(e){if("!"!==e[0])return;this.getObjectPlacement().getLayerManager().clearLayerContents(zs.Background);const t=new Phaser.GameObjects.Image(this.getObjectPlacement(),js.x,js.y,e).setInteractive();this.getObjectPlacement().getLayerManager().addToLayer(zs.Background,t)}getBackgroundAssetPath(){return this.backgroundAssetPath}screenLog(){return this.backgroundAssetPath+"\n"}}let Il;!function(e){e[e.DrawBBox=0]="DrawBBox",e[e.DragResizeObj=1]="DragResizeObj"}(Il||(Il={}));class Nl{constructor(){this.checkpointTitle="boundingBoxes",this.objectPlacement=void 0,this.bboxBeingDrawn=void 0,this.startingCoordinates=void 0,this.bboxDetailMap=void 0,this.getObjectPlacement=()=>ei(this.objectPlacement),this.bboxDetailMap=new Map}initialise(e){this.objectPlacement=e,this.addBBoxListeners(e)}addBBoxListeners(e){this.getObjectPlacement().getInputManager().registerEventListener("pointerdown",(()=>{this.getObjectPlacement().isCursorMode(Il.DrawBBox)&&(this.bboxBeingDrawn=this.createNewBBox())})),this.getObjectPlacement().getInputManager().registerEventListener("pointerup",(()=>{if(this.getObjectPlacement().isCursorMode(Il.DrawBBox)&&this.bboxBeingDrawn){if(this.bboxBeingDrawn.displayWidth<=2||this.bboxBeingDrawn.displayHeight<=2)return void this.bboxBeingDrawn.destroy();this.bboxBeingDrawn.x+=this.bboxBeingDrawn.displayWidth/2,this.bboxBeingDrawn.y+=this.bboxBeingDrawn.displayHeight/2,this.bboxBeingDrawn.setOrigin(.5),this.registerBBox(this.bboxBeingDrawn),e.input.setDraggable(this.bboxBeingDrawn),this.getObjectPlacement().setActiveSelection(this.bboxBeingDrawn),this.startingCoordinates=void 0,this.bboxBeingDrawn=void 0}}))}createNewBBox(){const[e,t]=this.getObjectPlacement().getCoordinates(),n=new Phaser.GameObjects.Rectangle(this.getObjectPlacement(),e,t,1,1,Os.white).setOrigin(0).setAlpha(.1).setInteractive().setDataEnabled();return this.startingCoordinates=[e,t],this.getObjectPlacement().getLayerManager().addToLayer(zs.BBox,n),n}registerBBox(e){const t="bbox"+this.getObjectPlacement().generateItemIdNumber(),n={id:t,x:e.x,y:e.y,width:e.displayWidth,height:e.displayHeight};this.bboxDetailMap.set(t,n),e.data.set("itemId",t),e.data.set("type","bbox")}getLoggables(){return[...this.bboxDetailMap.values()]}getItemById(e){return this.bboxDetailMap.get(e)}resizeWhileBeingDrawn(e){if(!this.getObjectPlacement().isCursorMode(Il.DrawBBox)||!this.startingCoordinates||!this.bboxBeingDrawn)return;const[t,n]=this.startingCoordinates,s=e.input.x,i=e.input.y;Gi(this.bboxBeingDrawn,s-t,i-n)}checkpointTxtLog(){const e=[];return this.bboxDetailMap.forEach((t=>{const n=["+"+t.id,ta.toIntString(t.x),ta.toIntString(t.y),ta.toIntString(t.width),ta.toIntString(t.height)];e.push(n.join(", ")),e.push("    show_dialogue*(click)")})),e}setAttribute(e,t,n){const s=e.data.get("itemId"),i=this.bboxDetailMap.get(s);i&&(i[t]=n)}deleteAll(){this.bboxDetailMap.clear()}delete(e){const t=e.data.get("itemId");this.bboxDetailMap.delete(t)}}var Pl={icon:{bgSize:55,size:40,yInterval:15},alpha:{inactive:.7,hover:1,active:.9}};class Rl extends Phaser.GameObjects.Container{constructor(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Il.DragResizeObj;super(e,t,n),this.isModes=void 0,this.currCursorMode=void 0,this.cursorModes=void 0,this.currActiveModeIdx=void 0,this.currCursorMode=s,this.isModes=new Array,this.cursorModes=new Array,this.currActiveModeIdx=vs.nullSequenceNumber}getCurrCursorMode(){return this.currCursorMode}setCursorMode(e){this.currCursorMode=e}addCursorMode(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vs.nullFunction,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:vs.nullFunction,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:vs.nullFunction;const o=new Phaser.GameObjects.Container(e,0,0);this.isModes.push(n),this.cursorModes.push(o);const c=this.cursorModes.length-1,l=new As(e,0,0,s),d=Si(e,{assetKey:Tl.iconBg.key,onUp:()=>{this.isModes[c]&&(this.currActiveModeIdx=c),i(),this.renderCursorModesContainer()},onHover:()=>{""!==s&&l.setVisible(!0),o.setAlpha(Pl.alpha.hover),a()},onOut:()=>{l.setVisible(!1);const e=c===this.currActiveModeIdx&&this.isModes[c];o.setAlpha(e?Pl.alpha.active:Pl.alpha.inactive),r()},onPointerMove:e=>{l.x=e.x-o.x-100,l.y=e.y-o.y-100},onHoverEffect:!1}),u=new Phaser.GameObjects.Sprite(e,0,0,t).setDisplaySize(Pl.icon.size,Pl.icon.size);d.add(u),o.add([d,l])}renderCursorModesContainer(){this.removeAll(!1);let e=0;this.cursorModes.forEach(((t,n)=>{t.setPosition(0,e);const s=n===this.currActiveModeIdx&&this.isModes[n];t.setAlpha(s?Pl.alpha.active:Pl.alpha.inactive),this.add(t),e+=Pl.icon.bgSize+Pl.icon.yInterval}))}}const Ml={key:fs.zektonFont.key,size:27,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT};function Ll(e){return e.split("/").pop().split(".")[0]}const Dl=e=>"    "+e;class Bl{constructor(){this.detailMapContainer=void 0,this.objectPlacement=void 0,this.getObjectPlacement=()=>ei(this.objectPlacement)}initialise(e){this.objectPlacement=e}printCheckpoint(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/locations/yourRoom-dim/normal.png",t=arguments.length>1?arguments[1]:void 0;const n=""===e?"default":Ll(e),s=t.map((e=>{const t=e.checkpointTxtLog();if(!t)return"";return`${e.checkpointTitle}\n${t.map(Dl).map(Dl).join("\n")}`})),i=`\nstartingLoc: ${n}\n\nobjectives\n    talk\n\nlocations\n    ${n}, ${e}, ${ta.toCapitalizedWords(e)}\n\n${n}\n    modes: explore\n    actions\n        show_dialogue(welcome)\n${s.map(Dl).join("\n")}\n\ndialogues\n    welcome\n        Congrats on creating your scene\n    click\n        Invisible bounding box is right here\n`;alert("Chapter ready!"),console.log(i)}showDetailMap(e){this.detailMapContainer=new Phaser.GameObjects.Container(this.getObjectPlacement(),0,0),e.forEach((e=>{const t=new Phaser.GameObjects.Rectangle(this.getObjectPlacement(),e.x,e.y,400,210,Os.darkBlue).setOrigin(0,.5).setAlpha(.9),n=_s(this.getObjectPlacement(),this.formatObjectDetails(e),{x:e.x+20,y:e.y+10,oriX:0,oriY:.6},Ml).setLetterSpacing(3);this.detailMapContainer.add([t,n])})),this.getObjectPlacement().add.existing(this.detailMapContainer)}formatObjectDetails(e){return Object.entries(e).map((e=>{let[t,n]=e;return`${t}: ${"number"===typeof n?ta.toIntString(n):n.toString()}`})).join("\n")}hideDetailMap(){this.detailMapContainer&&this.detailMapContainer.destroy()}}class Ul{constructor(){this.checkpointTitle="objects",this.objectPlacement=void 0,this.objectDetailMap=void 0,this.getObjectPlacement=()=>ei(this.objectPlacement),this.objectDetailMap=new Map}initialise(e){this.objectPlacement=e,this.objectDetailMap=new Map}async loadObject(){const e=sessionStorage.getItem("selectedAsset");if(!e)return;const t=`#${e}`;this.getObjectPlacement().addAsset(t,e);const n=await Ar(this.getObjectPlacement(),t,Zs(e,!0));this.renderObject(n)}renderObject(e){if("#"!==e[0])return;const t=new Phaser.GameObjects.Image(this.getObjectPlacement(),js.x,js.y,e).setInteractive().setDataEnabled();this.getObjectPlacement().input.setDraggable(t),this.getObjectPlacement().getLayerManager().addToLayer(zs.Objects,t),this.registerObject(e,t)}registerObject(e,t){const n=this.generateItemId(e,this.getObjectPlacement().generateItemIdNumber()),s={id:n,assetKey:e,assetPath:ei(this.getObjectPlacement().getAssetPath(e)),x:js.x,y:js.y};this.objectDetailMap.set(n,s),t.data.set("itemId",n),t.data.set("type","object"),this.getObjectPlacement().setActiveSelection(t)}generateItemId(e,t){return`${Ll(e)}${t}`}getLoggables(){return[...this.objectDetailMap.values()]}checkpointTxtLog(){return Array.from(this.objectDetailMap.values()).map((e=>{const t=["+"+e.id,e.assetPath,ta.toIntString(e.x),ta.toIntString(e.y)];return e.width&&(t.push(ta.toIntString(e.width)),t.push(ta.toIntString(e.height))),t.join(", ")}))}setAttribute(e,t,n){const s=e.data.get("itemId"),i=this.objectDetailMap.get(s);i&&(i[t]=n)}deleteAll(){this.objectDetailMap.clear()}delete(e){const t=e.data.get("itemId");this.objectDetailMap.delete(t)}}var Gl={activeSelectMargin:30,scaleFactor:1.02};class Fl{constructor(){this.activeSelection=void 0,this.activeSelectRect=void 0,this.objectPlacement=void 0,this.getObjectPlacement=()=>ei(this.objectPlacement)}initialise(e){this.objectPlacement=e,this.trackDraggables(e),this.drawActiveSelectRect(),this.bindDeleteKey()}drawActiveSelectRect(){this.activeSelectRect=new Phaser.GameObjects.Rectangle(this.getObjectPlacement(),0,0,1,1,0).setAlpha(.3),this.getObjectPlacement().getLayerManager().addToLayer(zs.Selector,this.activeSelectRect)}trackDraggables(e){e.getInputManager().registerEventListener("drag",((t,n,s,i)=>{e.isCursorMode(Il.DrawBBox)||(e.getCursorManager().setCursorMode(Il.DragResizeObj),n.x=s,n.y=i),"object"===n.data.get("type")&&(e.setObjAttribute(n,"x",s),e.setObjAttribute(n,"y",i),this.setActiveSelection(n)),"bbox"===n.data.get("type")&&(e.setBBoxAttribute(n,"x",s),e.setBBoxAttribute(n,"y",i),this.setActiveSelection(n))}))}resizeActive(e){const t=this.getObjectPlacement();if(!this.activeSelection||!this.activeSelectRect)return;const n=e?Gl.scaleFactor:1/Gl.scaleFactor;!function(e,t){e.displayWidth*=t,e.displayHeight*=t}(this.activeSelection,n),this.activeSelectRect.displayHeight=this.activeSelection.displayHeight+Gl.activeSelectMargin,this.activeSelectRect.displayWidth=this.activeSelection.displayWidth+Gl.activeSelectMargin,"object"===this.activeSelection.data.get("type")&&(t.setObjAttribute(this.activeSelection,"width",Math.abs(this.activeSelection.displayWidth)),t.setObjAttribute(this.activeSelection,"height",Math.abs(this.activeSelection.displayHeight))),"bbox"===this.activeSelection.data.get("type")&&(t.setBBoxAttribute(this.activeSelection,"width",Math.abs(this.activeSelection.displayWidth)),t.setBBoxAttribute(this.activeSelection,"height",Math.abs(this.activeSelection.displayHeight)))}setActiveSelection(e){this.activeSelectRect&&(this.activeSelectRect.setAlpha(.3),this.activeSelection=e,this.activeSelectRect.x=e.x,this.activeSelectRect.y=e.y,this.activeSelectRect.displayHeight=e.displayHeight+Gl.activeSelectMargin,this.activeSelectRect.displayWidth=e.displayWidth+Gl.activeSelectMargin)}deselect(){this.activeSelectRect.setAlpha(0),this.activeSelection=void 0}bindDeleteKey(){[Phaser.Input.Keyboard.KeyCodes.BACKSPACE,Phaser.Input.Keyboard.KeyCodes.DELETE].forEach((e=>this.getObjectPlacement().getInputManager().registerKeyboardListener(e,"up",(()=>{this.deleteActiveSelection(),this.deselect()}))))}deleteActiveSelection(){if(this.activeSelection){switch(this.getType(this.activeSelection)){case"object":this.getObjectPlacement().deleteObj(this.activeSelection);break;case"bbox":this.getObjectPlacement().deleteBBox(this.activeSelection)}this.activeSelection.destroy()}}getType(e){var t;return null===(t=this.activeSelection)||void 0===t?void 0:t.data.get("type")}}var Hl={cursor:{x:100,y:100}};class Vl extends Phaser.Scene{constructor(){super("ObjectPlacement"),this.layerManager=void 0,this.inputManager=void 0,this.transformManager=void 0,this.cursorModes=void 0,this.bboxManager=void 0,this.objectManager=void 0,this.backgroundManager=void 0,this.logManager=void 0,this.assetMap=void 0,this.itemIdNumber=void 0,this.openBracket=void 0,this.closedBracket=void 0,this.getCursorManager=()=>ei(this.cursorModes),this.getInputManager=()=>ei(this.inputManager),this.getLayerManager=()=>ei(this.layerManager),this.objectManager=new Ul,this.bboxManager=new Nl,this.backgroundManager=new _l,this.logManager=new Bl,this.transformManager=new Fl,this.cursorModes=void 0,this.itemIdNumber=0,this.assetMap=new Map}init(){this.layerManager=new Oa(this),this.inputManager=new xa(this),this.objectManager=new Ul,this.bboxManager=new Nl,this.backgroundManager=new _l,this.logManager=new Bl,this.transformManager=new Fl,this.cursorModes=void 0,this.itemIdNumber=0,this.assetMap=new Map}create(){zo.getInstance().setCurrentSceneRef(this),this.renderBackground(),this.createUIButtons(),this.backgroundManager.initialise(this),this.objectManager.initialise(this),this.bboxManager.initialise(this),this.transformManager.initialise(this),this.logManager.initialise(this),this.openBracket=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.OPEN_BRACKET),this.closedBracket=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.CLOSED_BRACKET)}update(){this.openBracket&&this.openBracket.isDown&&this.transformManager.resizeActive(!1),this.closedBracket&&this.closedBracket.isDown&&this.transformManager.resizeActive(!0),this.bboxManager.resizeWhileBeingDrawn(this)}createUIButtons(){const e=new Phaser.GameObjects.Container(this,0,0),t=new $a(this,(()=>{this.cleanUp(),zo.getInstance().setStorySimState(Wc.Default),this.scene.start("StorySimulatorMenu")}));this.cursorModes=new Rl(this,Hl.cursor.x,Hl.cursor.y),this.populateCursorModes(),e.add(this.cursorModes),e.add(t),this.getLayerManager().addToLayer(zs.UI,e)}renderBackground(){const e=new Phaser.GameObjects.Image(this,js.x,js.y,Tl.storySimBg.key);e.setDisplaySize(ys.x,ys.y),this.getLayerManager().addToLayer(zs.Background,e)}populateCursorModes(){this.cursorModes&&(this.cursorModes.addCursorMode(this,Tl.colorIcon.key,!1,"Set background",(async()=>await this.backgroundManager.loadBackground())),this.cursorModes.addCursorMode(this,Tl.imageIcon.key,!1,"Add selected object",(async()=>await this.objectManager.loadObject())),this.cursorModes.addCursorMode(this,Tl.bboxIcon.key,!0,"Draw bounding boxes",(()=>this.cursorModes.setCursorMode(Il.DrawBBox))),this.cursorModes.addCursorMode(this,Tl.handIcon.key,!0,"Drag or resize",(()=>this.cursorModes.setCursorMode(Il.DragResizeObj))),this.cursorModes.addCursorMode(this,Tl.listIcon.key,!1,"Print coordinates",(()=>this.logManager.printCheckpoint(this.backgroundManager.getBackgroundAssetPath(),[this.objectManager,this.bboxManager])),(()=>this.logManager.showDetailMap([...this.objectManager.getLoggables(),...this.bboxManager.getLoggables()])),(()=>this.logManager.hideDetailMap())),this.cursorModes.addCursorMode(this,Tl.eraseIcon.key,!1,"Erase all",(()=>{window.confirm("Are you sure you want to delete?")&&(this.getLayerManager().clearSeveralLayers([zs.Background,zs.BBox,zs.Objects]),this.objectManager.deleteAll(),this.bboxManager.deleteAll(),this.transformManager.deselect(),this.renderBackground())})),this.cursorModes.renderCursorModesContainer())}getCoordinates(){return[this.input.x,this.input.y]}isCursorMode(e){return this.getCursorManager().getCurrCursorMode()===e}cleanUp(){this.getInputManager().clearListeners(),this.getLayerManager().clearAllLayers()}addAsset(e,t){this.assetMap.set(e,t)}getAssetPath(e){return this.assetMap.get(e)}generateItemIdNumber(){return this.itemIdNumber++}setActiveSelection(e){this.transformManager.setActiveSelection(e)}setObjAttribute(e,t,n){this.objectManager.setAttribute(e,t,n)}deleteObj(e){this.objectManager.delete(e)}setBBoxAttribute(e,t,n){this.bboxManager.setAttribute(e,t,n)}deleteBBox(e){this.bboxManager.delete(e)}}const Wl={debug:!0,type:bs.CANVAS,width:ys.x,height:ys.y,physics:{default:"arcade"},scale:{mode:bs.Scale.FIT,parent:"game-display"},fps:{target:24}};var $l=function(){const e=Object(x.f)((e=>e.session)),[t,n]=f.useState(Wc.Default);return f.useEffect((()=>{(()=>{const e=new zo(Wl,qo.Simulator);return e.scene.add("StorySimulatorMenu",Al,!0),e.scene.add("ObjectPlacement",Vl),e.scene.add("GameManager",or),e.scene.add("CheckpointTransition",Oo),e})().setStorySimStateSetter(n)}),[]),f.useEffect((()=>{zo.getInstance().setAccountInfo({accessToken:e.accessToken,refreshToken:e.refreshToken,role:e.role,name:e.name})}),[e]),Object(ne.jsx)(ne.Fragment,{children:Object(ne.jsxs)("div",{className:"StorySimulatorWrapper",children:[Object(ne.jsx)("div",{id:"game-display"}),Object(ne.jsxs)("div",{className:"LeftAlign StorySimulatorPanel",children:[t===Wc.Default&&Object(ne.jsx)(ne.Fragment,{children:Object(ne.jsx)("h3",{children:"Welcome to story simulator!"})}),t===Wc.CheckpointSim&&Object(ne.jsx)(Cl,{}),t===Wc.ObjectPlacement&&Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("h3",{children:"Asset Selection"}),Object(ne.jsx)(dl,{})]}),t===Wc.AssetUploader&&Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("h3",{children:"Asset uploader"}),Object(ne.jsx)(il,{}),Object(ne.jsx)("h3",{children:"Asset Viewer"}),Object(ne.jsx)(dl,{})]}),t===Wc.ChapterSim&&Object(ne.jsx)(yl,{})]})]})})};const Xl=[{field:"name"},{field:"NUS Net ID"},{field:"Assessment Xp"},{field:"Achievement Xp"}],ql={resizable:!0,sortable:!0},zl=(e,t,n,s)=>0===n?"(none)":t!==n?`(#${e*t-19} - #${e*t})`:`(#${e*t-19} - #${s})`;var Yl=()=>{const e=Object(r.c)(),t=Object(x.f)((e=>e.session.allUserXp)),[n,s]=Object(f.useState)([]),[i,a]=Object(f.useState)(),[o,c]=Object(f.useState)({currPage:1,maxPages:1,rowCountString:"(none)",isBackDisabled:!0,isForwardDisabled:!0});Object(f.useEffect)((()=>{if(t){const e=t.map((e=>{const[t,n,s,i]=e;return{name:null!==t&&void 0!==t?t:"","NUS Net ID":null!==n&&void 0!==n?n:"","Assessment Xp":null!==s&&void 0!==s?s:"0","Achievement Xp":null!==i&&void 0!==i?i:"0"}}));s(e)}}),[t]);const l=Object(f.useCallback)((()=>{i&&i.exportDataAsCsv({fileName:`SA XP Count (${(new Date).toISOString()}).csv`,columnKeys:["name","NUS Net ID","Assessment Xp","Achievement Xp"]})}),[i]),d=Object(f.useCallback)((()=>{i&&i.sizeColumnsToFit()}),[i]),p=Object(f.useCallback)((e=>()=>{if(i)switch(e){case"first":return i.paginationGoToFirstPage();case"prev":return i.paginationGoToPreviousPage();case"next":return i.paginationGoToNextPage();case"last":return i.paginationGoToLastPage()}}),[i]),g=Object(f.useCallback)((()=>{if(i){const e=i.paginationGetTotalPages(),t=0===e?0:i.paginationGetCurrentPage()+1;c({currPage:t,maxPages:e,rowCountString:zl(25,t,e,i.paginationGetRowCount()),isBackDisabled:0===e||1===t,isForwardDisabled:0===e||t===e})}}),[i,c]),m=Object(f.useCallback)((e=>{a(e.api),g()}),[a,g]),b=()=>Object(ne.jsx)("div",{className:"grading-controls",children:Object(ne.jsxs)("div",{className:"GridControls ag-grid-controls",children:[Object(ne.jsx)("div",{style:{width:"130px"},className:"left-controls"}),Object(ne.jsxs)("div",{className:"centre-controls",children:[Object(ne.jsx)(h.b,{icon:C.a.CHEVRON_BACKWARD,onClick:p("first"),minimal:!0,disabled:o.isBackDisabled}),Object(ne.jsx)(h.b,{icon:C.a.CHEVRON_LEFT,onClick:p("prev"),minimal:!0,disabled:o.isBackDisabled}),Object(ne.jsxs)(h.b,{className:"pagination-details hidden-xs",disabled:!0,minimal:!0,children:[Object(ne.jsx)("div",{children:`Page ${o.currPage} of ${o.maxPages}`}),Object(ne.jsx)("div",{children:o.rowCountString})]}),Object(ne.jsx)(h.b,{icon:C.a.CHEVRON_RIGHT,onClick:p("next"),minimal:!0,disabled:o.isForwardDisabled}),Object(ne.jsx)(h.b,{icon:C.a.CHEVRON_FORWARD,onClick:p("last"),minimal:!0,disabled:o.isForwardDisabled})]}),Object(ne.jsx)("div",{className:"right-controls",children:Object(ne.jsx)(h.b,{icon:C.a.EXPORT,onClick:l,children:Object(ne.jsx)("span",{className:"hidden-xs",children:"Export to CSV"})})})]})}),v=Object(ne.jsx)(h.G,{className:"Grading",description:"Fetching XP...",icon:Object(ne.jsx)(h.R,{size:h.S.LARGE})}),y=Object(ne.jsxs)("div",{className:"Grading",children:[Object(ne.jsx)(b,{}),Object(ne.jsx)(h.i,{}),Object(ne.jsx)(Ln.AgGridReact,{domLayout:"autoHeight",className:"ag-grid-parent ag-theme-balham",columnDefs:Xl,onGridReady:m,onPaginationChanged:g,onGridSizeChanged:d,defaultColDef:ql,rowData:n,rowHeight:30,pagination:!0,paginationPageSize:20,suppressCellSelection:!0,suppressMovableColumns:!0,suppressPaginationPanel:!0})]});return Object(ne.jsx)(Me.a,{loadContentDispatch:()=>e(Object(u.fetchAllUserXp)()),display:t?y:v,fullWidth:!1})};const Kl=()=>{const{path:e,url:t}=Object(o.k)(),n=Object(r.c)();f.useEffect((()=>{n(Object(u.fetchNotifications)())}),[n]);const s=Object(x.f)((e=>e.session.assessmentConfigurations)),i=Object(x.f)((e=>e.session.enableGame)),a=Object(x.f)((e=>e.session.role)),c="student"!==a?[Object(ne.jsx)(o.c,{path:`${e}/groundcontrol`,component:Ic},0),Object(ne.jsx)(o.c,{path:`${e}/grading/${Ye.e}`,component:vc},1),Object(ne.jsx)(o.c,{path:`${e}/xpcalculation`,component:Yl},2),Object(ne.jsx)(o.c,{path:`${e}/sourcereel`,component:Vc},3),Object(ne.jsx)(o.c,{path:`${e}/storysimulator`,component:$l},4),Object(ne.jsx)(o.c,{path:`${e}/dashboard`,component:ms},5)]:null;return Object(ne.jsx)("div",{className:"Academy",children:Object(ne.jsxs)(o.e,{children:[null===s||void 0===s?void 0:s.map((t=>Object(ne.jsx)(o.c,{path:`${e}/${Object(Ee.a)(t.type)}/${Ye.d}`,children:Object(ne.jsx)(ze,{assessmentConfiguration:t})},t.type))),i&&Object(ne.jsx)(o.c,{path:`${e}/game`,component:Jo}),Object(ne.jsx)(o.c,{path:`${e}/sourcecast/:sourcecastId?`,component:Qn}),Object(ne.jsx)(o.c,{path:`${e}/achievements`,component:xn}),Object(ne.jsx)(o.c,{exact:!0,path:e,children:Object(ne.jsx)(o.b,{push:!1,to:i?`${t}/game`:s&&s.length>0?`${t}/${Object(Ee.a)(s[0].type)}`:"admin"===a?`${t}/adminpanel`:"/404"})}),c,"admin"===a&&Object(ne.jsx)(o.c,{path:`${e}/adminpanel`,component:us}),Object(ne.jsx)(o.c,{component:Ke})]})})};var Ql=()=>{const e=Object(r.c)(),t=Object(x.f)((e=>e.session.courseId)),{courseId:n}=Object(o.j)(),s=null!=n?parseInt(n,10):void 0;return f.useEffect((()=>{void 0!==s&&t!==s&&e(Object(u.updateLatestViewedCourse)(s))}),[t,e,s]),s===t?Object(ne.jsx)(Kl,{}):Object(ne.jsx)("div",{className:j()("Academy-switching-courses",p.a.DARK),children:Object(ne.jsx)(h.e,{className:p.a.ELEVATION_4,children:Object(ne.jsx)(h.G,{description:"Switching courses...",icon:Object(ne.jsx)(h.R,{size:h.S.LARGE})})})})};const Jl=Object(ne.jsx)("span",{className:"dot",children:"\u2022"});var Zl=()=>Object(ne.jsx)("div",{className:"outsideDetails",children:Object(ne.jsxs)(h.e,{className:"contributorsDetails",elevation:S.a.ONE,children:[Object(ne.jsx)(h.q,{children:"The Team behind the Source Academy"}),Object(ne.jsxs)("p",{className:"description",children:["The ",Object(ne.jsx)("i",{children:"Source Academy"})," is designed and developed by a team of students, most of who have used the system to learn the fundamentals of computing and enjoyed it. This page includes all developers who contributed to the Source Academy ",Object(ne.jsx)("i",{children:"Merlin"})," (2023) and its precursors"," ",Object(ne.jsx)("i",{children:"Rook"})," (2022), ",Object(ne.jsx)("i",{children:"Knight"})," (2020) and ",Object(ne.jsx)("i",{children:"Cadet"})," (2018). These versions succeeded Source Academy 2 (2017) and ultimately the original Source Academy (2016)."]}),Object(ne.jsxs)("div",{className:"leadership",children:[Object(ne.jsx)(h.s,{children:Object(ne.jsx)("strong",{children:Object(ne.jsx)("u",{children:"2023 Leadership (Merlin)"})})}),Object(ne.jsxs)("p",{children:["Chow En Rong,",Object(ne.jsx)("br",{}),"Shen Yi Hong",Object(ne.jsx)("br",{}),Object(ne.jsx)("strong",{children:"(Frontend)"})]}),Jl,Object(ne.jsxs)("p",{children:["Chen Yanyu",Object(ne.jsx)("br",{}),Object(ne.jsx)("strong",{children:"(Backend)"})]}),Jl,Object(ne.jsxs)("p",{children:["Gokul Rajiv,",Object(ne.jsx)("br",{}),"Lee Hyung Woon",Object(ne.jsx)("br",{}),Object(ne.jsx)("strong",{children:"(Game)"})]}),Jl,Object(ne.jsxs)("p",{children:["Shen Yi Hong,",Object(ne.jsx)("br",{}),"Zhan Jie,",Object(ne.jsx)("br",{}),Object(ne.jsx)("strong",{children:"(Source)"})]}),Jl,Object(ne.jsxs)("p",{children:["Lee Yi,",Object(ne.jsx)("br",{}),"Joel Leow",Object(ne.jsx)("br",{}),Object(ne.jsx)("strong",{children:"(Modules)"})]}),Jl,Object(ne.jsxs)("p",{children:["Richard Dominick",Object(ne.jsx)("br",{}),Object(ne.jsx)("strong",{children:"(Robotics)"})]}),Jl,Object(ne.jsxs)("p",{children:["Boyd Anderson,",Object(ne.jsx)("br",{}),"Martin Henz,",Object(ne.jsx)("br",{}),"Eldric Liew,",Object(ne.jsx)("br",{}),"Low Kok Lim,",Object(ne.jsx)("br",{}),"Sanka Rasnayaka",Object(ne.jsx)("br",{}),Object(ne.jsx)("strong",{children:"(Coordination)"})]})]}),Object(ne.jsxs)("div",{className:"hallOfFame",children:[Object(ne.jsx)(h.s,{children:Object(ne.jsx)("strong",{children:Object(ne.jsx)("u",{children:"Hall of Fame"})})}),Object(ne.jsx)("p",{children:Object(ne.jsx)("strong",{children:"Cadet architect"})}),Object(ne.jsx)("p",{children:"Evan Sebastian"}),Object(ne.jsx)("p",{children:Object(ne.jsx)("strong",{children:"Cadet core team"})}),Object(ne.jsxs)("p",{children:["Julius Putra Tanu Setiaji ",Jl," Lee Ning Yuan ",Jl," Vignesh Shankar ",Jl," Thomas Tan ",Jl," ","Chen Shaowei"]}),Object(ne.jsx)("p",{children:Object(ne.jsx)("strong",{children:"Graphic design"})}),Object(ne.jsxs)("p",{children:["Ng Tse Pei ",Jl," Joey Yeo ",Jl," Tan Yu Wei ",Jl," Sigmund Chianasta"]})]}),Object(ne.jsxs)("div",{className:"leadership",children:[Object(ne.jsx)("p",{children:Object(ne.jsx)("strong",{children:"2019 Leadership"})}),Object(ne.jsx)("br",{}),Object(ne.jsxs)("p",{children:["Liow Jia Chen",Object(ne.jsx)("br",{}),"(Backend)"]}),Jl,Object(ne.jsxs)("p",{children:["Ge Shuming",Object(ne.jsx)("br",{}),"(Frontend)"]}),Jl,Object(ne.jsxs)("p",{children:["Rahul Rajesh",Object(ne.jsx)("br",{}),"(DevOps)"]}),Jl,Object(ne.jsxs)("p",{children:["Daryl Tan",Object(ne.jsx)("br",{}),"(Source)"]}),Jl,Object(ne.jsxs)("p",{children:["She Jiayu",Object(ne.jsx)("br",{}),"(Tools)"]})]}),Object(ne.jsxs)("div",{className:"leadership",children:[Object(ne.jsx)("p",{className:"evenWider",children:Object(ne.jsx)("strong",{children:"2020 Leadership (Knight)"})}),Object(ne.jsx)("br",{}),Object(ne.jsxs)("p",{children:["Tiffany Chong",Object(ne.jsx)("br",{}),"(Game)"]}),Jl,Object(ne.jsxs)("p",{children:["Anthony Halim",Object(ne.jsx)("br",{}),"(Architecture)"]}),Jl,Object(ne.jsxs)("p",{children:["Kan Yip Keng, Jet",Object(ne.jsx)("br",{}),"(Frontend)"]}),Jl,Object(ne.jsxs)("p",{children:["Low Jun Kai, Sean",Object(ne.jsx)("br",{}),"(Frontend)"]}),Jl,Object(ne.jsxs)("p",{children:["Daryl Tan",Object(ne.jsx)("br",{}),"(Source)"]}),Jl,Object(ne.jsxs)("p",{className:"wider",children:["Tee Hao Wei",Object(ne.jsx)("br",{}),"(Backend & DevOps)"]})]}),Object(ne.jsxs)("div",{className:"leadership",children:[Object(ne.jsx)("p",{children:Object(ne.jsx)("strong",{children:"2021 Leadership"})}),Object(ne.jsx)("br",{}),Object(ne.jsxs)("p",{children:["Tiffany Chong",Object(ne.jsx)("br",{}),"(Game)"]}),Jl,Object(ne.jsxs)("p",{children:["Anthony Halim",Object(ne.jsx)("br",{}),"(Frontend)"]}),Jl,Object(ne.jsxs)("p",{className:"evenWider",children:["Daryl Tan, Thomas Tan",Object(ne.jsx)("br",{}),"(Source)"]}),Jl,Object(ne.jsxs)("p",{className:"wider",children:["Tee Hao Wei",Object(ne.jsx)("br",{}),"(Backend & DevOps)"]})]}),Object(ne.jsxs)("div",{className:"leadership",children:[Object(ne.jsx)("p",{className:"evenWider",children:Object(ne.jsx)("strong",{children:"2022 Leadership (Rook)"})}),Object(ne.jsx)("br",{}),Object(ne.jsxs)("p",{children:["Tee Hao Wei",Object(ne.jsx)("br",{}),"(CTO)"]}),Jl,Object(ne.jsxs)("p",{children:["Chow En Rong",Object(ne.jsx)("br",{}),"(Frontend)"]}),Jl,Object(ne.jsxs)("p",{children:["Chen Yanyu",Object(ne.jsx)("br",{}),"(Backend)"]}),Jl,Object(ne.jsxs)("p",{children:["Samuel Fang",Object(ne.jsx)("br",{}),"(SICP JS)"]}),Jl,Object(ne.jsxs)("p",{children:["Gokul Rajiv,",Object(ne.jsx)("br",{}),"Lee Hyung Woon",Object(ne.jsx)("br",{}),"(Game)"]}),Jl,Object(ne.jsxs)("p",{children:["Shen Yi Hong,",Object(ne.jsx)("br",{}),"Zhan Jie,",Object(ne.jsx)("br",{}),"Thomas Tan",Object(ne.jsx)("br",{}),"(Source)"]}),Jl,Object(ne.jsxs)("p",{children:["Bryan Loh,",Object(ne.jsx)("br",{}),"Marcus Tang",Object(ne.jsx)("br",{}),"(Modules)"]})]}),Object(ne.jsxs)("div",{className:"contributors",children:[Object(ne.jsx)(h.s,{children:Object(ne.jsx)("strong",{children:Object(ne.jsx)("u",{children:"All Contributors"})})}),Object(ne.jsxs)("p",{children:["Below are all contributors to the"," ",Object(ne.jsx)("a",{href:we.a.githubOrg,children:"GitHub repositories of the Source Academy"}),". Feel free to join us!"]})]})]})});const ed=["assessments","tools","source-academy2"],td=["dependabot[bot]","dependabot-preview[bot]"];var nd=()=>{const[e,t]=Object(f.useState)([]),[n,s]=Object(f.useState)([]);Object(f.useEffect)((()=>{(async()=>{const e=await fetch("https://api.github.com/orgs/source-academy/repos"),t=await e.json();return await t.filter((e=>!ed.includes(e.name))).map((e=>({key:e.id,name:e.name,description:e.description,link:e.contributors_url})))})().then((e=>{(async e=>{const t=await Promise.all(e.map((e=>fetch(e.link)))),n=await Promise.all(t.map((e=>e.json())));return await Promise.all(n.map((e=>e.filter((e=>!td.includes(e.login))).map((e=>({key:e.id,photo:e.avatar_url,githubPage:e.html_url,githubName:e.login,commits:e.contributions}))))))})(e).then((n=>{t(e),s(n)}))}))}),[]);const i=n.length?n.map(((t,n)=>{const s=e[n],i=t.map((e=>Object(ne.jsxs)("div",{children:[Object(ne.jsx)("img",{src:e.photo,alt:"Contributor"}),Object(ne.jsx)("p",{children:Object(ne.jsx)("a",{href:e.githubPage,rel:"noopener noreferrer",target:"_blank",children:e.githubName})}),Object(ne.jsxs)("p",{children:["Commits: ",e.commits]})]},e.key)));return Object(ne.jsxs)(h.e,{className:"containerPermalink",elevation:S.a.ONE,children:[Object(ne.jsxs)("div",{className:"repoDetailsPermalink",children:[Object(ne.jsx)(h.q,{children:s.name}),Object(ne.jsx)(h.s,{children:s.description})]}),Object(ne.jsx)("div",{className:"inPermalink",children:i})]},s.key)})):Object(ne.jsx)(h.p,{children:"Loading..."});return Object(ne.jsx)("div",{children:i})};var sd=()=>Object(ne.jsx)("div",{className:"fullpage",children:Object(ne.jsxs)(h.e,{className:"fullpage-content",elevation:S.a.THREE,children:[Object(ne.jsx)(Zl,{}),Object(ne.jsx)(nd,{})]})});var id=e=>{let{reason:t}=e;return Object(ne.jsx)("div",{className:j()("NoPage",p.a.DARK),children:Object(ne.jsx)(h.G,{icon:C.a.ERROR,title:"Disabled",description:`The Source Academy has been disabled${t?` for this reason: ${t}`:""}.`})})},ad=n(449),rd=n(194),od=n(452);function cd(e){const t=rd.parse(e);for(const[n,s]of Object.entries(t))Object(od.isArray)(s)?t[n]=s.join(","):null===s&&delete t[n];return t}var ld=n(70);function dd(e){let{title:t,children:n}=e;return Object(ne.jsx)("div",{className:j()("NoPage",p.a.DARK),children:Object(ne.jsx)(h.G,{icon:C.a.ERROR,title:t,description:n})})}var ud=function(e){let{location:t}=e;const n=cd(t.search).code,[s,i]=Object(f.useState)("initial");return Object(f.useEffect)((()=>{"initial"===s&&we.b.githubClientId&&n&&(i("loading"),async function(e,t,n){const s=await ld.e(we.b.githubOAuthProxyUrl,rd.stringify({code:e,clientId:t}));let i;try{if(i=await s.json(),"undefined"===typeof i.access_token)throw new Error("Access Token not found in payload")}catch(a){return void n()}try{new BroadcastChannel("GitHubOAuthAccessToken").postMessage(i.access_token),window.close()}catch(a){}}(n,we.b.githubClientId,(()=>i("error"))))}),[n,s]),we.b.githubClientId?n?"error"===s?Object(ne.jsx)(dd,{title:"We couldn't authenticate you with GitHub",children:"Connection with server was denied, or incorrect payload received. Please try again or contact the website administrator."}):Object(ne.jsx)("div",{className:j()("NoPage",p.a.DARK),children:Object(ne.jsx)(h.G,{description:"Logging In...",icon:Object(ne.jsx)(h.R,{size:h.S.LARGE})})}):Object(ne.jsx)(dd,{title:"We couldn't authenticate you with GitHub",children:"Access code not found in callback URL. Please try again or contact the website administrator."}):Object(ne.jsx)(dd,{title:"We couldn't authenticate you with GitHub",children:"Client ID not included with deployment. Please try again or contact the website administrator."})};const hd=[...we.b.authProviders.entries()].map((e=>{let[t,{name:n}]=e;return{id:t,name:n}})),pd=e=>{let{handleClick:t,id:n,name:s}=e;return Object(ne.jsx)(h.b,{className:p.a.LARGE,rightIcon:C.a.LOG_IN,onClick:f.useCallback((()=>t(n)),[t,n]),children:`Log in with ${s}`})};var gd=()=>{const e=Object(r.c)(),t=Object(o.i)(),{code:n,provider:s}=cd(t.search),i=f.useCallback((t=>e(Object(u.login)(t))),[e]);return f.useEffect((()=>{n&&e(Object(u.fetchAuth)(n,s))}),[n,s,e]),n?Object(ne.jsx)("div",{className:j()("Login",p.a.DARK),children:Object(ne.jsx)(h.e,{className:j()("login-card",p.a.ELEVATION_4),children:Object(ne.jsx)("div",{className:"login-body",children:Object(ne.jsx)(h.G,{description:"Logging In...",icon:Object(ne.jsx)(h.R,{size:h.S.LARGE})})})})}):Object(ne.jsx)("div",{className:j()("Login",p.a.DARK),children:Object(ne.jsxs)(h.e,{className:j()("login-card",p.a.ELEVATION_4),children:[Object(ne.jsx)("div",{className:"login-header",children:Object(ne.jsxs)(h.r,{children:[Object(ne.jsx)(h.w,{icon:C.a.LOCK}),"LOGIN"]})}),Object(ne.jsx)("div",{className:"login-body",children:Object(ne.jsx)(h.c,{fill:!0,vertical:!0,children:hd.map((e=>{let{id:t,name:n}=e;return Object(ne.jsx)(pd,{handleClick:i,name:n,id:t},t)}))})})]})})},md=n(259),bd=n(257);const fd=e=>e.charAt(0).toUpperCase()+e.slice(1),vd=()=>{const e=localStorage.getItem("MissionEditingAssessmentSA");return e?JSON.parse(e):null},yd=e=>{localStorage.setItem("MissionEditingAssessmentSA",JSON.stringify(e))},jd=e=>{localStorage.setItem("MissionEditingOverviewSA",JSON.stringify(e))},xd=(e,t)=>{const n=e.CONTENT.TASK[0],s=n.$;return{type:fd(s.kind),isManuallyGraded:!0,closeAt:s.duedate,coverImage:s.coverimage,id:-1,maxXp:t,number:s.number||"",openAt:s.startdate,title:s.title,reading:n.READING?n.READING[0]:"",shortSummary:n.WEBSUMMARY?n.WEBSUMMARY[0]:"",status:H.a.attempting,story:s.story,xp:0,gradingStatus:"none"}},Od=e=>{const t=e.CONTENT.TASK[0],n=t.$,s=wd(t);return[{type:fd(n.kind),id:-1,globalDeployment:Sd(t.DEPLOYMENT),graderDeployment:Sd(t.GRADERDEPLOYMENT),longSummary:t.TEXT[0],missionPDF:"google.com",questions:s[0],title:n.title},s[1]]},Sd=e=>{if(void 0===e)return Object(H.h)();{const t=e[0],n=t.IMPORT||t.EXTERNAL;return{external:{name:n?n[0].$.name:"NONE",symbols:n&&n[0].SYMBOL||[]},globals:t.GLOBAL?t.GLOBAL.map((e=>{return[e.IDENTIFIER[0],(t=e.VALUE[0],Function('"use strict";return ('+t+")")()),e.VALUE[0]];var t})):[]}}},wd=e=>{let t=0;const n=[];return e.PROBLEMS[0].PROBLEM.forEach(((e,s)=>{const i=e.$.maxxp?parseInt(e.$.maxxp,10):0,a={answer:null,content:e.TEXT[0],id:s,library:Sd(e.DEPLOYMENT),graderLibrary:Sd(e.GRADERDEPLOYMENT),type:e.$.type,xp:0,maxXp:i};t+=i,"programming"===a.type&&n.push(Ed(e,a)),"mcq"===a.type&&n.push(Cd(e,a))})),[n,t]},Cd=(e,t)=>{const n=[],s=e.SNIPPET?e.SNIPPET[0].SOLUTION:void 0;let i=0;return e.CHOICE.forEach(((e,t)=>{n.push({content:e.TEXT[0],hint:null}),i="true"===e.$.correct?t:i})),{...t,type:"mcq",answer:s?parseInt(s[0],10):0,choices:n,solution:i}},Ed=(e,t)=>{const n=e.SNIPPET[0].TESTCASES,s=n&&n[0].PUBLIC||[],i=n&&n[0].PRIVATE||[],a=e.SNIPPET[0].PREPEND,r=e.SNIPPET[0].POSTPEND,o=e.SNIPPET[0].SOLUTION,c={...t,autogradingResults:[],prepend:a?a[0].trim():"",solutionTemplate:e.SNIPPET[0].TEMPLATE[0].trim(),postpend:r?r[0].trim():"",testcases:s.map((e=>Td(e))),testcasesPrivate:i.map((e=>Td(e))),answer:o?o[0].trim():"",type:"programming"};return e.SNIPPET[0].GRADER&&(c.graderTemplate=e.SNIPPET[0].GRADER[0]),c},Td=e=>({type:H.f.public,answer:e.$.answer,score:parseInt(e.$.score,10),program:e._}),kd=(e,t)=>{const n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)},Ad=e=>{const t={$:{interpreter:N.Chapter.CALC.toString()},EXTERNAL:{$:{name:e.external.name}}};return 0!==e.external.symbols.length&&(t.EXTERNAL.SYMBOL=e.external.symbols),0!==e.globals.length&&(t.GLOBAL=e.globals.map((e=>({IDENTIFIER:e[0],VALUE:e[2]})))),t},_d=(e,t)=>{const n={},s={coverimage:t.coverImage,duedate:t.closeAt,kind:t.type.toLowerCase(),number:t.number||"",startdate:t.openAt,story:t.story,title:t.title};return n.$=s,t.reading&&""!==t.reading&&(n.READING=t.reading),n.WEBSUMMARY=t.shortSummary,n.TEXT=e.longSummary,n.PROBLEMS={PROBLEM:[]},n.DEPLOYMENT=Ad(e.globalDeployment),n.GRADERDEPLOYMENT=Ad(e.graderDeployment),e.questions.forEach((e=>{const t={$:{type:e.type},SNIPPET:{SOLUTION:e.answer},TEXT:e.content,CHOICE:[]};if(t.$.DEPLOYMENT=Ad(e.library),t.$.GRADERDEPLOYMENT=Ad(e.graderLibrary),e.maxXp&&(t.$.maxxp=e.maxXp),"programming"===e.type){e.graderTemplate&&(t.SNIPPET.GRADER=e.graderTemplate);const n={...t.SNIPPET,TEMPLATE:e.solutionTemplate,PREPEND:e.prepend,POSTPEND:e.postpend,TESTCASES:""};if(e.testcases.length||e.testcasesPrivate.length){if(n.TESTCASES={},e.testcases.length){const t=e.testcases.map((e=>({$:{answer:e.answer,score:e.score},_:e.program})));n.TESTCASES.PUBLIC=t}if(e.testcasesPrivate&&e.testcasesPrivate.length){const t=e.testcasesPrivate.map((e=>({$:{answer:e.answer,score:e.score},_:e.program})));n.TESTCASES.PRIVATE=t}}t.SNIPPET=n}"mcq"===e.type&&e.choices.forEach(((n,s)=>{t.CHOICE.push({$:{correct:e.solution===s?"true":"false"},TEXT:n.content})})),n.PROBLEMS.PROBLEM.push(t)})),n};class Id extends f.Component{constructor(e){var t;super(e),t=this,this.saveEditOverview=e=>t=>{const n={...this.props.overview,[e]:this.state.fieldValue};this.setState({editingOverviewField:"",fieldValue:""}),jd(n),this.props.updateEditingOverview(n)},this.handleEditOverview=()=>e=>{this.setState({fieldValue:e.target.value})},this.toggleEditField=e=>t=>{this.state.editingOverviewField!==e&&this.setState({editingOverviewField:e,fieldValue:this.props.overview[e]})},this.toggleOptionsOverlay=()=>{this.setState({showOptionsOverlay:!this.state.showOptionsOverlay})},this.handleExportXml=e=>{(()=>{const e=localStorage.getItem("MissionEditingAssessmentSA"),t=localStorage.getItem("MissionEditingOverviewSA");if(e&&t){const n=JSON.parse(e),s=JSON.parse(t),i=s.fileName||s.title,a=new bd.Builder,r={CONTENT:{$:{"xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},TASK:_d(n,s)}};let o=a.buildObject(r);o=o.replace(/(&#xD;)+/g,""),kd(i+".xml",o)}})()},this.makeEditingOverviewTextarea=e=>Object(ne.jsx)(md.a,{autoFocus:!0,className:"editing-textarea",onChange:this.handleEditOverview(),onBlur:this.saveEditOverview(e),value:this.state.fieldValue}),this.makeEditingOverviewCard=e=>Object(ne.jsx)("div",{children:Object(ne.jsxs)(h.e,{className:"row listing",elevation:S.a.ONE,children:[Object(ne.jsx)("div",{className:"col-xs-3 listing-picture",onClick:this.toggleEditField("coverImage"),children:"coverImage"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("coverImage"):Object(ne.jsx)("img",{alt:"Assessment cover",className:`cover-image-${e.status}`,src:e.coverImage?e.coverImage:_.a})}),Object(ne.jsxs)("div",{className:"col-xs-9 listing-text",children:[this.makeEditingOverviewCardTitle(e,e.title),Object(ne.jsx)("div",{className:"row listing-xp",children:Object(ne.jsxs)(h.t,{children:[" ",`Max XP: ${e.maxXp}`," "]})}),Object(ne.jsx)("div",{className:"row listing-description",onClick:this.toggleEditField("shortSummary"),children:"shortSummary"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("shortSummary"):Object(ne.jsx)(ee.a,{content:Nd(e.shortSummary)})}),Object(ne.jsxs)("div",{className:"listing-controls",children:[Object(ne.jsxs)(h.Y,{className:"listing-due-date",children:[Object(ne.jsx)(h.w,{className:"listing-due-icon",iconSize:12,icon:C.a.TIME}),Object(ne.jsx)("div",{className:"date-container",children:"Opens at:\xa0"}),Object(ne.jsx)("div",{className:"date-container",onClick:this.toggleEditField("openAt"),children:"openAt"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("openAt"):`${Ae(e.openAt)}`}),Object(ne.jsx)("div",{className:"date-container",children:"\xa0\xa0Due:\xa0"}),Object(ne.jsx)("div",{className:"date-container",onClick:this.toggleEditField("closeAt"),children:"closeAt"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("closeAt"):`${Ae(e.closeAt)}`})]}),Object(ne.jsx)(h.b,{icon:C.a.WRENCH,minimal:!0,onClick:this.toggleOptionsOverlay,children:"Other Options"}),Object(ne.jsx)(A.b,{to:`${this.props.listingPath}/${e.id.toString()}/${we.b.defaultQuestionId}`,children:Object(ne.jsx)(J.a,{label:"Edit mission",icon:C.a.EDIT})})]})]})]})}),this.makeEditingOverviewCardTitle=(e,t)=>Object(ne.jsxs)("div",{className:"row listing-title",children:[Object(ne.jsx)(h.Y,{ellipsize:!0,className:"col-xs-10",children:Object(ne.jsx)(h.r,{onClick:this.toggleEditField("title"),children:"title"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("title"):Nd(t)})}),Object(ne.jsx)("div",{className:"col-xs-2",children:this.makeExportButton(e)})]}),this.makeExportButton=e=>Object(ne.jsx)(h.b,{icon:C.a.EXPORT,intent:g.a.DANGER,minimal:!0,onClick:this.handleExportXml,children:"Save as XML"}),this.saveCategory=(e,t)=>{const n={...this.props.overview,category:e};jd(n),this.props.updateEditingOverview(n)},this.optionsOverlay=()=>Object(ne.jsx)(h.h,{canOutsideClickClose:!1,className:"assessment-reset",icon:C.a.WRENCH,isCloseButtonShown:!0,isOpen:this.state.showOptionsOverlay,onClose:this.toggleOptionsOverlay,title:"Other options",children:Object(ne.jsxs)("div",{className:p.a.DIALOG_BODY,children:[Object(ne.jsx)(h.q,{children:"Assessment Type"}),this.assessmentTypeSelect(this.props.overview.type,this.saveCategory),Object(ne.jsx)(h.q,{children:"Number"}),Object(ne.jsx)("div",{onClick:this.toggleEditField("number"),children:"number"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("number"):Nd(this.props.overview.number||"")}),Object(ne.jsx)(h.q,{children:"Story"}),Object(ne.jsx)("div",{onClick:this.toggleEditField("story"),children:"story"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("story"):Nd(this.props.overview.story||"")}),Object(ne.jsx)("br",{}),Object(ne.jsx)(h.q,{children:"Filename"}),Object(ne.jsx)("div",{onClick:this.toggleEditField("fileName"),children:"fileName"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("fileName"):Nd(this.props.overview.fileName||"")})]})}),this.assessmentTypeSelect=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t)=>{};return Object(ne.jsx)(Pd,{className:p.a.MINIMAL,items:t.props.assessmentTypes,onItemSelect:n,itemRenderer:Rd,filterable:!1,children:Object(ne.jsx)(h.b,{className:p.a.MINIMAL,text:e,rightIcon:C.a.DOUBLE_CARET_VERTICAL})})},this.state={editingOverviewField:"",fieldValue:"",showOptionsOverlay:!1}}render(){return Object(ne.jsxs)("div",{children:[this.optionsOverlay(),this.makeEditingOverviewCard(this.props.overview)]})}}const Nd=e=>e.match("^(\n| )*$")?"Enter Value Here (If Applicable)":e,Pd=ct.a.ofType(),Rd=(e,t)=>{let{handleClick:n,modifiers:s,query:i}=t;return Object(ne.jsx)(h.B,{active:!1,onClick:n,text:e},e)},Md=e=>{let{toggleEditMode:t,editingMode:n}=e;const s="question"===n?"Global":"Question Specific";return Object(ne.jsx)(E.a,{content:"Switch to "+s+" Editing Mode",children:Object(ne.jsx)(J.a,{label:s+" Editing Mode",icon:C.a.REFRESH,onClick:t})})},Ld=(e,t)=>{for(const n of e)t=t[n];return t},Dd=(e,t,n)=>{let s=0;for(s=0;s<e.length-1;s++)n=n[e[s]];n[e[s]]=t},Bd=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n=>{let s;return n="string"===typeof n?parseInt(n,10):n,s=null!==e&&n<e?e:null!==t&&n>t?t:n,s}},Ud=e=>{const t=e.isNumber||!1,[n,s]=Object(f.useState)(!1),[i]=Object(f.useState)(t),[a,r]=Object(f.useState)(""),[o]=Object(f.useState)(e.useRawValue||t),c=t=>{let n;i?(n=parseInt(a,10),isNaN(n)&&(n=Ld(e.path,e.assessment))):n=a;const r=Ld(e.path,e.assessment);if(e.processResults&&(n=e.processResults(n)),n!==r){const t=e.assessment;Dd(e.path,n,t),e.updateAssessment(t)}s(!1)},l=e=>{r(e.target.value)};let d;if(n)d=Object(ne.jsx)(md.a,{autoFocus:!0,className:"editing-textarea",onChange:l,onBlur:c,value:a});else{const t="Please enter value (if applicable)";let n=Ld(e.path,e.assessment);e.isNumber||(n=n||"",n=n.match(/^\s*$/)?t:n),d=o?n:Object(ne.jsx)(ee.a,{content:n})}return Object(ne.jsx)("div",{onClick:t=>{if(!n){const t=Ld(e.path,e.assessment)||"";s(!0),r("string"===typeof t?t:t.toString())}},children:d})};var Gd=Ud;const Fd=e=>{const t=t=>()=>{t.push(Object(H.l)()),e.updateAssessment(e.assessment)},n=(t,n)=>{const s=Ld(t,e.assessment),i=s[n];return Object(ne.jsx)("div",{children:Object(ne.jsx)(h.e,{className:"row listing",elevation:S.a.ONE,children:Object(ne.jsxs)("div",{className:"col-xs-9 listing-text",children:[Object(ne.jsx)("div",{className:"row listing-program",children:Object(ne.jsxs)(h.t,{children:["Test Program:",Object(ne.jsx)(Gd,{assessment:e.assessment,path:t.concat([n,"program"]),useRawValue:!0,updateAssessment:e.updateAssessment})]})}),Object(ne.jsx)("div",{className:"row listing-expected",children:Object(ne.jsxs)(h.t,{children:["Score:",Object(ne.jsx)(Gd,{assessment:e.assessment,isNumber:!0,path:t.concat([n,"score"]),updateAssessment:e.updateAssessment})]})}),Object(ne.jsx)("div",{className:"row listing-expected",children:Object(ne.jsxs)(h.t,{children:["Expected Answer:",Object(ne.jsx)(Gd,{assessment:e.assessment,path:t.concat([n,"answer"]),useRawValue:!0,updateAssessment:e.updateAssessment})]})}),Object(ne.jsx)("div",{className:"listing-controls",children:Object(ne.jsxs)("div",{children:[Object(ne.jsx)(J.a,{label:"Test",icon:C.a.PLAY,onClick:()=>e.handleTestcaseEval(i)}),Object(ne.jsx)(J.a,{label:"Delete",icon:C.a.DELETE,onClick:()=>((t,n)=>{t.splice(n,1),e.updateAssessment(e.assessment)})(s,n)})]})})]})})})},s=e.assessment.questions[e.questionId],i=["questions",e.questionId,"testcases"],a=s.testcases.map(((e,t)=>Object(ne.jsx)("div",{children:n(i,t)},t))),r=["questions",e.questionId,"testcasesPrivate"],o=s.testcasesPrivate.map(((e,t)=>Object(ne.jsx)("div",{children:n(r,t)},t)));return Object(ne.jsxs)("div",{children:["Public Testcases",a,Object(ne.jsx)(J.a,{label:"New public testcase",icon:C.a.PLUS,onClick:t(s.testcases)}),Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),"Private Testcases",o,Object(ne.jsx)(J.a,{label:"New private testcase",icon:C.a.PLUS,onClick:t(s.testcasesPrivate)})]})};var Hd=n(69);class Vd extends f.Component{constructor(){var e;super(...arguments),e=this,this.deploymentTab=()=>{const e=this.props.pathToLibrary,t=Ld(e,this.props.assessment),n=t.external.symbols.map(((t,n)=>Object(ne.jsxs)("tr",{children:[Object(ne.jsx)("td",{children:this.textareaContent(e.concat(["external","symbols",n]))}),Object(ne.jsx)("td",{style:{width:"100px"},children:Object(ne.jsx)(J.a,{label:"Delete",icon:C.a.MINUS,onClick:this.handleSymbolDelete(n)})})]},n))),s=t.globals.map(((t,n)=>Object(ne.jsxs)("tr",{children:[Object(ne.jsx)("td",{style:{width:"170px"},children:this.textareaContent(e.concat(["globals",n,0]))}),Object(ne.jsx)("td",{children:this.globalValueTextareaContent(n)}),Object(ne.jsx)("td",{style:{width:"90px"},children:Object(ne.jsx)(J.a,{label:"Delete",icon:C.a.MINUS,onClick:this.handleGlobalDelete(n)})})]},n))),i=Object(ne.jsx)(J.a,{label:"Use this Library",icon:C.a.REFRESH,onClick:()=>this.props.handleRefreshLibrary(t)}),a=Object(ne.jsxs)(f.Fragment,{children:["External Library:",Object(ne.jsx)("br",{}),Kd(t.external.name,this.handleExternalSelect),Object(ne.jsx)(h.i,{}),Object(ne.jsx)("div",{children:"Symbols:"}),Object(ne.jsx)("br",{}),Object(ne.jsx)("table",{style:{width:"100%"},children:Object(ne.jsx)("tbody",{children:n})}),Object(ne.jsx)(J.a,{label:"New Symbol",icon:C.a.PLUS,onClick:this.handleNewSymbol})]}),r=Object(ne.jsxs)(f.Fragment,{children:[Object(ne.jsx)("div",{children:"Globals:"}),Object(ne.jsx)("br",{}),Object(ne.jsx)("table",{style:{width:"100%",borderSpacing:"5px"},children:Object(ne.jsx)("tbody",{children:s})}),Object(ne.jsx)(J.a,{label:"New Global",icon:C.a.PLUS,onClick:this.handleNewGlobal})]});return Object(ne.jsxs)("div",{children:[Object(ne.jsx)(h.i,{}),i,Object(ne.jsx)(h.i,{}),"Interpreter:",Object(ne.jsx)("br",{}),Xd(t.variant,this.handleChapterSelect),Object(ne.jsx)(h.i,{}),a,Object(ne.jsx)(h.i,{}),r]})},this.textareaContent=e=>Object(ne.jsx)(Gd,{assessment:this.props.assessment,path:e,processResults:Wd,updateAssessment:this.props.updateAssessment,useRawValue:!0}),this.globalValueTextareaContent=e=>{const t=this.props.pathToLibrary.concat(["globals",e,2]);return Object(ne.jsx)(Gd,{assessment:this.props.assessment,path:t,updateAssessment:this.handleGlobalValueUpdate(e),useRawValue:!0})},this.handleGlobalValueUpdate=e=>t=>{const n=Ld(this.props.pathToLibrary,this.props.assessment).globals[e];try{n[1]=$d(n[2]),this.props.updateAssessment(t)}catch(s){n[2]='"Invalid Expression"'}},this.handleSymbolDelete=e=>()=>{const t=this.props.assessment;Ld(this.props.pathToLibrary,t).external.symbols.splice(e,1),this.props.updateAssessment(t)},this.handleNewSymbol=()=>{const e=this.props.assessment;Ld(this.props.pathToLibrary,e).external.symbols.push("new_symbol"),this.props.updateAssessment(e)},this.handleGlobalDelete=e=>()=>{const t=this.props.assessment;Ld(this.props.pathToLibrary,t).globals.splice(e,1),this.props.updateAssessment(t)},this.handleNewGlobal=()=>{const e=this.props.assessment;Ld(this.props.pathToLibrary,e).globals.push(["new_global",null,"null"]),this.props.updateAssessment(e)},this.handleChapterSelect=(e,t)=>{const n=this.props.assessment;this.props.updateAssessment(n)},this.handleExternalSelect=(e,t)=>{const n=this.props.assessment,s=Ld(this.props.pathToLibrary,n);s.external.name=e.name,s.external.symbols=JSON.parse(JSON.stringify(Hd.b.get(e.name))),this.props.updateAssessment(n)},this.handleSwitchDeployment=()=>{const e=this.props.assessment;if(this.isEmptyLibrary()){let t=Ld(this.props.pathToCopy||["globalDeployment"],e);t=JSON.parse(JSON.stringify(t)),Dd(this.props.pathToLibrary,t,e)}else Dd(this.props.pathToLibrary,Object(H.h)(),e);this.props.updateAssessment(e)},this.isEmptyLibrary=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.pathToLibrary;return-1===Ld(t.concat(["chapter"]),e.props.assessment)}}render(){return this.props.isOptionalDeployment?Object(ne.jsxs)("div",{children:[Object(ne.jsx)(h.T,{checked:!this.isEmptyLibrary(),label:"Enable "+this.props.label+" Deployment",onChange:this.handleSwitchDeployment}),this.isEmptyLibrary()?null:this.deploymentTab()]}):Object(ne.jsxs)("div",{children:[this.props.label+" Deployment",Object(ne.jsx)("br",{}),this.deploymentTab()]})}}const Wd=e=>"string"===typeof e?e.replace(/\s+/g,""):e,$d=e=>Function('"use strict";return ('+e+")")(),Xd=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N.Variant.DEFAULT,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t)=>{};return Object(ne.jsx)(qd,{className:p.a.MINIMAL,items:O.n,onItemSelect:t,itemRenderer:zd,filterable:!1,children:Object(ne.jsx)(h.b,{className:p.a.MINIMAL,text:Object(O.o)(N.Chapter.CALC,e),rightIcon:C.a.DOUBLE_CARET_VERTICAL})})},qd=ct.a.ofType(),zd=(e,t)=>{let{handleClick:n,modifiers:s,query:i}=t;return Object(ne.jsx)(h.B,{active:!1,onClick:n,text:e.displayName},e.displayName)},Yd=Array.from(Hd.b.entries()).map(((e,t)=>({name:e[0],key:t,symbols:e[1]}))),Kd=(e,t)=>Object(ne.jsx)(Qd,{className:p.a.MINIMAL,items:Yd,onItemSelect:t,itemRenderer:Jd,filterable:!1,children:Object(ne.jsx)(h.b,{className:p.a.MINIMAL,text:e,rightIcon:C.a.DOUBLE_CARET_VERTICAL})}),Qd=ct.a.ofType(),Jd=(e,t)=>{let{handleClick:n,modifiers:s,query:i}=t;return Object(ne.jsx)(h.B,{active:!1,onClick:n,text:e.name},e.key)};var Zd=Vd;var eu=e=>{return Object(ne.jsxs)("div",{children:["Max Xp:",(t=e.path.concat(["maxXp"]),Object(ne.jsx)(Gd,{assessment:e.assessment,isNumber:!0,path:t,processResults:Bd(0),updateAssessment:e.updateAssessment}))]});var t};const tu=e=>JSON.parse(JSON.stringify(e));var nu=e=>{const[t,n]=Object(f.useState)(!1),[s,i]=Object(f.useState)((()=>{})),a=t=>Object(ne.jsxs)("div",{children:[Object(ne.jsx)(J.a,{label:"Clone",icon:C.a.DOCUMENT,onClick:l(o((()=>tu(e.assessment.questions[t])),t))}),Object(ne.jsx)(J.a,{label:"Delete",icon:C.a.REMOVE,onClick:l(c(t))}),Object(ne.jsx)(J.a,{label:"Shift Up",icon:C.a.CARET_UP,onClick:l(r(-1,t)),isDisabled:0===t}),Object(ne.jsx)(J.a,{label:"Shift Down",icon:C.a.CARET_DOWN,onClick:l(r(1,t)),isDisabled:t>=e.assessment.questions.length-1}),Object(ne.jsx)("br",{}),Object(ne.jsx)(J.a,{label:"Insert Programming Question",icon:C.a.FONT,onClick:l(o(H.k,t))}),Object(ne.jsx)(J.a,{label:"Insert MCQ Question",icon:C.a.CONFIRM,onClick:l(o(H.i,t))})]}),r=(t,n)=>()=>{const s=e.assessment,i=n+t;if(i>=0&&i<s.questions.length){const t=s.questions[n],a=s.questions;a[n]=a[i],a[i]=t,s.questions=a,e.updateAssessment(s),Ce.a.push("/mission-control/-1/"+i.toString())}},o=(t,n)=>()=>{const s=e.assessment;n+=1;const i=s.questions;i.splice(n,0,t()),s.questions=i,e.updateAssessment(s),Ce.a.push("/mission-control/-1/"+n.toString())},c=t=>()=>{const n=e.assessment;let s=n.questions;s.length>1&&(s=s.slice(0,t).concat(s.slice(t+1))),n.questions=s,e.updateAssessment(n)},l=t=>()=>{e.hasUnsavedChanges?(n(!0),i(t)):t()},d=Object(ne.jsxs)(h.h,{className:"assessment-reset",icon:C.a.ERROR,isCloseButtonShown:!0,isOpen:t,title:"Confirmation: Save unsaved changes?",children:[Object(ne.jsx)("div",{className:p.a.DIALOG_BODY,children:Object(ne.jsx)(ee.a,{content:"Are you sure you want to save over your unsaved changes?"})}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)(h.c,{children:[Object(ne.jsx)(J.a,{label:"Cancel",onClick:()=>n(!1),options:{minimal:!1}}),Object(ne.jsx)(J.a,{label:"Confirm",onClick:()=>{s(),n(!1)},options:{minimal:!1,intent:g.a.DANGER}})]})})]});return Object(ne.jsxs)("div",{children:[d,e.assessment.questions.map(((e,t)=>Object(ne.jsxs)("div",{children:["Question ",t+1,Object(ne.jsx)("br",{}),Object(ne.jsx)(h.b,{className:"mcq-option col-xs-12",minimal:!0,children:Object(ne.jsx)(ee.a,{content:e.content.length>200?e.content.substring(0,300)+"...":e.content})}),a(t),Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{})]},t)))]})};var su=e=>{const t=function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0];return n?Object(ne.jsx)(Gd,{assessment:e.assessment,isNumber:!0,path:t,processResults:Bd(s[0],s[1]),updateAssessment:e.updateAssessment}):Object(ne.jsx)(Gd,{assessment:e.assessment,path:t,updateAssessment:e.updateAssessment})},{questionId:n}=e,s=e.assessment.questions[n],i=s.choices.map(((e,s)=>Object(ne.jsxs)("div",{className:"mcq-option col-xs-12",children:["Option ",s,":",t(["questions",n,"choices",s,"content"]),Object(ne.jsx)("br",{}),"Hint:",t(["questions",n,"choices",s,"hint"])]},s))),a=Object(ne.jsx)(J.a,{label:"Delete Option",icon:C.a.REMOVE,onClick:()=>{const{assessment:t,questionId:n}=e,s=t.questions[n],i=s.choices.slice(0,s.choices.length-1);s.choices=i,t.questions[n]=s,e.updateAssessment(t)}});return Object(ne.jsx)("div",{className:"MCQChooser row",children:Object(ne.jsx)(h.e,{className:"mcq-content-parent col-xs-12 middle-xs",children:Object(ne.jsxs)("div",{className:"row mcq-options-parent between-xs",children:[i,"Solution:",t(["questions",n,"solution"],!0,[0,s.choices.length]),Object(ne.jsx)("br",{}),Object(ne.jsx)(J.a,{label:"Add Option",icon:C.a.CONFIRM,onClick:()=>{const{assessment:t,questionId:n}=e,s=t.questions[n],i=s.choices.concat([{content:"A",hint:null}]);s.choices=i,t.questions[n]=s,e.updateAssessment(t)}}),s.choices.length>0?a:void 0]})})})},iu=n(139),au=n.n(iu);const ru=ct.a.ofType(),ou=[{label:"Prepend",icon:C.a.CHEVRON_UP,id:"prepend"},{label:"Postpend",icon:C.a.CHEVRON_DOWN,id:"postpend"},{label:"Solution Template",icon:C.a.MANUAL,id:"solutionTemplate"},{label:"Suggested Answer",icon:C.a.TICK,id:"answer"}];var cu=e=>{const[t,n]=Object(f.useState)(ou[0]),[s,i]=Object(f.useState)(""),[a,r]=Object(f.useState)(!1),o=t=>{const n=a?s:Ld(t,e.assessment);return Object(ne.jsx)("div",{onClick:c(t),onBlur:l(t),children:Object(ne.jsx)(au.a,{className:"react-ace",editorProps:{$blockScrolling:1/0},fontSize:14,highlightActiveLine:!1,mode:"javascript",onChange:i,theme:"source",value:n,width:"100%"})})},c=t=>n=>{a||(i(Ld(t,e.assessment)),r(!0))},l=n=>o=>{if(a){if(Ld(n,e.assessment)!==s){const t=e.assessment;Dd(n,s,t),e.updateAssessment(t)}if("prepend"===t.id){const t=s;e.handleUpdateActiveEditorTab({prependValue:t})}else if("postpend"===t.id){const t=s;e.handleUpdateActiveEditorTab({postpendValue:t})}i(""),r(!1)}},d=t=>()=>{const n=e.assessment;Dd(t,e.editorValue,n),e.updateAssessment(n)},u=t=>()=>{const n=Ld(t,e.assessment);e.handleEditorValueChange(n)};return(()=>{const s=["questions",e.questionId].concat(t.id),i=Object(ne.jsx)(J.a,{label:"Copy from Editor",icon:C.a.IMPORT,onClick:d(s)}),a=Object(ne.jsx)(J.a,{label:"Copy to Editor",icon:C.a.EXPORT,onClick:u(s)}),r=Object(ne.jsxs)("div",{children:[i,a,Object(ne.jsx)(h.i,{}),o(s)]}),c=(e,t)=>{let{handleClick:n}=t;return Object(ne.jsx)(h.B,{active:!1,onClick:n,text:e.label,icon:e.icon},e.id)};return Object(ne.jsx)("div",{className:"side-content",children:Object(ne.jsxs)(h.e,{children:[(l=t,g=n,Object(ne.jsx)(ru,{className:p.a.MINIMAL,items:ou,itemRenderer:c,onItemSelect:g,filterable:!1,children:Object(ne.jsx)(h.b,{className:p.a.MINIMAL,text:l.label,icon:C.a.EDIT,rightIcon:C.a.DOUBLE_CARET_VERTICAL})})),Object(ne.jsx)(h.i,{}),Object(ne.jsx)("div",{className:"side-content-text",children:r})]})});var l,g})()};function lu(e){const t={};return e.filter((e=>!t.hasOwnProperty(e)&&(t[e]=!0)))}var du=e=>{var t,n;const[s,i]=Object(f.useState)(vd()),[a,r]=Object(f.useState)("question"),[o,c]=Object(f.useState)(!1),[l,d]=Object(f.useState)(!1),[u,m]=Object(f.useState)(0);if(Object(f.useEffect)((()=>{s&&(y(),m(w()))}),[]),Object(f.useEffect)((()=>function(){if(void 0===s)return;const t=-1,n=b();e.storedAssessmentId===t&&e.storedQuestionId===n||(y(),e.handleUpdateCurrentAssessmentId(t,n),e.handleUpdateHasUnsavedChanges(!1),o&&(i(vd()),c(!1)),v())}())),null===s||0===s.questions.length)return Object(ne.jsx)(h.G,{className:j()("WorkspaceParent",p.a.DARK),description:"Getting mission ready...",icon:Object(ne.jsx)(h.R,{size:h.S.LARGE})});const b=()=>{let t=e.questionId;return t<0?t=0:t>=s.questions.length&&(t=s.questions.length-1),t};const v=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;const n=s.questions[b()];if(t||(t=n.library),t&&t.globals.length>0){const e=t.globals.map((e=>e[0])),n=t.external.symbols.concat(e);t={...t,external:{name:t.external.name,symbols:lu(n)}}}e.handleClearContext(t,!0)},y=()=>{const t=s.questions[b()];let n,i="",a="";t.type===H.d.programming?(n=t.editorValue?t.editorValue:t.solutionTemplate,i=t.prepend,a=t.postpend):n="//If you see this, this is a bug. Please report bug.",e.handleResetWorkspace({editorTabs:[{value:n,prependValue:i,postpendValue:a,highlightedLines:[],breakpoints:[]}]}),e.handleEditorValueChange(n)},x=t=>{const n=[t];e.handleUpdateWorkspace({editorTestcases:n}),e.handleTestcaseEval(0)},O=()=>{s.questions[b()].editorValue=e.editorTabs[0].value,i(s),c(!1),yd(s),S()},S=()=>{const t=w(),n=t-u;if(0!==n){const s=e.assessmentOverview;0!==n&&(s.maxXp=t),m(t),e.updateAssessmentOverview(s),jd(s)}},w=()=>{let e=0;const t=s.questions;for(const n of t)e+=n.maxXp;return e},E=e=>{i(e),c(!0)},T=e=>{i(e),v(),O(),y()},k=()=>{r("question"===a?"global":"question")};const A=b(),_=s.questions[A],I={controlBarProps:(t=>{const n="/mission-control",i=`/mission-control/${s.id.toString()}`,r=[t+1,s.questions.length],c=Object(ne.jsx)(X.a,{onClickNext:()=>Ce.a.push(i+`/${(t+1).toString()}`),onClickReturn:()=>Ce.a.push(n),questionProgress:r},"next_question"),l=Object(ne.jsx)(q.a,{onClick:()=>Ce.a.push(i+`/${(t-1).toString()}`),questionProgress:r},"previous_question"),u=Object(ne.jsx)(z.a,{questionProgress:r},"question_view"),h=Object(ne.jsx)(Y.a,{onClick:()=>{d((()=>o))}},"reset_template");return{editorButtons:[Object(ne.jsx)(K.a,{handleEditorEval:e.handleEditorEval},"run"),Object(ne.jsx)(Q.a,{hasUnsavedChanges:o,onClickSave:O},"save"),h],flowButtons:[l,u,c],editingWorkspaceButtons:[Object(ne.jsx)(Md,{editingMode:a,toggleEditMode:k},"toggle_edit_mode")]}})(A),editorContainerProps:_.type===H.d.programming?{editorVariant:"normal",editorTabs:e.editorTabs.map(Z.a).map(((e,t)=>0!==t?e:{...e,editorValue:e.editorValue||_.editorValue||_.solutionTemplate})),editorSessionId:"",handleDeclarationNavigate:e.handleDeclarationNavigate,handleEditorEval:e.handleEditorEval,handleEditorCheck:e.handleEditorCheck,handleEditorValueChange:e.handleEditorValueChange,handleEditorUpdateBreakpoints:e.handleEditorUpdateBreakpoints,handleUpdateHasUnsavedChanges:e.handleUpdateHasUnsavedChanges,handlePromptAutocomplete:e.handlePromptAutocomplete,isEditorAutorun:!1}:void 0,handleSideContentHeightChange:e.handleSideContentHeightChange,hasUnsavedChanges:o,mcqProps:{mcq:_,handleMCQSubmit:t=>e.handleSave(s.questions[A].id,t)},sideBarProps:{tabs:[]},sideContentHeight:e.sideContentHeight,sideContentProps:((e,t)=>{const n=s;let i;if("question"===a){const s=n.questions[e.questionId].type,a="mcq"===s?Object(ne.jsx)(su,{assessment:n,questionId:t,updateAssessment:E}):Object(ne.jsx)(cu,{assessment:n,questionId:t,updateAssessment:E,editorValue:e.editorTabs[0].value,handleEditorValueChange:e.handleEditorValueChange,handleUpdateActiveEditorTab:e.handleUpdateActiveEditorTab});i=[{label:`Question ${t+1}`,iconName:C.a.NINJA,body:Object(ne.jsx)(Ud,{assessment:n,path:["questions",t,"content"],updateAssessment:E}),id:Se.b.editorQuestionOverview},{label:"Question Template",iconName:C.a.DOCUMENT,body:a,id:Se.b.editorQuestionTemplate},{label:"Manage Local Deployment",iconName:C.a.HOME,body:Object(ne.jsx)(Zd,{assessment:n,label:"Question Specific",handleRefreshLibrary:v,pathToLibrary:["questions",t,"library"],updateAssessment:E,isOptionalDeployment:!0}),id:Se.b.editorLocalDeployment},{label:"Manage Local Grader Deployment",iconName:C.a.CONFIRM,body:Object(ne.jsx)(Zd,{assessment:n,label:"Question Specific Grader",handleRefreshLibrary:v,pathToLibrary:["questions",t,"graderLibrary"],pathToCopy:["questions",t,"library"],updateAssessment:E,isOptionalDeployment:!0}),id:Se.b.editorLocalGraderDeployment},{label:"Grading",iconName:C.a.TICK,body:Object(ne.jsx)(eu,{assessment:n,path:["questions",t],updateAssessment:E}),id:Se.b.editorGrading}],"programming"===s&&i.push({label:"Autograder",iconName:C.a.AIRPLANE,body:Object(ne.jsx)(Fd,{assessment:n,questionId:t,handleTestcaseEval:x,updateAssessment:E}),id:Se.b.editorAutograder});n.globalDeployment.external.symbols.includes("get_matrix")&&i.push({label:"Tone Matrix",iconName:C.a.GRID_VIEW,body:Object(ne.jsx)(Oe,{}),id:Se.b.toneMatrix})}else i=[{label:`${n.type} Briefing`,iconName:C.a.BRIEFCASE,body:Object(ne.jsx)(Ud,{assessment:n,path:["longSummary"],updateAssessment:E}),id:Se.b.editorBriefing},{label:"Manage Question",iconName:C.a.WRENCH,body:Object(ne.jsx)(nu,{assessment:n,hasUnsavedChanges:o,questionId:t,updateAssessment:T}),id:Se.b.editorManageQuestion},{label:"Manage Global Deployment",iconName:C.a.GLOBE,body:Object(ne.jsx)(Zd,{assessment:n,label:"Global",handleRefreshLibrary:v,pathToLibrary:["globalDeployment"],updateAssessment:E,isOptionalDeployment:!1}),id:Se.b.editorGlobalDeployment},{label:"Manage Global Grader Deployment",iconName:C.a.CONFIRM,body:Object(ne.jsx)(Zd,{assessment:n,label:"Global Grader",handleRefreshLibrary:v,pathToLibrary:["graderDeployment"],updateAssessment:E,isOptionalDeployment:!0}),id:Se.b.editorGlobalGraderDeployment}];return{tabs:{beforeDynamicTabs:i,afterDynamicTabs:[]}}})(e,A),replProps:{handleBrowseHistoryDown:e.handleBrowseHistoryDown,handleBrowseHistoryUp:e.handleBrowseHistoryUp,handleReplEval:e.handleReplEval,handleReplValueChange:e.handleReplValueChange,output:e.output,replValue:e.replValue,sourceChapter:N.Chapter.CALC,sourceVariant:N.Variant.DEFAULT,externalLibrary:(null===_||void 0===_||null===(t=_.library)||void 0===t||null===(n=t.external)||void 0===n?void 0:n.name)||"NONE",replButtons:function(){const t=Object(ne.jsx)(W.a,{handleReplOutputClear:e.handleReplOutputClear},"clear_repl");return[Object(ne.jsx)($.a,{handleReplEval:e.handleReplEval,isRunning:e.isRunning},"eval_repl"),t]}()}};return Object(ne.jsxs)("div",{className:j()("WorkspaceParent",p.a.DARK),children:[Object(ne.jsxs)(h.h,{className:"assessment-reset",icon:C.a.ERROR,isCloseButtonShown:!0,isOpen:l,title:"Confirmation: Reset editor?",children:[Object(ne.jsx)("div",{className:p.a.DIALOG_BODY,children:Object(ne.jsx)(ee.a,{content:"Are you sure you want to reset to your last save?"})}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)(h.c,{children:[Object(ne.jsx)(J.a,{label:"Cancel",onClick:()=>d(!1),options:{minimal:!1}}),Object(ne.jsx)(J.a,{label:"Confirm",onClick:()=>{const e=vd();i(e),c(!1),d(!1),m(w()),v(),y()},options:{minimal:!1,intent:g.a.DANGER}})]})})]}),Object(ne.jsx)(Te.a,{...I})]})};const uu="assessment";var hu=Object(r.b)(((e,t)=>({activeEditorTabIndex:e.workspaces.assessment.activeEditorTabIndex,editorTabs:e.workspaces.assessment.editorTabs,hasUnsavedChanges:e.workspaces.assessment.hasUnsavedChanges,isRunning:e.workspaces.assessment.isRunning,isDebugging:e.workspaces.assessment.isDebugging,enableDebugging:e.workspaces.assessment.enableDebugging,output:e.workspaces.assessment.output,replValue:e.workspaces.assessment.replValue,sideContentHeight:e.workspaces.assessment.sideContentHeight,storedAssessmentId:e.workspaces.assessment.currentAssessment,storedQuestionId:e.workspaces.assessment.currentQuestion})),(e=>Object(c.b)({handleBrowseHistoryDown:()=>Object(I.browseReplHistoryDown)(uu),handleBrowseHistoryUp:()=>Object(I.browseReplHistoryUp)(uu),handleChapterSelect:(e,t)=>Object(I.chapterSelect)(e,N.Variant.DEFAULT,uu),handleClearContext:(e,t)=>Object(I.beginClearContext)(uu,e,t),handleDeclarationNavigate:e=>Object(I.navigateToDeclaration)(uu,e),handleEditorEval:()=>Object(I.evalEditor)(uu),handleEditorCheck:()=>Object(I.checkEditor)(uu),handleEditorValueChange:e=>Object(I.updateEditorValue)(e,uu),handleEditorUpdateBreakpoints:e=>Object(I.setEditorBreakpoint)(e,uu),handleInterruptEval:()=>Object(Sn.beginInterruptExecution)(uu),handleReplEval:()=>Object(I.evalRepl)(uu),handleReplOutputClear:()=>Object(I.clearReplOutput)(uu),handleReplValueChange:e=>Object(I.updateReplValue)(e,uu),handleResetWorkspace:e=>Object(I.resetWorkspace)(uu,e),handleUpdateWorkspace:e=>Object(I.updateWorkspace)(uu,e),handleUpdateActiveEditorTab:e=>Object(I.updateActiveEditorTab)(uu,e),handleSave:u.submitAnswer,handleSideContentHeightChange:e=>Object(I.changeSideContentHeight)(e,uu),handleTestcaseEval:e=>Object(I.evalTestcase)(uu,e),handleUpdateHasUnsavedChanges:e=>Object(I.updateHasUnsavedChanges)(uu,e),handleUpdateCurrentAssessmentId:I.updateCurrentAssessmentId,handleDebuggerPause:()=>Object(Sn.beginDebuggerPause)(uu),handleDebuggerResume:()=>Object(Sn.debuggerResume)(uu),handleDebuggerReset:()=>Object(Sn.debuggerReset)(uu),handlePromptAutocomplete:(e,t,n)=>Object(I.promptAutocomplete)(uu,e,t,n)},e)))(du);class pu extends f.Component{constructor(e){super(e),this.fileReader=void 0,this.handleFileRead=e=>t=>{if(!this.fileReader)return;const n=this.fileReader.result;n&&Object(bd.parseString)(n,((t,n)=>{console.dir(e);try{const t=(e=>{const t=Od(e);return[xd(e,t[1]),t[0]]})(n);t[0].fileName=e.name.slice(0,-4),jd(t[0]),this.props.updateEditingOverview(t[0]),yd(t[1]),this.props.newAssessment(t[1]),this.setState({fileInputText:"Success!"})}catch(t){console.log(t),this.setState({fileInputText:"Invalid XML!"})}}))},this.handleChangeFile=e=>{const t=e.target.files;e.target.files&&(this.fileReader=new FileReader,this.fileReader.onloadend=this.handleFileRead(t[0]),this.fileReader.readAsText(t[0]))},this.makeMission=()=>{jd(Object(H.j)()),this.props.updateEditingOverview(Object(H.j)()),yd(Object(H.g)()),this.props.newAssessment(Object(H.g)())},this.handleFileRead=this.handleFileRead.bind(this),this.handleChangeFile=this.handleChangeFile.bind(this),this.makeMission=this.makeMission.bind(this),this.state={fileInputText:"Import XML"}}componentDidMount(){const e=vd();e&&this.props.newAssessment(e)}render(){return Object(ne.jsxs)("div",{children:[Object(ne.jsx)("div",{children:"Please ensure that the xml uploaded is trustable."}),Object(ne.jsx)("div",{children:Object(ne.jsx)(h.m,{text:this.state.fileInputText,inputProps:{accept:".xml"},onChange:this.handleChangeFile})}),Object(ne.jsx)("div",{children:Object(ne.jsx)(J.a,{label:"Make New Mission",icon:C.a.NEW_OBJECT,onClick:this.makeMission})})]})}}var gu=pu;var mu=Object(r.b)(((e,t)=>t),(e=>Object(c.b)({newAssessment:u.updateAssessment},e)))(gu);const bu=()=>{};var fu=e=>{const[t,n]=Object(f.useState)((()=>{const e=localStorage.getItem("MissionEditingOverviewSA");return e?JSON.parse(e):null})()),s=Object(Ee.b)(e.match.params.assessmentId),i=Object(Ee.b)(e.match.params.questionId)||we.b.defaultQuestionId;if(-1===s&&t){const e=t,a={assessmentId:s,questionId:i,assessmentOverview:e,updateAssessmentOverview:n,notAttempted:e.status===H.a.not_attempted,closeDate:e.closeAt};return Object(ne.jsx)("div",{className:"Academy",children:Object(ne.jsx)(hu,{...a})})}const a=Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(mu,{updateEditingOverview:n}),t&&Object(ne.jsx)(Id,{overview:t,updateEditingOverview:n,listingPath:"/mission-control",assessmentTypes:e.assessmentTypes})]});return Object(ne.jsx)("div",{className:"Assessment Academy",children:Object(ne.jsx)(Me.a,{display:a,loadContentDispatch:bu})})};var vu=Object(o.l)(Object(r.b)((e=>{var t;return{assessmentTypes:(null===(t=e.session.assessmentConfigurations)||void 0===t?void 0:t.map((e=>e.type)))||[]}}))(fu)),yu=n(166),ju=n(223),xu=n(122);const Ou=e=>Object(ne.jsx)(E.a,{content:"Execution Time",placement:w.a.TOP,children:Object(ne.jsx)(h.H,{leftIcon:C.a.TIME,style:{width:80},min:1e3,value:e.execTime,onValueChange:e.handleChangeExecTime})});var Su=n(200);function wu(e){Object(me.e)(`Could not connect: ${e&&e.message||e||"Unknown error"}`)}class Cu extends f.PureComponent{constructor(e){super(e),this.inviteInputElem=void 0,this.state={joinElemValue:""},this.handleChange=this.handleChange.bind(this),this.inviteInputElem=f.createRef(),this.selectInviteInputText=this.selectInviteInputText.bind(this)}render(){const e=Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("input",{value:this.props.editorSessionId,readOnly:!0,ref:this.inviteInputElem}),Object(ne.jsx)(Gn,{text:""+this.props.editorSessionId,children:Object(ne.jsx)(J.a,{icon:C.a.DUPLICATE,onClick:this.selectInviteInputText})})]}),t=Object(ne.jsx)(Le.a,{popoverClassName:"Popover-share",inheritDarkTheme:!1,content:e,children:Object(ne.jsx)(J.a,{label:"Invite",icon:C.a.GRAPH,onClick:()=>{""===this.props.editorSessionId&&Object(Su.b)(this.props.editorValue||"").then((e=>{this.props.handleSetEditorSessionId(e)}),wu)}})}),n=Object(ne.jsxs)("form",{onSubmit:e=>{e.preventDefault(),Object(Su.a)(this.state.joinElemValue).then((e=>{e?this.props.handleSetEditorSessionId(this.state.joinElemValue):(this.props.handleSetEditorSessionId(""),Object(me.e)("Could not find a session with that ID."))}),(e=>{this.props.handleSetEditorSessionId(""),wu(e)}))},children:[Object(ne.jsx)("input",{type:"text",value:this.state.joinElemValue,onChange:this.handleChange}),Object(ne.jsx)("span",{className:p.a.POPOVER_DISMISS,children:Object(ne.jsx)(J.a,{icon:C.a.KEY_ENTER,options:{type:"submit"}})})]}),s=Object(ne.jsx)(Le.a,{popoverClassName:"Popover-share",inheritDarkTheme:!1,content:n,children:Object(ne.jsx)(J.a,{label:"Join",icon:C.a.LOG_IN})}),i=Object(ne.jsx)(J.a,{label:"Leave",icon:C.a.FEED,onClick:()=>{this.props.handleSetEditorSessionId(""),this.setState({joinElemValue:""})}});return Object(ne.jsx)(Le.a,{content:Object(ne.jsxs)(h.A,{large:!0,children:[t,""===this.props.editorSessionId?s:i]}),children:Object(ne.jsx)(J.a,{label:"Session",icon:C.a.SOCIAL_MEDIA,options:{iconColor:""===this.props.editorSessionId?void 0:this.props.sharedbConnected?Zo.Colors.GREEN3:Zo.Colors.RED3}})})}selectInviteInputText(){null!==this.inviteInputElem.current&&(this.inviteInputElem.current.focus(),this.inviteInputElem.current.select())}handleChange(e){this.setState({joinElemValue:e.target.value})}}class Eu extends f.PureComponent{constructor(e){super(e),this.shareInputElem=void 0,this.selectShareInputText=this.selectShareInputText.bind(this),this.handleChange=this.handleChange.bind(this),this.toggleButton=this.toggleButton.bind(this),this.shareInputElem=f.createRef(),this.state={keyword:"",isLoading:!1}}render(){const e=void 0===this.props.queryString?Object(ne.jsx)(h.Y,{children:"Share your programs! Type something into the editor (left), then click on this button again."}):this.props.isSicp?Object(ne.jsxs)("div",{children:[Object(ne.jsx)("input",{defaultValue:this.props.queryString,readOnly:!0,ref:this.shareInputElem}),Object(ne.jsx)(E.a,{content:"Copy link to clipboard",children:Object(ne.jsx)(Gn,{text:this.props.queryString,children:Object(ne.jsx)(J.a,{icon:C.a.DUPLICATE,onClick:this.selectShareInputText})})})]}):Object(ne.jsx)(ne.Fragment,{children:this.props.shortURL&&"ERROR"!==this.props.shortURL?Object(ne.jsxs)("div",{children:[Object(ne.jsx)("input",{defaultValue:this.props.shortURL,readOnly:!0,ref:this.shareInputElem}),Object(ne.jsx)(E.a,{content:"Copy link to clipboard",children:Object(ne.jsx)(Gn,{text:this.props.shortURL,children:Object(ne.jsx)(J.a,{icon:C.a.DUPLICATE,onClick:this.selectShareInputText})})})]},this.props.shortURL):this.state.isLoading&&"ERROR"!==this.props.shortURL?Object(ne.jsx)("div",{children:Object(ne.jsx)(h.G,{description:"Generating Shareable Link...",icon:Object(ne.jsx)(h.R,{size:h.S.SMALL})})}):Object(ne.jsxs)("div",{children:[we.b.urlShortenerBase,"\xa0",Object(ne.jsx)("input",{placeholder:"custom string (optional)",onChange:this.handleChange,style:{width:175}}),Object(ne.jsx)(J.a,{label:"Get Link",icon:C.a.SHARE,onClick:()=>{this.props.handleShortenURL(this.state.keyword),this.setState({isLoading:!0})}})]})});return Object(ne.jsx)(Le.a,{popoverClassName:"Popover-share",inheritDarkTheme:!1,content:e,children:Object(ne.jsx)(E.a,{content:"Get shareable link",placement:w.a.TOP,children:Object(ne.jsx)(J.a,{label:"Share",icon:C.a.SHARE,onClick:()=>this.toggleButton()})})})}componentDidUpdate(e){this.props.shortURL!==e.shortURL&&this.setState({keyword:"",isLoading:!1})}toggleButton(){this.props.handleGenerateLz&&this.props.handleGenerateLz(),this.props.handleUpdateShortURL(""),this.setState({keyword:"",isLoading:!1})}handleChange(e){this.setState({keyword:e.currentTarget.value})}selectShareInputText(){null!==this.shareInputElem.current&&(this.shareInputElem.current.focus(),this.shareInputElem.current.select())}}const Tu=e=>Object(ne.jsx)(E.a,{content:"Step Limit",placement:w.a.TOP,children:Object(ne.jsx)(h.H,{leftIcon:C.a.VERTICAL_BAR_CHART_ASC,style:{width:80},min:500,max:5e3,value:e.stepLimit,onValueChange:e.handleChangeStepLimit})}),ku=`\nTips:\n  1. Call _printEnv()_ to display what is accessable in the current environment\n  2. The editor on the left supports [_Ace keyboard shortcuts_](${we.a.aceHotkeys}) \n    and [_Source Academy keyboard shortcuts_](${we.a.sourceHotkeys}).\n\nDeveloper: Cao Peng, Contact: e0376984@u.nus.edu\n`,Au=(e,t)=>"\nThis is a C language interpreter, which supports Syntax Check, Type Check, Memory Management, Heap Visualization (_printHeap_), Pointer Arithmetic, etc. Enjoy!\n\nNOT SUPPORTED: preprocessor directives, struct, function pointers, array declaration (use _malloc_ instead)\n"+ku,_u={goGreen:"h u l k"};const Iu=[Se.b.mobileEditor,Se.b.mobileEditorRun],Nu=[Se.b.introduction];var Pu=e=>{let{workspaceLocation:t="playground",...n}=e;const{isSicpEditor:s}=n,{isMobileBreakpoint:i}=Object(x.e)(),a=f.useRef(n);a.current=n;const c=Object(r.c)(),[l,d]=f.useState(),u=Object(o.i)(),h=Object(o.h)(),g=new URLSearchParams(u.search).get("add_device");g&&!l&&(d(g),h.replace(u.pathname));const[,m]=f.useState(new Date),[b,v]=f.useState(!1),[y,S]=f.useState(g?Se.b.remoteExecution:Se.b.introduction),[w,E]=f.useState(!1),[A,_]=f.useState((()=>B("playground",{editorValue:a.current.editorTabs[0].value,chapter:a.current.playgroundSourceChapter}))),P=Object(x.f)((e=>!!e.session.remoteExecutionSession))&&!s,R=Object(x.f)((e=>e.workspaces.playground.externalLibrary));f.useEffect((()=>{_(B("playground",{editorValue:a.current.editorTabs[0].value,chapter:a.current.playgroundSourceChapter}))}),[n.editorSessionId]);const M=s?n.initialEditorValueHash:n.location.hash;f.useEffect((()=>{M?async function(e,t){var n,s,i;const a=cd(e),r=Object(Ee.b)(a.chap)||void 0,o=null!==(n=a.lz)&&void 0!==n?n:a.prgrm,c=o&&Object(yu.decompressFromEncodedURIComponent)(o);c&&t.handleEditorValueChange(c);const l=null!==(s=null===(i=O.n.find((e=>e.chapter===r&&e.variant===a.variant)))||void 0===i?void 0:i.variant)&&void 0!==s?s:N.Variant.DEFAULT;r&&t.handleChapterSelect(r,l);const d=Math.max(Object(Ee.b)(a.exec||"1000")||1e3,1e3);d&&t.handleChangeExecTime(d)}(M,a.current):n.courseSourceChapter&&n.courseSourceVariant&&a.current.handleChapterSelect(n.courseSourceChapter,n.courseSourceVariant)}),[M,n.courseSourceChapter,n.courseSourceVariant]),f.useEffect((()=>{i&&Nu.includes(y)?S(Se.b.mobileEditor):!i&&Iu.includes(y)&&S(Se.b.introduction)}),[i,y]);const L=f.useMemo((()=>({goGreen:()=>v(!b)})),[b]),U=f.useCallback((e=>{m(new Date),a.current.handleEditorValueChange(e)}),[]),G=f.useCallback(((e,t,n)=>{if(e===t)return;const{handleUsingSubst:s,handleReplOutputClear:i,playgroundSourceChapter:r}=a.current;t===Se.b.substVisualizer&&e===Se.b.mobileEditorRun||(r<=2&&e===Se.b.substVisualizer&&s(!0),t!==Se.b.substVisualizer||w||(i(),s(!1)),S(e))}),[w]),F=f.useCallback((e=>{D(A,e)}),[A]),H=f.useCallback((()=>c(Object(I.evalEditor)(t))),[c,t]),X=f.useCallback((()=>c(Object(I.checkEditor)(t))),[c,t]),q=f.useMemo((()=>Object(f.createElement)(Cn,{...k.a.pick(n,"isDebugging","isEditorAutorun","isRunning"),handleInterruptEval:()=>c(Object(Sn.beginInterruptExecution)(t)),handleToggleEditorAutorun:()=>c(Object(I.toggleEditorAutorun)(t)),handleEditorEval:H,handleDebuggerPause:()=>c(Object(Sn.beginDebuggerPause)(t)),handleDebuggerReset:()=>c(Object(Sn.debuggerReset)(t)),handleDebuggerResume:()=>c(Object(Sn.debuggerResume)(t)),key:"autorun",autorunDisabled:P,sourceChapter:n.playgroundSourceChapter,pauseDisabled:P||!Object(O.m)(n.playgroundSourceChapter)})),[c,H,n,P,t]),z=f.useCallback(((e,t)=>{let{chapter:n,variant:s}=e;const{handleUsingSubst:i,handleReplOutputClear:r,handleChapterSelect:o}=a.current;(n<=2&&w||y===Se.b.substVisualizer)&&i(!0),n>2&&(r(),i(!1));const c={time:Date.now(),type:"chapterSelect",data:n};F(c),o(n,s)}),[w,y,F]),Y=f.useMemo((()=>Object(ne.jsx)(V.a,{handleChapterSelect:z,sourceChapter:n.playgroundSourceChapter,sourceVariant:n.playgroundSourceVariant,disabled:P},"chapter")),[z,n.playgroundSourceChapter,n.playgroundSourceVariant,P]),K=f.useMemo((()=>y===Se.b.substVisualizer?null:Object(ne.jsx)(W.a,{handleReplOutputClear:n.handleReplOutputClear},"clear_repl")),[n.handleReplOutputClear,y]),Q=f.useMemo((()=>y===Se.b.substVisualizer?null:Object(ne.jsx)($.a,{handleReplEval:n.handleReplEval,isRunning:n.isRunning},"eval_repl")),[n.handleReplEval,n.isRunning,y]),J=f.useMemo((()=>Object(ne.jsx)(Ou,{execTime:n.execTime,handleChangeExecTime:n.handleChangeExecTime},"execution_time")),[n.execTime,n.handleChangeExecTime]),se=f.useMemo((()=>Object(ne.jsx)(Tu,{stepLimit:n.stepLimit,handleChangeStepLimit:e=>c(Object(I.changeStepLimit)(e,t))},"step_limit")),[c,n.stepLimit,t]),{handleEditorValueChange:ie}=n,ae=Object(ne.jsx)(Cu,{editorSessionId:n.editorSessionId,editorValue:n.editorTabs[0].value,handleSetEditorSessionId:e=>c(Object(ju.setEditorSessionId)(t,e)),sharedbConnected:n.sharedbConnected},"session"),re=f.useMemo((()=>{const e=s?we.a.playground+"#"+n.initialEditorValueHash:n.queryString;return Object(ne.jsx)(Eu,{handleGenerateLz:()=>c(Object(xu.generateLzString)()),handleShortenURL:e=>c(Object(xu.shortenURL)(e)),handleUpdateShortURL:e=>c(Object(xu.updateShortURL)(e)),queryString:e,shortURL:n.shortURL,isSicp:s},"share")}),[c,s,n.initialEditorValueHash,n.queryString,n.shortURL]),oe=f.useMemo((()=>({label:"Introduction",iconName:C.a.HOME,body:Object(ne.jsx)(ee.a,{content:Au(n.playgroundSourceChapter,n.playgroundSourceVariant),openLinksInNewWindow:!0}),id:Se.b.introduction})),[n.playgroundSourceChapter,n.playgroundSourceVariant]),ce=f.useMemo((()=>[oe]),[oe]),le=[...ce].filter((e=>{let{id:t}=e;return!(t&&Nu.includes(t))})),de=f.useCallback((e=>{let t=!0;e.renderer.on("afterRender",(()=>{t&&(X(),t=!1)}))}),[X]),ue=f.useCallback(((e,t)=>{ie(e);const n={time:Date.now(),type:"codeDelta",data:t};F(n)}),[ie,F]),he=f.useCallback((e=>{const t={time:Date.now(),type:"cursorPositionChange",data:e.getCursor()};F(t)}),[F]),pe=f.useCallback((e=>{const t=e.getRange(),n=e.isBackwards();if(!Object(T.isEqual)(t.start,t.end)){const e={time:Date.now(),type:"selectionRangeData",data:{range:t,isBackwards:n}};F(e)}}),[F]),ge=f.useCallback((e=>{const t=e.filter((e=>!!e)).length;t>0&&(E(!0),a.current.playgroundSourceChapter<=2&&a.current.handleUsingSubst(!0)),0===t&&(E(!1),y!==Se.b.substVisualizer&&(a.current.handleReplOutputClear(),a.current.handleUsingSubst(!1))),a.current.handleEditorUpdateBreakpoints(e)}),[y]),me=P,be={...k.a.pick(n,"editorSessionId","isEditorAutorun"),editorVariant:"normal",editorTabs:n.editorTabs.map(Z.a),handleDeclarationNavigate:e=>c(Object(I.navigateToDeclaration)(t,e)),handleEditorEval:H,handleEditorCheck:X,handlePromptAutocomplete:(e,n,s)=>c(Object(I.promptAutocomplete)(t,e,n,s)),handleSendReplInputToOutput:e=>c(Object(I.sendReplInputToOutput)(e,t)),handleSetSharedbConnected:e=>c(Object(ju.setSharedbConnected)(t,e)),onChange:ue,onCursorChange:he,onSelectionChange:pe,onLoad:de,sourceChapter:n.playgroundSourceChapter,externalLibraryName:R,sourceVariant:n.playgroundSourceVariant,handleEditorValueChange:U,handleEditorUpdateBreakpoints:ge},fe={...k.a.pick(n,"output","replValue","handleReplEval","usingSubst"),handleBrowseHistoryDown:()=>c(Object(I.browseReplHistoryDown)(t)),handleBrowseHistoryUp:()=>c(Object(I.browseReplHistoryUp)(t)),handleReplValueChange:e=>c(Object(I.updateReplValue)(e,t)),sourceChapter:n.playgroundSourceChapter,sourceVariant:n.playgroundSourceVariant,externalLibrary:Hd.a.NONE,hidden:y===Se.b.substVisualizer,inputHidden:me,replButtons:[me?null:Q,K],disableScrolling:s},ve={tabs:[]},ye={controlBarProps:{editorButtons:[q,Y,P||!Object(O.m)(n.playgroundSourceChapter)?null:n.usingSubst?se:J]},editorContainerProps:be,handleSideContentHeightChange:e=>c(Object(I.changeSideContentHeight)(e,t)),replProps:fe,sideBarProps:ve,sideContentHeight:n.sideContentHeight,sideContentProps:{selectedTabId:y,onChange:G,tabs:{beforeDynamicTabs:ce,afterDynamicTabs:[]},workspaceLocation:s?"sicp":"playground",sideContentHeight:n.sideContentHeight},sideContentIsResizeable:y!==Se.b.substVisualizer},je={editorContainerProps:be,replProps:fe,sideBarProps:ve,mobileSideContentProps:{mobileControlBarProps:{editorButtons:[q,Y,re,s?null:ae]},selectedTabId:y,onChange:G,tabs:{beforeDynamicTabs:le,afterDynamicTabs:[]},workspaceLocation:s?"sicp":"playground"}};return i?Object(ne.jsx)("div",{className:j()("Playground",p.a.DARK,b?"GreenScreen":void 0),children:Object(ne.jsx)(te.a,{...je})}):Object(ne.jsx)(En.HotKeys,{className:j()("Playground",p.a.DARK,b?"GreenScreen":void 0),keyMap:_u,handlers:L,children:Object(ne.jsx)(Te.a,{...ye})})};const Ru=e=>({...k.a.pick(e.workspaces.playground,"activeEditorTabIndex","editorTabs","editorSessionId","execTime","stepLimit","isEditorAutorun","isRunning","isDebugging","enableDebugging","output","replValue","sideContentHeight","sharedbConnected","usingSubst"),queryString:e.playground.queryString,shortURL:e.playground.shortURL,playgroundSourceChapter:N.Chapter.CALC,playgroundSourceVariant:e.workspaces.playground.context.variant,courseSourceChapter:e.session.sourceChapter,courseSourceVariant:e.session.sourceVariant,persistenceUser:e.session.googleUser,persistenceFile:e.playground.persistenceFile,githubOctokitObject:e.session.githubOctokitObject,githubSaveInfo:e.playground.githubSaveInfo}),Mu="playground",Lu=e=>Object(c.b)({handleChangeExecTime:e=>Object(I.changeExecTime)(e,Mu),handleChapterSelect:(e,t)=>Object(I.chapterSelect)(e,t,Mu),handleEditorValueChange:e=>Object(I.updateEditorValue)(e,Mu),handleEditorUpdateBreakpoints:e=>Object(I.setEditorBreakpoint)(e,Mu),handleReplEval:()=>Object(I.evalRepl)(Mu),handleReplOutputClear:()=>Object(I.clearReplOutput)(Mu),handleUsingSubst:e=>Object(I.toggleUsingSubst)(e,Mu)},e);var Du=()=>{const e=Object(o.l)(Object(r.b)(Ru,Lu)(Pu));return Object(ne.jsx)(e,{workspaceLocation:Mu})};var Bu=()=>{const e=Object(x.f)((e=>e.session.name));return Object(ne.jsx)("div",{className:"fullpage",children:Object(ne.jsx)(h.e,{className:"fullpage-content",children:Object(ne.jsx)("div",{style:{marginTop:"20px",display:"flex",justifyContent:"center"},children:Object(ne.jsxs)("div",{children:[Object(ne.jsxs)(h.p,{children:["Welcome to ",we.b.sourceAcademyDeploymentName]}),Object(ne.jsxs)("div",{children:["You have logged in as ",Object(ne.jsx)("strong",{children:e}),". ",we.b.sourceAcademyDeploymentName," ","does not have any course information for this account."]}),Object(ne.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(ne.jsxs)(h.cb,{style:{textAlign:"left"},children:[Object(ne.jsx)("li",{children:"If you are enrolled in a course, check with the course staff to make sure your account is added to the course."}),Object(ne.jsxs)("li",{children:["If you are looking for a course to join, check"," ",Object(ne.jsx)("a",{href:we.a.resourcesForLearners,children:"here"})," to find a course that suits your needs."]}),Object(ne.jsxs)("li",{children:["If you are an instructor and want to create a course, click"," ",Object(ne.jsx)("a",{href:we.a.resourcesForEducators,children:"here"})," for a list of resources to get started."]})]})})]})})})})},Uu=n(1171),Gu=n(216);var Fu=e=>{const{item:t}=e,n=t.maxXp<=0&&0===t.xp,s=Object(ne.jsxs)("div",{className:"xp-details",children:[Object(ne.jsx)("div",{className:"title",children:"XP"}),Object(ne.jsxs)("div",{className:"value",children:[t.xp," / ",t.maxXp]}),Object(ne.jsx)(h.N,{animate:!1,className:"value-bar"+e.parseColour(e.getFrac(t.xp,t.maxXp)),stripes:!1,value:e.getFrac(t.xp,t.maxXp)})]});return Object(ne.jsx)(A.b,{className:"profile-summary-navlink",target:"_blank",to:`/courses/${e.courseId}/${Object(Ee.a)(t.type)}/${t.id}/0`,activeClassName:"profile-summary-navlink",children:Object(ne.jsx)(h.d,{className:"profile-summary-callout",icon:e.renderIcon(t.type),title:t.title,children:n?"":s},`${t.title}-${t.id}`)},`${t.title}-${t.id}`)};var Hu=e=>{const{name:t,role:n,assessmentOverviews:s,assessmentConfigurations:i,xp:a,courseId:o}=Object(x.f)((e=>e.session)),c=Object(r.c)();Object(f.useEffect)((()=>{t&&n&&!s&&c(Object(u.fetchAssessmentOverviews)())}),[s,c,t,n,a]),Object(f.useEffect)((()=>{o&&!a&&c(Object(u.fetchTotalXp)())}),[o,c,a]);const[l,d]=Object(f.useState)(t&&n&&s);let p;if(Object(f.useEffect)((()=>{d(t&&n&&s)}),[s,t,n]),l){const e=s.filter((e=>e.status===H.a.submitted)).length,r=a||0,c=we.b.caFulfillmentLevel,l=1e3*c,d=Object(ne.jsx)("div",{className:"profile-header",children:Object(ne.jsxs)("div",{className:"profile-username",children:[Object(ne.jsx)("div",{className:"name",children:t}),Object(ne.jsx)("div",{className:"role",children:n})]})});if(0===e)p=Object(ne.jsxs)("div",{className:"profile-content",children:[d,Object(ne.jsx)("div",{className:"profile-placeholder",children:"There are no closed assessments to render grade and XP of."})]});else{const e=(e,t)=>t<=0||e/t>1?1:e/t,t=e=>e<0?"":e>=.8?" progress-steelblue":e>=.45?" progress-deepskyblue":" progress-skyblue",n=e=>{const t=[C.a.FLAME,C.a.LIGHTBULB,C.a.PREDICTIVE_ANALYSIS,C.a.COMPARISON,C.a.MANUAL];if(i){const n=i.findIndex((t=>t.type===e));return n>0?t[n]:C.a.PULSE}return C.a.PULSE},a=s.filter((e=>e.status===H.a.submitted&&(e.gradingStatus===H.c.graded||e.gradingStatus===H.c.excluded))).map(((s,i)=>Object(ne.jsx)(Fu,{item:s,getFrac:e,parseColour:t,renderIcon:n,courseId:o},i)));p=Object(ne.jsxs)("div",{className:"profile-content",children:[d,Object(ne.jsx)("div",{className:"profile-progress",children:Object(ne.jsxs)("div",{className:"profile-xp",children:[Object(ne.jsx)(h.R,{className:"profile-spinner"+t(e(r,l)),size:144,value:e(r,l)}),Object(ne.jsx)("div",{className:"type",children:"XP Progress"}),Object(ne.jsxs)("div",{className:"total-value",children:[r," / ",l,"*"]}),Object(ne.jsxs)("div",{className:"percentage",children:[(100*e(r,l)).toFixed(2),"%"]})]})}),Object(ne.jsxs)("div",{className:"profile-xp-footer",children:["*",l,"XP needed to reach full CA level of ",c]}),Object(ne.jsx)("div",{className:"profile-callouts",children:a})]})}}else p=Object(ne.jsx)(h.G,{description:"Loading...",icon:Object(ne.jsx)(h.R,{})});return Object(ne.jsx)(h.j,{className:"profile",icon:C.a.USER,isCloseButtonShown:!0,isOpen:e.isOpen,onClose:e.onClose,title:"User Profile",position:"left",size:h.k.SMALL,children:p})};var Vu=e=>Object(ne.jsx)(h.h,{className:"about",icon:C.a.HELP,isCloseButtonShown:!0,isOpen:e.isOpen,onClose:e.onClose,title:"About",children:Object(ne.jsx)("div",{className:p.a.DIALOG_BODY,children:Object(ne.jsxs)("div",{className:"abt",children:[Object(ne.jsxs)("p",{children:["The ",Object(ne.jsx)("i",{children:"Source Academy"})," is a computer-mediated learning environment for studying the structure and interpretation of computer programs. Students write and run their programs in their web browser, using sublanguages of JavaScript called"," ",Object(ne.jsx)("a",{href:we.a.sourceDocs,children:"Source"}),", designed for the textbook"," ",Object(ne.jsx)("a",{href:we.a.textbook,children:"Structure and Interpretation of Computer Programs, JavaScript Edition"}),"."]}),Object(ne.jsxs)("p",{children:["The Source Academy is available under the Apache License 2.0 at the GitHub organisation"," ",Object(ne.jsx)("a",{href:we.a.githubOrg,children:"source-academy"}),". More information and resources are available at the ",Object(ne.jsx)("a",{href:we.a.about,children:"about pages"})," of the Source Academy."]})]})})});var Wu=e=>{const{courses:t}=e,n=t.map((e=>({value:e.courseId,label:e.courseName.concat(e.viewable?"":" - disabled"),disabled:!e.viewable&&e.role!==O.a.Admin})));return Object(ne.jsx)(h.h,{className:"my-courses",icon:C.a.PROPERTIES,isCloseButtonShown:!0,isOpen:e.isOpen,onClose:e.onClose,title:"My Courses",children:Object(ne.jsxs)("div",{className:p.a.DIALOG_BODY,children:[Object(ne.jsx)("div",{children:"Select a course to switch to:"}),Object(ne.jsx)(h.u,{value:e.courseId,options:n,fill:!0,onChange:t=>{Ce.a.push(`/courses/${t.currentTarget.value}`),e.onClose()},disabled:t.length<=1})]})})};var $u=e=>{const[t,n]=f.useState({courseName:"",courseShortName:"",viewable:!0,enableGame:!0,enableAchievements:!0,enableSourcecast:!0,sourceChapter:N.Chapter.CALC,sourceVariant:N.Variant.DEFAULT,moduleHelpText:""}),[s,i]=f.useState(as.WRITE),a=[{value:N.Chapter.CALC}],r=f.useCallback(((e,t,n)=>{e!==t&&i(e)}),[i]);return Object(ne.jsx)(h.h,{className:"create-course",icon:C.a.ADD,isCloseButtonShown:!0,canOutsideClickClose:!1,isOpen:e.isOpen,onClose:e.onClose,title:"Create Course",children:Object(ne.jsxs)("div",{className:p.a.DIALOG_BODY,children:[Object(ne.jsx)("div",{children:Object(ne.jsx)("b",{children:"Create your own Source Academy course and manage your own learners!"})}),Object(ne.jsx)("br",{}),Object(ne.jsx)(h.n,{helperText:"Please enter the course name that will be used for course selection",label:"Course Name",labelInfo:"(* required)",labelFor:"courseName",children:Object(ne.jsx)(h.y,{id:"courseName",value:t.courseName,onChange:e=>n({...t,courseName:e.target.value})})}),Object(ne.jsx)(h.n,{helperText:"Usually the module code of the course. This will be displayed on the top left.",label:"Course Short Name",labelInfo:"(optional)",labelFor:"courseShortName",children:Object(ne.jsx)(h.y,{id:"courseShortName",value:t.courseShortName,onChange:e=>n({...t,courseShortName:e.target.value})})}),Object(ne.jsxs)(h.n,{helperText:"The module help text will be used in the course help dialog.",labelFor:"moduleHelpText",children:[Object(ne.jsx)(h.Y,{tagName:"span",children:"Module Help Text\xa0"}),Object(ne.jsx)(h.Y,{tagName:"span",className:"optional-text",children:"(optional)"}),Object(ne.jsxs)(h.V,{selectedTabId:s,onChange:r,className:"module-help-text-tabs",children:[Object(ne.jsx)(h.U,{id:as.WRITE,title:"Write"}),Object(ne.jsx)(h.U,{id:as.PREVIEW,title:"Preview"})]}),s===as.WRITE&&Object(ne.jsx)(h.Z,{id:"moduleHelpText",className:"input-textarea",fill:!0,value:t.moduleHelpText,onChange:e=>n({...t,moduleHelpText:e.target.value})}),s===as.PREVIEW&&Object(ne.jsx)("div",{className:"input-markdown",children:Object(ne.jsx)(ee.a,{content:t.moduleHelpText||"",openLinksInNewWindow:!0})})]}),Object(ne.jsxs)("div",{className:"boolean-container",children:[Object(ne.jsxs)("div",{children:[Object(ne.jsx)(h.T,{checked:t.viewable,inline:!0,label:"Viewable",onChange:e=>n({...t,viewable:e.target.checked})}),Object(ne.jsx)(h.T,{checked:t.enableAchievements,inline:!0,label:"Enable Achievements",onChange:e=>n({...t,enableAchievements:e.target.checked})})]}),Object(ne.jsxs)("div",{children:[Object(ne.jsx)(h.T,{checked:t.enableGame,inline:!0,label:"Enable Game",onChange:e=>n({...t,enableGame:e.target.checked})}),Object(ne.jsx)(h.T,{checked:t.enableSourcecast,inline:!0,label:"Enable Sourcecast",onChange:e=>n({...t,enableSourcecast:e.target.checked})})]})]}),Object(ne.jsxs)("div",{children:[Object(ne.jsx)(h.n,{label:"Default Source Chapter",labelInfo:"(configurable later on)",labelFor:"source-chapter",children:Object(ne.jsx)(h.u,{id:"source-chapter",options:a,value:t.sourceChapter,onChange:e=>{n({...t,sourceChapter:parseInt(e.target.value)})},fill:!0})}),Object(ne.jsx)(h.n,{label:"Default Source Variant",labelInfo:"(configurable later on)",labelFor:"source-variant",children:Object(ne.jsx)(h.u,{id:"source-variant",options:(o=t.sourceChapter,O.n.filter((e=>e.chapter===o)).map((e=>({label:e.variant.replace(/^\w/,(e=>e.toUpperCase())),value:e.variant})))),value:t.sourceVariant,onChange:e=>{n({...t,sourceVariant:e.target.value})},fill:!0})})]}),Object(ne.jsx)("div",{className:"create-course-button-container",children:Object(ne.jsx)(h.b,{text:"Create Course",onClick:()=>{""!==t.courseName?(e.handleCreateCourse(t),e.onClose()):Object(me.e)("Course Name cannot be empty!")}})})]})});var o};var Xu=e=>{const t=Object(x.f)((e=>e.session.moduleHelpText));return Object(ne.jsx)(h.h,{className:"help",icon:C.a.ERROR,isCloseButtonShown:!0,isOpen:e.isOpen,onClose:e.onClose,title:"Help",children:Object(ne.jsx)("div",{className:p.a.DIALOG_BODY,children:t?Object(ne.jsx)(ee.a,{content:t,openLinksInNewWindow:!0}):Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsxs)("p",{children:["We recommend recent updates of the browsers ",Object(ne.jsx)("b",{children:"Google Chrome"}),","," ",Object(ne.jsx)("b",{children:"Microsoft Edge"}),", or ",Object(ne.jsx)("b",{children:"Mozilla Firefox"})," to visit the Source Academy."]}),Object(ne.jsxs)("p",{children:["If you encounter issues with the Source Academy using these browsers, please use the issue system of the"," ",Object(ne.jsx)("a",{href:we.a.githubIssues,children:"Source Academy frontend repository on GitHub"}),"."]})]})})})},qu=n(141);var zu=e=>{const[t,n]=Object(f.useContext)(qu.b),s=Object(f.useMemo)((()=>[{label:"None",value:qu.a.NONE},{label:"Vim",value:qu.a.VIM},{label:"Emacs",value:qu.a.EMACS}]),[]);return Object(ne.jsx)(h.h,{className:"settings",icon:C.a.COG,isCloseButtonShown:!0,isOpen:e.isOpen,onClose:e.onClose,title:"Settings",children:Object(ne.jsx)("div",{className:p.a.DIALOG_BODY,children:Object(ne.jsxs)(h.n,{label:"Editor Binding: ",labelFor:"editor-binding",inline:!0,children:[Object(ne.jsx)(h.u,{id:"editor-binding",options:s,value:t.editorBinding,onChange:e=>{n({...t,editorBinding:e.target.value})}}),Object(ne.jsx)(E.a,{position:h.L.TOP,className:"form-field-help-text",content:"Optional editor bindings for advanced users. Set to 'None' for default text editor behaviour.",children:Object(ne.jsx)(h.w,{icon:"help"})})]})})})};const Yu=e=>e.replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()));var Ku=e=>{const[t,n]=Object(f.useState)(!1),[s,i]=Object(f.useState)(!1),[a,r]=Object(f.useState)(!1),[o,c]=Object(f.useState)(!1),[l,d]=Object(f.useState)(!1),[u,p]=Object(f.useState)(!1);const g=()=>{n((e=>!e))},m=()=>{i((e=>!e))},b=()=>r((e=>!e)),v=()=>c((e=>!e)),y=()=>d((e=>!e)),j=()=>p((e=>!e));return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(Le.a,{content:function(e){const t=e.name&&null!=e.courseId?Object(ne.jsx)(h.B,{icon:C.a.USER,onClick:v,text:Yu(e.name)}):null,n=e.name?Object(ne.jsx)(h.B,{icon:C.a.PROPERTIES,onClick:y,text:"My Courses"}):null,s=e.name?Object(ne.jsx)(h.B,{icon:C.a.ADD,onClick:j,text:"Create Course"}):null,i=e.name?Object(ne.jsx)(h.B,{icon:C.a.LOG_OUT,text:"Logout",onClick:e.handleLogOut}):null;return Object(ne.jsxs)(h.A,{children:[t,n,s,Object(ne.jsx)(h.B,{icon:C.a.COG,onClick:g,text:"Settings"}),Object(ne.jsx)(h.B,{icon:C.a.HELP,onClick:m,text:"About"}),Object(ne.jsx)(h.B,{icon:C.a.ERROR,onClick:b,text:"Help"}),i]})}(e),inheritDarkTheme:!1,placement:w.a.BOTTOM,children:Object(ne.jsx)(J.a,{icon:C.a.CARET_DOWN})}),Object(ne.jsx)(zu,{isOpen:t,onClose:g}),Object(ne.jsx)(Vu,{isOpen:s,onClose:m}),Object(ne.jsx)(Xu,{isOpen:a,onClose:b}),e.name?Object(ne.jsx)(Wu,{isOpen:l,onClose:y,courses:e.courses,courseId:e.courseId}):null,e.name?Object(ne.jsx)($u,{isOpen:u,onClose:j,handleCreateCourse:e.handleCreateCourse}):null,e.name?Object(ne.jsx)(Hu,{isOpen:o,onClose:v}):null]})};const Qu=[C.a.FLAME,C.a.LIGHTBULB,C.a.PREDICTIVE_ANALYSIS,C.a.COMPARISON,C.a.MANUAL,C.a.GRAPH,C.a.LAB_TEST,C.a.CALCULATOR];var Ju=e=>{var t;return Object(ne.jsxs)(h.C,{className:"NavigationBar secondary-navbar",children:[Object(ne.jsx)(h.E,{align:Gu.a.LEFT,children:null===(t=e.assessmentTypes)||void 0===t?void 0:t.map(((t,n)=>Object(ne.jsxs)(A.b,{to:`/courses/${e.courseId}/${Object(Ee.a)(t)}`,activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),children:[Object(ne.jsx)(h.w,{icon:Qu[n]}),Object(ne.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:t}),Object(ne.jsx)(Ve,{notificationFilter:Ue(t),disableHover:!0})]},n)))}),e.role===O.a.Admin||e.role===O.a.Staff?Object(ne.jsxs)(h.E,{align:Gu.a.RIGHT,children:[Object(ne.jsxs)(A.b,{to:`/courses/${e.courseId}/groundcontrol`,activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),children:[Object(ne.jsx)(h.w,{icon:C.a.SATELLITE}),Object(ne.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:"Ground Control"})]}),Object(ne.jsxs)(A.b,{to:`/courses/${e.courseId}/dashboard`,activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),children:[Object(ne.jsx)(h.w,{icon:C.a.GLOBE}),Object(ne.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:"Dashboard"})]}),Object(ne.jsxs)(A.b,{to:`/courses/${e.courseId}/sourcereel`,activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),children:[Object(ne.jsx)(h.w,{icon:C.a.MOBILE_VIDEO}),Object(ne.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm hidden-md",children:"Sourcereel"})]}),e.role===O.a.Admin&&Object(ne.jsxs)(A.b,{to:`/courses/${e.courseId}/xpcalculation`,activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),children:[Object(ne.jsx)(h.w,{icon:C.a.CALCULATOR}),Object(ne.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:"XP Calculation"})]}),Object(ne.jsxs)(A.b,{to:`/courses/${e.courseId}/grading`,activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),children:[Object(ne.jsx)(h.w,{icon:C.a.ENDORSED}),Object(ne.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm hidden-md",children:"Grading"}),Object(ne.jsx)(Ve,{notificationFilter:Ue("Grading"),disableHover:!0})]}),Object(ne.jsxs)(A.b,{to:`/courses/${e.courseId}/storysimulator`,activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),children:[Object(ne.jsx)(h.w,{icon:C.a.CROWN}),Object(ne.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm hidden-md",children:"Story Simulator"})]}),e.role===O.a.Admin&&Object(ne.jsxs)(A.b,{to:`/courses/${e.courseId}/adminpanel`,activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),children:[Object(ne.jsx)(h.w,{icon:C.a.SETTINGS}),Object(ne.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm hidden-md hidden-lg",children:"Admin Panel"})]})]}):null]})};var Zu=e=>{var t;return Object(ne.jsxs)(h.j,{isOpen:e.isOpen,position:"left",onClose:e.onClose,title:"",className:p.a.DARK,children:[e.role?null===(t=e.assessmentTypes)||void 0===t?void 0:t.map(((t,n)=>Object(ne.jsxs)(A.b,{to:`/courses/${e.courseId}/${Object(Ee.a)(t)}`,activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link__mobile",p.a.BUTTON,p.a.MINIMAL,p.a.LARGE),onClick:e.onClose,children:[Object(ne.jsx)(h.w,{icon:Qu[n]}),Object(ne.jsx)("div",{children:t}),Object(ne.jsx)(Ve,{notificationFilter:Ue(t),disableHover:!0})]},n))):Object(ne.jsx)(ne.Fragment,{}),e.role&&e.enableSourcecast&&Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link__mobile",p.a.BUTTON,p.a.MINIMAL,p.a.LARGE),to:`/courses/${e.courseId}/sourcecast`,onClick:e.onClose,children:[Object(ne.jsx)(h.w,{icon:C.a.MUSIC}),Object(ne.jsx)("div",{children:"Sourcecast"})]}),e.role&&Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link__mobile",p.a.BUTTON,p.a.MINIMAL,p.a.LARGE),to:"/playground",onClick:e.onClose,children:[Object(ne.jsx)(h.w,{icon:C.a.CODE}),Object(ne.jsx)("div",{children:"Playground"})]}),we.b.enableGitHubAssessments&&Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link_mobile",p.a.BUTTON,p.a.MINIMAL,p.a.LARGE),to:"/githubassessments",onClick:e.onClose,children:[Object(ne.jsx)(h.w,{icon:C.a.BRIEFCASE}),Object(ne.jsx)("div",{className:"navbar-button-text",children:"Classroom"})]}),e.name&&Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link_mobile",p.a.BUTTON,p.a.MINIMAL,p.a.LARGE),to:"/sicpjs/",onClick:e.onClose,children:[Object(ne.jsx)(h.w,{icon:C.a.BOOK}),Object(ne.jsx)("div",{className:"navbar-button-text",children:"SICP JS"})]}),e.role&&e.enableAchievements&&Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link__mobile",p.a.BUTTON,p.a.MINIMAL,p.a.LARGE),to:`/courses/${e.courseId}/achievements`,onClick:e.onClose,children:[Object(ne.jsx)(h.w,{icon:C.a.MOUNTAIN}),Object(ne.jsx)("div",{children:"Achievements"})]})]})};const eh=/^\/courses\/\d+\/(sourcecast|achievements)/,th=(e,t)=>!!e&&!eh.test(t.pathname);var nh=e=>{var t;const[n,s]=f.useState(!1),{isMobileBreakpoint:i}=Object(x.e)(),a=Object(o.i)();Uu.a.onlyShowFocusOnTabs();const r=we.b.enableGitHubAssessments?i?Object(ne.jsx)(ne.Fragment,{children:Object(ne.jsxs)(h.E,{align:Gu.a.LEFT,children:[Object(ne.jsx)(h.b,{onClick:()=>s(!n),icon:C.a.MENU,large:!0,minimal:!0}),Object(ne.jsxs)(A.b,{className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),to:"/",children:[Object(ne.jsx)(h.w,{icon:C.a.SYMBOL_DIAMOND}),Object(ne.jsx)(h.F,{style:{paddingBottom:"0px"},children:"Source Academy"})]}),Object(ne.jsxs)(h.j,{isOpen:n,position:"left",onClose:()=>s(!1),title:"",className:p.a.DARK,children:[Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link__mobile",p.a.BUTTON,p.a.MINIMAL,p.a.LARGE),to:"/playground",onClick:()=>s(!1),children:[Object(ne.jsx)(h.w,{icon:C.a.CODE}),Object(ne.jsx)("div",{children:"Playground"})]}),Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link__mobile",p.a.BUTTON,p.a.MINIMAL,p.a.LARGE),to:"/githubassessments/missions",onClick:()=>s(!1),children:[Object(ne.jsx)(h.w,{icon:C.a.BRIEFCASE}),Object(ne.jsx)("div",{children:"Classroom"})]})]})]})}):Object(ne.jsxs)(h.E,{align:Gu.a.LEFT,children:[Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link__mobile",p.a.BUTTON,p.a.MINIMAL),to:"/playground",children:[Object(ne.jsx)(h.w,{icon:C.a.CODE}),Object(ne.jsx)("div",{children:"Playground"})]}),Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link__mobile",p.a.BUTTON,p.a.MINIMAL),to:"/githubassessments",children:[Object(ne.jsx)(h.w,{icon:C.a.BRIEFCASE}),Object(ne.jsx)("div",{children:"Classroom"})]})]}):Object(ne.jsx)(h.E,{align:Gu.a.LEFT,children:Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link__mobile",p.a.BUTTON,p.a.MINIMAL),to:"/playground",children:[Object(ne.jsx)(h.w,{icon:C.a.CODE}),Object(ne.jsx)("div",{children:"Playground"})]})}),c=Object(ne.jsxs)(h.E,{align:Gu.a.LEFT,children:[(e.role||we.b.enableGitHubAssessments)&&Object(ne.jsx)(h.b,{onClick:()=>s(!n),icon:C.a.MENU,large:!0,minimal:!0}),Object(ne.jsxs)(A.b,{className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),activeClassName:p.a.ACTIVE,to:null==e.courseId?"/welcome":`/courses/${e.courseId}`,children:[Object(ne.jsx)(h.w,{icon:C.a.SYMBOL_DIAMOND}),Object(ne.jsx)(h.F,{style:{paddingBottom:"0px"},children:e.courseShortName||"Source Academy @ NUS"})]}),(e.role||we.b.enableGitHubAssessments)&&Object(ne.jsx)(Zu,{name:e.name,role:e.role,courseId:e.courseId,enableAchievements:e.enableAchievements,enableSourcecast:e.enableSourcecast,assessmentTypes:e.assessmentTypes,isOpen:n,onClose:()=>s(!1),handleGitHubLogIn:()=>e.handleGitHubLogIn,handleGitHubLogOut:()=>e.handleGitHubLogOut})]}),l=Object(ne.jsx)(h.C,{children:Object(ne.jsx)(h.E,{children:null===(t=e.assessmentTypes)||void 0===t?void 0:t.map(((t,n)=>Object(ne.jsxs)(A.b,{to:`/courses/${e.courseId}/${Object(Ee.a)(t)}`,activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),children:[Object(ne.jsx)(h.w,{icon:Qu[n]}),Object(ne.jsx)("div",{className:"navbar-button-text",children:t}),Object(ne.jsx)(Ve,{notificationFilter:Ue(t),disableHover:!0})]},t)))})}),d=Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),to:null==e.courseId?"/welcome":`/courses/${e.courseId}`,isActive:th,children:[Object(ne.jsx)(h.w,{icon:C.a.SYMBOL_DIAMOND}),Object(ne.jsx)(h.F,{style:{paddingBottom:"0px"},children:e.courseShortName||"Source Academy @ NUS"})]}),u=["/playground","/contributors",`/courses/${e.courseId}/sourcecast`,`/courses/${e.courseId}/achievements`],g=null!=e.courseId&&!!u.find((e=>a.pathname.startsWith(e))),m=Object(ne.jsxs)(h.E,{align:Gu.a.LEFT,children:[g?Object(ne.jsx)(Le.a,{position:w.a.BOTTOM_RIGHT,interactionKind:"hover",content:l,popoverClassName:"desktop-navbar-popover",children:d}):d,e.role&&e.enableSourcecast&&Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),to:`/courses/${e.courseId}/sourcecast`,children:[Object(ne.jsx)(h.w,{icon:C.a.MUSIC}),Object(ne.jsx)("div",{className:"navbar-button-text",children:"Sourcecast"})]}),e.role&&Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),to:"/playground",children:[Object(ne.jsx)(h.w,{icon:C.a.CODE}),Object(ne.jsx)("div",{className:"navbar-button-text",children:"Playground"})]}),we.b.enableGitHubAssessments&&Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),to:"/githubassessments",children:[Object(ne.jsx)(h.w,{icon:C.a.BRIEFCASE}),Object(ne.jsx)("div",{className:"navbar-button-text",children:"Classroom"})]}),e.name,e.role&&e.enableAchievements&&Object(ne.jsxs)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),to:`/courses/${e.courseId}/achievements`,children:[Object(ne.jsx)(h.w,{icon:C.a.MOUNTAIN}),Object(ne.jsx)("div",{className:"navbar-button-text",children:"Achievements"})]})]}),b=Object(ne.jsxs)(h.E,{align:Gu.a.RIGHT,children:[Object(ne.jsx)(A.b,{activeClassName:p.a.ACTIVE,className:j()("NavigationBar__link",p.a.BUTTON,p.a.MINIMAL),to:"/contributors",children:Object(ne.jsx)(h.w,{icon:C.a.HEART})}),Object(ne.jsx)("div",{className:"visible-xs",children:Object(ne.jsx)(h.D,{className:"thin-divider"})}),Object(ne.jsx)("div",{className:"hidden-xs",children:Object(ne.jsx)(h.D,{className:"default-divider"})}),Object(ne.jsx)(Ku,{handleLogOut:e.handleLogOut,handleCreateCourse:e.handleCreateCourse,courses:e.courses,courseId:e.courseId,name:e.name})]});return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsxs)(h.C,{className:j()("NavigationBar","primary-navbar",p.a.DARK),children:[we.b.playgroundOnly?r:i?c:m,b]}),Object(ne.jsxs)(o.e,{children:[Object(ne.jsx)(o.c,{path:"/playground"}),Object(ne.jsx)(o.c,{path:"/githubassessments"}),Object(ne.jsx)(o.c,{path:"/contributors"}),Object(ne.jsx)(o.c,{path:"/courses/:courseId/sourcecast"}),Object(ne.jsx)(o.c,{path:"/courses/:courseId/achievements"}),Object(ne.jsx)(o.c,{children:!we.b.playgroundOnly&&e.role&&!i&&Object(ne.jsx)(Ju,{role:e.role,assessmentTypes:e.assessmentTypes,courseId:e.courseId})})]})]})};const sh=Object(ne.jsx)(o.c,{path:"/login",component:gd},"login"),ih=()=>Object(ne.jsx)(o.b,{to:"/login"}),ah=()=>Object(ne.jsx)(o.b,{to:"/welcome"}),rh=e=>{let{name:t,role:n}=e;return void 0===t?ih:void 0===n?ah:()=>Object(ne.jsx)(Ql,{})},oh=(e,t)=>{let{name:n}=e;return void 0===n?ih:()=>t},ch=(e,t)=>{let{name:n,role:s}=e;return void 0===n?ih:void 0===s?ah:()=>t};function lh(){const e=b()();for(const{start:t,end:n,reason:s}of we.b.disablePeriods)if(t.isBefore(e)&&n.isAfter(e))return s||!0;return!1}var dh=e=>{const t=f.useRef(void 0),[n,s]=f.useState(lh()),i=/iPhone|iPad|Android/.test(navigator.userAgent),a=window.matchMedia("(display-mode: standalone)").matches,r=f.useRef({height:0,width:0}),[c,l]=Object(x.c)(we.b.workspaceSettingsLocalStorageKey,qu.c),d="string"===typeof e.name&&"string"===typeof e.role;f.useEffect((()=>{e.name&&e.fetchUserAndCourse()}),[]),f.useEffect((()=>(we.b.disablePeriods.length>0&&(t.current=window.setInterval((()=>{const e=lh();n!==e&&s(e)}),5e3)),()=>{t.current&&window.clearInterval(t.current)})),[n]),f.useEffect((()=>{const e=()=>{window.innerHeight<r.current.height&&window.innerWidth===r.current.width||document.documentElement.style.setProperty("--application-height",window.innerHeight+"px"),r.current={height:window.innerHeight,width:window.innerWidth}};return!a&&i&&(e(),window.addEventListener("resize",e)),()=>{!a&&i&&window.removeEventListener("resize",e)}}),[a,i]);const u=[Object(ne.jsx)(o.c,{path:"/contributors",component:sd},"contributors"),Object(ne.jsx)(o.c,{path:"/callback/github",component:ud},"githubCallback"),we.b.enableGitHubAssessments?Object(ne.jsx)(o.c,{path:"/githubassessments",render:()=>Object(ne.jsx)(ad.a,{handleGitHubLogIn:e.handleGitHubLogIn,handleGitHubLogOut:e.handleGitHubLogOut})},"githubAssessments"):null],m=!["staff","admin"].includes(e.role)&&n;return Object(ne.jsx)(qu.b.Provider,{value:[c,l],children:Object(ne.jsxs)("div",{className:"Application",children:[Object(ne.jsx)(nh,{handleLogOut:e.handleLogOut,handleGitHubLogIn:e.handleGitHubLogIn,handleGitHubLogOut:e.handleGitHubLogOut,handleCreateCourse:e.handleCreateCourse,role:e.role,name:e.name,courses:e.courses,courseId:e.courseId,courseShortName:e.courseShortName,enableAchievements:e.enableAchievements,enableSourcecast:e.enableSourcecast,assessmentTypes:f.useMemo((()=>{var t;return null===(t=e.assessmentConfigurations)||void 0===t?void 0:t.map((e=>e.type))}),[e.assessmentConfigurations])}),Object(ne.jsxs)("div",{className:"Application__main",children:[m&&Object(ne.jsxs)(o.e,{children:[!we.b.playgroundOnly&&sh,d||we.b.playgroundOnly?[]:[Object(ne.jsx)(o.c,{path:"/courses",render:ih},0),Object(ne.jsx)(o.c,{exact:!0,path:"/",render:ih},1)],Object(ne.jsx)(o.c,{children:Object(ne.jsx)(id,{reason:"string"===typeof n?n:void 0})})]}),!m&&we.b.playgroundOnly&&Object(ne.jsxs)(o.e,{children:[u,Object(ne.jsx)(o.c,{path:"/playground",component:Du}),Object(ne.jsx)(o.c,{exact:!0,path:"/",children:Object(ne.jsx)(o.b,{to:"/playground"})}),Object(ne.jsx)(o.c,{component:Ke})]}),!m&&!we.b.playgroundOnly&&Object(ne.jsxs)(o.e,{children:[sh,u,Object(ne.jsx)(o.c,{path:"/courses/:courseId(\\d+)?",render:rh(e)}),Object(ne.jsx)(o.c,{path:"/welcome",render:oh(e,Object(ne.jsx)(Bu,{}))}),Object(ne.jsx)(o.c,{path:"/mission-control/:assessmentId(-?\\d+)?/:questionId(\\d+)?",component:vu}),Object(ne.jsx)(o.c,{path:"/playground",render:ch(e,Object(ne.jsx)(Du,{}))}),Object(ne.jsx)(o.b,{from:"/",exact:!0,to:null!=e.courseId?`/courses/${e.courseId}`:"/welcome"}),null!=e.courseId&&[Object(ne.jsx)(o.b,{from:"/sourcecast/:splat?",to:`/courses/${e.courseId}/sourcecast/:splat?`},"legacy-sourcecast"),Object(ne.jsx)(o.b,{from:"/achievements/:splat?",to:`/courses/${e.courseId}/achievements/:splat?`},"legacy-achievements"),Object(ne.jsx)(o.b,{from:"/academy/:splat?",to:`/courses/${e.courseId}/:splat?`},"legacy-academy")],Object(ne.jsx)(o.c,{component:Ke})]})]}),we.b.showResearchPrompt&&null===e.agreedToResearch&&Object(ne.jsx)("div",{className:"research-prompt",children:Object(ne.jsxs)(h.h,{className:p.a.DARK,title:"Agreement to Participate in Educational Research",canOutsideClickClose:!1,canEscapeKeyClose:!1,isCloseButtonShown:!1,isOpen:!0,children:[Object(ne.jsxs)("div",{className:p.a.DIALOG_BODY,children:[Object(ne.jsx)(h.r,{children:"Welcome to your new Source Academy @ NUS course!"}),Object(ne.jsx)("div",{children:"Here at Source Academy @ NUS, our mission is to bring out the beauty and fun in programming and the ideas behind programming, and to make these ideas universally accessible. This includes educational research!"}),Object(ne.jsx)("br",{}),Object(ne.jsx)("div",{children:"We collect programs that students run in Source Academy @ NUS and store them anonymously for our research. You are free to opt out of this collection, with no penalty for you whatsoever. Contact your course instructor if you have questions or concerns about this research."})]}),Object(ne.jsx)("div",{className:p.a.DIALOG_FOOTER,children:Object(ne.jsxs)("div",{className:p.a.DIALOG_FOOTER_ACTIONS,children:[Object(ne.jsx)(h.b,{text:"I would like to opt out",onClick:()=>e.updateCourseResearchAgreement(!1)}),Object(ne.jsx)(h.b,{text:"I consent!",intent:g.a.SUCCESS,onClick:()=>e.updateCourseResearchAgreement(!0)})]})})]})})]})})};var uh=Object(o.l)(Object(r.b)((e=>({role:e.session.role,name:e.session.name,courses:e.session.courses,courseId:e.session.courseId,courseShortName:e.session.courseShortName,enableAchievements:e.session.enableAchievements,enableSourcecast:e.session.enableSourcecast,assessmentConfigurations:e.session.assessmentConfigurations,agreedToResearch:e.session.agreedToResearch})),(e=>Object(c.b)({handleLogOut:d.logOut,handleGitHubLogIn:u.loginGitHub,handleGitHubLogOut:u.logoutGitHub,fetchUserAndCourse:u.fetchUserAndCourse,handleCreateCourse:l.createCourse,updateCourseResearchAgreement:u.updateCourseResearchAgreement},e)))(dh));const hh=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ph(e,t){navigator.serviceWorker.register(e).then((e=>{setInterval((()=>{try{e.update()}catch{}}),3e5),e.onupdatefound=()=>{const n=e.installing;null!=n&&(n.onstatechange=()=>{"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}var gh=n(328);const mh=Object(f.createContext)(void 0);var bh=e=>{let{children:t}=e;const[n,s]=Object(f.useState)();return Object(gh.configure)({fs:"MountableFileSystem",options:{"/playground":{fs:"IndexedDB",options:{storeName:"playground"}}}},(e=>{e&&console.error(e),s(Object(gh.BFSRequire)("fs"))})),Object(ne.jsx)(mh.Provider,{value:n,children:t})};if(we.b.sentryDsn){s.a({dsn:we.b.sentryDsn,environment:we.b.sourceAcademyEnvironment,release:`cadet-frontend@${we.b.sourceAcademyVersion}`});const e=Ks.a.getState().session.userId;i.b("undefined"!==typeof e?{id:e.toString()}:null)}const fh=document.getElementById("root");if(window.__REDUX_STORE__=Ks.a,console.log(`%cSource Academy ${we.b.sourceAcademyEnvironment}-${we.b.sourceAcademyVersion}; Please visit ${we.a.githubIssues} to report bugs or issues.`,"font-weight: bold;"),Object(a.render)(Object(ne.jsx)(r.a,{store:Ks.a,children:Object(ne.jsx)(bh,{children:Object(ne.jsx)(o.d,{history:Ce.a,children:Object(ne.jsx)(uh,{})})})}),fh),function(e){if("serviceWorker"in navigator){if(new URL("/c-slang-frontend",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="/c-slang-frontend/service-worker.js";hh?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((n=>{const s=n.headers.get("content-type");404===n.status||null!=s&&-1===s.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):ph(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):ph(t,e)}))}}({onUpdate:()=>{Object(me.e)("A new version of Source Academy is available. Please refresh the browser.",0)}}),we.b.cadetLoggerUrl){const e=()=>function(e){var t;e&&(null===(t=navigator.serviceWorker.controller)||void 0===t||t.postMessage({type:"SYNC_LOGS",accessToken:e}))}(Ks.a.getState().session.accessToken);navigator.serviceWorker.ready.then((()=>{setInterval(e,we.b.cadetLoggerInterval)}))}},117:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionParser=t.UNARY_MINUS_TAG=t.DEREFERENCE_TAG=void 0;const s=n(126),i=n(278),a=n(569),r=n(279),o=n(161),c=n(369);function l(e,n,a,r,o){if(e!=t.DEREFERENCE_TAG&&("string"!=typeof e||!new i.Lexer(e).matchIdentifier()||n.lookupType(e)==s.PrimitiveType.FUNCTION))throw new Error(o.formatError("expression is not assignable",a,r))}t.DEREFERENCE_TAG="$DEREFERENCE",t.UNARY_MINUS_TAG="$UNARY_MINUS";t.ExpressionParser=class{static recurParseNumericTerm(e,n,d,u,h){let p;if(n.matchDelimiter("!"))n.eatDelimiter("!"),this.recurParseNumericTerm(e,n,d,!1,h),d.push("!"),p=s.PrimitiveType.INT;else if(n.matchDelimiter("&")){const[a,r]=n.tell();n.eatDelimiter("&");const o=this.recurParseNumericTerm(e,n,d,!1,h);!function(e,n,a,r,o){if("string"!=typeof e)throw new Error(o.formatError("expression is not addressable",a,r));if(!(e==t.DEREFERENCE_TAG||new i.Lexer(e).matchIdentifier()&&n.lookupType(e)!=s.PrimitiveType.FUNCTION))throw new Error(o.formatError("expression is not addressable",a,r))}(d[d.length-1],e,a,r,n),d.push("&"),p=new s.PointerType(o)}else if(n.matchDelimiter("*")){const[i,a]=n.tell();n.eatDelimiter("*");const r=this.recurParseNumericTerm(e,n,d,!1,h);if(!(r instanceof s.PointerType))throw new Error(n.formatError("indirection requires pointer operand, ('"+r+"' invalid)",i,a));d.push(t.DEREFERENCE_TAG),p=r.dereference()}else if(n.matchDelimiter("("))if(n.eatDelimiter("("),n.matchDataType()){const[t,i]=n.tell(),a=n.eatDataType();if(a==s.PrimitiveType.VOID&&!u)throw new Error(n.formatError("expected expression of scalar type ('void' invalid)",t,i));n.eatDelimiter(")");const[r,o]=n.tell(),c=this.recurParseNumericTerm(e,n,d,!1,h);if(c==s.PrimitiveType.VOID)throw new Error(n.formatError("cannot cast type '"+c.toString()+"' to '"+a.toString()+"'",r,o));d.push(a),p=a}else p=this.recurParseExpression(e,n,d,!0,h),n.eatDelimiter(")");else if(n.matchNumber()){const e=n.eatNumber();d.push(e),p=e.getDataType()}else if(n.matchDelimiter("'"))d.push(n.eatCharacterLiteral()),p=s.PrimitiveType.CHAR;else if(n.matchDelimiter('"'))d.push(n.eatStringLiteral()),p=new s.PointerType(s.PrimitiveType.CHAR);else if(n.matchIncrementDecrementOperator()){if(h)throw new Error(n.formatError("expected a constant expression"));const[t,s]=n.tell(),i="++"==n.eatIncrementDecrementOperator()?a.IncrementDecrement.PRE_INCREMENT:a.IncrementDecrement.PRE_DECREMENT;p=this.recurParseNumericTerm(e,n,d,!1,h),l(d[d.length-1],e,t,s,n),d.push(i)}else if(n.matchUnaryPlusMinus()){const[s,i]=n.tell(),a=n.eatUnaryPlusMinus();p=this.recurParseNumericTerm(e,n,d,!1,h),"-"==a&&((0,c.checkUnaryMinusOperandType)(p,s,i,n),d.push(t.UNARY_MINUS_TAG))}else if(n.matchIdentifier()){if(h)throw new Error(n.formatError("expected a constant expression"));const[t,i]=n.tell(),a=n.eatIdentifier();d.push(a),function(e,t,n,s,i){if(!t.isDeclared(e))throw new Error(i.formatError("undeclared symbol: '"+e+"'",n,s))}(a,e,t,i,n);const o=e.lookupType(a);if(o!=s.PrimitiveType.FUNCTION){if(p=o,n.matchDelimiter("("))throw new Error(n.formatError("called object type is not a function",t,i))}else{const s=String(d.pop()),a=new r.FunctionCall(e,s,e.lookupFunction(s).parseActualParameters(e,n),t);if(!u&&"void"==a.getReturnType())throw new Error(n.formatError("expected expression of scalar type ('void' invalid)",t,i));d.push(a),p=a.getReturnType()}}else{if(!n.matchKeyword("sizeof"))throw new Error(n.formatError("expression expected"));{let t;if(n.eatKeyword("sizeof"),n.eatDelimiter("("),n.matchDataType())t=n.eatDataType();else{const s=[];t=this.recurParseExpression(e,n,s,!0,!1)}n.eatDelimiter(")"),d.push(o.NumericLiteral.new((0,s.sizeof)(t)).castToType(s.PrimitiveType.INT)),p=s.PrimitiveType.INT}}if(n.matchIncrementDecrementOperator()){const[t,s]=n.tell();l(d[d.length-1],e,t,s,n),d.push("++"==n.eatIncrementDecrementOperator()?a.IncrementDecrement.POST_INCREMENT:a.IncrementDecrement.POST_DECREMENT)}if(n.matchDelimiter("[")){(0,c.assertSubscritable)(p,n),n.eatDelimiter("[");const[s,i]=n.tell();(0,c.checkSubscriptType)(this.recurParseExpression(e,n,d,!1,!1),s,i,n),n.eatDelimiter("]"),d.push("+",t.DEREFERENCE_TAG),p=p.dereference()}return p}static recurParsePrioritizedNumericTerm(e,t,n,s,i){let a=this.recurParseNumericTerm(e,t,n,s,i);for(;t.matchPrioritizedArithmeticOperator();){const[s,r]=t.tell(),o=t.eatArithmeticOperator(),l=this.recurParseNumericTerm(e,t,n,!1,i);a=(0,c.checkBinaryExprssionOperandType)(s,r,t,a,o,l),n.push(o)}return a}static recurParseNumericalExpression(e,t,n,s,i){let a=this.recurParsePrioritizedNumericTerm(e,t,n,s,i);for(;t.matchArithmeticOperator();){const[s,r]=t.tell(),o=t.eatArithmeticOperator(),l=this.recurParsePrioritizedNumericTerm(e,t,n,!1,i);a=(0,c.checkBinaryExprssionOperandType)(s,r,t,a,o,l),n.push(o)}return a}static recurParsePrioritizedRelationalTerm(e,t,n,s,i){let a=this.recurParseNumericalExpression(e,t,n,s,i);for(;t.matchPrioritizedRelationalOperator();){const[s,r]=t.tell(),o=t.eatRelationalOperator(),l=this.recurParseNumericalExpression(e,t,n,!1,i);a=(0,c.checkBinaryExprssionOperandType)(s,r,t,a,o,l),n.push(o)}return a}static recurParseRelationalExpression(e,t,n,s,i){let a=this.recurParsePrioritizedRelationalTerm(e,t,n,s,i);for(;t.matchRelationalOperator();){const[s,r]=t.tell(),o=t.eatRelationalOperator(),l=this.recurParsePrioritizedRelationalTerm(e,t,n,!1,i);a=(0,c.checkBinaryExprssionOperandType)(s,r,t,a,o,l),n.push(o)}return a}static recurParsePrioritizedLogicalTerm(e,t,n,s,i){let r=this.recurParseRelationalExpression(e,t,n,s,i);const o=[];for(;t.matchDelimiter("&&");){const[s,l]=t.tell();o.push(new a.Jump(!1)),n.push(o[o.length-1]),t.eatDelimiter("&&");const d=this.recurParseRelationalExpression(e,t,n,!1,i);r=(0,c.checkBinaryExprssionOperandType)(s,l,t,r,"&&",d),n.push("&&")}return o.forEach((e=>e.toPosition=n.length)),r}static recurParseLogicalExpression(e,t,n,s,i){let r=this.recurParsePrioritizedLogicalTerm(e,t,n,s,i);const o=[];for(;t.matchDelimiter("||");){const[s,l]=t.tell();o.push(new a.Jump(!0)),n.push(o[o.length-1]),t.eatDelimiter("||");const d=this.recurParsePrioritizedLogicalTerm(e,t,n,!1,i);r=(0,c.checkBinaryExprssionOperandType)(s,l,t,r,"||",d),n.push("||")}return o.forEach((e=>e.toPosition=n.length)),r}static recurParseTernaryExpression(e,t,n,s,i){const[r,o]=t.tell(),l=this.recurParseLogicalExpression(e,t,n,s,i);if(!t.matchDelimiter("?"))return l;(0,c.checkConditionOperandType)(r,o,t,l),t.eatDelimiter("?");const d=new a.Jump(!1);n.push(d);const u=this.recurParseLogicalExpression(e,t,n,!1,i),h=new a.Jump;n.push(h),t.eatDelimiter(":"),d.toPosition=n.length;const p=this.recurParseLogicalExpression(e,t,n,!1,i);return h.toPosition=n.length,(0,c.getHigherPrecisionType)(u,p)}static recurParseExpression(e,t,n,s,i){let a=this.recurParseTernaryExpression(e,t,n,s,i);if(t.matchAssignmentOperator()){const[s,r]=t.tell();l(n[n.length-1],e,s,r,t);const o=t.eatAssignmentOperator(),d=this.recurParseExpression(e,t,n,!1,i);a=(0,c.checkAssignmentOperandType)(s,r,t,a,o,d),n.push(o)}return a}static parse(e,t,n,s,i){const r=[],[o,l]=t.tell(),d=this.recurParseExpression(e,t,r,n,s);return null!=i&&(0,c.checkAssignmentOperandType)(o,l,t,i,"=",d),new a.Expression(r,d)}}},12:function(e,t,n){"use strict";var s=n(98),i=n(41),a=(n(1),n(0));const r={className:"",fullWidth:!1,iconOnRight:!1,intent:s.a.NONE,minimal:!0};t.a=e=>{let{label:t="",icon:n,onClick:s,options:o={},isDisabled:c=!1}=e;const l={...r,...o},d=n&&Object(a.jsx)(i.w,{icon:n,color:l.iconColor});return Object(a.jsx)(i.b,{disabled:c,fill:l.fullWidth,intent:l.intent,minimal:l.minimal,className:l.className,type:l.type,onClick:s,icon:!l.iconOnRight&&d,rightIcon:l.iconOnRight&&d,children:t})}},120:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var s=n(41),i=n(3),a=n(116),r=n(331),o=(n(1),n(21)),c=n(0);const l=e=>{let{itemsParentRef:t,renderItem:n}=e;const i=o.h.map(n);return Object(c.jsx)(s.A,{ulRef:t,children:i})},d=(e,t)=>{let{handleClick:n}=t;return Object(c.jsx)(s.B,{onClick:n,text:e.displayName},e.displayName)},u=r.a.ofType(),h=e=>{let{sourceChapter:t,sourceVariant:n,handleChapterSelect:r=(()=>{}),disabled:h=!1}=e;return Object(c.jsx)(u,{items:o.n,onItemSelect:r,itemRenderer:d,itemListRenderer:l,filterable:!1,disabled:h,children:Object(c.jsx)(s.b,{className:i.a.MINIMAL,text:Object(o.o)(t,n),rightIcon:h?null:a.a.DOUBLE_CARET_VERTICAL,disabled:h})})}},121:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const s="SAVE_CANVAS",i=":assessmentId(\\d+)?/:questionId(\\d+)?",a=":submissionId(\\d+)?/:questionId(\\d+)?",r="CREATE_COURSE",o="ADD_NEW_USERS_TO_COURSE"},122:function(e,t,n){"use strict";n.r(t),n.d(t,"generateLzString",(function(){return a})),n.d(t,"shortenURL",(function(){return r})),n.d(t,"updateShortURL",(function(){return o})),n.d(t,"changeQueryString",(function(){return c})),n.d(t,"playgroundUpdatePersistenceFile",(function(){return l})),n.d(t,"playgroundUpdateGitHubSaveInfo",(function(){return d}));var s=n(7),i=n(104);const a=()=>Object(s.action)(i.b),r=e=>Object(s.action)(i.e,e),o=e=>Object(s.action)(i.f,e),c=e=>Object(s.action)(i.a,e),l=e=>Object(s.action)(i.d,e),d=(e,t,n)=>Object(s.action)(i.c,{repoName:e,filePath:t,lastSaved:n})},126:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BUILTINS=t.PLACEHOLDER_REGEX=t.PRIMITIVE_TYPES=t.sizeof=t.WHOLE_PRIMITIVE_TYPES=t.ARITH_PRIMITIVE_TYPES=t.PointerType=t.PrimitiveType=t.MAX_INT=void 0;const s=n(161),i=n(568);var a;t.MAX_INT=2147483647,function(e){e.INT="int",e.FLOAT="float",e.FUNCTION="function",e.VOID="void",e.CHAR="char"}(a=t.PrimitiveType||(t.PrimitiveType={}));class r{constructor(e){this.pointingTo=e}dereference(){return this.pointingTo}toString(){return this.pointingTo.toString()+"*"}}t.PointerType=r,t.ARITH_PRIMITIVE_TYPES=new Set([a.CHAR,a.FLOAT,a.INT]),t.WHOLE_PRIMITIVE_TYPES=new Set([a.CHAR,a.INT]),t.sizeof=function(e){if(e instanceof r)return 4;if(e==a.VOID)return 1;if(e==a.INT||e==a.FLOAT)return 4;if(e==a.FUNCTION)return 0;if(e==a.CHAR)return 1;throw new Error("unsupported sizeof datatype: "+e)},t.PRIMITIVE_TYPES=Object.values(a);t.PLACEHOLDER_REGEX=/%d|%ld|%f|%lf|%s|%c|%p/;t.BUILTINS={printf:[new i.BuiltinFunction(a.INT,"printf",[new r(a.CHAR)],((e,n,i)=>{let r=e.dereferenceAsString(i[0]),o=1;for(;o<i.length;){const n=t.PLACEHOLDER_REGEX.exec(r);if(null==n)throw new Error("data unused in format string");r="%s"==n[0]?r.replace(t.PLACEHOLDER_REGEX,e.dereferenceAsString(i[o])):"%c"==n[0]?r.replace(t.PLACEHOLDER_REGEX,i[o].toChar()):r.replace(t.PLACEHOLDER_REGEX,String(i[o].getValue())),o++}if(t.PLACEHOLDER_REGEX.test(r))throw new Error("expected more data arguments, '"+r+"'");return n.stdout+=r,s.NumericLiteral.new(r.length).castToType(a.INT)}),!1,!0),a.FUNCTION],scanf:[new i.BuiltinFunction(a.INT,"scanf",[new r(a.CHAR)],((e,n,i)=>{let r=1,o=e.dereferenceAsString(i[0]);for(;r<i.length;){const c=prompt(n.stdout);if(null==c)throw Error("execution interrupted");const l=null===c||void 0===c?void 0:c.split(/\s+/);for(let n=0;l&&n<l.length;n++){const c=t.PLACEHOLDER_REGEX.exec(o);if(null==c)throw new Error("impossible execution path");o=o.replace(t.PLACEHOLDER_REGEX,"0");const d=isNaN(parseFloat(l[n]))?s.NumericLiteral.new(0):s.NumericLiteral.new(parseFloat(l[n]));if(isNaN(parseFloat(l[n]))&&e.assignValueByAddress(i[r].getValue(),s.NumericLiteral.new(0)),"%c"==c[0])e.assignValueByAddress(i[r].getValue(),d.castToType(a.CHAR));else if("%d"==c[0]||"%ld"==c[0])e.assignValueByAddress(i[r].getValue(),d.castToType(a.INT));else{if("%f"!=c[0]&&"%lf"!=c[0])throw new Error("unsupported datatype for scanf: "+c[0]);e.assignValueByAddress(i[r].getValue(),d.castToType(a.FLOAT))}r++}n.stdout+=c+"\n"}return s.NumericLiteral.new(r-1).castToType(a.INT)}),!0,!0),a.FUNCTION],rand:[new i.BuiltinFunction(a.INT,"rand",[],((e,n,i)=>s.NumericLiteral.new(Math.floor(Math.random()*t.MAX_INT)).castToType(a.INT))),a.FUNCTION],time:[new i.BuiltinFunction(a.INT,"time",[],((e,t,n)=>s.NumericLiteral.new(Math.floor(Date.now()/1e3)).castToType(a.INT))),a.FUNCTION],sqrt:[new i.BuiltinFunction(a.FLOAT,"sqrt",[a.FLOAT],((e,t,n)=>n[0].sqrt())),a.FUNCTION],abs:[new i.BuiltinFunction(a.INT,"abs",[a.INT],((e,t,n)=>n[0].abs())),a.FUNCTION],strlen:[new i.BuiltinFunction(a.INT,"strlen",[new r(a.CHAR)],((e,t,n)=>s.NumericLiteral.new(e.dereferenceAsString(n[0]).length).castToType(a.INT))),a.FUNCTION],malloc:[new i.BuiltinFunction(new r(a.VOID),"malloc",[a.INT],((e,t,n)=>e.allocateOnHeap(n[0]))),a.FUNCTION],free:[new i.BuiltinFunction(a.VOID,"free",[new r(a.VOID)],((e,t,n)=>{e.free(n[0])})),a.FUNCTION],printHeap:[new i.BuiltinFunction(a.VOID,"printHeap",[],((e,t,n)=>{e.printHeap(t)})),a.FUNCTION],printEnv:[new i.BuiltinFunction(a.VOID,"printEnv",[],((e,t,n)=>{e.printEnv(t)})),a.FUNCTION]}},128:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));const s="FETCH_SOURCECAST_INDEX",i="SET_IS_EDITOR_READONLY",a="UPDATE_SOURCECAST_INDEX"},13:function(e,t,n){"use strict";n.r(t),n.d(t,"browseReplHistoryDown",(function(){return c})),n.d(t,"browseReplHistoryUp",(function(){return l})),n.d(t,"changeExternalLibrary",(function(){return d})),n.d(t,"changeExecTime",(function(){return u})),n.d(t,"changeSideContentHeight",(function(){return h})),n.d(t,"changeStepLimit",(function(){return p})),n.d(t,"chapterSelect",(function(){return g})),n.d(t,"externalLibrarySelect",(function(){return m})),n.d(t,"toggleEditorAutorun",(function(){return b})),n.d(t,"beginClearContext",(function(){return f})),n.d(t,"clearReplInput",(function(){return v})),n.d(t,"clearReplOutput",(function(){return y})),n.d(t,"clearReplOutputLast",(function(){return j})),n.d(t,"endClearContext",(function(){return x})),n.d(t,"evalEditor",(function(){return O})),n.d(t,"checkEditor",(function(){return S})),n.d(t,"evalRepl",(function(){return w})),n.d(t,"evalTestcase",(function(){return C})),n.d(t,"runAllTestcases",(function(){return E})),n.d(t,"updateActiveEditorTab",(function(){return T})),n.d(t,"updateEditorValue",(function(){return k})),n.d(t,"setEditorBreakpoint",(function(){return A})),n.d(t,"highlightEditorLine",(function(){return _})),n.d(t,"updateReplValue",(function(){return I})),n.d(t,"sendReplInputToOutput",(function(){return N})),n.d(t,"resetTestcase",(function(){return P})),n.d(t,"navigateToDeclaration",(function(){return R})),n.d(t,"moveCursor",(function(){return M})),n.d(t,"resetWorkspace",(function(){return L})),n.d(t,"updateWorkspace",(function(){return D})),n.d(t,"setIsEditorReadonly",(function(){return B})),n.d(t,"updateCurrentAssessmentId",(function(){return U})),n.d(t,"updateCurrentSubmissionId",(function(){return G})),n.d(t,"updateHasUnsavedChanges",(function(){return F})),n.d(t,"changeSublanguage",(function(){return H})),n.d(t,"updateSublanguage",(function(){return V})),n.d(t,"promptAutocomplete",(function(){return W})),n.d(t,"notifyProgramEvaluated",(function(){return $})),n.d(t,"toggleUsingSubst",(function(){return X})),n.d(t,"addHtmlConsoleError",(function(){return q}));var s=n(7),i=n(128),a=n(58),r=n(23),o=n(29);const c=e=>Object(s.action)(o.c,{workspaceLocation:e}),l=e=>Object(s.action)(o.d,{workspaceLocation:e}),d=(e,t)=>Object(s.action)(o.f,{newExternal:e,workspaceLocation:t}),u=(e,t)=>Object(s.action)(o.e,{execTime:e,workspaceLocation:t}),h=(e,t)=>Object(s.action)(o.g,{height:e,workspaceLocation:t}),p=(e,t)=>Object(s.action)(o.h,{stepLimit:e,workspaceLocation:t}),g=(e,t,n)=>Object(s.action)(o.j,{chapter:e,variant:t,workspaceLocation:n}),m=(e,t,n)=>Object(s.action)(o.w,{externalLibraryName:e,workspaceLocation:t,initialise:n||!1}),b=e=>Object(s.action)(o.B,{workspaceLocation:e}),f=(e,t,n)=>Object(s.action)(o.b,{library:t,workspaceLocation:e,shouldInitLibrary:n}),v=e=>Object(s.action)(o.l,{workspaceLocation:e}),y=e=>Object(s.action)(o.m,{workspaceLocation:e}),j=e=>Object(s.action)(o.n,{workspaceLocation:e}),x=(e,t)=>Object(s.action)(o.o,{library:e,workspaceLocation:t}),O=e=>Object(s.action)(o.p,{workspaceLocation:e}),S=e=>Object(s.action)(o.k,{workspaceLocation:e}),w=e=>Object(s.action)(o.r,{workspaceLocation:e}),C=(e,t)=>Object(s.action)(o.t,{workspaceLocation:e,testcaseId:t}),E=e=>Object(s.action)(o.q,{workspaceLocation:e}),T=(e,t)=>Object(s.action)(o.D,{workspaceLocation:e,activeEditorTabOptions:t}),k=(e,t)=>Object(s.action)(o.H,{newEditorValue:e,workspaceLocation:t}),A=(e,t)=>Object(s.action)(o.G,{breakpoints:e,workspaceLocation:t}),_=(e,t)=>Object(s.action)(a.l,{highlightedLines:e,workspaceLocation:t}),I=(e,t)=>Object(s.action)(o.J,{newReplValue:e,workspaceLocation:t}),N=(e,t)=>Object(s.action)(o.A,{type:"code",workspaceLocation:t,value:e}),P=(e,t)=>Object(s.action)(o.y,{workspaceLocation:e,index:t}),R=(e,t)=>Object(s.action)(o.v,{workspaceLocation:e,cursorPosition:t}),M=(e,t)=>Object(s.action)(o.u,{workspaceLocation:e,cursorPosition:t}),L=(e,t)=>Object(s.action)(o.z,{workspaceLocation:e,workspaceOptions:t}),D=(e,t)=>Object(s.action)(o.L,{workspaceLocation:e,workspaceOptions:t}),B=(e,t)=>Object(s.action)(i.b,{workspaceLocation:e,isEditorReadonly:t}),U=(e,t)=>Object(s.action)(o.E,{assessmentId:e,questionId:t}),G=(e,t)=>Object(s.action)(o.F,{submissionId:e,questionId:t}),F=(e,t)=>Object(s.action)(o.I,{workspaceLocation:e,hasUnsavedChanges:t}),H=e=>Object(s.action)(o.i,{sublang:e}),V=e=>Object(s.action)(o.K,{sublang:e}),W=(e,t,n,i)=>Object(s.action)(o.x,{workspaceLocation:e,row:t,column:n,callback:i}),$=(e,t,n,i,a)=>Object(s.action)(r.a,{result:e,lastDebuggerResult:t,code:n,context:i,workspaceLocation:a}),X=(e,t)=>Object(s.action)(o.C,{usingSubst:e,workspaceLocation:t}),q=(e,t)=>Object(s.action)(o.a,{errorMsg:e,workspaceLocation:t})},136:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SetPropertyError=t.GetInheritedPropertyError=t.GetPropertyError=t.ConstAssignment=t.VariableRedeclaration=t.InvalidNumberOfArguments=t.UnassignedVariable=t.UndefinedVariable=t.CallingNonFunctionValue=t.MaximumStackLimitExceeded=t.CRuntimeError=t.CProgramError=t.ExceptionError=t.InterruptedError=void 0;const s=n(500),i=n(27),a=n(102),r=n(272);class o extends r.RuntimeSourceError{constructor(e){super(e)}explain(){return"Execution aborted by user."}elaborate(){return"TODO"}}t.InterruptedError=o;t.ExceptionError=class{constructor(e,t){this.error=e,this.location=t,this.type=i.ErrorType.RUNTIME,this.severity=i.ErrorSeverity.ERROR}explain(){return this.error.toString()}elaborate(){return"TODO"}};t.CProgramError=class{constructor(e){this.error=e,this.type=i.ErrorType.SYNTAX,this.severity=i.ErrorSeverity.ERROR}explain(){return this.error.message}elaborate(){return"TODO"}};class c extends r.RuntimeSourceError{constructor(e){super(),this.error=e}explain(){return this.error.message}}t.CRuntimeError=c;class l extends r.RuntimeSourceError{constructor(e,t){super(e),this.calls=t,this.customGenerator=Object.assign(Object.assign({},s.baseGenerator),{CallExpression(e,t){t.write((0,s.generate)(e.callee)),t.write("(");const n=e.arguments.map((e=>(0,a.stringify)(e.value)));t.write(n.join(", ")),t.write(")")}})}explain(){const e=e=>(0,s.generate)(e,{generator:this.customGenerator});return"Maximum call stack size exceeded\n  "+this.calls.map((t=>e(t)+"..")).join("  ")}elaborate(){return"TODO"}}t.MaximumStackLimitExceeded=l,l.MAX_CALLS_TO_SHOW=3;class d extends r.RuntimeSourceError{constructor(e,t){super(t),this.callee=e,this.node=t}explain(){return`Calling non-function value ${(0,a.stringify)(this.callee)}.`}elaborate(){const e=this.callee,t=(0,a.stringify)(e);let n="";n=this.node.arguments.map(s.generate).join(", ");const i=`Because ${t} is not a function, you cannot run ${t}(${n}).`,r=`If you were planning to perform multiplication by ${t}, you need to use the * operator.`;return Number.isFinite(e)?`${i} ${r}`:i}}t.CallingNonFunctionValue=d;class u extends r.RuntimeSourceError{constructor(e,t){super(t),this.name=e}explain(){return`Name ${this.name} not declared.`}elaborate(){return`Before you can read the value of ${this.name}, you need to declare it as a variable or a constant. You can do this using the let or const keywords.`}}t.UndefinedVariable=u;class h extends r.RuntimeSourceError{constructor(e,t){super(t),this.name=e}explain(){return`Name ${this.name} declared later in current scope but not yet assigned`}elaborate(){return`If you're trying to access the value of ${this.name} from an outer scope, please rename the inner ${this.name}. An easy way to avoid this issue in future would be to avoid declaring any variables or constants with the name ${this.name} in the same scope.`}}t.UnassignedVariable=h;class p extends r.RuntimeSourceError{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(e),this.expected=t,this.got=n,this.hasVarArgs=i,this.calleeStr=(0,s.generate)(e.callee)}explain(){return`Expected ${this.expected} ${this.hasVarArgs?"or more ":""}arguments, but got ${this.got}.`}elaborate(){const e=this.calleeStr,t=1===this.expected?"":"s";return`Try calling function ${e} again, but with ${this.expected} argument${t} instead. Remember that arguments are separated by a ',' (comma).`}}t.InvalidNumberOfArguments=p;class g extends r.RuntimeSourceError{constructor(e,t,n){super(e),this.node=e,this.name=t,this.writable=n}explain(){return`Redeclaring name ${this.name}.`}elaborate(){if(!0===this.writable){const e=`Since ${this.name} has already been declared, you can assign a value to it without re-declaring.`;let t="";return"FunctionDeclaration"===this.node.type?t="("+this.node.params.map(s.generate).join(",")+") => {...":"VariableDeclaration"===this.node.type&&(t=(0,s.generate)(this.node.declarations[0].init)),`${e} As such, you can just do\n\n\t${this.name} = ${t};\n`}return!1===this.writable?`You will need to declare another variable, as ${this.name} is read-only.`:""}}t.VariableRedeclaration=g;class m extends r.RuntimeSourceError{constructor(e,t){super(e),this.name=t}explain(){return`Cannot assign new value to constant ${this.name}.`}elaborate(){return`As ${this.name} was declared as a constant, its value cannot be changed. You will have to declare a new variable.`}}t.ConstAssignment=m;class b extends r.RuntimeSourceError{constructor(e,t,n){super(e),this.obj=t,this.prop=n}explain(){return`Cannot read property ${this.prop} of ${(0,a.stringify)(this.obj)}.`}elaborate(){return"TODO"}}t.GetPropertyError=b;class f extends r.RuntimeSourceError{constructor(e,t,n){super(e),this.obj=t,this.prop=n,this.type=i.ErrorType.RUNTIME,this.severity=i.ErrorSeverity.ERROR,this.location=e.loc}explain(){return`Cannot read inherited property ${this.prop} of ${(0,a.stringify)(this.obj)}.`}elaborate(){return"TODO"}}t.GetInheritedPropertyError=f;class v extends r.RuntimeSourceError{constructor(e,t,n){super(e),this.obj=t,this.prop=n}explain(){return`Cannot assign property ${this.prop} of ${(0,a.stringify)(this.obj)}.`}elaborate(){return"TODO"}}t.SetPropertyError=v},137:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const s="LOG_OUT"},138:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var s=n(60),i=n(116),a=n(265),r=(n(1),n(12)),o=n(0);const c=e=>Object(o.jsx)(a.a,{content:"...or press shift-enter in the editor",placement:s.a.TOP,children:Object(o.jsx)(r.a,{label:"Run",icon:i.a.PLAY,onClick:e.handleEditorEval,options:{iconColor:e.color,className:e.className}})})},141:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o}));var s=n(1),i=n.n(s);let a;!function(e){e.NONE="",e.VIM="vim",e.EMACS="emacs"}(a||(a={}));const r={editorBinding:a.NONE},o=i.a.createContext(null)},142:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return r}));const s="CHANGE_DATE_ASSESSMENT",i="DELETE_ASSESSMENT",a="PUBLISH_ASSESSMENT",r="UPLOAD_ASSESSMENT"},143:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r}));const s="PERSISTENCE_OPEN_PICKER",i="PERSISTENCE_SAVE_FILE_AS",a="PERSISTENCE_SAVE_FILE",r="PERSISTENCE_INITIALISE"},144:function(e,t,n){"use strict";(function(e){n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return b}));var s=n(27),i=n(32),a=n(10);const r=20,o=e=>JSON.stringify(e,null,4),c=e=>e,l={taskDescription:{fileName:"Problem.md",isDefaultValue:e=>""===e,fromStringConverter:c,toStringConverter:c},starterCode:{fileName:"StarterCode.js",isDefaultValue:e=>""===e,fromStringConverter:c,toStringConverter:c},savedCode:{fileName:"SavedCode.js",isDefaultValue:e=>""===e,fromStringConverter:c,toStringConverter:c},testPrepend:{fileName:"TestPrepend.js",isDefaultValue:e=>""===e,fromStringConverter:c,toStringConverter:c},testPostpend:{fileName:"TestPostpend.js",isDefaultValue:e=>""===e,fromStringConverter:c,toStringConverter:c},testCases:{fileName:"TestCases.json",isDefaultValue:e=>0===e.length,fromStringConverter:JSON.parse,toStringConverter:e=>{const t=e.map((e=>({answer:e.answer,program:e.program,score:e.score?e.score:0,type:e.type?e.type:"public"})));return o(t)}}};async function d(e,t){const n=u(e.repoOwner,e.repoName,"README.md",t),i=u(e.repoOwner,e.repoName,".metadata",t),o=async function(e,t,n){const s=[];if(void 0===n)return s;const i=(await n.repos.getContent({owner:e,repo:t,path:""})).data;if(!Array.isArray(i))return s;const o=[];for(let c=1;c<=r;c++){const r="Q"+c;if(void 0===i.find((e=>e.name===r)))break;o.push(n.repos.getContent({owner:e,repo:t,path:r}).then((i=>{if(!Array.isArray(i.data))return;const a=i.data.map((e=>e.name)),o=Object.keys(l).filter((e=>a.includes(l[e].fileName))),d=o.map((async s=>{const i=l[s].fileName,a=await u(e,t,r+"/"+i,n);return l[s].fromStringConverter(a)}));return Promise.all(d).then((e=>{const t={questionNumber:c,taskDescription:"",starterCode:"",savedCode:"",testPrepend:"",testPostpend:"",testCases:[]};for(let n=0;n<e.length;n++)t[o[n]]=e[n];""===t.savedCode&&(t.savedCode=t.starterCode),s.push(t)}))})).catch((e=>{Object(a.e)("Error occurred while trying to retrieve file content",1e3),console.error(e)})))}return await Promise.all(o),s.sort(((e,t)=>e.questionNumber-t.questionNumber)),s}(e.repoOwner,e.repoName,t),[c,d,h]=await Promise.all([n,i,o]),p=function(e){try{return JSON.parse(e)}catch(t){return console.error(t),{sourceVersion:s.Chapter.CALC}}}(d);return{missionRepoData:e,missionBriefing:c,missionMetadata:p,tasksData:h}}async function u(t,n,s,i){let r="";if(void 0===i)return r;try{const a=await i.repos.getContent({owner:t,repo:n,path:s});r=e.from(a.data.content,"base64").toString()}catch(o){Object(a.e)("Error occurred while trying to retrieve file content",1e3),console.error(o)}return r}function h(e){return o(e)}function p(e,t,n,s,a,r,o){const c={},d=[];e!==t&&(c[".metadata"]=h(e)),n!==s&&(c["README.md"]=n);let u=0;for(;u<a.length;){const e=u+1,t="Q"+e;if(e>r.length){c[t+"/StarterCode.js"]=a[u].savedCode,c[t+"/Problem.md"]=a[u].taskDescription;const e=["testCases","testPrepend","testPostpend"];for(const n of e){const e=a[u][n];if(!l[n].isDefaultValue(e)){const e=t+"/"+l[n].fileName,s=l[n].toStringConverter(a[u][n]);c[e]=s}}}else{const e=Object.keys(l);for(const n of e){const e=a[u][n],s=r[u][n];if(!Object(i.isEqual)(e,s)){const e=t+"/"+l[n].fileName,s=l[n].toStringConverter(a[u][n]);c[e]=s}}if(o&&c[t+"/"+l.savedCode.fileName]){const e=c[t+"/"+l.savedCode.fileName];delete c[t+"/"+l.savedCode.fileName],c[t+"/"+l.starterCode.fileName]=e}}u++}for(;u<r.length;){const e=u+1;d.push("Q"+e),u++}return[c,d]}function g(e,t,n){const s={};s[".metadata"]=h(e),s["README.md"]=t;const i=["testCases","testPrepend","testPostpend"];for(let a=0;a<n.length;a++){const e="Q"+(a+1);s[e+"/"+l.starterCode.fileName]=n[a].savedCode,s[e+"/"+l.taskDescription.fileName]=n[a].taskDescription,i.forEach((t=>{const i=n[a][t];if(!l[t].isDefaultValue(i)){const i=e+"/"+l[t].fileName,r=l[t].toStringConverter(n[a][t]);s[i]=r}}))}return s}function m(e){let t=!1;const n={answer:0,choices:[],solution:-1,type:"mcq",content:"",grade:0,id:0,library:{chapter:s.Chapter.CALC,external:{name:"NONE",symbols:[]},globals:[]},maxGrade:0,xp:0,maxXp:0},i=e.trim();if("mcq"===i.substring(0,3).toLowerCase()&&(t=!0),t){const e=i.substring(3,i.length);try{const t=JSON.parse(e),s=t.answer,i=t.choices.map((e=>({content:e.option,hint:e.hint}))),a=t.solution;n.answer=s,n.choices=i,n.solution=a}catch(a){t=!1}}return[t,n]}function b(e){const t=e.answer,n=e.choices.map((e=>({option:e.content,hint:e.hint}))),s=e.solution;return"MCQ\n"+o({choices:n,answer:t,solution:s})}}).call(this,n(72).Buffer)},148:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i}));const s="FETCH_GROUP_GRADING_SUMMARY",i="UPDATE_GROUP_GRADING_SUMMARY"},15:function(e,t,n){"use strict";n.d(t,"j",(function(){return s})),n.d(t,"q",(function(){return i})),n.d(t,"k",(function(){return a})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"i",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"o",(function(){return d})),n.d(t,"p",(function(){return u})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return p})),n.d(t,"r",(function(){return g})),n.d(t,"u",(function(){return m})),n.d(t,"s",(function(){return b})),n.d(t,"t",(function(){return f})),n.d(t,"G",(function(){return v})),n.d(t,"H",(function(){return y})),n.d(t,"A",(function(){return j})),n.d(t,"B",(function(){return x})),n.d(t,"z",(function(){return O})),n.d(t,"y",(function(){return S})),n.d(t,"F",(function(){return w})),n.d(t,"D",(function(){return C})),n.d(t,"E",(function(){return E})),n.d(t,"C",(function(){return T})),n.d(t,"I",(function(){return k})),n.d(t,"J",(function(){return A})),n.d(t,"K",(function(){return _})),n.d(t,"L",(function(){return I})),n.d(t,"w",(function(){return N})),n.d(t,"v",(function(){return P})),n.d(t,"x",(function(){return R})),n.d(t,"M",(function(){return M})),n.d(t,"Q",(function(){return L})),n.d(t,"X",(function(){return D})),n.d(t,"N",(function(){return B})),n.d(t,"O",(function(){return U})),n.d(t,"U",(function(){return G})),n.d(t,"T",(function(){return F})),n.d(t,"n",(function(){return H})),n.d(t,"a",(function(){return V})),n.d(t,"W",(function(){return W})),n.d(t,"V",(function(){return $})),n.d(t,"R",(function(){return X})),n.d(t,"h",(function(){return q})),n.d(t,"P",(function(){return z})),n.d(t,"b",(function(){return Y})),n.d(t,"d",(function(){return K})),n.d(t,"Y",(function(){return Q})),n.d(t,"S",(function(){return J})),n.d(t,"c",(function(){return Z}));const s="FETCH_AUTH",i="FETCH_USER_AND_COURSE",a="FETCH_COURSE_CONFIG",r="FETCH_ASSESSMENT",o="FETCH_ASSESSMENT_ADMIN",c="FETCH_ASSESSMENT_OVERVIEWS",l="FETCH_ALL_USER_XP",d="FETCH_TOTAL_XP",u="FETCH_TOTAL_XP_ADMIN",h="FETCH_GRADING",p="FETCH_GRADING_OVERVIEWS",g="LOGIN",m="LOGOUT_GOOGLE",b="LOGIN_GITHUB",f="LOGOUT_GITHUB",v="SET_TOKENS",y="SET_USER",j="SET_COURSE_CONFIGURATION",x="SET_COURSE_REGISTRATION",O="SET_ASSESSMENT_CONFIGURATIONS",S="SET_ADMIN_PANEL_COURSE_REGISTRATIONS",w="SET_GOOGLE_USER",C="SET_GITHUB_ASSESSMENT",E="SET_GITHUB_OCTOKIT_OBJECT",T="SET_GITHUB_ACCESS_TOKEN",k="SUBMIT_ANSWER",A="SUBMIT_ASSESSMENT",_="SUBMIT_GRADING",I="SUBMIT_GRADING_AND_CONTINUE",N="REAUTOGRADE_SUBMISSION",P="REAUTOGRADE_ANSWER",R="REMOVE_GITHUB_OCTOKIT_OBJECT_AND_ACCESS_TOKEN",M="UNSUBMIT_SUBMISSION",L="UPDATE_ASSESSMENT_OVERVIEWS",D="UPDATE_TOTAL_XP",B="UPDATE_ALL_USER_XP",U="UPDATE_ASSESSMENT",G="UPDATE_GRADING_OVERVIEWS",F="UPDATE_GRADING",H="FETCH_NOTIFICATIONS",V="ACKNOWLEDGE_NOTIFICATIONS",W="UPDATE_NOTIFICATIONS",$="UPDATE_LATEST_VIEWED_COURSE",X="UPDATE_COURSE_CONFIG",q="FETCH_ASSESSMENT_CONFIGS",z="UPDATE_ASSESSMENT_CONFIGS",Y="DELETE_ASSESSMENT_CONFIG",K="FETCH_ADMIN_PANEL_COURSE_REGISTRATIONS",Q="UPDATE_USER_ROLE",J="UPDATE_COURSE_RESEARCH_AGREEMENT",Z="DELETE_USER_COURSE_REGISTRATION"},151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Statement=void 0;class s{static parse(e,t,n,i,a){let r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=t.tell()[0],c=s.parseStatement(e,t,n,i,a,r);return c.forEach((e=>e.row=o)),c}static parseStatement(e,t,n,s,p){let g=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return t.matchKeyword("if")?i.ConditionalStatement.parse(e,t,n,s,p):t.matchKeyword("do")?r.DoWhile.parse(e,t,n,s,p):t.matchKeyword("while")?h.While.parse(e,t,n,s,p):t.matchKeyword("for")?c.For.parse(e,t,n,s,p):t.matchKeyword("switch")?u.Switch.parse(e,t,n,s,p):t.matchKeyword("return")?l.Return.parse(e,t,n,s,p):t.matchKeyword("continue")?d.Continue.parse(e,t,n,s,p):t.matchKeyword("break")?d.Break.parse(e,t,n,s,p):t.matchDataType()?a.Declaration.parse(e,t,n,s,p,g):o.ExpressionStatement.parse(e,t)}execute(e,t){t.currentLine=this.row,this.doExecute(e,t)}}t.Statement=s;const i=n(570),a=n(282),r=n(571),o=n(371),c=n(572),l=n(281),d=n(175),u=n(573),h=n(574)},153:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(116),i=(n(1),n(12)),a=n(0);const r=e=>e.questionProgress[0]<=1?null:Object(a.jsx)(i.a,{label:"Previous",icon:s.a.ARROW_LEFT,onClick:e.onClick})},154:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(1);var s=n(12),i=n(0);const a=e=>{let{questionProgress:t}=e;return Object(i.jsx)(s.a,{label:`Question ${t[0]} of ${t[1]}  `,isDisabled:!0})}},155:function(e,t,n){"use strict";var s=n(32),i=n(267),a=n(25),r=n(10),o=n(73);class c{constructor(e){this.achievement=void 0,this.displayDeadline=void 0,this.xp=void 0,this.progressFrac=void 0,this.status=void 0,this.children=void 0,this.descendant=void 0,this.parents=void 0;const{deadline:t,prerequisiteUuids:n}=e;this.achievement=e,this.displayDeadline=t,this.xp=0,this.progressFrac=0,this.status=a.b.ACTIVE,this.children=new Set(n),this.descendant=new Set(n),this.parents=new Set}}t.a=class{constructor(e,t){this.nodeList=new Map,this.goalList=new Map,this.textToUuid=new Map,this.titleToUuid=new Map,this.achievementsToDelete=[],this.goalsToDelete=[],this.invalidGoal={uuid:"invalid",text:"invalid",achievementUuids:[],meta:{type:a.l.MANUAL,targetCount:0},count:0,targetCount:0,completed:!1},this.invalidAchievement={uuid:"invalid",title:"invalid",xp:0,isVariableXp:!1,deadline:void 0,release:void 0,isTask:!1,position:0,prerequisiteUuids:[],goalUuids:[],cardBackground:"invalid",view:{coverImage:"invalid",description:"invalid",completionText:"invalid"}},this.nodeList=this.constructNodeList(e),this.goalList=this.constructGoalList(t),this.processNodes(),this.processGoals()}getAllAchievements(){return[...this.nodeList.values()].map((e=>e.achievement))}getAllReleasedAchievements(){return[...this.nodeList.values()].filter((e=>e.status!==a.b.UNRELEASED)).map((e=>e.achievement))}getAllCompletedAchievements(){return[...this.nodeList.values()].filter((e=>e.status===a.b.COMPLETED)).map((e=>e.achievement))}getAllAchievementUuids(){return[...this.nodeList.keys()]}getAllGoals(){return[...this.goalList.values()]}getAllGoalUuids(){return[...this.goalList.keys()]}hasAchievement(e){return this.nodeList.has(e)}isPrerequisite(e){const t=this.nodeList.get(e);return!!t&&t.parents.size>0}getAchievement(e){const t=this.nodeList.get(e);return t?t.achievement:this.invalidAchievement}hasGoal(e){return this.goalList.has(e)}getGoal(e){return this.goalList.get(e)||this.invalidGoal}getGoalDefinition(e){return this.getGoal(e)}getGoalProgress(e){return this.getGoal(e)}getAchievementPositionByUuid(e){return this.getAchievement(e).position}getAchievementsToDelete(){return this.achievementsToDelete}getGoalsToDelete(){return this.goalsToDelete}resetToDelete(){this.achievementsToDelete=[],this.goalsToDelete=[]}getAchievementsByGoal(e){return this.getGoal(e).achievementUuids}listSortedAchievementUuids(){return this.getAllAchievements().sort(((e,t)=>e.position-t.position)).map((e=>e.uuid))}isInvalidGoal(e){return e===this.invalidGoal}isInvalidAchievement(e){return e===this.invalidAchievement}insertAchievement(e){let t=Object(i.a)();for(;this.nodeList.has(t);)t=Object(i.a)();return e.uuid=t,this.nodeList.set(t,new c(e)),this.processNodes(),this.normalizePositions(e.uuid,e.position),t}insertFakeAchievement(e){return this.nodeList.set(e.uuid,new c(e)),this.processNodes(),this.normalizePositions(e.uuid,e.position),e.uuid}insertGoalDefinition(e){let t=Object(i.a)();for(;this.goalList.has(t);)t=Object(i.a)();return e.uuid=t,this.goalList.set(t,{...e,...a.v}),this.processGoals(),t}insertFakeGoalDefinition(e,t){return t?this.goalList.set(e.uuid,{...e,count:1,targetCount:1,completed:!0}):this.goalList.set(e.uuid,{...e,count:0,targetCount:1,completed:!1}),this.processGoals(),e.uuid}modifyAchievement(e){this.nodeList.set(e.uuid,new c(e)),this.processNodes(),this.normalizePositions(e.uuid,e.position)}modifyGoalDefinition(e){this.goalList.set(e.uuid,{...e,...a.v}),this.processNodes(),this.processGoals()}modifyGoalProgress(e){const t=this.getGoal(e.uuid);if(this.isInvalidGoal(t))return;this.goalList.set(e.uuid,{...t,...e});const n=t.achievementUuids;for(const s in n){const e=this.nodeList.get(s);e&&(this.generateXp(e),this.generateProgressFrac(e),this.generateStatus(e))}}removeAchievement(e){this.nodeList.delete(e),this.nodeList.forEach(((t,n)=>{(t=>t.children.has(e))(t)&&this.nodeList.set(n,(t=>{const n=t.achievement.prerequisiteUuids.filter((t=>t!==e));return t.achievement.prerequisiteUuids=n,new c(t.achievement)})(t))})),this.achievementsToDelete.push(e),this.processNodes(),this.normalizePositions()}removeGoalDefinition(e){const t=t=>{const n=(t=>t.achievement.goalUuids.findIndex((t=>t===e)))(t);-1!==n&&t.achievement.goalUuids.splice(n,1)};this.goalList.delete(e),this.nodeList.forEach((e=>t(e))),this.goalsToDelete.push(e),this.processNodes(),this.processGoals()}listTaskUuids(){return this.getAllAchievements().filter((e=>e.isTask||this.isCompleted(e))).map((e=>e.uuid))}listSortedTaskUuids(){return this.getAllAchievements().filter((e=>e.isTask||this.isCompleted(e))).sort(((e,t)=>e.position-t.position)).map((e=>e.uuid))}listSortedReleasedTaskUuids(){return this.getAllReleasedAchievements().filter((e=>e.isTask||this.isCompleted(e))).sort(((e,t)=>e.position-t.position)).map((e=>e.uuid))}listAllSortedAchievementUuids(){return this.getAllAchievements().sort(((e,t)=>e.position-t.position)).map((e=>e.uuid))}isCompleted(e){const t=e.goalUuids.length,n=e.prerequisiteUuids.length;if(0===t&&0===n)return!1;for(let s=0;s<t;s++)if(!this.getGoal(e.goalUuids[s]).completed)return!1;for(let s=0;s<n;s++)if(!this.isCompleted(this.getAchievement(e.prerequisiteUuids[s])))return!1;return!0}listGoals(e){const{goalUuids:t}=this.getAchievement(e);return t.map((e=>this.getGoal(e)))}listPrerequisiteGoals(e){const t=[];for(const n of this.getImmediateChildren(e)){const{goalUuids:e}=this.getAchievement(n);e.forEach((e=>t.push(e)))}return t.map((e=>this.getGoal(e)))}getUuidByText(e){return this.textToUuid.get(e)}getTextByUuid(e){return this.getGoal(e).text}getUuidByTitle(e){return this.titleToUuid.get(e)}getTitleByUuid(e){return this.getAchievement(e).title}getAchievementXp(e){const t=this.getAchievement(e);return t.isVariableXp?this.listGoals(t.uuid).reduce(((e,t)=>e+t.count),0):t.xp}getTotalXp(){return this.getAllCompletedAchievements().reduce(((e,t)=>e+this.getAchievementXp(t.uuid)),0)}getProgressFrac(e){return this.nodeList.has(e)?this.nodeList.get(e).progressFrac:0}getStatus(e){return this.nodeList.has(e)?this.nodeList.get(e).status:a.b.ACTIVE}getDisplayDeadline(e){return this.nodeList.has(e)?this.nodeList.get(e).displayDeadline:void 0}isImmediateChild(e,t){return!!this.nodeList.has(e)&&this.nodeList.get(e).children.has(t)}getImmediateChildren(e){return this.nodeList.has(e)?this.nodeList.get(e).children:new Set}isDescendant(e,t){return!!this.nodeList.has(e)&&this.nodeList.get(e).descendant.has(t)}getDescendants(e){return this.nodeList.has(e)?this.nodeList.get(e).descendant:new Set}getDescendantXp(e){let t=this.getAchievementXp(e);return this.getDescendants(e).forEach((e=>{this.isCompleted(this.getAchievement(e))&&(t+=this.getAchievementXp(e))})),t}listAvailablePrerequisiteUuids(e){return this.getAllAchievementUuids().filter((t=>t!==e&&!this.isDescendant(e,t)&&!this.isDescendant(t,e)))}processNodes(){this.titleToUuid=new Map,this.nodeList.forEach((e=>{const{title:t,uuid:n}=e.achievement;this.titleToUuid.set(t,n),e.achievement.prerequisiteUuids=Object(s.uniq)(e.achievement.prerequisiteUuids),e.achievement.goalUuids=Object(s.uniq)(e.achievement.goalUuids),this.generateParentReference(e),this.generateDescendant(e),this.generateDisplayDeadline(e),this.generateXp(e),this.generateProgressFrac(e),this.generateStatus(e)}))}processGoals(){this.textToUuid=new Map,this.goalList.forEach((e=>{const{text:t,uuid:n}=e;this.textToUuid.set(t,n),e.achievementUuids=Object(s.uniq)(e.achievementUuids)}))}constructNodeList(e){const t=new Map;return e.forEach((e=>t.set(e.uuid,new c(Object(s.cloneDeep)(e))))),t}constructGoalList(e){const t=new Map;return e.forEach((e=>t.set(e.uuid,Object(s.cloneDeep)(e)))),t}generateParentReference(e){for(const n of e.children){var t;null===(t=this.nodeList.get(n))||void 0===t||t.parents.add(e.achievement.uuid)}}generateDescendant(e){for(const t of e.descendant){if(t===e.achievement.uuid){const{title:t}=e.achievement;Object(r.b)(`Circular dependency detected in achievement ${t}`,3e4)}for(const n of this.getDescendants(t))e.descendant.add(n)}}generateDisplayDeadline(e){const t=[];for(const n of e.descendant){const e=this.getAchievement(n).deadline;t.push(e)}e.displayDeadline=t.reduce(((e,t)=>void 0===t||Object(o.a)(t)?e:void 0===e||Object(o.a)(e)||t<e?t:e),e.displayDeadline)}generateXp(e){const{goalUuids:t,isVariableXp:n}=e.achievement,s=t.reduce(((e,t)=>e&&this.getGoal(t).completed),!0);e.xp=s?n?t.reduce(((e,t)=>e+this.getGoal(t).count),0):e.achievement.xp:0}generateProgressFrac(e){const{goalUuids:t}=e.achievement;if(0===t.length)e.progressFrac=0;else{const n=t.reduce(((e,t)=>e+this.getGoal(t).count),0),s=t.reduce(((e,t)=>e+this.getGoal(t).targetCount),0);e.progressFrac=Math.min(0===s?0:n/s,1)}}generateStatus(e){const t=this.isCompleted(e.achievement),n=Object(o.b)(e.achievement.release),s=!Object(o.a)(e.displayDeadline);e.status=t?a.b.COMPLETED:n?s?a.b.ACTIVE:a.b.EXPIRED:a.b.UNRELEASED}normalizePositions(e,t){let n=1;if(this.getAllAchievements().filter((e=>e.isTask)).filter((e=>e.position>=0)).sort(((e,t)=>e.position-t.position)).forEach((e=>e.position=n++)),this.getAllAchievements().filter((e=>!e.isTask)).forEach((e=>e.position=0)),e&&t&&0!==t){const n=this.getAchievement(e),s=n.position;if(s!==t){const e=this.getAllAchievements().find((e=>e.position===t));e&&(e.position=s,n.position=t)}}}}},156:function(e,t,n){"use strict";var s=n(1171),i=n(116),a=n(1),r=n.n(a),o=n(187),c=n(24),l=n(250),d=n(94),u=n(251),h=n(23),p=n(252),g=n.n(p),m=n(262),b=n(0);var f=e=>Object(b.jsx)(g.a,{axis:"y",handle:"#dragHandle",position:e.position,bounds:{top:-500,left:0,right:0,bottom:0},onDrag:e.onDrag,disabled:e.disabled,children:Object(b.jsxs)("div",{className:"mobile-draggable",children:[e.disabled?Object(b.jsx)("div",{className:"handle disabled",id:"draghandle",children:["1","2","3"].map((e=>Object(b.jsx)("div",{className:"circle"},e)))}):Object(b.jsx)("div",{className:"handle enabled",id:"dragHandle",children:["1","2","3"].map((e=>Object(b.jsx)("div",{className:"circle"},e)))}),Object(b.jsx)("div",{className:"REPL-content",children:Object(b.jsx)(m.a,{...e.replProps})})]})}),v=n(442),y=n.n(v);var j=e=>{const[t,n]=r.a.useState(!1),[s,i]=r.a.useState("\u1438"),[a,o]=r.a.useState({x:0,y:0}),[c,l]=r.a.useState(1),d=e=>{e.preventDefault()},u={onKeyPress:t=>{if(!e.targetKeyboardInput)return;const n=e.targetKeyboardInput;"{arrowleft}"===t?n.navigateLeft():"{arrowright}"===t?n.navigateRight():"{bksp}"===t?n.remove("left"):"{tab}"===t?n.insert("\t"):["+","-","*","/","%","=>","===","&&","||"].includes(t)?n.insert(" "+t+" "):n.insert(t)},baseClass:"simple-keyboard-shortcut",layout:{default:["{ } ( ) \" ' _ => ;","{tab} && || ! < > = ===","+ - * / % // {arrowleft} {arrowright}"]},buttonTheme:[{class:"mobile-navigation",buttons:"{arrowleft} {arrowright}"},{class:"big-buttons",buttons:"=== &&"}],theme:"hg-theme-default",preventMouseDownDefault:!0,disableCaretPositioning:!1};return Object(b.jsx)(g.a,{axis:"y",handle:"#floating-dragHandle",position:a,bounds:{top:-200,left:0,right:0,bottom:200},onDrag:(e,t)=>{o(t)},children:Object(b.jsxs)("div",{className:"mobile-floating-keyboard",id:"mobile-floating-toggle",children:[Object(b.jsx)("button",{className:"mobile-floating-toggle",onClick:e=>{t?(document.getElementById("mobile-keyboard-toggle").style.setProperty("display","none"),document.getElementById("mobile-floating-toggle").style.setProperty("width","42px"),document.getElementById("mobile-floating-toggle").style.setProperty("opacity","0.6"),i("\u1438"),n(!1)):(document.getElementById("mobile-keyboard-toggle").style.setProperty("display","flex"),document.getElementById("mobile-floating-toggle").style.setProperty("width","99%"),document.getElementById("mobile-floating-toggle").style.setProperty("opacity","1"),i("\u1433"),n(!0))},onMouseDown:d,children:s}),Object(b.jsxs)("div",{className:"mobile-keyboard-toggle-container",id:"mobile-keyboard-toggle",children:[Object(b.jsx)("div",{className:"mobile-keyboard-container",children:Object(b.jsx)(y.a,{...u})}),Object(b.jsx)("button",{className:"mobile-keyboard-row-toggle",onClick:e=>{l((c+1)%3);const t=document.getElementsByClassName("simple-keyboard-shortcut");Array.from(t)[0].style.top=45*-c+"px"},onMouseDown:d,children:"\u2938"})]}),Object(b.jsx)("div",{id:"floating-dragHandle",children:":"})]})})},x=n(41),O=n(3),S=n(265),w=n(19),C=n.n(w),E=n(171),T=n(253),k=n(329);var A=e=>{const t=Object(b.jsxs)("div",{className:"mobile-control-bar",children:[e.editorButtons,e.flowButtons,e.editingWorkspaceButtons]});return Object(b.jsx)(k.a,{content:t,autoFocus:!1,children:Object(b.jsx)(x.b,{icon:i.a.COG,className:C()(O.a.MINIMAL,"mobile-control-bar-button")})})};var _=r.a.memo((e=>{let{selectedTabId:t,renderActiveTabPanelOnly:n,mobileControlBarProps:s,...i}=e;const a=/iPhone|iPod/.test(navigator.platform),r=e=>e.map((e=>((e,n)=>{if(!e.body)return;const s=n?{...e.body,props:{...e.body.props,workspaceLocation:n}}:e.body;return Object(b.jsx)("div",{className:e.id===t?"mobile-selected-panel":"mobile-unselected-panel",children:s},e.id)})(e,i.workspaceLocation)));return Object(b.jsx)(E.a,{...i,renderFunction:(e,o)=>Object(b.jsxs)(b.Fragment,{children:[r(e),Object(b.jsx)("div",{className:"mobile-tabs-container",children:Object(b.jsxs)(x.V,{id:"mobile-side-content",onChange:o,renderActiveTabPanelOnly:n,selectedTabId:t,className:C()(O.a.DARK,"mobile-side-content"),children:[e.map((e=>((e,t,n)=>{const s=void 0===e.id?e.label:e.id,i=Object(b.jsx)(S.a,{content:e.label,onOpening:()=>{var e;t&&(null===(e=document.getElementById(Object(E.b)(s)))||void 0===e||e.click())},children:Object(b.jsx)("div",{className:"side-content-tooltip",id:Object(E.b)(s),children:Object(b.jsx)(x.w,{icon:e.iconName,iconSize:20})})});return Object(b.jsx)(x.U,{id:s,title:i,disabled:e.disabled,className:"side-content-tab"},s)})(e,a,i.workspaceLocation))),("playground"===i.workspaceLocation||"sicp"===i.workspaceLocation)&&Object(b.jsx)(A,{...s})]})})]})})}),T.a);t.a=e=>{const t=/Android/.test(navigator.userAgent),n=Object(o.useMediaQuery)({orientation:"portrait"}),[a,p]=r.a.useState({x:0,y:0}),[g,m]=r.a.useState(!1);s.a.onlyShowFocusOnTabs(),r.a.useEffect((()=>("assessment"===e.mobileSideContentProps.workspaceLocation&&document.documentElement.style.setProperty("--mobile-panel-height","calc(100% - 100px - 1.1rem)"),()=>{document.documentElement.style.setProperty("--mobile-panel-height","calc(100% - 70px)")})),[]),r.a.useEffect((()=>{if(n&&t){document.documentElement.style.setProperty("overflow","auto");document.querySelector("meta[name=viewport]").setAttribute("content","height="+window.innerHeight+", width=device-width")}return()=>{if(t){document.documentElement.style.setProperty("overflow","hidden");document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")}w()}}),[n,t]);const[v,y]=r.a.useState(null),x=()=>y(null),O=e=>({...e,onFocus:(t,n)=>{e.onFocus&&e.onFocus(t,n),n&&y(n)},onBlur:(t,n)=>{e.onBlur&&e.onBlur(t,n),x()}}),S=e=>{document.documentElement.style.setProperty("--mobile-repl-height",Math.max(-e,0)+"px"),p({x:0,y:e})},w=()=>{p({x:0,y:0}),document.documentElement.style.setProperty("--mobile-repl-height","0px")},C=e.sideBarProps.tabs.filter((e=>void 0!==e.id)),E=r.a.useMemo((()=>({label:"Editor",iconName:i.a.EDIT,body:null,id:h.b.mobileEditor})),[]),T=r.a.useMemo((()=>({label:"Run",iconName:i.a.PLAY,body:null,id:h.b.mobileEditorRun})),[]),k="assessment"===e.mobileSideContentProps.workspaceLocation||"githubAssessment"===e.mobileSideContentProps.workspaceLocation;return Object(b.jsxs)("div",{className:"workspace mobile-workspace",children:[e.hasUnsavedChanges?Object(b.jsx)(c.a,{message:"You have changes that may not be saved. Are you sure you want to leave?"}):null,k&&Object(b.jsx)(l.a,{...e.mobileSideContentProps.mobileControlBarProps}),Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"mobile-editor-panel",children:(()=>{if(e.editorContainerProps){const t={...e.editorContainerProps};return"sourcecast"===t.editorVariant&&(t.setDraggableReplPosition=()=>S(-100)),Object(b.jsx)(d.b,{...O(e.editorContainerProps)})}return Object(b.jsx)(u.a,{...e.mcqProps})})()}),Object(b.jsx)(_,{...{...e.mobileSideContentProps,onChange:(t,n,s)=>{e.mobileSideContentProps.onChange(t,n,s),((t,n)=>{var s;t===h.b.mobileEditorRun&&(null===(s=e.editorContainerProps)||void 0===s||s.handleEditorEval()),t===h.b.mobileEditorRun&&n!==h.b.substVisualizer&&n!==h.b.autograder&&n!==h.b.testcases?S(-300):w(),t===h.b.files||t===h.b.substVisualizer||n===h.b.substVisualizer&&t===h.b.mobileEditorRun?m(!0):m(!1)})(t,n)},tabs:{beforeDynamicTabs:[...C,E,...e.mobileSideContentProps.tabs.beforeDynamicTabs],afterDynamicTabs:[...e.mobileSideContentProps.tabs.afterDynamicTabs,T]}}})]}),Object(b.jsx)(f,{position:a,onDrag:(e,t)=>{document.documentElement.style.setProperty("--mobile-repl-height",Math.max(-t.y,0)+"px"),p(t)},disabled:g,replProps:(e=>({...e,onFocus:t=>{e.onFocus&&e.onFocus(t),y(t)},onBlur:()=>{e.onBlur&&e.onBlur(),x()}}))(e.replProps)},"repl"),Object(b.jsx)(j,{targetKeyboardInput:v})]})}},157:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n(116),i=(n(1),n(12)),a=n(0);const r=e=>{let{onClick:t}=e;return Object(a.jsx)(i.a,{label:"Return to Academy",icon:s.a.ARROW_RIGHT,onClick:t,options:{iconOnRight:!0}})},o=e=>e.questionProgress[0]===e.questionProgress[1]?Object(a.jsx)(r,{onClick:e.onClickReturn},"return_to_academy"):Object(a.jsx)(i.a,{label:"Next",icon:s.a.ARROW_RIGHT,onClick:e.onClickNext,options:{iconOnRight:!0}})},158:function(e,t,n){"use strict";n.d(t,"a",(function(){return Ne}));var s=n(41),i=n(1),a=n.n(i),r=n(14);class o{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._isDrawn=!1,this.ref=a.a.createRef()}x(){return this._x}y(){return this._y}width(){return this._width}height(){return this._height}isDrawn(){return this._isDrawn}reset(){this._isDrawn=!1}}let c;!function(e){e[e.CanvasMinHeight=300]="CanvasMinHeight",e[e.CanvasMinWidth=300]="CanvasMinWidth",e[e.CanvasPaddingX=30]="CanvasPaddingX",e[e.CanvasPaddingY=30]="CanvasPaddingY",e[e.LevelPaddingX=10]="LevelPaddingX",e[e.LevelPaddingY=10]="LevelPaddingY",e[e.FrameMinWidth=100]="FrameMinWidth",e[e.FramePaddingX=20]="FramePaddingX",e[e.FramePaddingY=30]="FramePaddingY",e[e.FrameMarginX=30]="FrameMarginX",e[e.FrameMarginY=10]="FrameMarginY",e[e.FrameCornerRadius=3]="FrameCornerRadius",e[e.FnRadius=15]="FnRadius",e[e.FnInnerRadius=3]="FnInnerRadius",e[e.FnTooltipOpacity=.3]="FnTooltipOpacity",e[e.DataMinWidth=20]="DataMinWidth",e[e.DataUnitWidth=40]="DataUnitWidth",e[e.DataUnitHeight=40]="DataUnitHeight",e[e.DataCornerRadius=3]="DataCornerRadius",e[e.DataHitStrokeWidth=5]="DataHitStrokeWidth",e[e.TextPaddingX=10]="TextPaddingX",e[e.TextPaddingY=30]="TextPaddingY",e[e.TextMargin=5]="TextMargin",e[e.TextMinWidth=30]="TextMinWidth",e.FontFamily="monospace, monospace",e[e.FontSize=15]="FontSize",e.FontStyle="normal",e.FontVariant="normal",e.HoveredColor="#32CD32",e[e.ArrowHeadSize=10]="ArrowHeadSize",e[e.ArrowStrokeWidth=1]="ArrowStrokeWidth",e[e.ArrowHitStrokeWidth=5]="ArrowHitStrokeWidth",e[e.ArrowHoveredStrokeWidth=2]="ArrowHoveredStrokeWidth",e[e.ArrowCornerRadius=40]="ArrowCornerRadius",e.SA_WHITE="#999999",e.SA_BLUE="#2c3e50",e.PRINT_BACKGROUND="white",e.ConstantColon=":= ",e.VariableColon=": ",e.Ellipsis="\u2026",e.UnassignedData="",e.GlobalFrameDefaultText=":::pre-declared names::",e.GlobalEnvId="-1"}(c||(c={}));const l={preventDefault:!1};var d=n(140),u=n(32);let h;!function(e){e[e.CanvasMinHeight=300]="CanvasMinHeight",e[e.CanvasMinWidth=300]="CanvasMinWidth",e[e.CanvasPaddingX=30]="CanvasPaddingX",e[e.CanvasPaddingY=30]="CanvasPaddingY",e[e.LevelPaddingX=10]="LevelPaddingX",e[e.LevelPaddingY=10]="LevelPaddingY",e[e.FrameMinWidth=100]="FrameMinWidth",e[e.FramePaddingX=20]="FramePaddingX",e[e.FramePaddingY=30]="FramePaddingY",e[e.FrameMarginX=60]="FrameMarginX",e[e.FrameMarginY=100]="FrameMarginY",e[e.FrameCornerRadius=3]="FrameCornerRadius",e[e.FnRadius=15]="FnRadius",e[e.FnInnerRadius=3]="FnInnerRadius",e[e.FnTooltipOpacity=.6]="FnTooltipOpacity",e[e.DataMinWidth=20]="DataMinWidth",e[e.DataUnitWidth=40]="DataUnitWidth",e[e.DataUnitPaddingY=40]="DataUnitPaddingY",e[e.DataUnitPaddingX=50]="DataUnitPaddingX",e[e.DataUnitHeight=40]="DataUnitHeight",e[e.DataCornerRadius=3]="DataCornerRadius",e[e.DataHitStrokeWidth=5]="DataHitStrokeWidth",e[e.DataGroupMaxDist=500]="DataGroupMaxDist",e[e.TextPaddingX=10]="TextPaddingX",e[e.TextPaddingY=20]="TextPaddingY",e[e.TextMargin=5]="TextMargin",e[e.TextMinWidth=30]="TextMinWidth",e.FontFamily="monospace, monospace",e[e.FontSize=15]="FontSize",e.FontStyle="normal",e.FontVariant="normal",e.HoveredColor="#32CD32",e[e.ArrowHeadSize=10]="ArrowHeadSize",e[e.ArrowStrokeWidth=1]="ArrowStrokeWidth",e[e.ArrowHitStrokeWidth=5]="ArrowHitStrokeWidth",e[e.ArrowHoveredStrokeWidth=2]="ArrowHoveredStrokeWidth",e[e.ArrowUnhoveredOpacity=.8]="ArrowUnhoveredOpacity",e[e.ArrowCornerRadius=10]="ArrowCornerRadius",e[e.ArrowMinHeight=100]="ArrowMinHeight",e[e.ArrowNumLanes=5]="ArrowNumLanes",e[e.ArrowLaneInterval=1]="ArrowLaneInterval",e[e.FrameArrowStrokeWidth=2]="FrameArrowStrokeWidth",e[e.FrameArrowHoveredStrokeWidth=2.5]="FrameArrowHoveredStrokeWidth",e[e.MaxExportWidth=2e4]="MaxExportWidth",e[e.MaxExportHeight=12e3]="MaxExportHeight",e.SA_WHITE="#999999",e.SA_BLUE="#2c3e50",e.PRINT_BACKGROUND="white",e.ConstantColon=":= ",e.VariableColon=": ",e.Ellipsis="\u2026",e.UnassignedData="",e.GlobalFrameDefaultText=":::pre-declared names::",e.GlobalEnvId="-1"}(h||(h={}));const p={preventDefault:!1};var g=n(0);const m={maxWidth:Number.MAX_VALUE,fontFamily:h.FontFamily.toString(),fontSize:Number(h.FontSize),fontStyle:h.FontStyle.toString(),fontVariant:h.FontVariant.toString(),isStringIdentifiable:!1};class b extends o{constructor(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0;super(),this.data=e,this._hoveredWidth=void 0,this.partialStr=void 0,this.fullStr=void 0,this.options=m,this.frame=void 0,this.updatePosition=(e,t)=>{this._x=e,this._y=t},this.onMouseEnter=e=>{var t;let{currentTarget:n}=e;Ne.getPrintableMode()||(se(n),this.ref.current.moveToTop(),this.ref.current.show(),null===(t=n.getLayer())||void 0===t||t.draw())},this.onMouseLeave=e=>{var t;let{currentTarget:n}=e;Ne.getPrintableMode()||(ie(n),this.ref.current.hide(),null===(t=n.getLayer())||void 0===t||t.draw())},this._x=t,this._y=n,this.frame=i,this.options={...this.options,...s};const{fontSize:a,fontStyle:r,fontFamily:o,maxWidth:c,isStringIdentifiable:l}=this.options;this.fullStr=this.partialStr=l&&JSON.stringify(e)||String(e),this._height=a;const d=e=>ee(e,`${r} ${a}px ${o}`);if(this._hoveredWidth=d(this.partialStr),this._hoveredWidth>c){let e=h.Ellipsis.toString(),t=0;for(;d(this.partialStr.substring(0,t)+h.Ellipsis.toString())<c;)e=this.partialStr.substring(0,t++)+h.Ellipsis.toString();this._width=d(e),this.partialStr=e}else this._width=Math.max(h.TextMinWidth,d(this.partialStr))}hoveredWidth(){return this._hoveredWidth}draw(){const e={fontFamily:this.options.fontFamily,fontSize:this.options.fontSize,fontStyle:this.options.fontStyle,fill:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString()};return Object(g.jsxs)(r.c,{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[Object(g.jsx)(r.d,{x:this.x(),y:this.y(),children:Object(i.createElement)(r.l,{...p,key:Ie.key++,text:this.partialStr,...e})}),Object(g.jsxs)(r.d,{x:this.x(),y:this.y(),ref:this.ref,visible:!1,listening:!1,children:[Object(g.jsx)(r.k,{...p,fill:Ne.getPrintableMode()?"white":"black",opacity:.5,listening:!1}),Object(i.createElement)(r.l,{...p,key:Ie.key++,text:this.fullStr,...e,listening:!1})]})]},Ie.key++)}}class f extends o{constructor(e){super(),this.points=[],this.source=void 0,this.target=void 0,this._path="",this.selected=!1,this.unhovered_opacity=h.ArrowUnhoveredOpacity,this.hovered_opacity=1,this.source=e,this._x=e.x(),this._y=e.y()}path(){return this._path}to(e){return this.target=e,this._width=Math.abs(e.x()-this.source.x()),this._height=Math.abs(e.y()-this.source.y()),this}isSelected(){return this.selected}calculateSteps(){const e=this.target;return e?[()=>[e.x(),e.y()]]:[]}getStrokeWidth(){return Number(h.ArrowStrokeWidth)}onMouseEnter(e){se(e.target),ae(e.currentTarget,{strokeWidth:Number(h.ArrowHoveredStrokeWidth)}),this.ref.current.opacity=this.unhovered_opacity}onClick(e){let{currentTarget:t}=e;var n;(this.selected=!this.selected,this.isSelected())||(this.source instanceof b&&null!==(n=this.source.frame)&&void 0!==n&&n.isSelected()||this.source instanceof I&&this.source.isSelected()?(ae(t,{strokeWidth:Number(h.ArrowHoveredStrokeWidth)*this.unhovered_opacity}),this.ref.current.opacity=this.hovered_opacity):(re(t,{strokeWidth:this.getStrokeWidth()}),this.ref.current.opacity=this.unhovered_opacity))}onMouseLeave(e){var t;(ie(e.target),this.isSelected())||(this.source instanceof b&&null!==(t=this.source.frame)&&void 0!==t&&t.isSelected()||this.source instanceof I&&this.source.isSelected()?(ae(e.currentTarget,{strokeWidth:Number(h.ArrowHoveredStrokeWidth)*this.unhovered_opacity}),this.ref.current.opacity=this.hovered_opacity):(re(e.currentTarget,{strokeWidth:this.getStrokeWidth()}),this.ref.current.opacity=this.unhovered_opacity))}draw(){const e=this.calculateSteps().reduce(((e,t)=>[...e,...t(e[e.length-2],e[e.length-1])]),[this.source.x(),this.source.y()]);e.splice(0,2);let t="";if(t+=`M ${e[0]} ${e[1]} `,4===e.length)t+=`L ${e[2]} ${e[3]} `;else{let n=0;for(;n<e.length-4;){const[s,i,a,r,o,c]=e.slice(n,n+6),l=(a-s)/2,d=(o-a)/2,u=(r-i)/2,p=(c-r)/2,g=Math.sqrt(Math.pow(l,2)+Math.pow(u,2))/2,m=Math.sqrt(Math.pow(d,2)+Math.pow(p,2))/2,b=Math.min(h.ArrowCornerRadius,g,m);t+=`L ${a-b*l/g} ${r-b*u/g} Q ${a} ${r} ${a+b*d/m} ${r+b*p/m} `,n+=2}}return t+=`L ${e[e.length-2]} ${e[e.length-1]} `,this._path=t,Object(g.jsxs)(r.c,{ref:this.ref,onMouseEnter:e=>this.onMouseEnter(e),onMouseLeave:e=>this.onMouseLeave(e),onClick:e=>this.onClick(e),opacity:this.unhovered_opacity,children:[Object(i.createElement)(r.g,{...p,stroke:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString(),strokeWidth:this.getStrokeWidth(),hitStrokeWidth:Number(h.ArrowHitStrokeWidth),data:t,key:Ie.key++}),Object(i.createElement)(r.a,{...p,points:e.slice(e.length-4),fill:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString(),strokeEnabled:!1,pointerWidth:Number(h.ArrowHeadSize),pointerLength:Number(h.ArrowHeadSize),key:Ie.key++})]},Ie.key++)}}class v extends f{calculateSteps(){const e=this.target;if(!e)return[];const t=[(e,t)=>[e+h.FramePaddingX,t]];return e instanceof I&&(t.push(((t,n)=>[t,L.getHorizontalLaneAfterSource(e,n).getPosition(e)])),t.push(((t,n)=>[e.x()+h.FramePaddingX,n]))),t.push(((t,n)=>[e.x()+h.FramePaddingX,e.y()+e.height()])),t}getStrokeWidth(){return Number(h.FrameArrowStrokeWidth)}onClick(e){super.onClick(e),ae(e.currentTarget,{strokeWidth:Number(h.FrameArrowHoveredStrokeWidth)})}onMouseEnter(e){super.onMouseEnter(e),ae(e.currentTarget,{strokeWidth:Number(h.FrameArrowHoveredStrokeWidth)})}onMouseLeave(e){super.onMouseLeave(e),this.isSelected()||this.source.isSelected()?ae(e.currentTarget,{strokeWidth:Number(h.FrameArrowStrokeWidth)}):re(e.currentTarget,{strokeWidth:Number(h.FrameArrowStrokeWidth)})}}class y extends o{constructor(e){super(),this.parent=e,this.value=null,this.data=[],this.ref=a.a.createRef(),this.updatePosition=()=>{this._x=this.parent.x(),this._y=this.parent.y()},this._x=this.parent.x(),this._y=this.parent.y(),this._height=this.parent.height(),this._width=this.parent.width()}draw(){return Object(i.createElement)(r.h,{...p,key:Ie.key++,x:this.x(),y:this.y(),width:this.width(),height:this.height(),stroke:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString(),ref:this.ref})}}class j extends f{calculateSteps(){const e=this.source,t=this.target;if(!t)return[];const n=[(e,t)=>[e+3*h.FnRadius,t]];return t.y()<e.y()&&e.y()<t.y()+t.height()?(n.push(((e,t)=>[e,t-2*h.FnRadius])),n.push(((n,s)=>[t.x()+(e.x()<t.x()?0:t.width()),s]))):(n.push(((e,t)=>[e,t-2*h.FnRadius])),n.push(((t,n)=>[L.getVerticalLaneBeforeTarget(e,t).getPosition(e),n])),n.push(((e,n)=>[e,L.getHorizontalLaneBeforeTarget(t,n).getPosition(t)])),n.push(((e,n)=>[t.x()+(t.x()<e?t.width():0),n])),n.push(((n,s)=>[n,t.y()+(t.y()<e.y()?t.height():0)]))),n}}class x extends o{constructor(){super(...arguments),this.referencedBy=void 0,this.data=void 0}addReference(e){this.referencedBy.push(e)}}class O extends x{constructor(e,t){super(),this.data=e,this.referencedBy=t,this.centerX=void 0,this.tooltipWidth=void 0,this.exportTooltipWidth=void 0,this.radius=h.FnRadius,this.innerRadius=h.FnInnerRadius,this.fnName=void 0,this.paramsText=void 0,this.bodyText=void 0,this.exportBodyText=void 0,this.tooltip=void 0,this.exportTooltip=void 0,this.selected=!1,this._arrow=void 0,this.enclosingEnvNode=void 0,this.ref=a.a.createRef(),this.labelRef=a.a.createRef(),this.onMouseEnter=e=>{let{currentTarget:t}=e;Ne.getPrintableMode()||(this.labelRef.current.moveToTop(),this.labelRef.current.show(),ae(t))},this.onMouseLeave=e=>{let{currentTarget:t}=e;if(!Ne.getPrintableMode())if(this.selected){var n;const e=null===(n=t.getStage())||void 0===n?void 0:n.container();e&&(e.style.cursor="default")}else this.labelRef.current.hide(),re(t)},this.onClick=e=>{let{currentTarget:t}=e;Ne.getPrintableMode()||(this.selected=!this.selected,this.selected?(this.labelRef.current.show(),ae(t)):(this.labelRef.current.hide(),re(t)))},Ie.memoizeValue(this);const n=this.referencedBy[0];n instanceof U?(this._x=n.frame.x()+n.frame.width()+h.FrameMarginX/4,this._y=n.y(),this.centerX=this._x+2*this.radius):(n.isLastUnit?(this._x=n.x()+2*h.DataUnitWidth,this._y=n.y()+h.DataUnitHeight/2-this.radius):(this._x=n.x(),this._y=n.y()+n.parent.height()+h.DataUnitHeight),this.centerX=this._x+h.DataUnitWidth/2,this._x=this.centerX-2*this.radius),this._y+=this.radius,this._width=4*this.radius,this._height=2*this.radius,this.enclosingEnvNode=Ie.environmentTree.getTreeNode(oe(this.data.environment)),this.fnName=this.data.functionName,this.paramsText=`params: (${te(this.data)})`,this.bodyText=`body: ${ne(this.data)}`,this.exportBodyText=(this.bodyText.length>23?this.bodyText.slice(0,20):this.bodyText).split("\n").slice(0,2).join("\n")+" ...",this.tooltip=`${this.paramsText}\n${this.bodyText}`,this.exportTooltip=`${this.paramsText}\n${this.exportBodyText}`,this.tooltipWidth=Math.max(ee(this.paramsText),ee(this.bodyText)),this.exportTooltipWidth=Math.max(ee(this.paramsText),ee(this.exportBodyText))}isSelected(){return this.selected}arrow(){return this._arrow}updatePosition(){const e=this.referencedBy.find((e=>e instanceof U&&e.frame.envTreeNode===this.enclosingEnvNode))||this.referencedBy[0];e instanceof U?(this._x=e.frame.x()+e.frame.width()+h.FrameMarginX/4,this._y=e.y(),this.centerX=this._x+2*this.radius):(e.isLastUnit?(this._x=e.x()+2*h.DataUnitWidth,this._y=e.y()+h.DataUnitHeight/2-this.radius):(this._x=e.x(),this._y=e.y()+e.parent.height()+h.DataUnitHeight),this.centerX=this._x+h.DataUnitWidth/2,this._x=this.centerX-2*this.radius),this._y+=this.radius}reset(){super.reset(),this.referencedBy.length=0}draw(){var e;return this._isDrawn=!0,this._arrow=this.enclosingEnvNode.frame&&new j(this).to(this.enclosingEnvNode.frame),Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsxs)(r.c,{onMouseEnter:e=>this.onMouseEnter(e),onMouseLeave:e=>this.onMouseLeave(e),onClick:e=>this.onClick(e),ref:this.ref,children:[Object(i.createElement)(r.b,{...p,key:Ie.key++,x:this.centerX-this.radius,y:this.y(),radius:this.radius,stroke:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString()}),Object(i.createElement)(r.b,{...p,key:Ie.key++,x:this.centerX-this.radius,y:this.y(),radius:this.innerRadius,fill:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString()}),Object(i.createElement)(r.b,{...p,key:Ie.key++,x:this.centerX+this.radius,y:this.y(),radius:this.radius,stroke:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString()}),Object(i.createElement)(r.b,{...p,key:Ie.key++,x:this.centerX+this.radius,y:this.y(),radius:this.innerRadius,fill:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString()})]}),Ne.getPrintableMode()?Object(g.jsxs)(r.d,{x:this.x()+this.width()+2*h.TextPaddingX,y:this.y()-h.TextPaddingY,visible:!0,ref:this.labelRef,children:[Object(g.jsx)(r.k,{stroke:"black",fill:"white",opacity:Number(h.FnTooltipOpacity)}),Object(g.jsx)(r.l,{text:this.exportTooltip,fontFamily:h.FontFamily.toString(),fontSize:Number(h.FontSize),fontStyle:h.FontStyle.toString(),fill:h.SA_BLUE.toString(),padding:5})]}):Object(g.jsxs)(r.d,{x:this.x()+this.width()+2*h.TextPaddingX,y:this.y()-h.TextPaddingY,visible:!1,ref:this.labelRef,children:[Object(g.jsx)(r.k,{stroke:"black",fill:"black",opacity:Number(h.FnTooltipOpacity)}),Object(g.jsx)(r.l,{text:this.tooltip,fontFamily:h.FontFamily.toString(),fontSize:Number(h.FontSize),fontStyle:h.FontStyle.toString(),fill:h.SA_WHITE.toString(),padding:5})]}),null===(e=this._arrow)||void 0===e?void 0:e.draw()]},Ie.key++)}}class S extends x{constructor(e,t){super(),this.data=e,this.referencedBy=t,this.centerX=void 0,this.tooltipWidth=void 0,this.exportTooltipWidth=void 0,this.radius=h.FnRadius,this.innerRadius=h.FnInnerRadius,this._arrow=void 0,this.paramsText=void 0,this.bodyText=void 0,this.exportBodyText=void 0,this.tooltip=void 0,this.exportTooltip=void 0,this.selected=!1,this.ref=a.a.createRef(),this.labelRef=a.a.createRef(),this.onMouseEnter=e=>{let{currentTarget:t}=e;Ne.getPrintableMode()||(this.labelRef.current.show(),ae(t))},this.onMouseLeave=e=>{let{currentTarget:t}=e;if(!Ne.getPrintableMode())if(this.selected){var n;const e=null===(n=t.getStage())||void 0===n?void 0:n.container();e&&(e.style.cursor="default")}else this.labelRef.current.hide(),re(t)},this.onClick=e=>{let{currentTarget:t}=e;Ne.getPrintableMode()||(this.selected=!this.selected,this.selected?(this.labelRef.current.show(),ae(t)):(this.labelRef.current.hide(),re(t)))},Ie.memoizeValue(this);const n=this.referencedBy[0];n instanceof U?(this._x=n.frame.x()+n.frame.width()+h.FrameMarginX/4,this._y=n.y(),this.centerX=this._x+2*this.radius):(n.isLastUnit?(this._x=n.x()+2*h.DataUnitWidth,this._y=n.y()+h.DataUnitHeight/2-this.radius):(this._x=n.x(),this._y=n.y()+n.parent.height()+h.DataUnitHeight),this.centerX=this._x+h.DataUnitWidth/2,this._x=this.centerX-2*this.radius),this._y+=this.radius,this._width=4*this.radius,this._height=2*this.radius,this.paramsText=`params: ${te(this.data)}`,this.bodyText=`body: ${ne(this.data)}`,this.exportBodyText=(this.bodyText.length>23?this.bodyText.slice(0,20):this.bodyText).split("\n").slice(0,2).join("\n")+" ...",this.tooltip=`${this.paramsText}\n${this.bodyText}`,this.exportTooltip=`${this.paramsText}\n${this.exportBodyText}`,this.tooltipWidth=Math.max(ee(this.paramsText),ee(this.bodyText))+h.TextPaddingX,this.exportTooltipWidth=Math.max(ee(this.paramsText),ee(this.exportBodyText))}isSelected(){return this.selected}arrow(){return this._arrow}updatePosition(){const e=this.referencedBy.find((e=>e instanceof U))||this.referencedBy[0];e instanceof U?(this._x=e.frame.x()+e.frame.width()+h.FrameMarginX/4,this._y=e.y(),this.centerX=this._x+2*this.radius):(e.isLastUnit?(this._x=e.x()+2*h.DataUnitWidth,this._y=e.y()+h.DataUnitHeight/2-this.radius):(this._x=e.x(),this._y=e.y()+e.parent.height()+h.DataUnitHeight),this.centerX=this._x+h.DataUnitWidth/2,this._x=this.centerX-2*this.radius),this._y+=this.radius}draw(){var e;return this._isDrawn=!0,this._arrow=Ie.globalEnvNode.frame&&new j(this).to(Ie.globalEnvNode.frame),Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsxs)(r.c,{onMouseEnter:e=>this.onMouseEnter(e),onMouseLeave:e=>this.onMouseLeave(e),onClick:e=>this.onClick(e),ref:this.ref,children:[Object(i.createElement)(r.b,{...p,key:Ie.key++,x:this.centerX-this.radius,y:this.y(),radius:this.radius,stroke:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString()}),Object(i.createElement)(r.b,{...p,key:Ie.key++,x:this.centerX-this.radius,y:this.y(),radius:this.innerRadius,fill:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString()}),Object(i.createElement)(r.b,{...p,key:Ie.key++,x:this.centerX+this.radius,y:this.y(),radius:this.radius,stroke:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString()}),Object(i.createElement)(r.b,{...p,key:Ie.key++,x:this.centerX+this.radius,y:this.y(),radius:this.innerRadius,fill:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString()})]}),Ne.getPrintableMode()?Object(g.jsxs)(r.d,{x:this.x()+this.width()+2*h.TextPaddingX,y:this.y()-h.TextPaddingY,visible:!0,ref:this.labelRef,children:[Object(g.jsx)(r.k,{stroke:"black",fill:"white",opacity:Number(h.FnTooltipOpacity)}),Object(g.jsx)(r.l,{text:this.exportTooltip,fontFamily:h.FontFamily.toString(),fontSize:Number(h.FontSize),fontStyle:h.FontStyle.toString(),fill:h.SA_BLUE.toString(),padding:5})]}):Object(g.jsxs)(r.d,{x:this.x()+this.width()+2*h.TextPaddingX,y:this.y()-h.TextPaddingY,visible:!1,ref:this.labelRef,children:[Object(g.jsx)(r.k,{stroke:"black",fill:"black",opacity:Number(h.FnTooltipOpacity)}),Object(g.jsx)(r.l,{text:this.tooltip,fontFamily:h.FontFamily.toString(),fontSize:Number(h.FontSize),fontStyle:h.FontStyle.toString(),fill:h.SA_WHITE.toString(),padding:5})]}),null===(e=this._arrow)||void 0===e?void 0:e.draw()]},Ie.key++)}}class w extends f{static emergeFromTopOrBottom(e,t,n){e.push(((e,s)=>[e,s+(n.y()>t.y()||n.y()===t.y()&&n.x()<=t.x()?.9:-.9)*h.DataUnitHeight]))}calculateSteps(){const e=this.source,t=this.target;if(!t)return[];const n=[(e,t)=>[e+h.DataUnitWidth/2,t+h.DataUnitHeight/2]];if(t instanceof O||t instanceof S)Math.abs(t.y()-e.y())<2*h.DataUnitHeight?(w.emergeFromTopOrBottom(n,e,t),n.push((()=>[t.centerX+2*h.FnRadius+h.FnRadius,t.y()])),n.push(((e,t)=>[e-h.FnRadius,t]))):n.push((()=>[t.centerX+2*h.FnRadius,t.y()]));else if(t instanceof A)if(e.parent===t)n.push(((e,t)=>[e,t-3*h.DataUnitHeight/4])),n.push(((e,t)=>[e+h.DataUnitHeight/3,t])),n.push(((e,t)=>[e,t+h.DataUnitHeight/4]));else if(e.isLastUnit&&t.x()-e.x()<=3*h.DataUnitWidth&&t.x()>e.x()&&t.level===e.parent.level)n.push((()=>[t.x(),t.y()+h.DataUnitHeight/2]));else{w.emergeFromTopOrBottom(n,e,t);const s=L.getVerticalLaneAfterSource(t,e.x()).getPosition(t);(s-e.x())*(s-t.x())<0&&n.push(((e,t)=>[s,t]));const i=L.getHorizontalLaneBeforeTarget(t,e.y()).getPosition(t);(i-e.y())*(i-t.y())<0&&n.push(((e,n)=>(i-n)*(i-t.y())>0?[e,n]:[e,L.getHorizontalLaneBeforeTarget(t,n).getPosition(t)])),n.push(((e,n)=>{let s,i=t.y()+h.DataUnitHeight/2-n;const a=t.y()+h.DataUnitHeight/2-Math.sign(i)*h.DataUnitHeight/2;if(i=a-n,e<t.x()-h.DataUnitWidth)s=Math.max(e+h.DataUnitWidth,t.x()-Math.abs(i));else{if(!(e>=t.x()+t.units.length*h.DataUnitWidth+h.DataUnitWidth)){if(e<t.x())s=t.x();else if(e>=t.x()+t.units.length*h.DataUnitWidth+h.DataUnitWidth)s=t.x()+t.units.length*h.DataUnitWidth+h.DataUnitWidth;else{const n=Math.floor((e-t.x())/h.DataUnitWidth);s=t.x()+h.DataUnitWidth*n}return[(e+s)/2,(n+a)/2]}s=t.x()+t.units.length*h.DataUnitWidth,s=Math.min(e-h.DataUnitWidth,s+Math.abs(i))}return[s,n]})),n.push(((e,n)=>{const s=Math.floor((e-t.x())/h.DataUnitWidth),i=t.y()+h.DataUnitHeight/2-n,a=t.y()+h.DataUnitHeight/2-Math.sign(i)*h.DataUnitHeight/2;return e<t.x()?[t.x(),a]:e>=t.x()+t.units.length*h.DataUnitWidth?[t.x()+t.units.length*h.DataUnitWidth,a]:[t.x()+h.DataUnitWidth*s,a]}))}else n.push((()=>[t.x(),t.y()]));return n}}const C=e=>{let{x:t,y:n,width:s,height:i,cornerRadius:a,forwardRef:o,...c}=e;return Object(g.jsx)(r.i,{sceneFunc:(e,r)=>{const{upperLeft:o,lowerLeft:c,upperRight:l,lowerRight:d}=a;e.beginPath(),e.moveTo(t+o,n),e.lineTo(t+s-l,n),e.quadraticCurveTo(t+s,n,t+s,n+l),e.lineTo(t+s,n+i-d),e.quadraticCurveTo(t+s,n+i,t+s-d,n+i),e.lineTo(t+c,n+i),e.quadraticCurveTo(t,n+i,t,n+i-c),e.lineTo(t,n+o),e.quadraticCurveTo(t,n,t+o,n),e.closePath(),e.fillStrokeShape(r)},...p,ref:o,...c})};class E extends o{constructor(e){super(),this.arrayUnit=void 0,this.referencedBy=void 0,this.updatePosition=()=>{this._x=this.arrayUnit.x(),this._y=this.arrayUnit.y()},this.referencedBy=e,this.arrayUnit=e[0],this._x=this.arrayUnit.x(),this._y=this.arrayUnit.y(),this._height=this.arrayUnit.height(),this._width=this.arrayUnit.width()}draw(){return Object(i.createElement)(r.f,{...p,key:Ie.key++,points:[this.x(),this.y()+this.height(),this.x()+this.width(),this.y()],stroke:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString(),hitStrokeWidth:Number(h.DataHitStrokeWidth),ref:this.ref,listening:!1})}}class T extends x{constructor(e,t){super(),this.data=e,this.referencedBy=t,this.text=void 0,this.updatePosition=()=>{const e=this.referencedBy[0];if(e instanceof U)this._x=e.x()+ee(e.keyString)+h.TextPaddingX,this._y=e.y();else{const t=e.width(),n=Math.min(ee(String(this.data)),t);this._x=e.x()+(e.width()-n)/2,this._y=e.y()+(e.height()-h.FontSize)/2}this.text instanceof b?this.text.updatePosition(this.x(),this.y()):this.text.updatePosition()};const n=this.referencedBy[0];if(n instanceof U)this._x=n.x()+ee(n.keyString)+h.TextPaddingX,this._y=n.y(),this.text=new b(this.data,this._x,this._y,{isStringIdentifiable:!0});else{const e=n.width(),t=Math.min(ee(String(this.data)),e);this._x=n.x()+(n.width()-t)/2,this._y=n.y()+(n.height()-h.FontSize)/2,this.text=z(this.data)?new E([n]):new b(this.data,this.x(),this.y(),{maxWidth:e,isStringIdentifiable:!0})}this._width=this.text.width(),this._height=this.text.height()}reset(){super.reset(),this.referencedBy.length=0}onMouseEnter(){}onMouseLeave(){}draw(){return this._isDrawn=!0,Object(g.jsx)(a.a.Fragment,{children:this.text.draw()},Ie.key++)}}class k extends o{constructor(e,t,n){super(),this.idx=e,this.data=t,this.value=void 0,this.isFirstUnit=void 0,this.isLastUnit=void 0,this.isMainReference=void 0,this.parent=void 0,this.arrow=void 0,this.updatePosition=()=>{this._x=this.parent.x()+this.idx*h.DataUnitWidth,this._y=this.parent.y(),this.value instanceof T&&this.value.updatePosition()},this.onMouseEnter=()=>{this.parent.units.forEach((e=>{ae(e.ref.current)}))},this.onMouseLeave=e=>{let{currentTarget:t}=e;if(this.parent.isSelected()){var n;const e=null===(n=t.getStage())||void 0===n?void 0:n.container();e&&(e.style.cursor="default")}else this.parent.units.forEach((e=>{re(e.ref.current)}))},this.onClick=()=>{this.parent.onClick()},this.parent=n,this._x=this.parent.x()+this.idx*h.DataUnitWidth,this._y=this.parent.y(),this._height=h.DataUnitHeight,this._width=h.DataUnitWidth,this.isFirstUnit=0===this.idx,this.isLastUnit=this.idx===this.parent.data.length-1,this.value=Ie.createValue(this.data,this),this.isMainReference=this.value.referencedBy.length>1}draw(){if(this._isDrawn)return null;this._isDrawn=!0;const e={upperLeft:0,lowerLeft:0,upperRight:0,lowerRight:0};return this.isFirstUnit&&(e.upperLeft=e.lowerLeft=Number(h.DataCornerRadius)),this.isLastUnit&&(e.upperRight=e.lowerRight=Number(h.DataCornerRadius)),this.value instanceof T||(this.arrow=new w(this).to(this.value),this.parent.addArrow(this.arrow),this.value instanceof A&&this.value.addArrow(this.arrow)),Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsx)(C,{x:this.x(),y:this.y(),width:this.width(),height:this.height(),stroke:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString(),hitStrokeWidth:Number(h.DataHitStrokeWidth),fillEnabled:!1,forwardRef:this.ref,cornerRadius:e,onClick:this.onClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},Ie.key++),!(this.value instanceof O||this.value instanceof S)&&this.value.draw(),this.arrow&&this.arrow.draw()]},Ie.key++)}}class A extends x{constructor(e,t){super(),this.data=e,this.referencedBy=t,this.units=[],this.emptyUnit=void 0,this.level=void 0,this._arrows=[],this.selected=!1,this.ref=a.a.createRef(),this.parentArray=void 0,this.arrayLevelY=-1,this.onClick=()=>{this.selected=!this.selected,this.selected||(this.units.forEach((e=>{re(e.ref.current)})),this.emptyUnit&&re(this.emptyUnit.ref.current))},this.addArrow=e=>{this._arrows.push(e)},Ie.memoizeValue(this);const n=this.referencedBy[0];n instanceof U?(this._x=n.frame.x()+n.frame.width()+h.FrameMarginX,this._y=n.y()):(this.parentArray=n.parent,n.isLastUnit?(this._x=n.x()+2*h.DataUnitWidth,this._y=n.y()):(this._x=n.x(),this._y=n.y()+n.parent.height()+h.DataUnitHeight)),this._width=this.data.length*h.DataUnitWidth+h.DataMinWidth,this._height=h.DataUnitHeight;for(let s=this.data.length-1;s>=0;s--){const e=new k(s,this.data[s],this);this.units=[e,...this.units]}}onMouseEnter(){}onMouseLeave(){}isSelected(){return this.selected}arrows(){return this._arrows}reset(){super.reset(),this.units.map((e=>e.reset())),this.referencedBy.length=0,this._arrows=[]}setLevel(e,t){this.level=e,this.arrayLevelY=t}updatePosition(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:-1,y:-1};this._x=e.x>0?e.x:this._x,this._y=e.y>0?e.y:this._y,this.units.forEach((e=>{e.updatePosition()}))}draw(){return this.isDrawn()?null:(this._isDrawn=!0,this._arrows=this.referencedBy.filter((e=>e instanceof U)).map((e=>{const t=new D(e.key).to(this);return e.frame.trackObjects(this),e.frame.trackObjects(t),t})),0===this.units.length&&(this.emptyUnit=new y(this)),Object(g.jsxs)(r.c,{ref:this.ref,children:[this._arrows.map((e=>e.draw())),this.units.length>0&&this.units.map((e=>e.draw())),this.emptyUnit&&this.emptyUnit.draw(),Object(g.jsx)(r.h,{width:this.width(),height:this.height()})]},Ie.key++))}}const _=new Map([["global","Global"],["programEnvironment","Program"],["forLoopEnvironment","Body of for-loop"],["forBlockEnvironment","Control variable of for-loop"],["blockEnvironment","Block"],["functionBodyEnvironment","Function Body"]]);class I extends o{constructor(e,t,n){var s;super(),this.envTreeNode=e,this.xCoord=t,this.yCoord=n,this.totalHeight=void 0,this.totalWidth=void 0,this.totalHoveredWidth=void 0,this.bindings=[],this.name=void 0,this.level=void 0,this.environment=void 0,this.parentFrame=void 0,this.offsetY=void 0,this.values=[],this.selected=!1,this.updatePosition=(e,t)=>{this._x=e,this._y=t+this.offsetY,this.name.updatePosition(this.x(),t),this.bindings.forEach((e=>{e.updatePosition(this.x(),t)}))},this.update=e=>{this.level=e.level,this.environment=e.environment,this.offsetY=this.name.height()+h.TextPaddingY/3,this._y=this.level.y()+this.offsetY;let t=0;for(const[l,d]of Object.entries(this.environment.head)){const e=Math.max(h.TextMinWidth,ee(l+h.ConstantColon))+h.TextPaddingX+(Y(d)?Math.max(h.TextMinWidth,ee(h.UnassignedData.toString())):K(d)?Math.max(h.TextMinWidth,ee(String(d))):0);t=Math.max(t,e)}this._width=t+2*h.FramePaddingX,this.values=[];let n=null,s=this._width,i=this._width;this.totalHoveredWidth=Math.max(s,this.name.hoveredWidth());const a=Object.getOwnPropertyDescriptors(this.environment.head),r=[],o=[];for(const l of Object.entries(a))if(Z(l[0])){const e=oe(l[1].value.environment);(this.environment.id===h.GlobalEnvId||e&&e.id===this.environment.id)&&o.push(l)}else r.push(l);r.push(...o);for(const[l,d]of r){const e=new U(l,d.value,this,n,!d.writable);-1===this.bindings.findIndex((t=>t.value===e.value&&(e.isDummyBinding||t.keyString===e.keyString)))&&(this.bindings.push(e),n=e,s=Math.max(s,e.width()+h.FramePaddingX),i=Math.max(i,e.exportWidth()+h.FramePaddingX),this.totalHoveredWidth=Math.max(this.totalHoveredWidth,e.hoveredWidth()+h.FramePaddingX))}Ne.getPrintableMode()?this.totalWidth=i:this.totalWidth=s,this._height=n?n.y()+n.height()+h.FramePaddingY-this.y():2*h.FramePaddingY,this.totalHeight=this.height()+this.name.height()+h.TextPaddingY/2;const c=I.cumWidths[this.xCoord]+this.totalWidth+h.FrameMarginX+h.FnRadius;I.cumWidths[this.xCoord+1]=void 0===I.cumWidths[this.xCoord+1]?c:Math.max(I.cumWidths[this.xCoord+1],c),I.maxX=Math.max(I.maxX,I.cumWidths[this.xCoord]+(Ne.getPrintableMode()?this.totalWidth:this.totalHoveredWidth),I.cumWidths[I.cumWidths.length-1]),I.heights[this.yCoord]=Math.max(I.heights[this.yCoord]||0,this.totalHeight)},this.isSelected=()=>this.selected,this.onMouseEnter=()=>{se(this.ref.current),ae(this.ref.current),this.bindings.forEach((e=>{const t=e.getArrow();t&&ae(t.ref.current)})),this.values.forEach((e=>{e&&ae(e.ref.current)}))},this.onMouseLeave=()=>{ie(this.ref.current),this.selected||(re(this.ref.current),this.bindings.forEach((e=>{const t=e.getArrow();t&&!t.isSelected()&&re(t.ref.current)})),this.values.forEach((e=>{e instanceof A&&e.isSelected()||e&&re(e.ref.current)})))},this.onClick=e=>{this.selected=!this.selected,this.selected?(ae(this.ref.current),this.bindings.forEach((e=>{const t=e.getArrow();t&&ae(t.ref.current)})),this.values.forEach((e=>{e&&ae(e.ref.current)}))):(re(this.ref.current),this.bindings.forEach((e=>{const t=e.getArrow();t&&!t.isSelected()&&re(t.ref.current)})),this.values.forEach((e=>{e instanceof A&&e.isSelected()||e&&re(e.ref.current)})))},this._width=h.FrameMinWidth,this.level=e.level,this.environment=e.environment,this.parentFrame=null===(s=e.parent)||void 0===s?void 0:s.frame,this.xCoord=t,this.yCoord=n,I.maxXCoord=Math.max(t,I.maxXCoord),this._x=0===t?h.CanvasPaddingX:I.cumWidths[t],this.name=new b(_.get(this.environment.name)||this.environment.name,this.x(),this.level.y(),{maxWidth:this.width()}),this.offsetY=this.name.height()+h.TextPaddingY/3,this._y=this.level.y()+this.offsetY,this._width=2*h.FramePaddingX,this.totalWidth=this.width(),this.totalHoveredWidth=this.totalWidth,this._height=2*h.FramePaddingY,this.totalHeight=this.height()+this.name.height()+h.TextPaddingY/2,this.update(e)}static lastXCoordBelow(e){let t=I.cumWidths.length;for(;t--;)if(I.cumWidths[t]<=e)return t;return 0}trackObjects(e){const t=this.values.includes(e);return!t&&this.values.push(e),!t}draw(){let e;return void 0!==this.parentFrame&&(e=new v(this).to(this.parentFrame),this.trackObjects(e)),Object(g.jsxs)(r.c,{ref:this.ref,children:[e&&e.draw(),this.bindings.map((e=>!(e.data instanceof A)&&e.draw())),this.name.draw(),Object(i.createElement)(r.h,{...p,x:this.x(),y:this.y(),width:this.width(),height:this.height(),stroke:Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString(),cornerRadius:Number(h.FrameCornerRadius),key:Ie.key++,onClick:e=>this.onClick(e),onMouseEnter:()=>this.onMouseEnter(),onMouseLeave:()=>this.onMouseLeave()})]},Ie.key++)}}I.maxXCoord=-1,I.maxX=h.CanvasPaddingX.valueOf(),I.cumWidths=[h.CanvasPaddingX.valueOf()],I.heights=[h.CanvasPaddingY.valueOf()],I.reset=()=>{I.maxX=h.CanvasPaddingX.valueOf(),I.maxXCoord=-1,I.cumWidths=[h.CanvasPaddingX.valueOf()],I.heights=[h.CanvasPaddingY.valueOf()]};class N extends o{constructor(e){super(),this.parentLevel=e}}class P extends N{constructor(e){super(e),this.parentLevel=e,this._minX=1/0,this._count=0,this.position=[[]],this._rowCount=0,this.arrays=[],this.getNumLanes=()=>this._rowCount,this.addArray=(e,t)=>{var n,s;t=t||0;let i=null!==(n=null===(s=e.parentArray)||void 0===s?void 0:s.arrayLevelY)&&void 0!==n?n:0,a=0,r=e;const o=[];for(;r instanceof A&&!o.includes(r);)o.push(r),a+=h.DataUnitPaddingX+r.units.length*h.DataUnitWidth,r.units.length>0&&r.units[r.units.length-1].value instanceof A&&(r=r.units[r.units.length-1].value);e:for(const d of this.position.slice(i)){for(const e of d)if(e[0]<t+a+h.DataMinWidth&&e[1]>t){i++;continue e}break}this._minX=Math.min(t,this._minX),this._count++,this._rowCount=Math.max(this._rowCount,i),this.position[i]=this.position[i]||[],this.position[i].push([t,t+e.width()+h.DataUnitWidth/2]),this.position[i].sort(((e,t)=>e[0]-t[0]));const c=h.DataUnitPaddingY,l=this._y+i*h.DataUnitHeight+(i+1)*c;e.updatePosition({x:t,y:l}),e.setLevel(this,i),this._height=Math.max(this._height,l+c),this.arrays.push(e),this._width=Math.max(this._width,t+e.width())},this.setY=e=>{this.arrays.forEach((t=>t.updatePosition({x:t.x(),y:t.y()-this.y()+e}))),this._y=e},this.reset=()=>{this._minX=1/0,this._count=0},this._x=h.CanvasPaddingX,this._y=0,this._width=0,this._rowCount=0}minX(){return this._minX}count(){return this._count}draw(){return Object(g.jsxs)(r.c,{ref:this.ref,children:[Object(i.createElement)(r.h,{...p,x:this.x(),y:this.y(),width:this.width(),height:this.height(),key:Ie.key++,listening:!1}),this.arrays.map((e=>e.draw()))]},Ie.key++)}}class R extends N{constructor(e){super(e),this.parentLevel=e,this.lastXcoord=void 0,this.yCoord=void 0,this.frames=[],this.addFrame=e=>{var t;const n=Math.max(null!==(t=e.xCoord)&&void 0!==t?t:0,R.maxXcoord,this.lastXcoord+1);this.lastXcoord=n,R.maxXcoord=Math.max(R.maxXcoord,n),e.level=this,void 0!==this.frames[n]?this.frames[n].update(e):(this.frames[n]=new I(e,n,this.yCoord),e.frame=this.frames[n]),this._width=I.maxX},this.setY=e=>{this._y=e,this.frames.forEach((t=>{t.updatePosition(t.x(),e)}))},this._x=h.CanvasPaddingX,this._y=0,this._width=0,this.lastXcoord=-1,this.yCoord=R.maxYcoord++}height(){return I.heights[this.yCoord]+h.FrameMarginY}draw(){return Object(g.jsxs)(r.c,{ref:this.ref,children:[Object(i.createElement)(r.h,{...p,x:this.x(),y:this.y(),width:this.width(),height:this.height(),key:Ie.key++,listening:!1}),this.frames.reverse().map((e=>e.draw()))]},Ie.key++)}}R.maxXcoord=0,R.maxYcoord=0,R.reset=()=>{R.maxXcoord=0,R.maxYcoord=0};class M extends o{constructor(e){super(),this.envTreeNodes=e,this.frameLevels=void 0,this.arrayLevels=void 0,this.levels=void 0,this.widths=void 0,this.destroy=()=>{this.frameLevels.forEach((e=>e.ref.current.destroyChildren()))},this._x=0,this._y=0,this.frameLevels=[],this.arrayLevels=[],this.levels=[],this.widths=[],M.cumHeights=[],this._height=0,this._width=0,this.update(e)}update(e){I.reset(),R.reset(),L.reset(),this.arrayLevels.forEach((e=>e.reset())),this.frameLevels=[],this.arrayLevels=[],this.levels=[];const t=e.reduce(((e,t,n)=>(0===n?(this.frameLevels[n]=new R(null),this.arrayLevels[n]=new P(this.frameLevels[n])):(this.frameLevels[n]=new R(this.arrayLevels[n-1]),this.arrayLevels[n]=new P(this.frameLevels[n])),this.levels.push(this.frameLevels[n]),this.levels.push(this.arrayLevels[n]),[...e,...t.map((e=>[n,e]))])),new Array);t.sort(((e,t)=>parseInt(e[1].environment.id)-parseInt(t[1].environment.id))),this.widths=[],M.cumHeights=[];const n=[];t.forEach((e=>{var t,s,i;if(n[e[0]]=null!==(t=n[e[0]])&&void 0!==t?t:[],e[1].xCoord=Math.max(n[e[0]].length-1+1,null!==(s=null===(i=e[1].parent)||void 0===i?void 0:i.xCoord)&&void 0!==s?s:0),n[e[0]][e[1].xCoord]=e[1],e[1].parent){let t=e[1],s=e[0],i=!0;for(;i;){const e=t.parent;if(e.xCoord&&e.children.flatMap((e=>de(e)))[0]===t)if(void 0===t.xCoord||void 0===e.xCoord)i=!1;else{const a=t.xCoord-e.xCoord,r=e.xCoord;a>0&&n[s].slice(r,t.xCoord).every((t=>{var n;return void 0===t||parseInt(null!==(n=t.parent.environment.id)&&void 0!==n?n:0)<parseInt(e.environment.id)}))?(n[s-1].slice(r).forEach((e=>{void 0!==e&&(e.xCoord=e.xCoord?e.xCoord+a:e.xCoord)})),n[s-1]=[...n[s-1].slice(0,r),...Array(a).fill(void 0),...n[s-1].slice(r)],s-=1,t=e):i=!1}else i=!1}}})),t.sort(((e,t)=>{var n,s;return(null!==(n=e[1].xCoord)&&void 0!==n?n:0)-(null!==(s=t[1].xCoord)&&void 0!==s?s:0)})),t.forEach((e=>this.frameLevels[e[0]].addFrame(e[1]))),Ie.values.forEach(((e,t,n)=>{if(e instanceof A){let t=e.referencedBy.filter((e=>e instanceof U)),n=e.referencedBy.find((e=>e instanceof k));const r=e.referencedBy[0]instanceof U;for(;0===t.length;)t=n.parent.referencedBy.filter((e=>e instanceof U)),n=n.parent.referencedBy.find((e=>e instanceof k));if(r){const t=e.referencedBy[0].frame.yCoord,n=I.cumWidths[e.referencedBy[0].frame.xCoord+1]+.8*h.FrameMarginX;this.arrayLevels[Math.floor(t)].addArray(e,n)}else if(e.referencedBy[0]instanceof k){var s,i,a;const t=null!==(s=null===(i=e.referencedBy[0].parent.level)||void 0===i||null===(a=i.parentLevel)||void 0===a?void 0:a.yCoord)&&void 0!==s?s:0,n=e.referencedBy[0].x()+(e.referencedBy[0]instanceof k&&e.referencedBy[0].isLastUnit?h.DataUnitWidth+h.DataUnitPaddingX:0);this.arrayLevels[Math.floor(t)].addArray(e,n)}}})),M.cumHeights=this.levels.reduce(((e,t,n)=>{let s;if(n%2===0){const e=this.arrayLevels[Math.floor(n/2)];s=I.cumWidths[t.lastXcoord+1]<=e.minX()?0:I.heights[Math.floor(n/2)]+(I.heights[Math.floor(n/2)],h.FrameMarginY/2)}else{const e=this.frameLevels[Math.floor(n/2)];s=I.heights[Math.floor(n/2)]+(I.heights[Math.floor(n/2)]>0?h.FrameMarginY:0),t.count()>0&&(s=I.cumWidths[e.lastXcoord+1]<=t.minX()?Math.max(s,this.arrayLevels[Math.floor((n-1)/2)].height()+(this.arrayLevels[Math.floor((n-1)/2)].height()>0?h.FrameMarginY:h.FrameMarginY/2)):this.arrayLevels[Math.floor((n-1)/2)].height()+h.FrameMarginY)}return[...e,e[e.length-1]+s]}),[h.CanvasPaddingY.valueOf()]),this.levels.forEach(((e,t)=>{e.setY(M.cumHeights[t])})),this._height=M.cumHeights[M.cumHeights.length-1],this._width=Math.max(this.frameLevels.reduce(((e,t)=>Math.max(e,t.width())),0),this.arrayLevels.reduce(((e,t)=>Math.max(e,t.width())),0))+h.FrameMarginX}static lastYCoordBelow(e){let t=M.cumHeights.length;for(;t--;)if(M.cumHeights[t]<=e)return t;return 0}draw(){return Object(g.jsxs)(r.c,{children:[Object(i.createElement)(r.h,{...p,x:this.x(),y:this.y(),width:this.width(),height:this.height(),key:Ie.key++,listening:!1}),this.arrayLevels.reverse().map((e=>e.draw())),this.frameLevels.reverse().map((e=>e.draw()))]},Ie.key++)}}M.cumHeights=void 0;class L{constructor(e,t){this.id=void 0,this.objects=[],this.frames=[],this.isVertical=!0,this.getPosition=e=>{if(e instanceof I){let t=this.frames.indexOf(e);-1===t&&(t=this.frames.push(e)-1);const n=t*h.ArrowLaneInterval%h.ArrowNumLanes;return M.cumHeights[this.id]-.45*h.FrameMarginY-n/h.ArrowNumLanes*h.FrameMarginY*.35}{let t=this.objects.indexOf(e instanceof x?e.data:e);-1===t&&(t=this.objects.push(e instanceof x?e.data:e)-1);const n=t*h.ArrowLaneInterval%h.ArrowNumLanes;return this.isVertical?I.cumWidths[this.id]-.9*h.FrameMarginX+h.FnRadius+n/(h.ArrowNumLanes+1)*h.FrameMarginX*.7:(this.id,M.cumHeights[this.id]-.1*h.FrameMarginY-n/h.ArrowNumLanes*h.FrameMarginY*.35)}},this.id=e,this.isVertical=t}}L.verticalLanes=[],L.horizontalLanes=[],L.arrayLevelLanes=[],L.reset=()=>{L.verticalLanes=[],L.horizontalLanes=[],L.arrayLevelLanes=[]},L.getVerticalLaneBeforeTarget=(e,t)=>{let n=I.lastXCoordBelow(e.x())+(t>e.x()?0:1);const s=I.cumWidths[n];return e.x()>s&&t>s&&n++,void 0===L.verticalLanes[n]&&(L.verticalLanes[n]=new L(n,!0)),L.verticalLanes[n]},L.getVerticalLaneAfterSource=(e,t)=>{let n=I.lastXCoordBelow(t)+(t>e.x()?0:1);const s=I.cumWidths[n];return e.x()>s&&t>s&&n++,void 0===L.verticalLanes[n]&&(L.verticalLanes[n]=new L(n,!0)),L.verticalLanes[n]},L.getHorizontalLaneBeforeTarget=(e,t)=>{const n=M.lastYCoordBelow(e.y())+(t>e.y()?1:0);return void 0===L.horizontalLanes[n]&&(L.horizontalLanes[n]=new L(n,!1)),L.horizontalLanes[n]},L.getHorizontalLaneAfterSource=(e,t)=>{const n=M.lastYCoordBelow(t)+(t>e.y()?0:1);return void 0===L.horizontalLanes[n]&&(L.horizontalLanes[n]=new L(n,!1)),L.horizontalLanes[n]};class D extends f{calculateSteps(){const e=this.source,t=this.target;if(!t)return[];const n=[(t,n)=>[t+e.width(),n+e.height()/2]];if(t instanceof A){n.push(((e,t)=>[e+h.TextMargin+h.TextPaddingX,t])),n.push(((n,s)=>L.getVerticalLaneAfterSource(t,n).getPosition(t)<n?[n,s-Math.sign(e.y()-t.y())*(e.height()+h.TextMargin)]:[n,s])),n.push(((e,n)=>[L.getVerticalLaneAfterSource(t,e).getPosition(t),n]));const s=L.getHorizontalLaneBeforeTarget(t,e.y()).getPosition(t);(s-e.y())*(s-t.y())<0&&n.push(((e,n)=>{const s=L.getHorizontalLaneBeforeTarget(t,n).getPosition(t);return(s-n)*(s-t.y())>0?[e,n]:[e,L.getHorizontalLaneBeforeTarget(t,n).getPosition(t)]})),n.push(((e,n)=>{let s,i=t.y()+h.DataUnitHeight/2-n;if(i=Math.abs(i-Math.sign(i)*h.DataUnitHeight/2),e<t.x())s=Math.max(e+h.DataUnitWidth,t.x()-i);else{if(!(e>=t.x()+t.units.length*h.DataUnitWidth)){const i=Math.floor((e-t.x())/h.DataUnitWidth);return s=t.x()+h.DataUnitWidth*i,[(e+s)/2,(n+t.y())/2]}s=t.x()+t.units.length*h.DataUnitWidth,s=Math.min(e-h.DataUnitWidth,s+i)}return[s,n]})),n.push(((n,s)=>{const i=Math.floor((n-t.x())/h.DataUnitWidth),a=e.y()-(t.y()+h.DataUnitHeight/2),r=t.y()+h.DataUnitHeight/2+(Math.abs(a)<h.DataUnitHeight?0:Math.sign(a))*h.DataUnitHeight/2;return n<t.x()?[t.x(),r]:n>=t.x()+t.units.length*h.DataUnitWidth?[t.x()+t.units.length*h.DataUnitWidth,r]:[t.x()+h.DataUnitWidth*i,r]}))}else t instanceof O||t instanceof S?t.x()<e.x()?(n.push(((e,t)=>[e+h.TextMargin,t])),n.push(((n,s)=>[n,s-Math.sign(e.y()-t.y())*e.height()])),M.lastYCoordBelow(t.y())===M.lastYCoordBelow(e.y())&&I.lastXCoordBelow(e.x())===I.lastXCoordBelow(t.x())+1?(n.push(((e,n)=>[t.centerX+3*h.FnRadius,n])),n.push(((e,n)=>[e,t.y()])),n.push(((e,t)=>[e-h.FnRadius,t]))):(n.push(((e,n)=>[L.getVerticalLaneAfterSource(t,e).getPosition(t),n])),n.push(((e,n)=>[e,L.getHorizontalLaneBeforeTarget(t,n).getPosition(t)])),n.push(((e,n)=>[L.getVerticalLaneBeforeTarget(t,e).getPosition(t),n])),n.push(((e,n)=>[e,t.y()])),n.push(((e,n)=>[t.centerX+2*h.FnRadius,n])))):M.lastYCoordBelow(t.y())===M.lastYCoordBelow(e.y())&&I.lastXCoordBelow(e.x())===I.lastXCoordBelow(t.x())?(n.push(((e,n)=>[t.x(),n])),n.push(((e,n)=>[e,t.y()]))):(n.push(((e,n)=>[L.getVerticalLaneAfterSource(t,e).getPosition(t),n])),n.push(((e,n)=>[e,L.getHorizontalLaneBeforeTarget(t,n).getPosition(t)])),n.push(((e,n)=>[L.getVerticalLaneBeforeTarget(t,e).getPosition(t),n])),n.push(((e,n)=>[e,t.y()])),n.push(((e,n)=>[t.centerX+2*h.FnRadius,n]))):(n.push(((e,n)=>[e,t.y()])),n.push(((e,n)=>[t.x(),n])));return n}}class B extends x{constructor(e){super(),this.referencedBy=e,this.data=Symbol(),this.text=void 0;const t=this.referencedBy[0];if(t instanceof U)this._x=t.x()+ee(t.keyString)+h.TextPaddingX,this._y=t.y(),this.text=new b(h.UnassignedData.toString(),this._x,this._y,{isStringIdentifiable:!1});else{const e=t.width(),n=Math.min(ee(String(this.data)),e);this._x=t.x()+(t.width()-n)/2,this._y=t.y()+(t.height()-h.FontSize)/2,this.text=new b(h.UnassignedData.toString(),this._x,this._y,{maxWidth:e,isStringIdentifiable:!1})}this._width=this.text.width(),this._height=this.text.height()}reset(){super.reset(),this.referencedBy.length=0}updatePosition(){const e=this.referencedBy[0];if(e instanceof U)this._x=e.x()+ee(e.keyString)+h.TextPaddingX,this._y=e.y();else{const t=e.width(),n=Math.min(ee(String(this.data)),t);this._x=e.x()+(e.width()-n)/2,this._y=e.y()+(e.height()-h.FontSize)/2}this.text.updatePosition(this._x,this._y)}onMouseEnter(){}onMouseLeave(){}draw(){return this._isDrawn=!0,Object(g.jsx)(a.a.Fragment,{children:this.text.draw()},Ie.key++)}}class U extends o{constructor(e,t,n,s){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.keyString=e,this.data=t,this.frame=n,this.prevBinding=s,this.isConstant=i,this.offsetY=void 0,this._hoveredWidth=void 0,this.isMainReference=void 0,this.value=void 0,this.key=void 0,this.isDummyBinding=!1,this.keyYOffset=void 0,this.arrow=void 0,this.getArrow=()=>this.arrow,this.updatePosition=(e,t)=>{this._x=e+h.FramePaddingX,this._y=t+this.offsetY,this.key.updatePosition(this.x(),this.y()+this.keyYOffset),Q(this.value,this)&&this.value.updatePosition()},this.isDummyBinding=Z(this.keyString),this.prevBinding?(this._x=this.prevBinding.x(),this.offsetY=this.prevBinding.offsetY+this.prevBinding.height()+h.TextPaddingY):(this._x=this.frame.x()+h.FramePaddingX,this.offsetY=this.frame.y()+h.FramePaddingY),this._y=this.offsetY,this.keyString+=i?h.ConstantColon:h.VariableColon,this.value=Ie.createValue(t,this),this.isMainReference=Q(this.value,this),this.isMainReference&&this.value.updatePosition(),this.keyYOffset=(this.value instanceof O||this.value instanceof S)&&this.isMainReference?(this.value.height()-h.FontSize)/2:0,this.key=new b(this.keyString,this.x(),this.offsetY+this.keyYOffset,{},n),this._width=this.value instanceof A||!this.isMainReference?this.key.width():this.value.x()+this.value.width()-this.x(),this._hoveredWidth=this._width+(this.value instanceof O||this.value instanceof S?this.value.tooltipWidth:0),this._height=Math.max(this.key.height(),(this.value instanceof O||this.value instanceof S)&&this.isMainReference?this.value.height():0),this.isDummyBinding&&!this.isMainReference&&this.prevBinding&&(this.offsetY=this.prevBinding.offsetY,this._width=this.prevBinding.width(),this._height=this.prevBinding.height()),this._y=this.offsetY}hoveredWidth(){return Ne.getPrintableMode()?this._hoveredWidth:this._width+(this.value instanceof O||this.value instanceof S?this.value.tooltipWidth:0)}exportWidth(){return this._width+(this.value instanceof O||this.value instanceof S?this.value.exportTooltipWidth:0)}draw(){return this.isDummyBinding||this.value instanceof T||this.value instanceof B||this.value instanceof A||(this.arrow=new D(this.key).to(this.value)),Object(g.jsxs)(a.a.Fragment,{children:[this.isDummyBinding?null:this.key.draw(),this.arrow&&this.arrow.draw(),this.value instanceof A||!this.isMainReference?null:this.value.draw()]},Ie.key++)}}function G(e){return"head"in e&&"tail"in e&&"name"in e}function F(e){return"parent"in e&&"children"in e}function H(e){return"root"in e}function V(e){return null===e||(t=e.head,0===Object.keys(t).length);var t}function W(e){return Array.isArray(e)}function $(e){return e&&"[object Function]"==={}.toString.call(e)}function X(e){return $(e)&&"environment"in e&&"functionName"in e}function q(e){return $(e)&&!X(e)}function z(e){return null===e}function Y(e){return"symbol"===typeof e}function K(e){return function(e){return void 0===e}(e)||z(e)||function(e){return"string"===typeof e}(e)||function(e){return"number"===typeof e}(e)||function(e){return"boolean"===typeof e}(e)}function Q(e,t){return e instanceof O?t instanceof U&&e.enclosingEnvNode===t.frame.envTreeNode&&-1!==e.referencedBy.findIndex((e=>e instanceof U&&e===t)):e instanceof S?e.referencedBy.find((e=>e instanceof U))===t:e.referencedBy[0]===t}function J(e,t){return e.referencedBy[0]===t}function Z(e){return/^-?\d+$/.test(e)}function ee(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:`${h.FontStyle} ${h.FontSize}px ${h.FontFamily}`;const n=document.createElement("canvas"),s=n.getContext("2d");if(!s||!e)return 0;s.font=t;const i=e.split("\n").reduce(((e,t)=>s.measureText(e).width>s.measureText(t).width?e:t),""),a=s.measureText(i);return a.width}function te(e){if(X(e))return e.node.params.map((e=>e.name)).join(",");{const t=e.toString();return t.substring(t.indexOf("("),t.indexOf("{")).trim()}}function ne(e){const t=e.toString();if(X(e)){let n="FunctionDeclaration"===e.node.type||"function"===t.substring(0,8)?t.substring(t.indexOf("{")):t.substring(t.indexOf("=")+3);return"{"!==n[0]&&(n="{\n  return "+n+";\n}"),n}return t.substring(t.indexOf("{"))}function se(e){var t;const n=null===(t=e.getStage())||void 0===t?void 0:t.container();n&&(n.style.cursor="pointer")}function ie(e){var t;const n=null===(t=e.getStage())||void 0===t?void 0:t.container();n&&(n.style.cursor="default")}function ae(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e instanceof d.a?Array.from(e.children||[]):[];n.push(e),n.forEach((e=>{e.setAttrs({stroke:e.attrs.stroke?h.HoveredColor.toString():e.attrs.stroke,fill:e.attrs.fill?h.HoveredColor.toString():e.attrs.fill,...t})}))}function re(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e instanceof d.a?Array.from(e.children||[]):[];n.push(e),n.forEach((e=>{e.setAttrs({stroke:e.attrs.stroke?Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString():e.attrs.stroke,fill:e.attrs.fill?Ne.getPrintableMode()?h.SA_BLUE.toString():h.SA_WHITE.toString():e.attrs.fill,...t})}))}function oe(e){return null===e?null:V(e)?oe(e.tail):e}function ce(e,t){$(e)||K(e)||(H(e)&&H(t)?ce(e.root,t.root):F(e)&&F(t)?(ce(e.children,t.children),ce(e.environment,t.environment)):W(e)&&W(t)?e.forEach(((e,n)=>ce(e,t[n]))):G(e)&&G(t)&&(Object.defineProperties(t.head,Object.getOwnPropertyDescriptors(e.head)),ce(e.tail,t.tail)))}function le(e){const t=Object(u.cloneDeep)(e);return ce(e,t),t}function de(e){if(V(e.environment)){const t=[];return e.children.forEach((e=>{t.push(...de(e))})),t}return[e]}class ue extends o{constructor(e){super(),this._path="",this.points=[],this.source=void 0,this.target=void 0,this.onMouseEnter=e=>{let{currentTarget:t}=e;ae(t,{strokeWidth:Number(c.ArrowHoveredStrokeWidth)})},this.onMouseLeave=e=>{let{currentTarget:t}=e;re(t,{strokeWidth:Number(c.ArrowStrokeWidth)})},this.source=e,this.target=void 0,this._x=e.x(),this._y=e.y()}path(){return this._path}to(e){return this.target=e,this._width=Math.abs(e.x()-this.source.x()),this._height=Math.abs(e.y()-this.source.y()),this}calculateSteps(){const e=this.target;return e?[()=>[e.x(),e.y()]]:[]}onClick(){}draw(){const e=this.calculateSteps().reduce(((e,t)=>[...e,...t(e[e.length-2],e[e.length-1])]),[this.source.x(),this.source.y()]);if(e.splice(0,2),this._path+=`M ${e[0]} ${e[1]} `,4===e.length)this._path+=`L ${e[2]} ${e[3]} `;else{let t=0;for(;t<e.length-4;){const[n,s,i,a,r,o]=e.slice(t,t+6),l=i-n,d=r-i,u=a-s,h=o-a,p=Math.min(c.ArrowCornerRadius,Math.max(Math.abs(l),Math.abs(u))/2,Math.max(Math.abs(d),Math.abs(h))/2),g=i-p*Math.sign(l),m=a-p*Math.sign(u),b=i+p*Math.sign(d),f=a+p*Math.sign(h);this._path+=`L ${g} ${m} Q ${i} ${a} ${b} ${f}`,t+=2}}return this._path+=`L ${e[e.length-2]} ${e[e.length-1]} `,Object(g.jsxs)(r.c,{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[Object(i.createElement)(r.g,{...l,stroke:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString(),strokeWidth:Number(c.ArrowStrokeWidth),hitStrokeWidth:Number(c.ArrowHitStrokeWidth),data:this.path(),key:Ie.key++}),Object(i.createElement)(r.a,{...l,points:e.slice(e.length-4),fill:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString(),strokeEnabled:!1,pointerWidth:Number(c.ArrowHeadSize),key:Ie.key++})]},Ie.key++)}}class he extends ue{calculateSteps(){const e=this.target;if(!e)return[];const t=[(e,t)=>[e+c.FramePaddingX,t]];return e instanceof Ae&&(t.push(((e,t)=>[e,t-c.FrameMarginY])),t.push(((t,n)=>[e.x()+c.FramePaddingX,n]))),t.push(((t,n)=>[e.x()+c.FramePaddingX,e.y()+e.height()])),t}}class pe extends o{constructor(e){super(),this.parent=e,this.value=null,this.data=[],this.updatePosition=()=>{this._x=this.parent.x(),this._y=this.parent.y()},this._x=this.parent.x(),this._y=this.parent.y(),this._height=this.parent.height(),this._width=this.parent.width()}x(){return this._x}y(){return this._y}height(){return this._height}width(){return this._width}reset(){}draw(){return Object(i.createElement)(r.h,{...l,key:Ie.key++,x:this.x(),y:this.y(),width:this.width(),height:this.height(),stroke:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString(),ref:this.ref})}}class ge extends ue{calculateSteps(){const e=this.source,t=this.target;if(!t)return[];const n=[(e,t)=>[e+3*c.FnRadius,t]];return t.y()<e.y()&&e.y()<t.y()+t.height()?(n.push(((e,t)=>[e,t-2*c.FnRadius])),n.push(((n,s)=>[t.x()+(e.x()<t.x()?0:t.width()),s]))):n.push((()=>[t.x()+t.width()/2,t.y()+(t.y()<e.y()?t.height():0)])),n}}class me extends o{constructor(){super(...arguments),this.referencedBy=[],this.data=void 0}addReference(e){this.referencedBy.push(e)}}class be extends me{constructor(e,t){super(),this.data=e,this.referencedBy=t,this.radius=c.FnRadius,this.innerRadius=c.FnInnerRadius,this.tooltipWidth=void 0,this.centerX=void 0,this.fnName=void 0,this.paramsText=void 0,this.bodyText=void 0,this.exportBodyText=void 0,this.tooltip=void 0,this.exportTooltip=void 0,this.exportTooltipWidth=void 0,this._arrow=void 0,this.enclosingEnvNode=void 0,this.labelRef=a.a.createRef(),this.onMouseEnter=e=>{let{currentTarget:t}=e;Ne.getPrintableMode()||(this.ref.current.moveToTop(),this.labelRef.current.show(),ae(t))},this.onMouseLeave=e=>{let{currentTarget:t}=e;Ne.getPrintableMode()||(this.labelRef.current.hide(),re(t))},Ie.memoizeCompactValue(this);const n=this.referencedBy[0];n instanceof Te?(this._x=n.frame.x()+n.frame.width()+c.FrameMarginX/4,this._y=n.y(),this.centerX=this._x+2*this.radius):(n.isLastUnit?(this._x=n.x()+2*c.DataUnitWidth,this._y=n.y()+c.DataUnitHeight/2-this.radius):(this._x=n.x(),this._y=n.y()+n.parent.height()+c.DataUnitHeight),this.centerX=this._x+c.DataUnitWidth/2,this._x=this.centerX-2*this.radius),this._y+=this.radius,this._width=4*this.radius,this._height=2*this.radius,this.enclosingEnvNode=Ie.environmentTree.getTreeNode(oe(this.data.environment)),this.fnName=this.data.functionName,this.paramsText=`params: (${te(this.data)})`,this.bodyText=`body: ${ne(this.data)}`,this.exportBodyText=(this.bodyText.length>23?this.bodyText.slice(0,20):this.bodyText).split("\n").slice(0,2).join("\n")+" ...",this.tooltip=`${this.paramsText}\n${this.bodyText}`,this.exportTooltip=`${this.paramsText}\n${this.exportBodyText}`,this.tooltipWidth=Math.max(ee(this.paramsText),ee(this.bodyText)),this.exportTooltipWidth=Math.max(ee(this.paramsText),ee(this.exportBodyText))}updatePosition(){}draw(){var e;return this._arrow=this.enclosingEnvNode.compactFrame&&new ge(this).to(this.enclosingEnvNode.compactFrame),Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsxs)(r.c,{onMouseEnter:e=>this.onMouseEnter(e),onMouseLeave:e=>this.onMouseLeave(e),ref:this.ref,children:[Object(i.createElement)(r.b,{...l,key:Ie.key++,x:this.centerX-this.radius,y:this.y(),radius:this.radius,stroke:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString()}),Object(i.createElement)(r.b,{...l,key:Ie.key++,x:this.centerX-this.radius,y:this.y(),radius:this.innerRadius,fill:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString()}),Object(i.createElement)(r.b,{...l,key:Ie.key++,x:this.centerX+this.radius,y:this.y(),radius:this.radius,stroke:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString()}),Object(i.createElement)(r.b,{...l,key:Ie.key++,x:this.centerX+this.radius,y:this.y(),radius:this.innerRadius,fill:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString()})]}),Ne.getPrintableMode()?Object(g.jsxs)(r.d,{x:this.x()+this.width()+2*c.TextPaddingX,y:this.y()-c.TextPaddingY,visible:!0,ref:this.labelRef,children:[Object(g.jsx)(r.k,{stroke:"black",fill:"white",opacity:Number(c.FnTooltipOpacity)}),Object(g.jsx)(r.l,{text:this.exportTooltip,fontFamily:c.FontFamily.toString(),fontSize:Number(c.FontSize),fontStyle:c.FontStyle.toString(),fill:c.SA_BLUE.toString(),padding:5})]}):Object(g.jsxs)(r.d,{x:this.x()+this.width()+2*c.TextPaddingX,y:this.y()-c.TextPaddingY,visible:!1,ref:this.labelRef,children:[Object(g.jsx)(r.k,{stroke:"black",fill:"black",opacity:Number(c.FnTooltipOpacity)}),Object(g.jsx)(r.l,{text:this.tooltip,fontFamily:c.FontFamily.toString(),fontSize:Number(c.FontSize),fontStyle:c.FontStyle.toString(),fill:c.SA_WHITE.toString(),padding:5})]}),null===(e=this._arrow)||void 0===e?void 0:e.draw()]},Ie.key++)}}class fe extends me{constructor(e,t){super(),this.data=e,this.referencedBy=t,this.centerX=void 0,this.tooltipWidth=void 0,this.exportTooltipWidth=void 0,this.radius=c.FnRadius,this.innerRadius=c.FnInnerRadius,this._arrow=void 0,this.paramsText=void 0,this.bodyText=void 0,this.exportBodyText=void 0,this.tooltip=void 0,this.exportTooltip=void 0,this.selected=!1,this.labelRef=a.a.createRef(),this.onMouseEnter=e=>{let{currentTarget:t}=e;Ne.getPrintableMode()||(this.labelRef.current.show(),ae(t))},this.onMouseLeave=e=>{let{currentTarget:t}=e;if(!Ne.getPrintableMode())if(this.selected){var n;const e=null===(n=t.getStage())||void 0===n?void 0:n.container();e&&(e.style.cursor="default")}else this.labelRef.current.hide(),re(t)},this.onClick=e=>{let{currentTarget:t}=e;Ne.getPrintableMode()||(this.selected=!this.selected,this.selected?(this.labelRef.current.show(),ae(t)):(this.labelRef.current.hide(),re(t)))},Ie.memoizeCompactValue(this);const n=this.referencedBy[0];n instanceof Te?(this._x=n.frame.x()+n.frame.width()+c.FrameMarginX/4,this._y=n.y(),this.centerX=this._x+2*this.radius):(n.isLastUnit?(this._x=n.x()+2*c.DataUnitWidth,this._y=n.y()+c.DataUnitHeight/2-this.radius):(this._x=n.x(),this._y=n.y()+n.parent.height()+c.DataUnitHeight),this.centerX=this._x+c.DataUnitWidth/2,this._x=this.centerX-2*this.radius),this._y+=this.radius,this._width=4*this.radius,this._height=2*this.radius,this.paramsText=`params: ${te(this.data)}`,this.bodyText=`body: ${ne(this.data)}`,this.exportBodyText=(this.bodyText.length>23?this.bodyText.slice(0,20):this.bodyText).split("\n").slice(0,2).join("\n")+" ...",this.tooltip=`${this.paramsText}\n${this.bodyText}`,this.exportTooltip=`${this.paramsText}\n${this.exportBodyText}`,this.tooltipWidth=Math.max(ee(this.paramsText),ee(this.bodyText))+c.TextPaddingX,this.exportTooltipWidth=Math.max(ee(this.paramsText),ee(this.exportBodyText))}isSelected(){return this.selected}arrow(){return this._arrow}updatePosition(){const e=this.referencedBy.find((e=>e instanceof Te))||this.referencedBy[0];e instanceof Te?(this._x=e.frame.x()+e.frame.width()+c.FrameMarginX/4,this._y=e.y(),this.centerX=this._x+2*this.radius):(e.isLastUnit?(this._x=e.x()+2*c.DataUnitWidth,this._y=e.y()+c.DataUnitHeight/2-this.radius):(this._x=e.x(),this._y=e.y()+e.parent.height()+c.DataUnitHeight),this.centerX=this._x+c.DataUnitWidth/2,this._x=this.centerX-2*this.radius),this._y+=this.radius}draw(){return this._isDrawn=!0,this._arrow=Ie.globalEnvNode.compactFrame&&new ge(this).to(Ie.globalEnvNode.compactFrame),Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsxs)(r.c,{onMouseEnter:e=>this.onMouseEnter(e),onMouseLeave:e=>this.onMouseLeave(e),onClick:e=>this.onClick(e),ref:this.ref,children:[Object(i.createElement)(r.b,{...l,key:Ie.key++,x:this.centerX-this.radius,y:this.y(),radius:this.radius,stroke:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString()}),Object(i.createElement)(r.b,{...l,key:Ie.key++,x:this.centerX-this.radius,y:this.y(),radius:this.innerRadius,fill:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString()}),Object(i.createElement)(r.b,{...l,key:Ie.key++,x:this.centerX+this.radius,y:this.y(),radius:this.radius,stroke:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString()}),Object(i.createElement)(r.b,{...l,key:Ie.key++,x:this.centerX+this.radius,y:this.y(),radius:this.innerRadius,fill:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString()})]}),Ne.getPrintableMode()?Object(g.jsxs)(r.d,{x:this.x()+this.width()+2*c.TextPaddingX,y:this.y()-c.TextPaddingY,visible:!0,ref:this.labelRef,children:[Object(g.jsx)(r.k,{stroke:"black",fill:"white",opacity:Number(c.FnTooltipOpacity)}),Object(g.jsx)(r.l,{text:this.exportTooltip,fontFamily:c.FontFamily.toString(),fontSize:Number(c.FontSize),fontStyle:c.FontStyle.toString(),fill:c.SA_BLUE.toString(),padding:5})]}):Object(g.jsxs)(r.d,{x:this.x()+this.width()+2*c.TextPaddingX,y:this.y()-c.TextPaddingY,visible:!1,ref:this.labelRef,children:[Object(g.jsx)(r.k,{stroke:"black",fill:"black",opacity:Number(c.FnTooltipOpacity)}),Object(g.jsx)(r.l,{text:this.tooltip,fontFamily:c.FontFamily.toString(),fontSize:Number(c.FontSize),fontStyle:c.FontStyle.toString(),fill:c.SA_WHITE.toString(),padding:5})]}),Ie.globalEnvNode.compactFrame&&new ge(this).to(Ie.globalEnvNode.compactFrame).draw()]},Ie.key++)}}class ve extends ue{calculateSteps(){const e=this.source,t=this.target;if(!t)return[];const n=[(e,t)=>[e+c.DataUnitWidth/2,t+c.DataUnitHeight/2]];return t instanceof be||t instanceof fe?n.push((()=>[e.x()<t.x()?t.x():t.centerX,t.y()])):t instanceof we&&(e.y()===t.y()?Math.abs(e.x()-t.x())>2*c.DataUnitWidth?(n.push(((e,t)=>[e,t-c.DataUnitHeight])),n.push((()=>[t.x()+c.DataUnitWidth/2,t.y()-c.DataUnitHeight/2])),n.push(((e,t)=>[e,t+c.DataUnitHeight/2]))):n.push((()=>[t.x(),t.y()+c.DataUnitHeight/2])):n.push((()=>[t.x()+c.DataUnitWidth/2,t.y()+(e.y()>t.y()?c.DataUnitHeight:0)]))),n}}class ye extends o{constructor(e){super(),this.arrayUnit=void 0,this.referencedBy=void 0,this.updatePosition=()=>{},this.referencedBy=e,this.arrayUnit=e[0],this._x=this.arrayUnit.x(),this._y=this.arrayUnit.y(),this._height=this.arrayUnit.height(),this._width=this.arrayUnit.width()}draw(){return Object(i.createElement)(r.f,{...l,key:Ie.key++,points:[this.x(),this.y()+this.height(),this.x()+this.width(),this.y()],stroke:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString(),hitStrokeWidth:Number(c.DataHitStrokeWidth),ref:this.ref,listening:!1})}}const je={maxWidth:Number.MAX_VALUE,fontFamily:c.FontFamily.toString(),fontSize:Number(c.FontSize),fontStyle:c.FontStyle.toString(),fontVariant:c.FontVariant.toString(),isStringIdentifiable:!1};class xe extends o{constructor(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.data=e,this._x=t,this._y=n,this._height=void 0,this._width=void 0,this.partialStr=void 0,this.fullStr=void 0,this.options=je,this.onMouseEnter=e=>{var t,n;let{currentTarget:s}=e;const i=null===(t=s.getStage())||void 0===t?void 0:t.container();i&&(i.style.cursor="pointer"),this.ref.current.moveToTop(),this.ref.current.show(),null===(n=s.getLayer())||void 0===n||n.draw()},this.onMouseLeave=e=>{var t,n;let{currentTarget:s}=e;const i=null===(t=s.getStage())||void 0===t?void 0:t.container();i&&(i.style.cursor="default"),this.ref.current.hide(),null===(n=s.getLayer())||void 0===n||n.draw()},this.options={...this.options,...s};const{fontSize:i,fontStyle:a,fontFamily:r,maxWidth:o,isStringIdentifiable:l}=this.options;this.fullStr=this.partialStr=l&&JSON.stringify(e)||String(e),this._height=i;const d=e=>ee(e,`${a} ${i}px ${r}`);if(d(this.partialStr)>o){let e=c.Ellipsis.toString(),t=0;for(;d(this.partialStr.substring(0,t)+c.Ellipsis.toString())<o;)e=this.partialStr.substring(0,t++)+c.Ellipsis.toString();this._width=d(e),this.partialStr=e}else this._width=Math.max(c.TextMinWidth,d(this.partialStr))}draw(){const e={fontFamily:this.options.fontFamily,fontSize:this.options.fontSize,fontStyle:this.options.fontStyle,fill:c.SA_WHITE.toString()};return Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsx)(r.d,{x:this.x(),y:this.y(),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:Object(i.createElement)(r.l,{...l,key:Ie.key++,text:this.partialStr,...e})}),Object(g.jsxs)(r.d,{x:this.x(),y:this.y(),ref:this.ref,visible:!1,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[Object(g.jsx)(r.k,{...l,fill:"black",opacity:.5}),Object(i.createElement)(r.l,{...l,key:Ie.key++,text:this.fullStr,...e})]})]},Ie.key++)}}class Oe extends me{constructor(e,t){super(),this.data=e,this.referencedBy=t,this.text=void 0;const n=this.referencedBy[0];if(n instanceof Te)this._x=n.x()+ee(n.keyString)+c.TextPaddingX,this._y=n.y(),this.text=new xe(this.data,this.x(),this.y(),{isStringIdentifiable:!0});else{const e=n.width(),t=Math.min(ee(String(this.data)),e);this._x=n.x()+(n.width()-t)/2,this._y=n.y()+(n.height()-c.FontSize)/2,this.text=z(this.data)?new ye([n]):new xe(this.data,this.x(),this.y(),{maxWidth:e,isStringIdentifiable:!0})}this._width=this.text.width(),this._height=this.text.height()}updatePosition(){}draw(){return Object(g.jsx)(a.a.Fragment,{children:this.text.draw()},Ie.key++)}}class Se extends o{constructor(e,t,n){super(),this.idx=e,this.data=t,this.value=void 0,this.isFirstUnit=void 0,this.isLastUnit=void 0,this.isMainReference=void 0,this.parent=void 0,this.arrow=void 0,this.updatePosition=()=>{},this.onMouseEnter=e=>{let{currentTarget:t}=e;ae(t)},this.onMouseLeave=e=>{let{currentTarget:t}=e;re(t)},this.parent=n,this._x=this.parent.x()+this.idx*c.DataUnitWidth,this._y=this.parent.y(),this._height=c.DataUnitHeight,this._width=c.DataUnitWidth,this.isFirstUnit=0===this.idx,this.isLastUnit=this.idx===this.parent.data.length-1,this.value=Ie.createCompactValue(this.data,this),this.isMainReference=this.value.referencedBy.length>1}draw(){if(this.isDrawn())return null;this._isDrawn=!0;const e={upperLeft:0,lowerLeft:0,upperRight:0,lowerRight:0};return this.isFirstUnit&&(e.upperLeft=e.lowerLeft=Number(c.DataCornerRadius)),this.isLastUnit&&(e.upperRight=e.lowerRight=Number(c.DataCornerRadius)),Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsx)(C,{x:this.x(),y:this.y(),width:this.width(),height:this.height(),stroke:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString(),hitStrokeWidth:Number(c.DataHitStrokeWidth),fillEnabled:!1,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,cornerRadius:e,forwardRef:this.ref},Ie.key++),this.value.draw(),this.value instanceof Oe||new ve(this).to(this.value).draw()]},Ie.key++)}}class we extends me{constructor(e,t){super(),this.data=e,this.referencedBy=t,this.units=[],Ie.memoizeCompactValue(this);const n=this.referencedBy[0];n instanceof Te?(this._x=n.frame.x()+n.frame.width()+c.FrameMarginX,this._y=n.y()):n.isLastUnit?(this._x=n.x()+2*c.DataUnitWidth,this._y=n.y()):(this._x=n.x(),this._y=n.y()+n.parent.height()+c.DataUnitHeight),this._width=this.data.length*c.DataUnitWidth+c.DataMinWidth,this._height=c.DataUnitHeight;for(let s=this.data.length-1;s>=0;s--){const e=new Se(s,this.data[s],this);this._width=Math.max(this.width(),e.value.width()+(e.value instanceof Oe||s!==this.data.length-1?s*c.DataUnitWidth:(s+1)*c.DataUnitWidth+c.DataUnitWidth)),this._height=Math.max(this._height,e.value instanceof Oe||e.isMainReference?c.DataUnitHeight:e.value.y()+e.value.height()-e.y()),this.units=[e,...this.units]}}reset(){super.reset(),this.units.map((e=>e.reset())),this.referencedBy.length=0}updatePosition(){}draw(){return this.isDrawn()?null:(this._isDrawn=!0,Object(g.jsx)(a.a.Fragment,{children:this.units.length>0?this.units.map((e=>e.draw())):new pe(this).draw()},Ie.key++))}}class Ce extends ue{calculateSteps(){const e=this.source,t=this.target;if(!t)return[];const n=[(t,n)=>[t+e.width(),n+e.height()/2]];return t.x()<e.x()?t instanceof we?(n.push(((e,t)=>[e+c.TextMargin,t])),n.push(((e,n)=>[e,t.y()-c.DataUnitHeight/3])),n.push(((e,n)=>[t.x()+c.DataUnitWidth/2,n])),n.push(((e,n)=>[e,t.y()]))):(n.push(((e,t)=>[e+c.TextMargin,t])),n.push(((t,n)=>[t,n-e.height()/2-c.TextMargin])),n.push(((e,n)=>[t.x()+t.width()+c.ArrowHeadSize,n])),n.push(((e,n)=>[e,t.y()])),n.push(((e,t)=>[e-c.ArrowHeadSize,t]))):n.push(((e,n)=>[t.x(),t.y()+(t instanceof we?c.DataUnitHeight/2:0)])),n}}class Ee extends me{constructor(e){super(),this.referencedBy=e,this.data=Symbol(),this.text=void 0;const t=this.referencedBy[0];if(t instanceof Te)this._x=t.x()+ee(t.keyString)+c.TextPaddingX,this._y=t.y(),this.text=new xe(c.UnassignedData.toString(),this._x,this._y,{isStringIdentifiable:!1});else{const e=t.width(),n=Math.min(ee(String(this.data)),e);this._x=t.x()+(t.width()-n)/2,this._y=t.y()+(t.height()-c.FontSize)/2,this.text=new xe(c.UnassignedData.toString(),this._x,this._y,{maxWidth:e,isStringIdentifiable:!1})}this._width=this.text.width(),this._height=this.text.height()}reset(){super.reset(),this.referencedBy.length=0}updatePosition(){}draw(){return this._isDrawn=!0,Object(g.jsx)(a.a.Fragment,{children:this.text.draw()},Ie.key++)}}class Te extends o{constructor(e,t,n,s){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.keyString=e,this.data=t,this.frame=n,this.prevBinding=s,this.isConstant=i,this.value=void 0,this.key=void 0,this.isDummyBinding=!1,this.arrow=void 0,this.getArrow=()=>this.arrow,this.isDummyBinding=Z(this.keyString),this.prevBinding?(this._x=this.prevBinding.x(),this._y=this.prevBinding.y()+this.prevBinding.height()+c.TextPaddingY):(this._x=this.frame.x()+c.FramePaddingX,this._y=this.frame.y()+c.FramePaddingY),this.keyString+=i?c.ConstantColon:c.VariableColon,this.value=Ie.createCompactValue(t,this);const a=this.value instanceof we?(c.DataUnitHeight-c.FontSize)/2:(this.value.height()-c.FontSize)/2;this.key=new xe(this.keyString,this.x(),this.y()+a),this._width=J(this.value,this)?this.value.x()+this.value.width()-this.x()+(this.value instanceof be||this.value instanceof fe?this.value.tooltipWidth:0):this.key.width(),this._height=Math.max(this.key.height(),this.value.height()),this.isDummyBinding&&!J(this.value,this)&&this.prevBinding&&(this._y=this.prevBinding.y(),this._width=this.prevBinding.width(),this._height=this.prevBinding.height())}draw(){return Object(g.jsxs)(a.a.Fragment,{children:[this.isDummyBinding?null:this.key.draw(),this.isDummyBinding||this.value instanceof Oe||this.value instanceof Ee?null:new Ce(this.key).to(this.value).draw(),J(this.value,this)?this.value.draw():null]},Ie.key++)}}const ke=new Map([["global","Global"],["programEnvironment","Program"],["forLoopEnvironment","Body of for-loop"],["forBlockEnvironment","Control variable of for-loop"],["blockEnvironment","Block"],["functionBodyEnvironment","Function Body"]]);class Ae extends o{constructor(e,t){var n;super(),this.envTreeNode=e,this.leftSiblingFrame=t,this.totalHeight=void 0,this.totalWidth=void 0,this.bindings=[],this.name=void 0,this.level=void 0,this.environment=void 0,this.parentFrame=void 0,this.onMouseEnter=e=>{let{currentTarget:t}=e;ae(t)},this.onMouseLeave=e=>{let{currentTarget:t}=e;re(t)},this._width=c.FrameMinWidth,this.level=e.compactLevel,this.environment=e.environment,this.parentFrame=null===(n=e.parent)||void 0===n?void 0:n.compactFrame,this._x=this.level.x(),this.leftSiblingFrame&&(this._x+=this.leftSiblingFrame.x()+this.leftSiblingFrame.totalWidth+c.FrameMarginX),this.name=new xe(ke.get(this.environment.name)||this.environment.name,this.x(),this.level.y(),{maxWidth:this.width()}),this._y=this.level.y()+this.name.height()+c.TextPaddingY/2;let s=0;for(const[d,u]of Object.entries(this.environment.head)){const e=Math.max(c.TextMinWidth,ee(d+c.ConstantColon))+c.TextPaddingX+(Y(u)?Math.max(c.TextMinWidth,ee(c.UnassignedData.toString())):K(u)?Math.max(c.TextMinWidth,ee(String(u))):0);s=Math.max(s,e)}this._width=s+2*c.FramePaddingX;let i=null,a=this._width;const r=Object.getOwnPropertyDescriptors(this.environment.head),o=[],l=[];for(const d of Object.entries(r))if(Z(d[0])){const e=oe(d[1].value.environment);(this.environment.id===c.GlobalEnvId||e&&e.id===this.environment.id)&&l.push(d)}else o.push(d);o.push(...l);for(const[d,u]of o){const e=new Te(d,u.value,this,i,!u.writable);this.bindings.push(e),i=e,a=Math.max(a,e.width()+c.FramePaddingX)}this.totalWidth=a,this._height=i?i.y()+i.height()+c.FramePaddingY-this.y():2*c.FramePaddingY,this.totalHeight=this.height()+this.name.height()+c.TextPaddingY/2}draw(){return Object(g.jsxs)(r.c,{children:[this.name.draw(),Object(i.createElement)(r.h,{...l,x:this.x(),y:this.y(),width:this.width(),height:this.height(),stroke:Ne.getPrintableMode()?c.SA_BLUE.toString():c.SA_WHITE.toString(),cornerRadius:Number(c.FrameCornerRadius),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,key:Ie.key++}),this.bindings.map((e=>e.draw())),this.parentFrame&&new he(this).to(this.parentFrame).draw()]},Ie.key++)}}class _e extends o{constructor(e,t){super(),this.parentLevel=e,this.envTreeNodes=t,this.frames=[],this._x=c.CanvasPaddingX,this._y=c.CanvasPaddingY,this.parentLevel&&(this._y+=this.parentLevel.height()+this.parentLevel.y());let n=null;t.forEach((e=>{e.compactLevel=this;const t=new Ae(e,n);e.compactFrame=t,this.frames.push(t),n=t})),this._height=this.frames.reduce(((e,t)=>Math.max(e,t.totalHeight)),0);const s=this.frames[this.frames.length-1];this._width=s.x()+s.totalWidth-this.x()+c.LevelPaddingX}destroy(){this.ref.current.destroyChildren()}draw(){return Object(g.jsxs)(r.c,{ref:this.ref,children:[Object(i.createElement)(r.h,{...l,x:this.x(),y:this.y(),width:this.width(),height:this.height(),key:Ie.key++,listening:!1}),this.frames.map((e=>e.draw()))]},Ie.key++)}}class Ie{static updateDimensions(e,t){Ie.visibleWidth=e,Ie.visibleHeight=t,null!==Ie.stageRef.current&&(Math.min(Ie.width(),window.innerWidth)>Ie.stageWidth||Math.min(Ie.height(),window.innerHeight)>Ie.stageHeight)&&(Ie.currentLight=void 0,Ie.currentDark=void 0,Ie.currentCompactLight=void 0,Ie.currentCompactDark=void 0,Ie.stageWidth=Math.min(Ie.width(),window.innerWidth),Ie.stageHeight=Math.min(Ie.height(),window.innerHeight),Ie.stageRef.current.width(Ie.stageWidth),Ie.stageRef.current.height(Ie.stageHeight),Ne.redraw()),Ie.stageHeight,Ie.visibleHeight,Ie.invisiblePaddingVertical=Ie.stageHeight>Ie.visibleHeight?(Ie.stageHeight-Ie.visibleHeight)/2:0,Ie.invisiblePaddingHorizontal=Ie.stageWidth>Ie.visibleWidth?(Ie.stageWidth-Ie.visibleWidth)/2:0;const n=this.scrollContainerRef.current;n&&(n.style.width=`${Ie.visibleWidth}px`,n.style.height=`${Ie.visibleHeight}px`)}static setContext(e){if(Ie.currentLight=void 0,Ie.currentDark=void 0,Ie.currentCompactLight=void 0,Ie.currentCompactDark=void 0,Ie.values.forEach(((e,t)=>{e.reset()})),Ie.values.clear(),Ie.compactValues.forEach(((e,t)=>{e.reset()})),Ie.compactValues.clear(),Ie.key=0,Ie.environmentTree=le(e),Ie.globalEnvNode=Ie.environmentTree.root,Ie.removeProgramEnv(),Ie.removeUnreferencedGlobalFns(),Ie.initializeGrid(),Ne.getCompactLayout()){const e=Ie.compactLevels[Ie.compactLevels.length-1];Ie.compactHeight=Math.max(h.CanvasMinHeight,e.y()+e.height()+h.CanvasPaddingY),Ie.compactWidth=Math.max(h.CanvasMinWidth,Ie.compactLevels.reduce(((e,t)=>Math.max(e,t.width())),0)+2*h.CanvasPaddingX)}else Ie.nonCompactHeight=Math.max(h.CanvasMinHeight,this.grid.height()+h.CanvasPaddingY),Ie.nonCompactWidth=Math.max(h.CanvasMinWidth,this.grid.width()+2*h.CanvasPaddingX)}static removeProgramEnv(){if(!Ie.globalEnvNode.children)return;const e=Ie.globalEnvNode.children[0],t=Ie.globalEnvNode;t.environment.head={...e.environment.head,...t.environment.head},e.children&&t.resetChildren(e.children);for(const n of Object.values(t.environment.head))X(n)&&delete n.functionName}static removeUnreferencedGlobalFns(){const e=new Set,t=new Set,n=t=>{for(const n of Object.values(t.environment.head))q(n)?e.add(n):W(n)&&s(n);t.children&&t.children.forEach(n)},s=n=>{n.forEach((n=>{q(n)?e.add(n):W(n)&&!t.has(n)&&(t.add(n),s(n))}))};Ie.globalEnvNode.children&&Ie.globalEnvNode.children.forEach(n);const i={};for(const[a,r]of Object.entries(Ie.globalEnvNode.environment.head))(e.has(r)||Z(a))&&(i[a]=r);Ie.globalEnvNode.environment.head={[h.GlobalFrameDefaultText]:Symbol(),...i}}static width(){return Ne.getCompactLayout()?Ie.compactWidth:Ie.nonCompactWidth}static height(){return Ne.getCompactLayout()?Ie.compactHeight:Ie.nonCompactHeight}static initializeGrid(){if(Ne.getCompactLayout()){this.compactLevels=[];let e,t=[Ie.globalEnvNode],n=null;for(;t.length>0;){e=new _e(n,t),this.compactLevels.push(e);const s=[];t.forEach((e=>{e.children.forEach((t=>{const n=de(t);n.forEach((t=>t.parent=e)),s.push(...n)}))})),n=e,t=s}}else{const e=[];let t=[Ie.globalEnvNode];for(;t.length>0;){e.push(t);const n=[];t.forEach((e=>{e.children.forEach((t=>{const s=de(t);s.forEach((t=>t.parent=e)),n.push(...s)}))})),t=n}void 0===this.grid?this.grid=new M(e):this.grid.update(e)}}static memoizeValue(e){Ie.values.set(e.data,e)}static createValue(e,t){if(Y(e))return new B([t]);if(K(e))return new T(e,[t]);{const n=Ie.values.get(e);if(n)return n.addReference(t),n;let s=new T(null,[t]);return W(e)?s=new A(e,[t]):$(e)&&(s=X(e)?new O(e,[t]):new S(e,[t])),s}}static memoizeCompactValue(e){Ie.compactValues.set(e.data,e)}static createCompactValue(e,t){if(Y(e))return new Ee([t]);if(K(e))return new Oe(e,[t]);{const n=Ie.compactValues.get(e);if(n)return n.addReference(t),n;let s=new Oe(null,[t]);return W(e)?s=new we(e,[t]):$(e)&&(s=X(e)?new be(e,[t]):new fe(e,[t])),s}}static saveButtonText(){return"Save "+(Ie.width()>h.MaxExportWidth||Ie.height()>h.MaxExportHeight?Math.ceil(Ie.width()/h.MaxExportWidth)*Math.ceil(Ie.height()/h.MaxExportHeight)+" images":"image")}static handleScrollPosition(e,t){const n=e-Ie.invisiblePaddingHorizontal,s=t-Ie.invisiblePaddingVertical;this.stageRef.current.container().style.transform="translate("+n+"px, "+s+"px)",this.stageRef.current.x(-n),this.stageRef.current.y(-s)}static draw(){if(0!==Ie.key)return Ie.prevLayout;{const e=Object(g.jsx)("div",{className:"sa-env-visualizer",children:Object(g.jsx)("div",{id:"scroll-container",ref:Ie.scrollContainerRef,onScroll:e=>Ie.handleScrollPosition(e.currentTarget.scrollLeft,e.currentTarget.scrollTop),style:{width:Ie.visibleWidth,height:Ie.visibleHeight,overflow:"auto",margin:"10px"},children:Object(g.jsxs)("div",{id:"large-container",style:{width:Ie.width(),height:Ie.height(),overflow:"hidden",backgroundColor:Ne.getPrintableMode()?h.PRINT_BACKGROUND.toString():h.SA_BLUE.toString()},children:[Object(g.jsx)("div",{style:{right:40,position:"absolute",display:"flex",alignSelf:"right"},children:Object(g.jsxs)(s.c,{vertical:!0,children:[Object(g.jsx)(s.b,{large:!0,outlined:!0,style:{backgroundColor:Ne.getPrintableMode()?h.PRINT_BACKGROUND.toString():h.SA_BLUE.toString(),opacity:.8,borderColor:Ne.getPrintableMode()?h.SA_BLUE.toString():h.PRINT_BACKGROUND.toString()},onMouseUp:()=>{Ne.toggleCompactLayout(),Ne.redraw()},children:Object(g.jsx)(s.f,{checked:!Ne.getCompactLayout(),label:"Experimental",style:{marginBottom:"0px",color:Ne.getPrintableMode()?h.SA_BLUE.toString():h.PRINT_BACKGROUND.toString()}})}),Object(g.jsx)(s.b,{large:!0,outlined:!0,style:{backgroundColor:Ne.getPrintableMode()?h.PRINT_BACKGROUND.toString():h.SA_BLUE.toString(),opacity:.8,borderColor:Ne.getPrintableMode()?h.SA_BLUE.toString():h.PRINT_BACKGROUND.toString()},onMouseUp:()=>{Ne.togglePrintableMode(),Ne.redraw()},children:Object(g.jsx)(s.f,{checked:Ne.getPrintableMode(),label:"Printable",style:{marginBottom:"0px",color:Ne.getPrintableMode()?h.SA_BLUE.toString():h.PRINT_BACKGROUND.toString()}})}),Object(g.jsx)(s.b,{outlined:!0,text:Ie.saveButtonText(),large:!0,onClick:this.exportImage,style:{color:Ne.getPrintableMode()?h.SA_BLUE.toString():h.PRINT_BACKGROUND.toString(),backgroundColor:Ne.getPrintableMode()?h.PRINT_BACKGROUND.toString():h.SA_BLUE.toString(),opacity:.8,borderColor:Ne.getPrintableMode()?h.SA_BLUE.toString():h.PRINT_BACKGROUND.toString()}})]})}),Object(g.jsx)(r.j,{width:Ie.stageWidth,height:Ie.stageHeight,ref:this.stageRef,children:Object(g.jsxs)(r.e,{children:[Object(i.createElement)(r.h,{...p,x:0,y:0,width:Ie.width(),height:Ie.height(),fill:Ne.getPrintableMode()?h.PRINT_BACKGROUND.toString():h.SA_BLUE.toString(),key:Ie.key++,listening:!1}),!Ne.getCompactLayout()&&Ie.grid.draw(),Ne.getCompactLayout()&&Ie.compactLevels.map((e=>e.draw()))]})})]})})});return Ie.prevLayout=e,Ne.getCompactLayout()?Ne.getPrintableMode()?Ie.currentCompactLight=e:Ie.currentCompactDark=e:Ne.getPrintableMode()?Ie.currentLight=e:Ie.currentDark=e,e}}}Ie.nonCompactHeight=void 0,Ie.nonCompactWidth=void 0,Ie.compactWidth=void 0,Ie.compactHeight=void 0,Ie.visibleHeight=window.innerHeight,Ie.visibleWidth=window.innerWidth,Ie.stageHeight=window.innerHeight,Ie.stageWidth=window.innerWidth,Ie.key=0,Ie.environmentTree=void 0,Ie.globalEnvNode=void 0,Ie.grid=void 0,Ie.compactLevels=[],Ie.values=new Map,Ie.compactValues=new Map,Ie.prevLayout=void 0,Ie.currentDark=void 0,Ie.currentLight=void 0,Ie.currentCompactDark=void 0,Ie.currentCompactLight=void 0,Ie.stageRef=a.a.createRef(),Ie.invisiblePaddingVertical=300,Ie.invisiblePaddingHorizontal=300,Ie.scrollContainerRef=a.a.createRef(),Ie.exportImage=()=>{Ie.scrollContainerRef.current.scrollTo({left:0,top:0}),Ie.handleScrollPosition(0,0);const e=Ie.height(),t=Ie.width(),n=Math.ceil(t/h.MaxExportWidth),s=Math.ceil(e/h.MaxExportHeight);(()=>{const i=a=>{if(a>=n*s)return;const r=a%n,o=Math.floor(a/n),c=document.createElement("a");c.style.display="none",c.href=Ie.stageRef.current.toDataURL({x:r*h.MaxExportWidth+Ie.invisiblePaddingHorizontal,y:o*h.MaxExportHeight+Ie.invisiblePaddingVertical,width:Math.min(t-r*h.MaxExportWidth,h.MaxExportWidth),height:Math.min(e-o*h.MaxExportHeight,h.MaxExportHeight),mimeType:"image/jpeg"}),c.download=`diagram_${r}_${o}.jpg`,document.body.appendChild(c),c.click(),document.body.removeChild(c),setTimeout((function(){i(a+1)}),1e3)};i(0)})()};class Ne{static togglePrintableMode(){Ne.printableMode=!Ne.printableMode}static toggleCompactLayout(){Ne.compactLayout=!Ne.compactLayout}static getPrintableMode(){return Ne.printableMode}static getCompactLayout(){return Ne.compactLayout}static init(e,t,n){Ie.visibleHeight=n,Ie.visibleWidth=t,this.setVis=e}static clear(){Ie.values.clear(),Ie.compactValues.clear()}static drawEnv(e){if(Ne.environmentTree=le(e.runtime.environmentTree),!this.setVis)throw new Error("env visualizer not initialized");Ie.setContext(e.runtime.environmentTree),this.setVis(Ie.draw()),Ie.updateDimensions(Ie.visibleWidth,Ie.visibleHeight);const t=document.getElementById("env_visualizer-icon");t&&t.classList.add("side-content-tab-alert")}static redraw(){this.environmentTree&&(Ne.getCompactLayout()&&Ne.getPrintableMode()&&void 0!==Ie.currentCompactLight?this.setVis(Ie.currentCompactLight):Ne.getCompactLayout()&&!Ne.getPrintableMode()&&void 0!==Ie.currentCompactDark?this.setVis(Ie.currentCompactDark):!Ne.getCompactLayout()&&Ne.getPrintableMode()&&void 0!==Ie.currentLight?this.setVis(Ie.currentLight):Ne.getCompactLayout()||Ne.getPrintableMode()||void 0===Ie.currentDark?(Ie.setContext(Ne.environmentTree),this.setVis(Ie.draw())):this.setVis(Ie.currentDark),Ie.updateDimensions(Ie.visibleWidth,Ie.visibleHeight))}static updateDimensions(e,t){null!=Ie.stageRef&&null!==e&&null!==t&&Ie.updateDimensions(e,t)}}Ne.setVis=void 0,Ne.printableMode=!1,Ne.compactLayout=!0,Ne.environmentTree=void 0},16:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var s=n(27),i=n(64),a=n.n(i);function r(e,t){return"undefined"===typeof e&&"undefined"!==typeof t?t:"string"===typeof e&&"TRUE"===e.toUpperCase()}const o=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_VERSION||"local",c=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_ENVIRONMENT||"dev",l=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_DEPLOYMENT_NAME||"Source Academy",d=r(Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_SHOW_RESEARCH_PROMPT),u=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_BACKEND_URL,h=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_CADET_LOGGER,p=parseInt(Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_CADET_LOGGER_INTERVAL||"10000",10),g=r(Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_USE_BACKEND),m=s.Chapter.CALC,b=s.Variant.DEFAULT,f=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_URL_SHORTENER_BASE,v=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_URL_SHORTENER_SIGNATURE,y=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_MODULE_BACKEND_URL||"modules",j=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_SHAREDB_BACKEND_URL||"",x=r(Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_PLAYGROUND_ONLY,!0),O=r(Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_ENABLE_GITHUB_ASSESSMENTS),S=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_SENTRY_DSN,w=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_GOOGLE_CLIENT_ID,C=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_GOOGLE_API_KEY,E=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_GOOGLE_APP_ID,T=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_GITHUB_CLIENT_ID||"",k=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_GITHUB_OAUTH_PROXY_URL||"",A=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_SICPJS_BACKEND_URL||"https://sicp.sourceacademy.org/",_=parseInt(Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_CA_FULFILLMENT_LEVEL||"0"),I=new Map;for(let M=1;;++M){const e=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0})[`REACT_APP_OAUTH2_PROVIDER${M}`];if(!e)break;const t=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0})[`REACT_APP_OAUTH2_PROVIDER${M}_NAME`]||"Unnamed provider",n=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0})[`REACT_APP_OAUTH2_PROVIDER${M}_ENDPOINT`]||"";I.set(e,{name:t,endpoint:n,isDefault:1===M})}const N=[];for(let M=1;;++M){const e=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0})[`REACT_APP_DISABLE${M}_START`],t=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0})[`REACT_APP_DISABLE${M}_END`];if(!e||!t)break;const n=Object({NODE_ENV:"production",PUBLIC_URL:"/c-slang-frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0})[`REACT_APP_DISABLE${M}_REASON`],s=a()(e),i=a()(t);i.isBefore(s)||a()().isAfter(i)||N.push({start:s,end:i,reason:n})}let P;!function(e){e.githubIssues="https://github.com/source-academy/frontend/issues",e.githubOrg="https://github.com/source-academy",e.about="https://about.sourceacademy.org",e.moduleDetails="https://www.comp.nus.edu.sg/~cs1101s",e.luminus="https://luminus.nus.edu.sg/modules/41d42e9a-5880-43b5-8ee6-75f5a41355e3/announcements/active",e.piazza="https://piazza.com/class/kas136yscf8605",e.resourcesForEducators="https://about.sourceacademy.org/educator/README.html",e.resourcesForLearners="https://about.sourceacademy.org/learner/README.html",e.sourceAcademyAssets="https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/",e.sourceDocs="https://docs.sourceacademy.org/",e.techSVC="mailto:techsvc@comp.nus.edu.sg",e.techSVCNumber="6516 2736",e.textbook="https://sourceacademy.org/sicpjs/",e.playground="https://sourceacademy.org/playground",e.textbookChapter2_2="https://sourceacademy.org/sicpjs/2.2",e.textbookChapter3_2="https://sourceacademy.org/sicpjs/3.2",e.aceHotkeys="https://github.com/ajaxorg/ace/wiki/Default-Keyboard-Shortcuts",e.sourceHotkeys="https://github.com/source-academy/frontend/wiki/Source-Academy-Keyboard-Shortcuts",e.source_1="https://docs.sourceacademy.org/source_1/",e.source_1_Lazy="https://docs.sourceacademy.org/source_1_lazy/",e.source_1_Wasm="https://docs.sourceacademy.org/source_1_wasm/",e.source_2="https://docs.sourceacademy.org/source_2/",e.source_2_Lazy="https://docs.sourceacademy.org/source_2_lazy/",e.source_3="https://docs.sourceacademy.org/source_3/",e.source_3_Concurrent="https://docs.sourceacademy.org/source_3_concurrent/",e.source_3_Nondet="https://docs.sourceacademy.org/source_3_non-det/",e.source_4="https://docs.sourceacademy.org/source_4/",e.source_4_Gpu="https://docs.sourceacademy.org/source_4_gpu/",e.ecmaScript_2021="https://262.ecma-international.org/12.0/"}(P||(P={}));const R={sourceAcademyVersion:o,sourceAcademyEnvironment:c,sourceAcademyDeploymentName:l,showResearchPrompt:d,backendUrl:u,cadetLoggerUrl:h,useBackend:g,defaultSourceChapter:m,defaultSourceVariant:b,defaultQuestionId:0,maxBrowseIndex:50,mobileBreakpoint:768,urlShortenerBase:f,urlShortenerSignature:v,moduleBackendUrl:y,authProviders:I,playgroundOnly:x,enableGitHubAssessments:O,sentryDsn:S,googleClientId:w,googleApiKey:C,googleAppId:E,githubClientId:T,githubOAuthProxyUrl:k,sharedbBackendUrl:j,disablePeriods:N,cadetLoggerInterval:p,sicpBackendUrl:A,workspaceSettingsLocalStorageKey:"workspace-settings",caFulfillmentLevel:_};t.b=R},161:function(e,t,n){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.NumericLiteral=void 0;const i=n(126),a=n(117),r=n(369);class o{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.val=e,this.type=t,this.address=n}getValue(){return this.val}getStep(){return this.type instanceof i.PointerType?(0,i.sizeof)(this.type.dereference()):1}toChar(){return String.fromCharCode(this.val)}increment(e,t){return this.assertIsLValue(),this.val+=this.getStep(),e.assignValueByAddress(this.address,this),new o(t?this.val:this.val-this.getStep(),this.type)}decrement(e,t){return this.assertIsLValue(),this.val-=this.getStep(),e.assignValueByAddress(this.address,this),new o(t?this.val:this.val+this.getStep(),this.type)}toBoolean(){return 0!=this.val}castToType(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e==i.PrimitiveType.FUNCTION||e==i.PrimitiveType.VOID)throw new Error("attempt to cast '"+this.type+"' to '"+e+"'");return e.toString()==this.type.toString()||e instanceof i.PointerType&&this.type instanceof i.PointerType?new o(this.val,e,t?this.address:null):this.type==i.PrimitiveType.FLOAT?(this.truncateDecimals(),this.castToType(e,t)):e==i.PrimitiveType.CHAR?new o(this.val%256,e,t?this.address:null):new o(this.val,e,t?this.address:null)}static booleanToNumericLiteral(e){return e?o.new(1):o.new(0)}assign(e,t,n){if(this.assertIsLValue(),"="==n)return e.assignValueByAddress(this.address,t.castToType(this.type)),t;{const s=o.BINARY_ARITHMETIC_OPERATORS.get(n.replace("=",""));if(void 0==s)throw new Error("unknown assign operator: "+n);const i=s(t,this);return e.assignValueByAddress(this.address,i.castToType(this.type)),i}}truncateDecimals(){return this.type=i.PrimitiveType.INT,this.val=Math[this.val<0?"ceil":"floor"](this.val),this}divideBy(e){if(0==e.val)throw new Error("division by 0 is undefined");return o.new(this.val/e.val).castToType((0,r.getHigherPrecisionType)(this.type,e.type))}plus(e){if(this.type instanceof i.PointerType&&e.type instanceof i.PointerType)throw new Error("impossible execution path");return e.type instanceof i.PointerType?e.plus(this):o.new(this.val+e.val*this.getStep()).castToType((0,r.getHigherPrecisionType)(this.type,e.type))}minus(e){return this.type instanceof i.PointerType&&e.type instanceof i.PointerType?o.new((this.val-e.val)/this.getStep()).castToType(i.PrimitiveType.INT):o.new(this.val-e.val*this.getStep()).castToType((0,r.getHigherPrecisionType)(this.type,e.type))}multiply(e){return o.new(this.val*e.val).castToType((0,r.getHigherPrecisionType)(this.type,e.type))}modulo(e){if(0==e.val)throw new Error("remainder by 0 is undefined");return o.new(this.val%e.val).castToType((0,r.getHigherPrecisionType)(this.type,e.type))}sqrt(){return new o(Math.sqrt(this.val),i.PrimitiveType.FLOAT)}abs(){return new o(Math.abs(this.val),i.PrimitiveType.INT)}static new(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new o(e,e%1!=0?i.PrimitiveType.FLOAT:e>=-128&&e<=127?i.PrimitiveType.CHAR:i.PrimitiveType.INT,t)}static parse(e){const t=parseFloat(e);return isNaN(t)?o.new(0):e.includes(".")?new o(t,i.PrimitiveType.FLOAT):new o(t,i.PrimitiveType.INT)}isLValue(){return null!=this.address}assertIsLValue(){if(!this.isLValue())throw new Error("attempt to access the address of rvalue")}getAddress(){return this.assertIsLValue(),this.address}toAddress(){return new o(this.getAddress(),new i.PointerType(this.type))}getDataType(){return this.type}}t.NumericLiteral=o,s=o,o.BINARY_ARITHMETIC_OPERATORS=new Map([["+",(e,t)=>t.plus(e)],["-",(e,t)=>t.minus(e)],["*",(e,t)=>t.multiply(e)],["/",(e,t)=>t.divideBy(e)],["%",(e,t)=>t.modulo(e)],["<",(e,t)=>o.booleanToNumericLiteral(t.val<e.val)],["<=",(e,t)=>o.booleanToNumericLiteral(t.val<=e.val)],[">",(e,t)=>o.booleanToNumericLiteral(t.val>e.val)],[">=",(e,t)=>o.booleanToNumericLiteral(t.val>=e.val)],["==",(e,t)=>o.booleanToNumericLiteral(t.val==e.val)],["!=",(e,t)=>o.booleanToNumericLiteral(t.val!=e.val)],["&&",(e,t)=>o.booleanToNumericLiteral(t.toBoolean()&&e.toBoolean())],["||",(e,t)=>o.booleanToNumericLiteral(t.toBoolean()||e.toBoolean())]]),o.UNARY_ARITHMETIC_OPERATORS=new Map([["!",e=>s.booleanToNumericLiteral(!e.toBoolean())],[a.UNARY_MINUS_TAG,e=>o.new(-e.val).castToType(e.type)]])},170:function(e,t,n){"use strict";n.r(t),n.d(t,"changeDateAssessment",(function(){return a})),n.d(t,"deleteAssessment",(function(){return r})),n.d(t,"publishAssessment",(function(){return o})),n.d(t,"uploadAssessment",(function(){return c}));var s=n(7),i=n(142);const a=(e,t,n)=>Object(s.action)(i.a,{id:e,openAt:t,closeAt:n}),r=e=>Object(s.action)(i.b,e),o=(e,t)=>Object(s.action)(i.c,{id:t,togglePublishTo:e}),c=(e,t,n)=>Object(s.action)(i.d,{file:e,forceUpdate:t,assessmentConfigId:n})},171:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var s=n(1),i=n.n(s),a=n(34),r=n(52),o=n.n(r),c=n(23);const l=new Map,d=e=>{if(null==e.context)return[];const t=e.context.moduleContexts;if(null==t)return[];return Object.values(t).flatMap((e=>{var t,n;return null!==(t=null===(n=e.tabs)||void 0===n?void 0:n.map((e=>e(i.a,o.a))))&&void 0!==t?t:[]}))},u=e=>`${e}-icon`;t.a=e=>{const{tabs:t,onChange:n}=e,[s,r]=i.a.useState(t.beforeDynamicTabs.concat(t.afterDynamicTabs)),o=Object(a.f)((t=>e.workspaceLocation&&t.workspaces[e.workspaceLocation].debuggerContext));i.a.useEffect((()=>{const e=t.beforeDynamicTabs.concat((e=>{const t=[...d(e).filter((t=>t.toSpawn(e))).map((t=>({...t,body:t.body(e),id:c.b.module})))];return e.workspaceLocation&&l.set(e.workspaceLocation,t.map((e=>e.label))),t})(o||{})).concat(t.afterDynamicTabs);r(e)}),[t,o]);const h=i.a.useCallback(((e,t,s)=>{const i=e=>{const t=u(e),n=document.getElementById(t);n&&n.classList.remove("side-content-tab-alert")};void 0===n||n(e,t,s),i(t)}),[n]);return e.renderFunction(s,h)}},174:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Block=void 0;const s=n(211),i=n(281),a=n(175),r=n(151);class o{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.content=e,this.isFunctionBody=t}static parse(e,t,n,c,l){let d=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const u=[],h=d?e:s.Frame.extend(e);let p=!0;if(!t.matchDelimiter("{"))return r.Statement.parse(h,t,n,c,l).forEach((e=>u.push(e))),new o(u);for(t.eatDelimiter("{");!t.matchDelimiter("}");){if(!p)throw new Error(t.formatError("unreachable statements"));if(t.matchDelimiter("{"))u.push(o.parse(h,t,n,c,l));else{r.Statement.parse(h,t,n,c,l).forEach((e=>u.push(e)));const e=u[u.length-1];p=!(e instanceof i.Return||e instanceof a.Break||e instanceof a.Continue)}}return t.eatDelimiter("}"),new o(u,d)}execute(e,t){const n=this.isFunctionBody?e:s.Frame.extend(e);this.content.forEach((e=>e.execute(n,t)))}}t.Block=o},175:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Continue=t.Break=void 0;const s=n(151);class i extends s.Statement{static parse(e,t,n,s,a){if(!n)throw new Error(t.formatError("break statement not in loop statement"));return t.eatKeyword("break"),t.eatDelimiter(";"),[new i]}doExecute(e,t){throw this}}t.Break=i;class a extends s.Statement{static parse(e,t,n,s,i){if(!s)throw new Error(t.formatError("continue statement not in loop statement"));return t.eatKeyword("continue"),t.eatDelimiter(";"),[new a]}doExecute(e,t){throw this}}t.Continue=a},18:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return u})),n.d(t,"l",(function(){return h})),n.d(t,"i",(function(){return p})),n.d(t,"g",(function(){return g}));const s="FETCH_ASSESSMENT_OVERVIEWS",i="SUBMIT_ASSESSMENT";let a,r,o,c;!function(e){e.attempting="attempting",e.attempted="attempted",e.not_attempted="not_attempted",e.submitted="submitted"}(a||(a={})),function(e){e.excluded="excluded",e.graded="graded",e.grading="grading",e.none="none"}(r||(r={})),function(e){e.public="public",e.opaque="opaque",e.secret="secret"}(o||(o={})),function(e){e.programming="programming",e.mcq="mcq",e.voting="voting"}(c||(c={}));const l=()=>({external:{name:"NONE",symbols:[]},globals:[]}),d=()=>({type:"Missions",isManuallyGraded:!0,closeAt:"2100-12-01T00:00+08",coverImage:"https://fakeimg.pl/300/",id:-1,maxXp:0,openAt:"2000-01-01T00:00+08",title:"Insert title here",reading:"",shortSummary:"Insert short summary here",status:a.not_attempted,story:"mission",xp:0,gradingStatus:"none"}),u=()=>({autogradingResults:[],answer:"// [Marking Scheme]\n// 1 mark for correct answer",content:"Enter content here",id:0,library:l(),graderLibrary:l(),prepend:"",solutionTemplate:"//This is a mock solution template",postpend:"",testcases:[],testcasesPrivate:[],type:"programming",xp:0,maxXp:0,blocking:!1}),h=()=>({type:o.public,answer:"",score:0,program:""}),p=()=>({answer:3,content:"This is a mock MCQ question",choices:[{content:"A",hint:null},{content:"B",hint:null},{content:"C",hint:null},{content:"D",hint:null}],id:2,library:l(),graderLibrary:l(),type:"mcq",solution:0,xp:0,maxXp:0,blocking:!1}),g=()=>({type:"Missions",globalDeployment:{external:{name:"NONE",symbols:[]},globals:[]},graderDeployment:l(),id:-1,longSummary:"Insert mission briefing here",missionPDF:"www.google.com",questions:[u()],title:"Insert title here"})},186:function(e,t,n){"use strict";n.r(t),n.d(t,"saveCanvas",(function(){return a})),n.d(t,"createCourse",(function(){return r})),n.d(t,"addNewUsersToCourse",(function(){return o}));var s=n(7),i=n(121);const a=e=>Object(s.action)(i.c,e),r=e=>Object(s.action)(i.b,e),o=(e,t)=>Object(s.action)(i.a,{users:e,provider:t})},190:function(e,t,n){"use strict";t.a=n.p+"static/media/default_cover_image.e2be0724.jpg"},191:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(116),i=(n(1),n(12)),a=n(0);const r=e=>{let{onClick:t}=e;return Object(a.jsx)(i.a,{label:"Reset",icon:s.a.REPEAT,onClick:t})}},192:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n(98),i=n(116),a=(n(1),n(12)),r=n(0);const o=e=>{const t=e.hasUnsavedChanges?{intent:s.a.WARNING,minimal:!1}:{};return Object(r.jsx)(a.a,{label:"Save",icon:i.a.FLOPPY_DISK,onClick:e.onClickSave,options:t})}},193:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchSourcecastIndex",(function(){return a})),n.d(t,"updateSourcecastIndex",(function(){return r}));var s=n(7),i=n(128);const a=e=>Object(s.action)(i.a,{workspaceLocation:e}),r=(e,t)=>Object(s.action)(i.c,{index:e,workspaceLocation:t})},195:function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var s=n(14);const i=2,a="white",r="white",o=45,c=15,l=30,d=22.5,u=60,h=15,p=4,g=13,m=-5,b=5,f=15,v=15,y=15,j=20;var x=n(323);function O(e){return function(e){return void 0===Array.isArray?e instanceof Array:Array.isArray(e)}(e)&&2===e.length}function S(e){if(O(e))return e[1];throw new Error("tail(xs) expects a pair as argument xs, but encountered "+e)}function w(e){return null===e}function C(e){for(;;e=S(e)){if(w(e))return!0;if(!O(e))return!1}}function E(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return""+e;{const t=typeof e;if("function"!==t&&"object"!==t||null===e){if("string"===t){const t=e+"";return`"${t.substring(0,j)}${t.length>j?"...":""}"`}return`${e}`}return}}var T=n(1),k=n.n(T),A=n(0);class _ extends k.a.PureComponent{render(){return Object(A.jsx)(s.a,{points:[this.props.from.x,this.props.from.y,this.props.to.x+g,this.props.to.y+m],pointerWidth:b,pointerLength:b,fill:r,stroke:a,strokeWidth:i,preventDefault:!1},this.props+"")}}class I extends T.PureComponent{render(){const e=this.props.from.y+l/2+v,t=this.props.to.x-y,n=this.props.to.y-f,o=[this.props.from.x,this.props.from.y,this.props.from.x,e,t,e,t,n,this.props.to.x+g,n,this.props.to.x+g,this.props.to.y+m];return Object(A.jsx)(s.a,{points:o,pointerLength:b,pointerWidth:b,fill:r,stroke:a,strokeWidth:i,preventDefault:!1})}}class N{constructor(){this.children=void 0,this.children=null}}class P extends N{constructor(e){super(),this.actualNode=void 0,this.actualNode=e}}class R extends N{constructor(e){super(),this.data=void 0,this.data=e}}class M extends N{constructor(){super(...arguments),this._drawable=void 0,this.drawableX=void 0,this.drawableY=void 0}get drawable(){return this._drawable}}class L extends k.a.PureComponent{render(){return Object(A.jsx)(s.f,{x:this.props.x,y:this.props.y,points:[0,l,o,0],strokeWidth:i-1,stroke:a,preventDefault:!1})}}class D extends k.a.PureComponent{render(){const e=(e,t)=>{const n=e.data;if(C(n)){if(function(e){return null===e}(n)){const e={x:t*o,y:0};return Object(A.jsx)(L,{...e},t)}return null}{const i=E(n),a=null!==i&&void 0!==i?i:"*"+V.displaySpecialContent(e);return Object(A.jsx)(s.l,{text:a,align:"center",width:o,x:o*t,y:Math.floor((l-1.2*12)/2),fontStyle:void 0===i?"italic":"normal",fill:"white",preventDefault:!1},""+n+t)}};return Object(A.jsxs)(s.c,{x:this.props.x,y:this.props.y,children:[Object(A.jsx)(s.h,{width:Math.max(o*this.props.nodes.length,c),height:l,strokeWidth:i,stroke:a,fill:"#17181A",preventDefault:!1}),this.props.nodes.length>1&&Array.from(Array(this.props.nodes.length-1),((e,t)=>Object(A.jsx)(s.f,{points:[o*(t+1),0,o*(t+1),l],strokeWidth:i,stroke:a,preventDefault:!1},"line"+t))),this.props.nodes.map(((t,n)=>t instanceof R&&e(t,n)))]})}}class B extends k.a.PureComponent{render(){return Object(A.jsxs)(s.c,{...this.props,children:[Object(A.jsx)(s.b,{radius:h,strokeWidth:i,stroke:a,x:h,y:h,preventDefault:!1}),Object(A.jsx)(s.b,{radius:h,strokeWidth:i,stroke:a,x:3*h+i,y:h,preventDefault:!1}),Object(A.jsx)(s.b,{radius:p,strokeWidth:i,stroke:r,fill:r,x:h,y:h,preventDefault:!1}),Object(A.jsx)(s.b,{radius:p,strokeWidth:i,stroke:a,fill:r,x:3*h+i,y:h,preventDefault:!1})]})}}class U extends M{createDrawable(e,t,n,i){return this._drawable=Object(A.jsxs)(s.c,{children:[Object(A.jsx)(B,{x:e,y:t}),(n!==e||i!==t)&&Object(A.jsx)(_,{from:{x:n+o/2,y:i+l/2},to:{x:e,y:t}})]},e+", "+t),this.drawableX=e,this.drawableY=t,this._drawable}}class G extends M{createDrawable(e,t,n,i){var a;const r={nodes:null!==(a=this.children)&&void 0!==a?a:[],x:e,y:t},c=Object(A.jsx)(D,{...r});return this._drawable=Object(A.jsxs)(s.c,{children:[c,(n!==e||i!==t)&&Object(A.jsx)(_,{from:{x:n+o/2,y:i+l/2},to:{x:e,y:t}})]},e+", "+t),this.drawableX=e,this.drawableY=t,this._drawable}}class F{constructor(e,t){this._rootNode=void 0,this.nodes=void 0,this._rootNode=e,this.nodes=t}get rootNode(){return this._rootNode}getNodeById(e){return this.nodes[e]}static fromSourceStructure(e){let t=0;function n(e){const a=s.get(e);return void 0!==a?new P(a):(r=e,Array.isArray(r)?function(e){const a=new G;return s.set(e,a),i[t]=a,t++,a.children=e.map(n),a}(e):function(e){return"function"===typeof e}(e)?function(e){const n=new U;return s.set(e,n),i[t]=n,t++,n}(e):function(e){return new R(e)}(e));var r}const s=new Map,i=[],a=n(e);return new F(a,i)}draw(){return new H(this)}}class H{constructor(e){this.tree=void 0,this.drawables=void 0,this.nodeWidths=void 0,this.width=0,this.height=0,this.minX=0,this.minY=0,this.tree=e,this.drawables=[],this.nodeWidths=new Map}draw(e,t){if(this.tree.rootNode instanceof R){const e={text:E(this.tree.rootNode.data),align:"center",fontStyle:"normal",fontSize:20,fill:a},t=new x.a.Text(e);return this.width=t.width(),this.height=t.height(),Object(A.jsx)(s.e,{children:Object(A.jsx)(s.l,{...e})})}return this.drawNode(this.tree.rootNode,e,t,e,t),this.width=this.getNodeWidth(this.tree.rootNode)-this.minX,this.height=this.getNodeHeight(this.tree.rootNode)-this.minY+i,Object(A.jsx)(s.e,{offsetX:this.minX,offsetY:this.minY,children:this.drawables},e+", "+t)}drawNode(e,t,n,s,a){if(e instanceof P){const r=e.actualNode,c={from:{x:s+o/2,y:a+l/2},to:{x:r.drawableX,y:r.drawableY}};let d;c.from.y>=c.to.y?(this.minX=Math.min(this.minX,r.drawableX-y-i/2),this.minY=Math.min(this.minY,r.drawableY-f-i/2),d=Object(A.jsx)(I,{...c},"Arrow (back)"+s+t+a+n)):d=Object(A.jsx)(_,{...c},"Arrow"+s+t+a+n),this.drawables.push(d)}if(e instanceof M)if(e instanceof U){const i=e.createDrawable(t,n,s,a);this.drawables.push(i)}else if(e instanceof G){var r;const i=e.createDrawable(t,n,s,a);this.drawables.push(i);let c=t;null===(r=e.children)||void 0===r||r.forEach(((e,s)=>{const i=e instanceof P?n:n+u;this.drawNode(e,c,i,t+o*s,n);const a=this.getNodeWidth(e);c+=a?a+d:0}))}}getNodeWidth(e){if(e instanceof R||e instanceof P)return 0;if(e instanceof U)return 4*h+2*i;if(e instanceof G){var t;if(this.nodeWidths.has(e))return null!==(t=this.nodeWidths.get(e))&&void 0!==t?t:0;if(null!=e.children){const t=e.children.map((e=>this.getNodeWidth(e))).filter((e=>e>0)),n=t.length>0?t.reduce(((e,t)=>e+t+d)):0,s=Math.max(e.children.length*o+i,n,c+i);return this.nodeWidths.set(e,s),s}return 0}return 0}getNodeHeight(e){return e instanceof R?0:e instanceof U?l:e instanceof P?v:e instanceof G?(null!==(t=e.children)&&void 0!==t?t:[]).map((e=>this.getNodeHeight(e)+(e instanceof M?u/2:0))).filter((e=>e>0)).reduce(((e,t)=>Math.max(e,t)),0)+l:0;var t}}class V{static empty(e){}constructor(){this.steps=[],this.nodeLabel=0,this.nodeToLabelMap=new Map}static init(e){V.setSteps=e}static drawData(e){if(!V.setSteps)throw new Error("Data visualizer not initialized");V._instance.addStep(e),V.setSteps(V._instance.steps)}static clear(){V._instance=new V,V.setSteps(V._instance.steps)}static displaySpecialContent(e){return V._instance.displaySpecialContent(e)}displaySpecialContent(e){var t;return this.nodeToLabelMap.has(e)?null!==(t=this.nodeToLabelMap.get(e))&&void 0!==t?t:0:(console.log("*"+this.nodeLabel+": "+e.data),this.nodeToLabelMap.set(e,this.nodeLabel),this.nodeLabel++)}addStep(e){const t=e.map(this.createDrawing);this.steps.push(t)}createDrawing(e){const t=F.fromSourceStructure(e).draw(),n=i/2,a=i/2,r=t.draw(n,a);return Object(A.jsx)(s.j,{width:t.width+n,height:t.height+a,children:r},e)}}V.setSteps=V.empty,V._instance=new V},200:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var s=n(16);const i={"http:":"ws:","https:":"wss:"};function a(e,t){const n=new URL(e,s.b.sharedbBackendUrl);return t&&(n.protocol=i[n.protocol]),n.toString()}async function r(e){const t=await fetch(a(e));return t&&t.ok}async function o(e){const t=await fetch(s.b.sharedbBackendUrl,{method:"POST",body:e,headers:{"Content-Type":"text/plain"}});if(!t||!t.ok)throw new Error(t?`Could not create new session: ${await t.text()}`:"Unknown error creating session");return t.text()}},205:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i}));const s="SET_EDITOR_SESSION_ID",i="SET_SHAREDB_CONNECTED"},206:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return b}));var s=n(440),i=n(147),a=n(27);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.Variant.DEFAULT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NONE";function s(t,n,s){const i=t("../lib/oop"),r=t("./doc_comment_highlight_rules").DocCommentHighlightRules,o=t("./text_highlight_rules").TextHighlightRules,c="[a-zA-Z\\$_\xa1-\uffff][a-zA-Z\\d\\$_\xa1-\uffff]*";a.Variant.DEFAULT,e.toString();const l=function(e){const t=this.createKeywordMapper({"variable.language":"implements|interface|package|private|protected|public|staticwindow|document",keyword:"Array|Boolean|Date|Function|Iterator|Number|Object|RegExp|String|Proxy|Namespace|QName|XML|XMLList|ArrayBuffer|Float32Array|Float64Array|Int16Array|Int32Array|Int8Array|Uint16Array|Uint32Array|Uint8Array|Uint8ClampedArray|Error|EvalError|InternalError|RangeError|ReferenceError|StopIteration|SyntaxError|TypeError|URIError|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|isFinite|isNaN|parseFloat|parseInt|Math|this|arguments|prototypeyield|get|set|async|await|enum|eval|true|false|null|Infinity|NaN|undefined|break|case|continue|default|delete|do|else|finally|for|if|else|in|of|instanceof|new|return|switch|case|throw|try|sizeof|do|while|for|break|continue|escape|with|extends|super|export","storage.type":"int|float|void|char|double","support.function":"alert"},"identifier"),n="\\\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|u{[0-9a-fA-F]{1,6}}|[0-2][0-7]{0,2}|3[0-7][0-7]?|[4-7][0-7]?|.)";this.$rules={no_regex:[r.getStartRule("doc-start"),u("no_regex"),{token:"string",regex:"'(?=.)",next:"qstring"},{token:"string",regex:'"(?=.)',next:"qqstring"},{token:"constant.numeric",regex:/0(?:[xX][0-9a-fA-F]+|[oO][0-7]+|[bB][01]+)\b/},{token:"constant.numeric",regex:/(?:\d\d*(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+\b)?/},{token:["storage.type","punctuation.operator","support.function","punctuation.operator","entity.name.function","text","keyword.operator"],regex:"("+c+")(\\.)(prototype)(\\.)("+c+")(\\s*)(=)",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+c+")(\\.)("+c+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+c+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+c+")(\\.)("+c+")(\\s*)(=)(\\s*)(function)(\\s+)(\\w+)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","text","entity.name.function","text","paren.lparen"],regex:"(function)(\\s+)("+c+")(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","punctuation.operator","text","storage.type","text","paren.lparen"],regex:"("+c+")(\\s*)(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["text","text","storage.type","text","paren.lparen"],regex:"(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:"keyword",regex:"from(?=\\s*('|\"))"},{token:"keyword",regex:"(?:printf|scanf|rand|time|sqrt|abs|strlen|malloc|free|printHeap|printEnv|sizeof)\\b",next:"start"},{token:["support.constant"],regex:/that\b/},{token:t,regex:c},{token:"variable.language",regex:/[.](?![.])/,next:"property"},{token:"storage.type",regex:/=>/},{token:"keyword.operator",regex:/--|\+\+|\.{3}|===|==|=|!=|!==|<+=?|>+=?|!|&&|\|\||\?:|[!$%&*+\-~\/^]=?/,next:"start"},{token:"punctuation.operator",regex:/[?:,;.]/,next:"start"},{token:"paren.lparen",regex:/[\[({]/,next:"start"},{token:"paren.rparen",regex:/[\])}]/},{token:"comment",regex:/^#!.*$/}],property:[{token:"text",regex:"\\s+"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+c+")(\\.)("+c+")(\\s*)(=)(\\s*)(function)(?:(\\s+)(\\w+))?(\\s*)(\\()",next:"function_arguments"},{token:"punctuation.operator",regex:/[.](?![.])/},{token:"variable.language",regex:/(s(?:h(?:ift|ow(?:Mod(?:elessDialog|alDialog)|Help))|croll(?:X|By(?:Pages|Lines)?|Y|To)?|t(?:op|rike)|i(?:n|zeToContent|debar|gnText)|ort|u(?:p|b(?:str(?:ing)?)?)|pli(?:ce|t)|e(?:nd|t(?:Re(?:sizable|questHeader)|M(?:i(?:nutes|lliseconds)|onth)|Seconds|Ho(?:tKeys|urs)|Year|Cursor|Time(?:out)?|Interval|ZOptions|Date|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Date|FullYear)|FullYear|Active)|arch)|qrt|lice|avePreferences|mall)|h(?:ome|andleEvent)|navigate|c(?:har(?:CodeAt|At)|o(?:s|n(?:cat|textual|firm)|mpile)|eil|lear(?:Timeout|Interval)?|a(?:ptureEvents|ll)|reate(?:StyleSheet|Popup|EventObject))|t(?:o(?:GMTString|S(?:tring|ource)|U(?:TCString|pperCase)|Lo(?:caleString|werCase))|est|a(?:n|int(?:Enabled)?))|i(?:s(?:NaN|Finite)|ndexOf|talics)|d(?:isableExternalCapture|ump|etachEvent)|u(?:n(?:shift|taint|escape|watch)|pdateCommands)|j(?:oin|avaEnabled)|p(?:o(?:p|w)|ush|lugins.refresh|a(?:ddings|rse(?:Int|Float)?)|r(?:int|ompt|eference))|e(?:scape|nableExternalCapture|val|lementFromPoint|x(?:p|ec(?:Script|Command)?))|valueOf|UTC|queryCommand(?:State|Indeterm|Enabled|Value)|f(?:i(?:nd|le(?:ModifiedDate|Size|CreatedDate|UpdatedDate)|xed)|o(?:nt(?:size|color)|rward)|loor|romCharCode)|watch|l(?:ink|o(?:ad|g)|astIndexOf)|a(?:sin|nchor|cos|t(?:tachEvent|ob|an(?:2)?)|pply|lert|b(?:s|ort))|r(?:ou(?:nd|teEvents)|e(?:size(?:By|To)|calc|turnValue|place|verse|l(?:oad|ease(?:Capture|Events)))|andom)|g(?:o|et(?:ResponseHeader|M(?:i(?:nutes|lliseconds)|onth)|Se(?:conds|lection)|Hours|Year|Time(?:zoneOffset)?|Da(?:y|te)|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Da(?:y|te)|FullYear)|FullYear|A(?:ttention|llResponseHeaders)))|m(?:in|ove(?:B(?:y|elow)|To(?:Absolute)?|Above)|ergeAttributes|a(?:tch|rgins|x))|b(?:toa|ig|o(?:ld|rderWidths)|link|ack))\b(?=\()/},{token:"variable.language.dom",regex:/(s(?:ub(?:stringData|mit)|plitText|e(?:t(?:NamedItem|Attribute(?:Node)?)|lect))|has(?:ChildNodes|Feature)|namedItem|c(?:l(?:ick|o(?:se|neNode))|reate(?:C(?:omment|DATASection|aption)|T(?:Head|extNode|Foot)|DocumentFragment|ProcessingInstruction|E(?:ntityReference|lement)|Attribute))|tabIndex|i(?:nsert(?:Row|Before|Cell|Data)|tem)|open|delete(?:Row|C(?:ell|aption)|T(?:Head|Foot)|Data)|focus|write(?:ln)?|a(?:dd|ppend(?:Child|Data))|re(?:set|place(?:Child|Data)|move(?:NamedItem|Child|Attribute(?:Node)?)?)|get(?:NamedItem|Element(?:sBy(?:Name|TagName|ClassName)|ById)|Attribute(?:Node)?)|blur)\b(?=\()/},{token:"support.constant",regex:/(s(?:ystemLanguage|cr(?:ipts|ollbars|een(?:X|Y|Top|Left))|t(?:yle(?:Sheets)?|atus(?:Text|bar)?)|ibling(?:Below|Above)|ource|uffixes|e(?:curity(?:Policy)?|l(?:ection|f)))|h(?:istory|ost(?:name)?|as(?:h|Focus))|y|X(?:MLDocument|SLDocument)|n(?:ext|ame(?:space(?:s|URI)|Prop))|M(?:IN_VALUE|AX_VALUE)|c(?:haracterSet|o(?:n(?:structor|trollers)|okieEnabled|lorDepth|mp(?:onents|lete))|urrent|puClass|l(?:i(?:p(?:boardData)?|entInformation)|osed|asses)|alle(?:e|r)|rypto)|t(?:o(?:olbar|p)|ext(?:Transform|Indent|Decoration|Align)|ags)|SQRT(?:1_2|2)|i(?:n(?:ner(?:Height|Width)|put)|ds|gnoreCase)|zIndex|o(?:scpu|n(?:readystatechange|Line)|uter(?:Height|Width)|p(?:sProfile|ener)|ffscreenBuffering)|NEGATIVE_INFINITY|d(?:i(?:splay|alog(?:Height|Top|Width|Left|Arguments)|rectories)|e(?:scription|fault(?:Status|Ch(?:ecked|arset)|View)))|u(?:ser(?:Profile|Language|Agent)|n(?:iqueID|defined)|pdateInterval)|_content|p(?:ixelDepth|ort|ersonalbar|kcs11|l(?:ugins|atform)|a(?:thname|dding(?:Right|Bottom|Top|Left)|rent(?:Window|Layer)?|ge(?:X(?:Offset)?|Y(?:Offset)?))|r(?:o(?:to(?:col|type)|duct(?:Sub)?|mpter)|e(?:vious|fix)))|e(?:n(?:coding|abledPlugin)|x(?:ternal|pando)|mbeds)|v(?:isibility|endor(?:Sub)?|Linkcolor)|URLUnencoded|P(?:I|OSITIVE_INFINITY)|f(?:ilename|o(?:nt(?:Size|Family|Weight)|rmName)|rame(?:s|Element)|gColor)|E|whiteSpace|l(?:i(?:stStyleType|n(?:eHeight|kColor))|o(?:ca(?:tion(?:bar)?|lName)|wsrc)|e(?:ngth|ft(?:Context)?)|a(?:st(?:M(?:odified|atch)|Index|Paren)|yer(?:s|X)|nguage))|a(?:pp(?:MinorVersion|Name|Co(?:deName|re)|Version)|vail(?:Height|Top|Width|Left)|ll|r(?:ity|guments)|Linkcolor|bove)|r(?:ight(?:Context)?|e(?:sponse(?:XML|Text)|adyState))|global|x|m(?:imeTypes|ultiline|enubar|argin(?:Right|Bottom|Top|Left))|L(?:N(?:10|2)|OG(?:10E|2E))|b(?:o(?:ttom|rder(?:Width|RightWidth|BottomWidth|Style|Color|TopWidth|LeftWidth))|ufferDepth|elow|ackground(?:Color|Image)))\b/},{token:"identifier",regex:c},{regex:"",token:"empty",next:"no_regex"}],start:[r.getStartRule("doc-start"),u("start"),{token:"string.regexp",regex:"\\/",next:"regex"},{token:"text",regex:"\\s+|^$",next:"start"},{token:"empty",regex:"",next:"no_regex"}],regex:[{token:"regexp.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"string.regexp",regex:"/[sxngimy]*",next:"no_regex"},{token:"invalid",regex:/\{\d+\b,?\d*\}[+*]|[+*$^?][+*]|[$^][?]|\?{3,}/},{token:"constant.language.escape",regex:/\(\?[:=!]|\)|\{\d+\b,?\d*\}|[+*]\?|[()$^+*?.]/},{token:"constant.language.delimiter",regex:/\|/},{token:"constant.language.escape",regex:/\[\^?/,next:"regex_character_class"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp"}],regex_character_class:[{token:"regexp.charclass.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"constant.language.escape",regex:"]",next:"regex"},{token:"constant.language.escape",regex:"-"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp.charachterclass"}],function_arguments:[{token:"variable.parameter",regex:c},{token:"punctuation.operator",regex:"[, ]+"},{token:"punctuation.operator",regex:"$"},{token:"empty",regex:"",next:"no_regex"}],qqstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",consumeLineEnd:!0},{token:"string",regex:'"|$',next:"no_regex"},{defaultToken:"string"}],qstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",consumeLineEnd:!0},{token:"string",regex:"'|$",next:"no_regex"},{defaultToken:"string"}]},e&&e.noES6||(this.$rules.no_regex.unshift({regex:"[{}]",onMatch:function(e,t,n){if(this.next="{"==e?this.nextState:"","{"==e&&n.length)n.unshift("start",t);else if("}"==e&&n.length&&(n.shift(),this.next=n.shift(),-1!=this.next.indexOf("string")||-1!=this.next.indexOf("jsx")))return"paren.quasi.end";return"{"==e?"paren.lparen":"paren.rparen"},nextState:"start"},{token:"string.quasi.start",regex:/`/,push:[{token:"constant.language.escape",regex:n},{token:"paren.quasi.start",regex:/\${/,push:"start"},{token:"string.quasi.end",regex:/`/,next:"pop"},{defaultToken:"string.quasi"}]}),e&&0==e.jsx||d.call(this)),this.embedRules(r,"doc-",[r.getEndRule("no_regex")]),this.normalizeRules()};function d(){const e=c.replace("\\d","\\d\\-"),t={onMatch:function(e,t,n){const s="/"==e.charAt(1)?2:1;return 1==s?(t!=this.nextState?n.unshift(this.next,this.nextState,0):n.unshift(this.next),n[2]++):2==s&&t==this.nextState&&(n[1]--,(!n[1]||n[1]<0)&&(n.shift(),n.shift())),[{type:"meta.tag.punctuation."+(1==s?"":"end-")+"tag-open.xml",value:e.slice(0,s)},{type:"meta.tag.tag-name.xml",value:e.substr(s)}]},regex:"</?"+e,next:"jsxAttributes",nextState:"jsx"};this.$rules.start.unshift(t);const n={regex:"{",token:"paren.quasi.start",push:"start"};this.$rules.jsx=[n,t,{include:"reference"},{defaultToken:"string"}],this.$rules.jsxAttributes=[{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",onMatch:function(e,t,n){return t==n[0]&&n.shift(),2==e.length&&(n[0]==this.nextState&&n[1]--,(!n[1]||n[1]<0)&&n.splice(0,2)),this.next=n[0]||"start",[{type:this.token,value:e}]},nextState:"jsx"},n,u("jsxAttributes"),{token:"entity.other.attribute-name.xml",regex:e},{token:"keyword.operator.attribute-equals.xml",regex:"="},{token:"text.tag-whitespace.xml",regex:"\\s+"},{token:"string.attribute-value.xml",regex:"'",stateName:"jsx_attr_q",push:[{token:"string.attribute-value.xml",regex:"'",next:"pop"},{include:"reference"},{defaultToken:"string.attribute-value.xml"}]},{token:"string.attribute-value.xml",regex:'"',stateName:"jsx_attr_qq",push:[{token:"string.attribute-value.xml",regex:'"',next:"pop"},{include:"reference"},{defaultToken:"string.attribute-value.xml"}]},t],this.$rules.reference=[{token:"constant.language.escape.reference.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}]}function u(e){return[{token:"comment",regex:/\/\*/,next:[r.getTagRule(),{token:"comment",regex:"\\*\\/",next:e||"pop"},{defaultToken:"comment",caseInsensitive:!0}]},{token:"comment",regex:"\\/\\/",next:[r.getTagRule(),{token:"comment",regex:"$|^",next:e||"pop"},{defaultToken:"comment",caseInsensitive:!0}]}]}i.inherits(l,o),n.SourceHighlightRules=l}const r=e.toString()+t+n;i.define("ace/mode/source_highlight_rules"+r,["require","exports","module","ace/lib/oop","ace/mode/doc_comment_highlight_rules","ace/mode/text_highlight_rules"],s)}var o=n(91),c=n(86),l=n(69);const d={};function u(e){return e.length<=27?e:e.substring(0,24)+"..."}function h(e){return e in o.SourceDocumentation.ext_lib?{caption:u(e),value:e,meta:o.SourceDocumentation.ext_lib[e].meta,docHTML:o.SourceDocumentation.ext_lib[e].description}:{caption:u(e),value:e,meta:"const"}}for(const[f,v]of l.b)d[f]=v.map(h);for(const f of c.h)d[f.deviceLibraryName]=f.internalFunctions.map(h);const p={};Object.entries(o.SourceDocumentation.builtins).forEach((e=>{const[t,n]=e;p[t]=Object.entries(n).map((e=>{const[t,n]=e;return{caption:u(t),value:t,meta:n.meta,docHTML:n.description}}))}));const g={builtins:p,externalLibraries:d},m=(e,t,n)=>{var i;"function"!==typeof(null===(i=ace.define.modules[`ace/mode/${b(e,t,n)}`])||void 0===i?void 0:i.Mode)&&(r(e,t,n,g.externalLibraries[n]),Object(s.ModeSelector)(e,t,n))},b=(e,t,n)=>`source${e}${t}${n}`},21:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"o",(function(){return u})),n.d(t,"n",(function(){return h})),n.d(t,"h",(function(){return p})),n.d(t,"p",(function(){return g})),n.d(t,"m",(function(){return m})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return v})),n.d(t,"d",(function(){return y})),n.d(t,"i",(function(){return j})),n.d(t,"g",(function(){return x})),n.d(t,"b",(function(){return O})),n.d(t,"l",(function(){return S})),n.d(t,"j",(function(){return w})),n.d(t,"k",(function(){return C}));var s=n(27),i=n(36),a=n(16),r=n(96),o=n(69);let c,l;!function(e){e.Development="development",e.Production="production",e.Test="test"}(c||(c={})),function(e){e.Student="student",e.Staff="staff",e.Admin="admin"}(l||(l={}));const d=new Map([[s.Variant.DEFAULT,"calc"]]),u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.Variant.DEFAULT;return`Source \xa7${e}${d.has(t)?` ${d.get(t)}`:""}`},h=[{chapter:s.Chapter.CALC,variant:s.Variant.DEFAULT}].map((e=>({...e,displayName:u(e.chapter,e.variant)}))),p=h.filter((e=>e.variant===s.Variant.DEFAULT)),g=h.filter((e=>e.variant!==s.Variant.DEFAULT)),m=e=>[s.Chapter.CALC].includes(e),b={gameCanvas:void 0},f={environment:c.Production},v={gradingSummary:{cols:[],rows:[]}},y={achievements:[],goals:[],users:[],assessmentOverviews:[]},j={githubSaveInfo:{repoName:"",filePath:""}},x='// The Tower of Hanoi is a mathematical game or puzzle consisting of \n// three rods and a number of disks of various diameters, which can \n// slide onto any rod. The objective of the puzzle is to move the \n// entire stack from the first rod to the last rod.\n// (visit https://en.wikipedia.org/wiki/Tower_of_Hanoi for the game rules)\n\n#include <stdio.h>\n\nvoid move(int n, char from_rod, char to_rod, char aux_rod) {\n    if (n == 1) {\n        printf("move disk %d from rod %c to rod %c\\n", n, from_rod, to_rod);\n        return;\n    }\n    move(n-1, from_rod, aux_rod, to_rod);\n    printf("move disk %d from rod %c to rod %c\\n", n, from_rod, to_rod);\n    move(n-1, aux_rod, to_rod, from_rod);\n}\n\nint main() {\n  int n = -1;\n  printf("Enter the number of disks: ");\n  while (n <= 0) {\n      scanf("%d", &n);\n      if (n <= 0) {\n          printf("Must enter a positive number: ");\n      }\n  }\n  move(n, \'A\', \'C\', \'B\');\n  return 0;\n}\n',O=e=>({autogradingResults:[],context:Object(r.a)([],e,a.b.defaultSourceVariant),activeEditorTabIndex:0,editorTabs:[{value:["playground","sourcecast","githubAssessments"].includes(e)?x:"",prependValue:"",postpendValue:"",highlightedLines:[],breakpoints:[]}],editorSessionId:"",isEditorReadonly:!1,editorTestcases:[],externalLibrary:o.a.NONE,execTime:1e3,output:[],replHistory:{browseIndex:null,records:[],originalValue:""},replValue:"",sharedbConnected:!1,stepLimit:1e3,globals:[],isEditorAutorun:!1,isRunning:!1,isDebugging:!1,enableDebugging:!0,debuggerContext:{}}),S={assessment:{...O("assessment"),currentAssessment:void 0,currentQuestion:void 0,hasUnsavedChanges:!1},grading:{...O("grading"),currentSubmission:void 0,currentQuestion:void 0,hasUnsavedChanges:!1},playground:{...O("playground"),usingSubst:!1},sourcecast:{...O("sourcecast"),audioUrl:"",codeDeltasToApply:null,currentPlayerTime:0,description:null,inputToApply:null,playbackData:{init:{editorValue:"",chapter:s.Chapter.CALC,externalLibrary:o.a.NONE},inputs:[]},playbackDuration:0,playbackStatus:i.b.paused,sourcecastIndex:null,title:null,uid:null},sourcereel:{...O("sourcereel"),playbackData:{init:{editorValue:"",chapter:s.Chapter.CALC,externalLibrary:o.a.NONE},inputs:[]},recordingStatus:i.c.notStarted,timeElapsedBeforePause:0,timeResumed:0},sicp:{...O("sicp"),usingSubst:!1},githubAssessment:{...O("githubAssessment"),hasUnsavedChanges:!1}},w={courses:[],group:null,gameState:{completed_quests:[],collectibles:{}},xp:0,allUserXp:void 0,story:{story:"",playStory:!1},assessments:new Map,assessmentOverviews:void 0,agreedToResearch:void 0,sessionId:Date.now(),githubOctokitObject:{octokit:void 0},gradingOverviews:void 0,gradings:new Map,notifications:[]},C={academy:b,achievement:y,application:f,dashboard:v,playground:j,session:w,workspaces:S}},211:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Frame=void 0;const s=n(161),i=n(280),a=n(370),r=n(575),o=n(126);class c{constructor(e,t,n,s){this.boundings={},this.prev=e,this.stackTop=t,this.memory=n,this.depth=s}static addBuiltins(e){for(const t in o.BUILTINS)o.BUILTINS[t][1]==o.PrimitiveType.FUNCTION?e.declareFunction(t,o.BUILTINS[t][0]):(e.declareVariable(t,o.BUILTINS[t][1]),e.assignValue(t,o.BUILTINS[t][0]));return e}static getBuiltinFrame(){const e=new r.Memory;return c.addBuiltins(new c(null,e.getStackBottom(),e,0))}getStackTop(){return this.stackTop}getFrameWithName(e){if(e in this.boundings)return this;let t=this.prev;for(;null!=t&&!(e in t.boundings);)t=t.prev;return t}findFrameWith(e){const t=this.getFrameWithName(e);if(null==t)throw new Error("undeclared symbol: "+e);return t}isDeclared(e){return null!=this.getFrameWithName(e)}isFunctionDefined(e){const t=this.getFrameWithName(e);if(null==t)return!1;const n=t.boundings[e];return n.val instanceof i.Function&&n.val.isDefined()}lookupNumber(e){const t=this.lookup(e);if(!(t instanceof s.NumericLiteral))throw new Error("unmatched variable type, expected number, got function object");return t}lookupFunction(e){const t=this.lookup(e);if(!(t instanceof i.Function))throw new Error("unmatched variable type, expected function object, got number");return t}lookup(e){const t=this.findFrameWith(e),n=t.boundings[e].val,s=t.boundings[e].type;if(void 0==n)throw new Error("unbounded identifier: "+e);if(s instanceof o.PointerType)return this.memory.readPointer(n,s);if(s==o.PrimitiveType.FUNCTION)return n;if(s==o.PrimitiveType.INT)return this.memory.readInt(n);if(s==o.PrimitiveType.FLOAT)return this.memory.readFloat(n);if(s==o.PrimitiveType.CHAR)return this.memory.readChar(n);throw new Error("lookup unknown datatype: "+s)}lookupType(e){return this.findFrameWith(e).boundings[e].type}isRedefinition(e){return e in this.boundings&&(!(this.boundings[e].val instanceof a.SelfDefinedFunction)||this.boundings[e].val.isDefined())}allocateStringLiteral(e){const t=this.memory.allocateStringLiteral(e);return s.NumericLiteral.new(t).castToType(new o.PointerType(o.PrimitiveType.CHAR))}checkRedefinition(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.isRedefinition(e)){let i="redefinition of '"+e+"'";throw null!=s&&(i=s.formatError(i,t,n)),new Error(i)}}conflictingFunctionSignatures(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i="conflicting signatures of function '"+e+"'";throw null!=s&&(i=s.formatError(i,t,n)),new Error(i)}declareFunction(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return this.checkRedefinition(e,n,s,i),e in this.boundings&&this.boundings[e].val.toString()!=t.toString()&&this.conflictingFunctionSignatures(e,n,s,i),this.boundings[e]={type:o.PrimitiveType.FUNCTION,val:t},console.log("declared function: "+t.toString()+" ["+this.stackTop+"]"),e}declareVariable(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.checkRedefinition(e,n,s,i);const a=this.stackTop;return(0,o.sizeof)(t)>=4&&(this.stackTop=4*Math.ceil(this.stackTop/4)),this.stackTop+=(0,o.sizeof)(t),this.boundings[e]={type:t,val:a},console.log("declared variable: "+e+":"+t+" ["+this.stackTop+"]"),e}assignValueByAddress(e,t){this.memory.writeNumeric(e,t)}assignValue(e,t){const n=this.lookupType(e),s=this.findFrameWith(e).boundings[e].val;if(!(n instanceof o.PointerType||n==o.PrimitiveType.INT||n==o.PrimitiveType.FLOAT||n==o.PrimitiveType.CHAR))throw new Error("attempt to assign to unknown varialble type '"+n+"'");return this.memory.writeNumeric(s,t.castToType(n)),t}dereferenceAsString(e){const t=e.getDataType();if(!(t instanceof o.PointerType))throw new Error("attempt to dereference non-pointer type '"+t+"' to 'char*'");if(t.dereference()!=o.PrimitiveType.CHAR)throw new Error("attempt to dereference type '"+t+"' to 'char*'");return this.memory.readStringLiteral(e.getValue())}dereference(e){const t=e.getDataType();if(!(t instanceof o.PointerType))throw new Error("attempt to dereference non-pointer type '"+t+"'");const n=e.getValue();if(t.dereference()instanceof o.PointerType)return this.memory.readPointer(n,t.dereference());if(t.dereference()==o.PrimitiveType.CHAR)return this.memory.readChar(n);if(t.dereference()==o.PrimitiveType.INT)return this.memory.readInt(n);if(t.dereference()==o.PrimitiveType.FLOAT)return this.memory.readFloat(n);throw new Error("attempt to dereference unknown pointer type '"+t+"'")}allocateOnHeap(e){return this.memory.allocate(e.getValue())}free(e){this.memory.free(e.getValue())}printHeap(e){this.memory.printHeap(e)}static extendWithStackTop(e,t){return new c(e,t,e.memory,e.depth+1)}static extend(e){return this.extendWithStackTop(e,e.stackTop)}recurPrintEnv(e){null!=this.prev&&this.prev.recurPrintEnv(e),e.stdout+="=".repeat(20)+"depth: "+String(this.depth)+"=".repeat(20)+"\n";const t=Object.keys(this.boundings);0==this.depth&&t.push("sizeof"),t.sort().forEach((t=>{if("sizeof"==t)return void(e.stdout+=t+": int sizeof(any)\n");const n=this.boundings[t].type;n==o.PrimitiveType.FUNCTION?e.stdout+=t+": "+this.boundings[t].val.toString()+"\n":e.stdout+=t+": "+n.toString()+"\n"}))}printEnv(e){e.stdout+="\n",this.recurPrintEnv(e),e.stdout+="=".repeat(21)+"ENDING"+"=".repeat(21)+"\n"}}t.Frame=c},221:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=t.TrailingCommaError=t.MissingSemicolonError=t.FatalSyntaxError=t.DisallowedConstructError=void 0;const s=n(567),i=n(136),a=n(27),r=n(576),o=n(278);t.DisallowedConstructError=class{constructor(e){this.node=e,this.type=a.ErrorType.SYNTAX,this.severity=a.ErrorSeverity.ERROR,this.nodeType=this.formatNodeType(this.node.type)}get location(){return this.node.loc}explain(){return`${this.nodeType} are not allowed`}elaborate(){return r.stripIndent`
      You are trying to use ${this.nodeType}, which is not allowed (yet).
    `}formatNodeType(e){switch(e){case"ThisExpression":return"'this' expressions";case"Property":return"Properties";default:return e.split(/(?=[A-Z])/).map(((e,t)=>0===t?e:e.toLowerCase())).join(" ")+"s"}}};class c{constructor(e,t){this.location=e,this.message=t,this.type=a.ErrorType.SYNTAX,this.severity=a.ErrorSeverity.ERROR}explain(){return this.message}elaborate(){return"There is a syntax error in your program"}}t.FatalSyntaxError=c;t.MissingSemicolonError=class{constructor(e){this.location=e,this.type=a.ErrorType.SYNTAX,this.severity=a.ErrorSeverity.ERROR}explain(){return"Missing semicolon at the end of statement"}elaborate(){return"Every statement must be terminated by a semicolon."}};t.TrailingCommaError=class{constructor(e){this.location=e}explain(){return"Trailing comma"}elaborate(){return"Please remove the trailing comma"}};t.parse=function(e,t){try{return s.Program.parse(new o.Lexer(e))}catch(n){t.errors.push(new i.CProgramError(n))}}},223:function(e,t,n){"use strict";n.r(t),n.d(t,"setEditorSessionId",(function(){return a})),n.d(t,"setSharedbConnected",(function(){return r}));var s=n(7),i=n(205);const a=(e,t)=>Object(s.action)(i.a,{workspaceLocation:e,editorSessionId:t}),r=(e,t)=>Object(s.action)(i.b,{workspaceLocation:e,connected:t})},23:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i}));const s="NOTIFY_PROGRAM_EVALUATED";let i;!function(e){e.autograder="autograder",e.briefing="briefing",e.contestVoting="contest_voting",e.contestLeaderboard="contest_leaderboard",e.dataVisualizer="data_visualizer",e.editorGrading="editor_grading",e.editorAutograder="editor_autograder",e.editorBriefing="editor_briefing",e.editorGlobalDeployment="editor_global_deployment",e.editorGlobalGraderDeployment="editor_global_grader_deployment",e.editorLocalDeployment="editor_local_deployment",e.editorLocalGraderDeployment="editor_local_grader_deployment",e.editorManageQuestion="editor_manage_question",e.editorQuestionOverview="editor_question_overview",e.editorQuestionTemplate="editor_question_template",e.envVisualizer="env_visualizer",e.files="files",e.grading="grading",e.introduction="introduction",e.module="module",e.questionOverview="question_overview",e.remoteExecution="remote_execution",e.missionMetadata="mission_metadata",e.mobileEditor="mobile_editor",e.mobileEditorRun="mobile_editor_run",e.sourcereel="sourcereel",e.substVisualizer="subst_visualiser",e.testcases="testcases",e.toneMatrix="tone_matrix",e.htmlDisplay="html_display"}(i||(i={}))},241:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureGlobalEnvironmentExist=t.createEmptyContext=t.createGlobalEnvironment=t.EnvTreeNode=t.EnvTree=t.LazyBuiltIn=void 0;const s=n(27);t.LazyBuiltIn=class{constructor(e,t){this.func=e,this.evaluateArgs=t}};class i{constructor(){this._root=null,this.map=new Map}get root(){return this._root}insert(e){const t=e.tail;if(null===t)null===this._root&&(this._root=new a(e,null),this.map.set(e,this._root));else{const n=this.map.get(t);if(n){const t=new a(e,n);n.addChild(t),this.map.set(e,t)}}}getTreeNode(e){return this.map.get(e)}}t.EnvTree=i;class a{constructor(e,t){this.environment=e,this.parent=t,this._children=[]}get children(){return this._children}resetChildren(e){this.clearChildren(),this.addChildren(e),e.forEach((e=>e.parent=this))}clearChildren(){this._children=[]}addChildren(e){this._children.push(...e)}addChild(e){return this._children.push(e),e}}t.EnvTreeNode=a;const r=()=>({break:!1,debuggerOn:!0,isRunning:!1,environmentTree:new i,environments:[],value:void 0,nodes:[]});t.createGlobalEnvironment=()=>({tail:null,name:"global",head:{},id:"-1"});t.createEmptyContext=(e,t,n)=>({externalSymbols:t,errors:[],externalContext:n,runtime:r(),numberOfOuterEnvironments:1,prelude:null,executionMethod:"auto",variant:e,moduleContexts:{},unTypecheckedCode:[],previousCode:[]});t.ensureGlobalEnvironmentExist=e=>{if(e.runtime||(e.runtime=r()),e.runtime.environments||(e.runtime.environments=[]),e.runtime.environmentTree||(e.runtime.environmentTree=new i),0===e.runtime.environments.length){const n=(0,t.createGlobalEnvironment)();e.runtime.environments.push(n),e.runtime.environmentTree.insert(n)}};t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.Variant.DEFAULT,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;const a=(0,t.createEmptyContext)(e,n,i);return a}},244:function(e,t,n){"use strict";n.r(t),n.d(t,"logOut",(function(){return a}));var s=n(7),i=n(137);const a=()=>Object(s.action)(i.a)},245:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var s=n(454);function i(e){return new s.a({auth:e,userAgent:"Source Academy Playground",baseUrl:"https://api.github.com",log:{debug:()=>{},info:()=>{},warn:console.warn,error:console.error},request:{agent:void 0,fetch:void 0,timeout:0}})}},25:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"m",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return d})),n.d(t,"j",(function(){return u})),n.d(t,"n",(function(){return h})),n.d(t,"o",(function(){return p})),n.d(t,"p",(function(){return g})),n.d(t,"q",(function(){return m})),n.d(t,"s",(function(){return b})),n.d(t,"r",(function(){return f})),n.d(t,"t",(function(){return v})),n.d(t,"u",(function(){return y})),n.d(t,"b",(function(){return j})),n.d(t,"f",(function(){return x})),n.d(t,"v",(function(){return O})),n.d(t,"l",(function(){return S})),n.d(t,"e",(function(){return w}));const s="ADD_EVENT",i="BULK_UPDATE_ACHIEVEMENTS",a="BULK_UPDATE_GOALS",r="HANDLE_EVENT",o="GET_ACHIEVEMENTS",c="GET_GOALS",l="GET_OWN_GOALS",d="GET_USER_ASSESSMENT_OVERVIEWS",u="GET_USERS",h="REMOVE_ACHIEVEMENT",p="REMOVE_GOAL",g="SAVE_ACHIEVEMENTS",m="SAVE_GOALS",b="SAVE_USER_ASSESSMENT_OVERVIEWS",f="SAVE_USERS",v="UPDATE_GOAL_PROGRESS",y="UPDATE_OWN_GOAL_PROGRESS";let j,x;!function(e){e.ACTIVE="ACTIVE",e.COMPLETED="COMPLETED",e.EXPIRED="EXPIRED",e.UNRELEASED="UNRELEASED"}(j||(j={})),function(e){e.ALL="ALL",e.ACTIVE="ACTIVE",e.COMPLETED="COMPLETED"}(x||(x={}));const O={count:0,targetCount:1,completed:!1};let S,w;!function(e){e.MANUAL="Manual",e.EVENT="Event",e.ASSESSMENT="Assessment (unsupported)",e.BINARY="Binary (unsupported)"}(S||(S={})),function(e){e.NONE="None",e.RUN_CODE="Run Code",e.ERROR="Error",e.RUN_TESTCASE="Run Testcase"}(w||(w={}))},250:function(e,t,n){"use strict";var s=n(3),i=n(19),a=n.n(i),r=(n(1),n(0));t.a=e=>{const t=Object(r.jsx)("div",{className:a()("ControlBar_editor",s.a.BUTTON_GROUP),children:e.editorButtons}),n=e.flowButtons&&Object(r.jsx)("div",{className:a()("ControlBar_flow",s.a.BUTTON_GROUP),children:e.flowButtons}),i=Object(r.jsx)("div",{className:a()("ControlBar_editingWorkspace",s.a.BUTTON_GROUP),children:e.editingWorkspaceButtons});return Object(r.jsxs)("div",{className:"ControlBar",children:[t,n,i]})}},251:function(e,t,n){"use strict";var s=n(98),i=n(41),a=n(1),r=n(44),o=n(10),c=n(0);class l extends a.PureComponent{constructor(){super(...arguments),this.onButtonClickFactory=e=>t=>{e!==this.props.mcq.answer&&this.props.handleMCQSubmit(e);if(null!==this.props.mcq.solution&&this.props.mcq.choices[e].hint){const t=Object(c.jsx)(r.a,{className:"markdown-notification",content:this.props.mcq.choices[e].hint});e===this.props.mcq.solution?Object(o.d)(t,4e3):Object(o.e)(t,4e3)}},this.getButtonIntent=(e,t,n)=>{const i=e===t,a=i&&void 0!==n&&e===n;return void 0===n?s.a.NONE:i&&a?s.a.SUCCESS:i&&!a?s.a.DANGER:s.a.NONE}}render(){const e=this.props.mcq.choices.map(((e,t)=>Object(c.jsx)(i.b,{className:"mcq-option col-xs-12",active:t===this.props.mcq.answer,intent:this.getButtonIntent(t,this.props.mcq.answer,this.props.mcq.solution),onClick:this.onButtonClickFactory(t),minimal:!0,children:Object(c.jsx)(r.a,{content:e.content})},t)));return Object(c.jsx)("div",{className:"MCQChooser row",children:Object(c.jsx)(i.e,{className:"mcq-content-parent col-xs-12 middle-xs",children:Object(c.jsx)("div",{className:"row mcq-options-parent between-xs",children:e})})})}}t.a=l},253:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var s=n(32);const i=(e,t)=>s.isEqual(e,t)},254:function(e,t,n){"use strict";var s=n(41),i=n(3),a=n(132),r=n(91),o=n(102),c=n(19),l=n.n(c),d=n(1),u=n(18),h=n(0);t.a=e=>{const{index:t,testcase:n,handleTestcaseEval:c}=e,p=d.useMemo((()=>{const e=void 0!==n.result||n.errors,t=Object(o.stringify)(n.result)===n.answer;return{correct:e&&t,wrong:e&&!t,secret:n.type===u.f.secret||n.type===u.f.opaque}}),[n]),g=d.useCallback((()=>{c(t)}),[t,c]);return Object(h.jsx)("div",{className:l()("AutograderCard",p),children:Object(h.jsx)(s.e,{className:i.a.INTERACTIVE,elevation:a.a.ONE,onClick:g,children:n.type===u.f.opaque&&"assessment"===e.workspaceLocation?Object(h.jsx)(s.M,{className:"testcase-placeholder",children:"Hidden testcase"}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(s.M,{className:"testcase-program",children:n.program}),Object(h.jsx)(s.M,{className:"testcase-expected",children:n.answer}),Object(h.jsx)(s.M,{className:"testcase-actual",children:n.errors?Object(r.parseError)(n.errors):void 0!==n.result?Object(o.stringify)(n.result):"No Answer"})]})})})}},255:function(e,t,n){"use strict";n.d(t,"b",(function(){return m}));var s=n(41),i=n(331),a=n(1),r=n(39),o=n(10),c=n(0);const l=i.a.ofType(),d=(e,t)=>{let{handleClick:n}=t;return Object(c.jsx)(s.B,{onClick:n,text:e.text},e.uuid)},u=(e,t)=>t.text.toLowerCase().includes(e.toLowerCase()),h=i.a.ofType(),p=(e,t)=>{let{handleClick:n}=t;return Object(c.jsx)(s.B,{onClick:n,text:e.name||e.username},e.courseRegId)},g=(e,t)=>[t.name,t.username,t.group].reduce(((t,n)=>n?t||n.toLowerCase().includes(e.toLowerCase()):t),!1);function m(){Object(o.d)("Goal updated")}t.a=function(e){const{userState:t,hiddenState:n,studio:i,getUsers:m,updateGoalProgress:b}=e,f="Staff"===i?[...e.users].sort(((e,t)=>null!=e.name&&null!=t.name?e.name.localeCompare(t.name):null==e.name?1:-1)):e.users.filter((e=>e.group===i)).sort(((e,t)=>null!=e.name&&null!=t.name?e.name.localeCompare(t.name):null==e.name?1:-1));Object(a.useEffect)(m,[m]);const v=Object(a.useContext)(r.a).getAllGoals().filter((e=>"Manual"===e.meta.type)),[y,j]=Object(a.useState)(void 0),[x,O]=t,[S,w]=Object(a.useState)(0),[C,E]=n;return Object(c.jsxs)("div",{className:"achievement-manual-editor",children:[Object(c.jsx)("h3",{children:"User: "}),Object(c.jsx)(h,{filterable:!0,items:f,itemRenderer:p,itemPredicate:g,onItemSelect:O,noResults:Object(c.jsx)(s.B,{disabled:!0,text:"No matching user"}),children:Object(c.jsx)(s.b,{outlined:!0,text:x?x.name||x.username:"No User Selected",color:"White"})}),Object(c.jsx)("h3",{children:"Goal: "}),Object(c.jsx)(l,{filterable:!0,items:v,itemRenderer:d,itemPredicate:u,onItemSelect:j,noResults:Object(c.jsx)(s.B,{disabled:!0,text:"No matching goal"}),children:Object(c.jsx)(s.b,{outlined:!0,text:y?y.text:"No Goal Selected",color:"White"})}),Object(c.jsx)("h3",{children:"Count: "}),Object(c.jsx)(s.H,{value:S,min:0,allowNumericCharactersOnly:!0,minorStepSize:null,placeholder:"Count",onValueChange:w}),Object(c.jsx)("h3",{children:" "}),Object(c.jsx)(s.b,{outlined:!0,text:"Update Goal",onClick:()=>{if(y&&x){const e={uuid:y.uuid,count:S<0?0:Math.floor(S),targetCount:y.targetCount,completed:S>=y.targetCount};b(x.courseRegId,e)}else!y&&Object(o.e)("Goal not selected"),!x&&Object(o.e)("User not selected")},intent:"primary"}),Object(c.jsx)("h3",{children:" "}),Object(c.jsx)(s.f,{checked:C,label:"View Hidden Achievements",onChange:()=>E(!C)})]})}},256:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchGroupGradingSummary",(function(){return a})),n.d(t,"updateGroupGradingSummary",(function(){return r}));var s=n(7),i=n(148);const a=()=>Object(s.action)(i.a),r=e=>Object(s.action)(i.b,e)},261:function(e,t,n){"use strict";var s=n(102);const i={log:e=>function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e(n.map((e=>"string"===typeof e?e:Object(s.stringify)(e))).join(" "))}};const a=new class{constructor(){this.buffer=void 0,this.workspaceLocation=void 0,this.buffer=[]}dump(){const e=[...this.buffer];return this.resetBuffer(),e}push(e,t){this.handleWorkspaceChange(t),this.buffer.push(e)}attachConsole(e){const t=t=>this.push(t,e),n={};return Object.entries(i).forEach((e=>{let[s,i]=e;n[s]=console[s],console[s]=i(t)})),()=>{Object.entries(i).forEach((e=>{let[t]=e;console[t]=n[t]}))}}handleWorkspaceChange(e){this.hasWorkspace()&&e===this.workspaceLocation||(this.workspaceLocation=e,this.resetBuffer())}hasWorkspace(){return Boolean(this.workspaceLocation)}resetBuffer(){this.buffer=[]}};t.a=a},262:function(e,t,n){"use strict";var s=n(3),i=n(41),a=n(91),r=n(19),o=n.n(r),c=n(1),l=n(129),d=n(139),u=n.n(d),h=n(187),p=n.n(h),g=n(206),m=n(0);const b=e=>{const{onFocus:t,onBlur:n}=e,i=c.useRef(null),a=c.useRef(null),r=e.handleBrowseHistoryDown,l=e.handleBrowseHistoryUp;c.useEffect((()=>{if(!i.current)return;const e=i.current.editor;t&&e.on("focus",(()=>t(e))),n&&e.on("blur",n)})),c.useEffect((()=>{a.current&&!e.disableScrolling&&(a.current.clientWidth>=window.innerWidth-50||a.current.scrollIntoView())})),Object(g.b)(e.sourceChapter,e.sourceVariant,e.externalLibrary);return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(u.a,{className:"repl-react-ace react-ace",mode:Object(g.a)(e.sourceChapter,e.sourceVariant,e.externalLibrary),theme:"source",height:"1px",width:"100%",value:e.replValue,onChange:e.handleReplValueChange,commands:[{name:"browseHistoryDown",bindKey:{win:"Down",mac:"Down"},exec:r},{name:"browseHistoryUp",bindKey:{win:"Up",mac:"Up"},exec:l},{name:"evaluate",bindKey:{win:"Shift-Enter",mac:"Shift-Enter"},exec:()=>{e.handleReplEval(),a.current&&!e.disableScrolling&&a.current.scrollIntoView()}}],minLines:1,maxLines:20,fontSize:17,highlightActiveLine:!1,showGutter:!1,showPrintMargin:!1,setOptions:{fontFamily:"'Inconsolata', 'Consolas', monospace"},ref:i}),Object(m.jsx)("div",{className:o()(s.a.BUTTON_GROUP,s.a.DARK),children:e.replButtons}),Object(m.jsx)(p.a,{minWidth:769,children:Object(m.jsx)("div",{ref:a})})]})},f={"\\a":"a","\\b":"\b","\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t","\\v":"\v","\\'":"'",'\\"':'"',"\\?":"?","\\\\":"\\"};function v(e){let t=e;for(const n in f)t=t.replaceAll(n,f[n]);return t}const y=e=>{switch(console.log(e),e.output.type){case"code":return Object(m.jsx)(i.e,{children:Object(m.jsx)(i.M,{className:"code-output",children:e.output.value})});case"running":return Object(m.jsx)(i.e,{children:Object(m.jsx)(i.M,{className:"log-output",children:e.output.consoleLogs.join("\n")})});case"result":return e.usingSubst&&e.output.value instanceof Array?Object(m.jsx)(i.e,{children:Object(m.jsx)(i.M,{className:"log-output",children:"Check out the Stepper tab!"})}):0===e.output.consoleLogs.length?Object(m.jsx)(i.e,{children:Object(m.jsx)(i.M,{className:"result-output",children:v(e.output.value)})}):Object(m.jsxs)(i.e,{children:[Object(m.jsx)(i.M,{className:"log-output",children:e.output.consoleLogs.join("\n")}),Object(m.jsx)(i.M,{className:"result-output",children:e.output.value})]});case"errors":return 0===e.output.consoleLogs.length?Object(m.jsx)(i.e,{children:Object(m.jsx)(i.M,{className:"error-output",children:Object(a.parseError)(e.output.errors)})}):Object(m.jsxs)(i.e,{children:[Object(m.jsx)(i.M,{className:"log-output",children:e.output.consoleLogs.join("\n")}),Object(m.jsx)("br",{}),Object(m.jsx)(i.M,{className:"error-output",children:Object(a.parseError)(e.output.errors)})]});default:return Object(m.jsx)(i.e,{children:"''"})}},j={goGreen:()=>{}};t.a=e=>{const t=e.output.map(((t,n)=>{var s;return Object(m.jsx)(y,{output:t,usingSubst:null!==(s=e.usingSubst)&&void 0!==s&&s},n)}));return Object(m.jsx)("div",{className:"Repl",style:{display:e.hidden?"none":void 0},children:Object(m.jsxs)("div",{className:"repl-output-parent",children:[t,!e.inputHidden&&Object(m.jsx)(l.HotKeys,{className:o()("repl-input-parent","row",s.a.CARD,s.a.ELEVATION_0),handlers:j,children:Object(m.jsx)(b,{...e})})]})})}},27:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disallowedTypes=t.Variant=t.Chapter=t.ErrorSeverity=t.ErrorType=void 0,function(e){e.SYNTAX="Syntax",e.TYPE="Type",e.RUNTIME="Runtime"}(t.ErrorType||(t.ErrorType={})),function(e){e.WARNING="Warning",e.ERROR="Error"}(t.ErrorSeverity||(t.ErrorSeverity={})),function(e){e[e.CALC=1]="CALC"}(t.Chapter||(t.Chapter={})),function(e){e.DEFAULT="calc"}(t.Variant||(t.Variant={})),t.disallowedTypes=["bigint","never","object","symbol","unknown"]},271:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.ACORN_PARSE_OPTIONS=t.sourceLanguages=t.JSSLANG_PROPERTIES=t.UNKNOWN_LOCATION=t.MAX_LIST_DISPLAY_LENGTH=t.MODULE_CONTEXTS_ID=t.MODULE_PARAMS_ID=t.NATIVE_STORAGE_ID=t.GLOBAL=t.TRY_AGAIN=t.CUT=void 0;const s=n(27);t.CUT="cut",t.TRY_AGAIN="retry",t.GLOBAL="undefined"===typeof window?e:window,t.NATIVE_STORAGE_ID="nativeStorage",t.MODULE_PARAMS_ID="moduleParams",t.MODULE_CONTEXTS_ID="moduleContexts",t.MAX_LIST_DISPLAY_LENGTH=100,t.UNKNOWN_LOCATION={start:{line:-1,column:-1},end:{line:-1,column:-1}},t.JSSLANG_PROPERTIES={maxExecTime:1e3,factorToIncreaseBy:10},t.sourceLanguages=[{chapter:s.Chapter.CALC,variant:s.Variant.DEFAULT}],t.ACORN_PARSE_OPTIONS={ecmaVersion:2015}}).call(this,n(61))},272:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RuntimeSourceError=void 0;const s=n(271),i=n(27);t.RuntimeSourceError=class{constructor(e){this.type=i.ErrorType.RUNTIME,this.severity=i.ErrorSeverity.ERROR,this.location=e?e.loc:s.UNKNOWN_LOCATION}explain(){return""}elaborate(){return this.explain()}}},277:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CircularImportError=t.CannotFindModuleError=t.ConsecutiveSlashesInFilePathError=t.IllegalCharInFilePathError=t.InvalidFilePathError=void 0;const s=n(271),i=n(368),a=n(27);class r{constructor(e){this.filePath=e,this.type=a.ErrorType.TYPE,this.severity=a.ErrorSeverity.ERROR,this.location=s.UNKNOWN_LOCATION}}t.InvalidFilePathError=r;t.IllegalCharInFilePathError=class extends r{explain(){const e=Object.keys(i.nonAlphanumericCharEncoding).map((e=>`'${e}'`)).join(", ");return`File path '${this.filePath}' must only contain alphanumeric chars and/or ${e}.`}elaborate(){return"Rename the offending file path to only use valid chars."}};t.ConsecutiveSlashesInFilePathError=class extends r{explain(){return`File path '${this.filePath}' cannot contain consecutive slashes '//'.`}elaborate(){return"Remove consecutive slashes from the offending file path."}};t.CannotFindModuleError=class{constructor(e){this.moduleFilePath=e,this.type=a.ErrorType.TYPE,this.severity=a.ErrorSeverity.ERROR,this.location=s.UNKNOWN_LOCATION}explain(){return`Cannot find module '${this.moduleFilePath}'.`}elaborate(){return"Check that the module file path resolves to an existing file."}};t.CircularImportError=class{constructor(e){this.filePathsInCycle=e,this.type=a.ErrorType.TYPE,this.severity=a.ErrorSeverity.ERROR,this.location=s.UNKNOWN_LOCATION}explain(){return`Circular import detected: ${this.filePathsInCycle.map((e=>`'${e}'`)).reverse().join(" -> ")}.`}elaborate(){return"Break the circular import cycle by removing imports from any of the offending files."}}},278:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Lexer=t.RELATIONAL_OPERATOR_RETEX=void 0;const s=n(161),i=n(126),a=/^\s*#\s*include\b|^\s*#\s*define\b|^\s*#\s*ifdef\b|^\s*#\s*ifndef\b|^\s*#\s*if\b|^\s*#\s*elif\b|^\s*#\s*else\b|^\s*#\s*pragma\b/,r=/^[+-]?([0-9]*[.])?[0-9]+/,o=/^[_a-zA-Z][_a-zA-Z0-9]*/,c=/^".*?(?<!\\)"/,l=/^'.(?<!\\)'|^'\\[abfnrtv'"?]'|^'\\\\'/,d=/^int\b|^char\b|^float\b|^double\b|^void\b/,u=/^\s+/,h=/^[*\/%](?!=)/,p=/^[*\/%\+-](?!=)/,g=/^\+\+|^--/,m=/^\+(?!\+)|^-(?!-)/;t.RELATIONAL_OPERATOR_RETEX=/^>=|^<=|^>|^<|^==|^!=/;const b=/^>=|^<=|^>|^</,f=/^\+=|^-=|^\*=|^\/=|^%=|^=/,v=new Set(["void","int","char","float","double","break","continue","return","if","else","while","do","for","switch","case","default","sizeof"]),y={"\\a":"a","\\b":"\b","\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t","\\v":"\v","\\'":"'",'\\"':'"',"\\?":"?","\\\\":"\\"};class j{constructor(e){this.lines=e.split(/\r?\n/),this.row=0,this.col=0,this.skipToNextLine()}tell(){return this.hasNext(),[this.row,this.col]}trimHead(){const e=u.exec(this.currentLine);e&&(this.col+=e[0].length,this.currentLine=this.currentLine.substring(e[0].length))}hasNext(){for(this.trimHead();this.row<this.lines.length&&0===this.currentLine.length;)this.skipToNextLine(),this.trimHead();return this.currentLine.startsWith("//")?(this.skipToNextLine(),this.hasNext()):this.currentLine.length>0}skipToNextLine(){if(this.row<this.lines.length){this.currentLine=this.lines[this.row],this.row+=1,this.col=1;const e=a.exec(this.currentLine);if(null==e)return;if(!e[0].includes("include"))throw new Error(this.formatError("preprocessor directive is not supported"));this.skipToNextLine()}else this.col+=this.currentLine.length,this.currentLine=""}formatError(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.row,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.col;return"Line "+String(t)+": "+e+" at ("+t+", "+n+")\n\t"+this.lines[t-1]+"\n\t"+" ".repeat(n-1)+"^"}matchNumber(){return this.hasNext()&&r.test(this.currentLine)}eatNumber(){if(!this.hasNext())throw new Error(this.formatError("expected a number"));const e=r.exec(this.currentLine);if(!e)throw new Error(this.formatError("expected a number"));return this.currentLine=this.currentLine.substring(e[0].length),this.col+=e[0].length,s.NumericLiteral.parse(e[0])}matchIdentifier(){if(!this.hasNext())return!1;const e=o.exec(this.currentLine);return null!=e&&!v.has(e[0])}eatIdentifier(){if(!this.hasNext())throw new Error(this.formatError("expected an identifier"));const e=o.exec(this.currentLine);if(!e)throw new Error(this.formatError("expected an identifier"));if(v.has(e[0]))throw new Error(this.formatError('"'+e[0]+'" is a reserved keyword'));return this.currentLine=this.currentLine.substring(e[0].length),this.col+=e[0].length,e[0]}matchKeyword(e){return this.hasNext()&&new RegExp("^"+e+"\\b").test(this.currentLine)}eatKeyword(e){if(!this.matchKeyword(e))throw new Error(this.formatError('expected a keyword "'+e+'"'));return this.currentLine=this.currentLine.substring(e.length),this.col+=e.length,e}matchDelimiter(e){return this.hasNext()&&this.currentLine.startsWith(e)}eatDelimiter(e){if(!this.hasNext()||!this.currentLine.startsWith(e))throw new Error(this.formatError('expected a delimiter "'+e+'"'));this.currentLine=this.currentLine.substring(e.length),this.col+=e.length}matchDataType(){return this.hasNext()&&d.test(this.currentLine)}eatDataType(){if(!this.hasNext())throw new Error(this.formatError("expected a datatype"));const e=d.exec(this.currentLine);if(!e)throw new Error(this.formatError("expected a datatype"));this.currentLine=this.currentLine.substring(e[0].length),this.col+=e[0].length;let t="double"==e[0]?i.PrimitiveType.FLOAT:e[0];for(;this.matchDelimiter("*");)this.eatDelimiter("*"),t=new i.PointerType(t);return t}matchPrioritizedArithmeticOperator(){return this.hasNext()&&h.test(this.currentLine)}matchArithmeticOperator(){return this.hasNext()&&p.test(this.currentLine)}eatArithmeticOperator(){if(!this.hasNext())throw new Error(this.formatError("expected an arithmetic operator"));const e=p.exec(this.currentLine);if(!e)throw new Error(this.formatError("expected an arithmetic operator"));return this.currentLine=this.currentLine.substring(e[0].length),this.col+=e[0].length,e[0]}matchIncrementDecrementOperator(){return this.hasNext()&&g.test(this.currentLine)}eatIncrementDecrementOperator(){if(!this.hasNext())throw new Error(this.formatError("expected an increment or decrement operator"));const e=g.exec(this.currentLine);if(!e)throw new Error(this.formatError("expected an increment or decrement operator"));return this.currentLine=this.currentLine.substring(e[0].length),this.col+=e[0].length,e[0]}matchPrioritizedRelationalOperator(){return this.hasNext()&&b.test(this.currentLine)}matchRelationalOperator(){return this.hasNext()&&t.RELATIONAL_OPERATOR_RETEX.test(this.currentLine)}eatRelationalOperator(){if(!this.hasNext())throw new Error(this.formatError("expected a relational operator"));const e=t.RELATIONAL_OPERATOR_RETEX.exec(this.currentLine);if(!e)throw new Error(this.formatError("expected a relational operator"));return this.currentLine=this.currentLine.substring(e[0].length),this.col+=e[0].length,e[0]}matchAssignmentOperator(){return this.hasNext()&&f.test(this.currentLine)}eatAssignmentOperator(){if(!this.hasNext())throw new Error(this.formatError("expected an assignment operator"));const e=f.exec(this.currentLine);if(!e)throw new Error(this.formatError("expected an assignment operator"));return this.currentLine=this.currentLine.substring(e[0].length),this.col+=e[0].length,e[0]}eatCharacterLiteral(){if(!this.hasNext())throw new Error(this.formatError("expected an ascii character literal"));const e=l.exec(this.currentLine);if(!e)throw new Error(this.formatError("expected an ascii character literal"));return this.checkNonAsciiCharacter(e[0]),this.currentLine=this.currentLine.substring(e[0].length),this.col+=e[0].length,s.NumericLiteral.new(j.restoreEscapeChars(e[0]).charCodeAt(1)).castToType(i.PrimitiveType.CHAR)}matchUnaryPlusMinus(){return this.hasNext()&&m.test(this.currentLine)}eatUnaryPlusMinus(){if(!this.hasNext())throw new Error(this.formatError("expected a unary plus or minus operator"));const e=m.exec(this.currentLine);if(!e)throw new Error(this.formatError("expected a unary plus or minus operator"));return this.currentLine=this.currentLine.substring(e[0].length),this.col+=e[0].length,e[0]}static restoreEscapeChars(e){let t=e;for(const n in y)t=t.replaceAll(n,y[n]);return t}checkNonAsciiCharacter(e){for(let t=1;t<e.length-1;t++){const n=e.charCodeAt(t);if(n>127||n<0)throw new Error(this.formatError("expected an ascii character",this.row,this.col+t))}}eatStringLiteral(){if(!this.hasNext())throw new Error(this.formatError("expected a string literal"));const e=c.exec(this.currentLine);if(!e)throw new Error(this.formatError("expected a string literal"));return this.currentLine=this.currentLine.substring(e[0].length),this.checkNonAsciiCharacter(e[0]),this.col+=e[0].length,j.restoreEscapeChars(e[0])}assertEndOfLine(){const e=this.row;if(this.hasNext()&&this.row==e)throw new Error(this.formatError("expected a line break"))}}t.Lexer=j},279:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionCall=void 0;class s{constructor(e,t,n,i){this.functionObj=e.lookupFunction(t),s.calledFunctions.add(t),this.actualParameterList=n,this.row=i}static clearCalledFunctions(){s.calledFunctions.clear()}static checkCalledFunctionDefinition(e){s.calledFunctions.forEach((t=>{if(!e.isFunctionDefined(t))throw new Error("called function '"+t+"' has no definition yet")}))}getReturnType(){return this.functionObj.returnType}execute(e,t){const n=[];return this.actualParameterList.forEach((s=>n.push(s.evaluate(e,t)))),e.lookupFunction(this.functionObj.functionName).call(e,t,n)}}t.FunctionCall=s,s.calledFunctions=new Set},280:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Function=void 0;t.Function=class{constructor(e,t){this.returnType=e,this.functionName=t}checkTooFewArguments(e){if(e.matchDelimiter(")"))throw new Error(e.formatError("'too few arguments in call to '"+this.functionName+"'"))}}},281:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Return=void 0;const s=n(126),i=n(117),a=n(151);class r extends a.Statement{constructor(e,t){super(),this.expression=t,this.returnType=e}static parse(e,t,n,a,o){if(null==o)throw new Error(t.formatError("return statement not in function definition"));t.eatKeyword("return");let c=null;if(t.matchDelimiter(";")&&o!=s.PrimitiveType.VOID)throw new Error(t.formatError("non-void function should return a value"));if(!t.matchDelimiter(";")&&o==s.PrimitiveType.VOID)throw new Error(t.formatError("void function should not return a value"));return t.matchDelimiter(";")||(c=i.ExpressionParser.parse(e,t,!1,!1,o)),t.eatDelimiter(";"),[new r(o,c)]}getEvaluated(){return this.evaluated}doExecute(e,t){var n,s;throw this.evaluated=null===(s=null===(n=this.expression)||void 0===n?void 0:n.evaluate(e,t))||void 0===s?void 0:s.castToType(this.returnType),this}}t.Return=r},282:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionDeclaration=t.Declaration=void 0;const s=n(126),i=n(211),a=n(174),r=n(117),o=n(370),c=n(151);class l extends c.Statement{static parseFormalParameterList(e,t,n){const i=[];if(t.eatDelimiter("("),!t.matchDataType())return t.eatDelimiter(")"),i;const a=t.eatDataType();if(a==s.PrimitiveType.VOID)return t.eatDelimiter(")"),i;if("main"==n)throw new Error(t.formatError("expected no parameters on 'main' function declaration"));let[r,o]=t.tell(),c=t.eatIdentifier();for(i.push([a,e.declareVariable(c,a,r,o,t)]);!t.matchDelimiter(")");){t.eatDelimiter(",");const[n,a]=t.tell(),l=t.eatDataType();if(l==s.PrimitiveType.VOID)throw new Error(t.formatError("argument may not have 'void' type",n,a));[r,o]=t.tell(),c=t.eatIdentifier(),i.push([l,e.declareVariable(c,l,r,o,t)])}return t.eatDelimiter(")"),i}static parseDeclaredVariables(e,t,n,s){const i=[new d(t,n,null)];let a=n;for(;s.matchDelimiter("=")&&(s.eatDelimiter("="),i[i.length-1].expression=r.ExpressionParser.parse(e,s,!1,!1,t)),s.matchDelimiter(",");){s.eatDelimiter(",");const[n,r]=s.tell();a=s.eatIdentifier(),e.declareVariable(a,t,n,r,s),i.push(new d(t,a,null))}if(s.matchDelimiter("["))throw new Error(s.formatError("array declaration is not supported, use malloc instead"));return s.eatDelimiter(";"),i}static parse(e,t,n,r,c,d){let h=s.PrimitiveType.VOID;if(!t.matchDataType())throw new Error(t.formatError("declaration statement expected"));h=t.eatDataType();const[p,g]=t.tell(),m=t.eatIdentifier();if(t.matchDelimiter("(")){if(!d)throw new Error(t.formatError("function definition is not allowed here"));const n=i.Frame.extend(e),s=l.parseFormalParameterList(n,t,m),r=new o.SelfDefinedFunction(h,m,s,null);return e.declareFunction(m,r,p,g,t),t.matchDelimiter("{")?r.body=a.Block.parse(n,t,!1,!1,h,!0):t.eatDelimiter(";"),[new u(h,m,s,r.body)]}if(h==s.PrimitiveType.VOID)throw new Error(t.formatError("variable has incomplete type 'void'"));return e.declareVariable(m,h,p,g,t),this.parseDeclaredVariables(e,h,m,t)}}t.Declaration=l;class d extends l{constructor(e,t,n){super(),this.variableType=e,this.variableName=t,this.expression=n}doExecute(e,t){if(e.declareVariable(this.variableName,this.variableType),null!=this.expression){const n=this.expression.evaluate(e,t);if(void 0==n)throw new Error("impossible execution path");e.assignValue(this.variableName,n)}}}class u extends l{constructor(e,t,n,s){super(),this.returnType=e,this.functionName=t,this.parameterList=n,this.body=s}doExecute(e,t){e.declareFunction(this.functionName,new o.SelfDefinedFunction(this.returnType,this.functionName,this.parameterList,this.body))}}t.FunctionDeclaration=u},283:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoopStatement=void 0;const s=n(151);class i extends s.Statement{resetLoopCounter(){this.loopCounter=0}incrementLoopCounter(e){if(this.loopCounter++,this.loopCounter>=i.MAX_LOOP_COUNT)throw e.currentLine=this.row,new Error("maximum loop count exceeded.")}}t.LoopStatement=i,i.MAX_LOOP_COUNT=Math.pow(2,20)},29:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return u})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return p})),n.d(t,"n",(function(){return g})),n.d(t,"o",(function(){return m})),n.d(t,"p",(function(){return b})),n.d(t,"k",(function(){return f})),n.d(t,"r",(function(){return v})),n.d(t,"x",(function(){return y})),n.d(t,"s",(function(){return j})),n.d(t,"t",(function(){return x})),n.d(t,"q",(function(){return O})),n.d(t,"u",(function(){return S})),n.d(t,"v",(function(){return w})),n.d(t,"w",(function(){return C})),n.d(t,"y",(function(){return E})),n.d(t,"z",(function(){return T})),n.d(t,"A",(function(){return k})),n.d(t,"B",(function(){return A})),n.d(t,"C",(function(){return _})),n.d(t,"E",(function(){return I})),n.d(t,"F",(function(){return N})),n.d(t,"D",(function(){return P})),n.d(t,"H",(function(){return R})),n.d(t,"G",(function(){return M})),n.d(t,"I",(function(){return L})),n.d(t,"J",(function(){return D})),n.d(t,"L",(function(){return B})),n.d(t,"K",(function(){return U})),n.d(t,"i",(function(){return G}));const s="ADD_HTML_CONSOLE_ERROR",i="BEGIN_CLEAR_CONTEXT",a="BROWSE_REPL_HISTORY_DOWN",r="BROWSE_REPL_HISTORY_UP",o="CHANGE_EXEC_TIME",c="CHANGE_EXTERNAL_LIBRARY",l="CHANGE_SIDE_CONTENT_HEIGHT",d="CHANGE_STEP_LIMIT",u="CHAPTER_SELECT",h="CLEAR_REPL_INPUT",p="CLEAR_REPL_OUTPUT",g="CLEAR_REPL_OUTPUT_LAST",m="END_CLEAR_CONTEXT",b="EVAL_EDITOR",f="CHECK_EDITOR",v="EVAL_REPL",y="PROMPT_AUTOCOMPLETE",j="EVAL_SILENT",x="EVAL_TESTCASE",O="EVAL_EDITOR_AND_TESTCASES",S="MOVE_CURSOR",w="NAV_DECLARATION",C="PLAYGROUND_EXTERNAL_SELECT ",E="RESET_TESTCASE",T="RESET_WORKSPACE",k="SEND_REPL_INPUT_TO_OUTPUT",A="TOGGLE_EDITOR_AUTORUN",_="TOGGLE_USING_SUBST",I="UPDATE_CURRENT_ASSESSMENT_ID",N="UPDATE_CURRENT_SUBMISSION_ID",P="UPDATE_ACTIVE_EDITOR_TAB",R="UPDATE_EDITOR_VALUE",M="UPDATE_EDITOR_BREAKPOINTS",L="UPDATE_HAS_UNSAVED_CHANGES",D="UPDATE_REPL_VALUE",B="UPDATE_WORKSPACE",U="UPDATE_SUBLANGUAGE",G="CHANGE_SUBLANGUAGE"},30:function(e,t,n){"use strict";n.d(t,"D",(function(){return u})),n.d(t,"w",(function(){return h})),n.d(t,"r",(function(){return p})),n.d(t,"N",(function(){return g})),n.d(t,"M",(function(){return m})),n.d(t,"E",(function(){return b})),n.d(t,"l",(function(){return f})),n.d(t,"f",(function(){return v})),n.d(t,"n",(function(){return y})),n.d(t,"t",(function(){return j})),n.d(t,"h",(function(){return x})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return S})),n.d(t,"X",(function(){return w})),n.d(t,"W",(function(){return C})),n.d(t,"Q",(function(){return E})),n.d(t,"S",(function(){return T})),n.d(t,"k",(function(){return k})),n.d(t,"v",(function(){return A})),n.d(t,"g",(function(){return _})),n.d(t,"x",(function(){return I})),n.d(t,"i",(function(){return N})),n.d(t,"B",(function(){return P})),n.d(t,"C",(function(){return R})),n.d(t,"p",(function(){return M})),n.d(t,"o",(function(){return L})),n.d(t,"F",(function(){return D})),n.d(t,"H",(function(){return B})),n.d(t,"G",(function(){return U})),n.d(t,"J",(function(){return G})),n.d(t,"s",(function(){return F})),n.d(t,"A",(function(){return H})),n.d(t,"u",(function(){return V})),n.d(t,"I",(function(){return W})),n.d(t,"d",(function(){return $})),n.d(t,"V",(function(){return X})),n.d(t,"c",(function(){return q})),n.d(t,"Y",(function(){return z})),n.d(t,"q",(function(){return Y})),n.d(t,"L",(function(){return K})),n.d(t,"j",(function(){return Q})),n.d(t,"K",(function(){return J})),n.d(t,"R",(function(){return Z})),n.d(t,"y",(function(){return ee})),n.d(t,"O",(function(){return te})),n.d(t,"P",(function(){return ne})),n.d(t,"T",(function(){return se})),n.d(t,"e",(function(){return ie})),n.d(t,"m",(function(){return ae})),n.d(t,"U",(function(){return re})),n.d(t,"z",(function(){return oe}));var s=n(2),i=n(85),a=n(25);const r=e=>({uuid:e.uuid||"",text:e.text||"",achievementUuids:e.achievementUuids,meta:"Event"===e.meta.type?{...e.meta,release:e.meta.release?new Date(e.meta.release):void 0,deadline:e.meta.deadline?new Date(e.meta.deadline):void 0,observeFrom:e.meta.observeFrom?new Date(e.meta.observeFrom):void 0,observeTo:e.meta.observeTo?new Date(e.meta.observeTo):void 0}:e.meta,count:e.count,targetCount:e.targetCount,completed:e.count>=e.targetCount});var o=n(18),c=n(8);var l=n(16),d=n(10);const u=async(e,t,n,s)=>{const i=await re("auth/login","POST",{body:{code:e,provider:t,...n?{client_id:n}:{},...s?{redirect_uri:s}:{}},errorMessage:"Could not login. Please contact the module administrator."});if(!i)return null;const a=await i.json();return{accessToken:a.access_token,refreshToken:a.refresh_token}},h=async e=>{const t=await re("user","GET",{...e,shouldRefresh:!0});return t&&t.ok?await t.json():{user:null,courseRegistration:null,courseConfiguration:null,assessmentConfigurations:null}},p=async e=>{const t=await re("user/latest_viewed_course","GET",{...e,shouldRefresh:!0});return t&&t.ok?await t.json():{courseRegistration:null,courseConfiguration:null,assessmentConfigurations:null}},g=async(e,t)=>await re("user/latest_viewed_course","PUT",{...e,body:{courseId:t},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),m=async(e,t)=>await re(`${le()}/user/research_agreement`,"PUT",{...e,body:{agreedToResearch:t},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),b=async(e,t)=>await re("config/create","POST",{...e,body:{...t},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),f=async e=>{const t=await re(`${le()}/config`,"GET",{...e,shouldRefresh:!0});return t&&t.ok?t.json():null},v=async e=>{const t=await re(`${le()}/achievements`,"GET",{...e,shouldRefresh:!0});if(!t||!t.ok)return null;return(await t.json()).map((e=>(e=>({uuid:e.uuid||"",title:e.title||"",xp:e.xp,isVariableXp:e.isVariableXp,deadline:null===e.deadline?void 0:new Date(e.deadline),release:null===e.release?void 0:new Date(e.release),isTask:e.isTask,position:e.position,prerequisiteUuids:e.prerequisiteUuids,goalUuids:e.goalUuids,cardBackground:e.cardBackground||"",view:{coverImage:e.view.coverImage||"",completionText:e.view.completionText||"",description:e.view.description||""}}))(e)))},y=async(e,t)=>{const n=await re(`${le()}/admin/users/${t}/goals`,"GET",{...e,shouldRefresh:!0});if(!n||!n.ok)return null;return(await n.json()).map((e=>r(e)))},j=async e=>{const t=await re(`${le()}/self/goals`,"GET",{...e,shouldRefresh:!0});if(!t||!t.ok)return null;return(await t.json()).map((e=>r(e)))},x=async e=>{const t=await re(`${le()}/admin/users`,"GET",{...e,shouldRefresh:!0});if(!t||!t.ok)return null;return(await t.json()).map((e=>({name:e.name,courseRegId:e.courseRegId,group:e.group,username:e.username})))};async function O(e,t){return await re(`${le()}/admin/achievements`,"PUT",{accessToken:t.accessToken,body:{achievements:e.map((e=>(e=>({...e,deadline:e.deadline?e.deadline:null,release:e.release?e.release:null}))(e)))},noHeaderAccept:!0,refreshToken:t.refreshToken,shouldAutoLogout:!1,shouldRefresh:!0})}async function S(e,t){return await re(`${le()}/admin/goals`,"PUT",{accessToken:t.accessToken,body:{goals:e.map((e=>(e=>({targetCount:e.meta.type===a.l.ASSESSMENT?1:e.meta.targetCount,meta:e.meta,text:e.text,type:e.meta.type,uuid:e.uuid}))(e)))},noHeaderAccept:!0,refreshToken:t.refreshToken,shouldAutoLogout:!1,shouldRefresh:!0})}const w=async(e,t)=>await re(`${le()}/self/goals/${e.uuid}/progress`,"POST",{...t,body:{progress:e},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),C=async(e,t,n)=>await re(`${le()}/admin/users/${e}/goals/${t.uuid}/progress`,"POST",{...n,body:{progress:t},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),E=async(e,t)=>await re(`${le()}/admin/achievements/${e}`,"DELETE",{...t,body:{uuid:e},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),T=async(e,t)=>await re(`${le()}/admin/goals/${e}`,"DELETE",{...t,body:{uuid:e},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),k=async e=>{const t=await re(`${le()}/assessments`,"GET",{...e,shouldRefresh:!0});if(!t||!t.ok)return null;return(await t.json()).map((e=>(e.gradingStatus=ce(e.isManuallyGraded,e.status,e.gradedCount,e.questionCount),delete e.gradedCount,delete e.questionCount,e)))},A=async(e,t)=>{let n;if(n=void 0!==t?await re(`${le()}/admin/users/${t}/total_xp`,"GET",{...e,shouldRefresh:!0}):await re(`${le()}/user/total_xp`,"GET",{...e,shouldRefresh:!0}),!n||!n.ok)return null;return await n.json()},_=async e=>{const t=await re(`${le()}/admin/users/total_xp`,"GET",{...e,shouldRefresh:!0});if(!t||!t.ok)return null;return await t.json()},I=async(e,t)=>{const n=await re(`${le()}/admin/users/${e}/assessments`,"GET",{...t,shouldRefresh:!0});if(!n||!n.ok)return null;return(await n.json()).map((e=>(e.gradingStatus=ce(e.isManuallyGraded,e.status,e.gradedCount,e.questionCount),delete e.gradedCount,delete e.questionCount,e)))},N=async(e,t,n)=>{let s;for(s=void 0!==n?await re(`${le()}/admin/users/${n}/assessments/${e}`,"GET",{...t,shouldRefresh:!0}):await re(`${le()}/assessments/${e}`,"GET",{...t,shouldAutoLogout:!1,shouldRefresh:!0});s&&403===s.status;){const n=window.prompt("Please enter password.","");if(!n)return s=null,window.history.back(),null;s=await re(`${le()}/assessments/${e}/unlock`,"POST",{...t,body:{password:n},shouldAutoLogout:!1,shouldRefresh:!0})}if(!s||!s.ok)return null;const i=await s.json();return i.questions=i.questions.map((e=>{if(e.type===o.d.programming){const t=e;t.autogradingResults=t.autogradingResults||[],t.prepend=t.prepend||"",t.postpend=t.postpend||"",t.testcases=t.testcases||[],e=t}if(e.type===o.d.voting){const t=e;t.prepend=t.prepend||"",t.postpend=t.postpend||""}return null===e.grader&&(delete e.grader,delete e.gradedAt),e.library.external.name=e.library.external.name.toUpperCase(),e.library.globals=Object.entries(e.library.globals).map((e=>{try{e[1]=window.eval(e[1])}catch(t){}return e})),e})),i},P=async(e,t,n)=>await re(`${le()}/assessments/question/${e}/answer`,"POST",{...n,body:"object"==typeof t?{answer:t}:{answer:`${t}`},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),R=async(e,t)=>await re(`${le()}/assessments/${e}/submit`,"POST",{...t,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),M=async(e,t)=>{const n=await re(`${le()}/admin/grading?group=${t}`,"GET",{...e,shouldRefresh:!0});if(!n)return null;return(await n.json()).map((e=>{const t={assessmentId:e.assessment.id,assessmentName:e.assessment.title,assessmentType:e.assessment.type,studentId:e.student.id,studentName:e.student.name,submissionId:e.id,submissionStatus:e.status,groupName:e.student.groupName,groupLeaderId:e.student.groupLeaderId,gradingStatus:"none",questionCount:e.assessment.questionCount,gradedCount:e.gradedCount,initialXp:e.xp,xpAdjustment:e.xpAdjustment,currentXp:e.xp+e.xpAdjustment,maxXp:e.assessment.maxXp,xpBonus:e.xpBonus};return t.gradingStatus=ce(e.assessment.isManuallyGraded,t.submissionStatus,t.gradedCount,t.questionCount),t})).sort(((e,t)=>e.assessmentId!==t.assessmentId?t.assessmentId-e.assessmentId:t.submissionId-e.submissionId))},L=async(e,t)=>{const n=await re(`${le()}/admin/grading/${e}`,"GET",{...t,shouldRefresh:!0});if(!n)return null;return(await n.json()).map((e=>{const{student:t,question:n,grade:s}=e,i={question:{answer:n.answer,autogradingResults:n.autogradingResults||[],choices:n.choices,content:n.content,id:n.id,library:(a=n.library,{external:{name:a.external.name.toUpperCase(),symbols:a.external.symbols},execTimeMs:null==a.execTimeMs?void 0:a.execTimeMs,variant:null==a.variant?void 0:a.variant,globals:Object.entries(a.globals).map((e=>{try{e[1]=window.eval(e[1])}catch(t){}return e}))}),solution:e.solution||n.solution||null,solutionTemplate:n.solutionTemplate,prepend:n.prepend||"",postpend:n.postpend||"",testcases:n.testcases||[],type:n.type,maxXp:n.maxXp},student:t,grade:{xp:s.xp,xpAdjustment:s.xpAdjustment,comments:s.comments}};var a;return null!==e.grade.grader&&(i.grade.grader=e.grade.grader,i.grade.gradedAt=e.grade.gradedAt),i}))},D=async(e,t,n,s,i)=>await re(`${le()}/admin/grading/${e}/${t}`,"POST",{...s,body:{grading:{xpAdjustment:n,comments:i}},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),B=async(e,t)=>await re(`${le()}/admin/grading/${e}/autograde`,"POST",{...t,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),U=async(e,t,n)=>await re(`${le()}/admin/grading/${e}/${t}/autograde`,"POST",{...n,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),G=async(e,t)=>await re(`${le()}/admin/grading/${e}/unsubmit`,"POST",{...t,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),F=async e=>{const t=await re(`${le()}/notifications`,"GET",{...e,shouldAutoLogout:!1});let n=[];if(!t||!t.ok)return n;return n=(await t.json()).map((e=>({id:e.id,type:e.type,assessment_id:e.assessment_id||void 0,assessment_type:e.assessment?e.assessment.type:void 0,assessment_title:e.assessment?e.assessment.title:void 0,submission_id:e.submission_id||void 0}))),n},H=async(e,t)=>await re(`${le()}/notifications/acknowledge`,"POST",{...e,body:{notificationIds:t},shouldAutoLogout:!1}),V=async e=>{const t=await re(`${le()}/sourcecast`,"GET",{...e,shouldAutoLogout:!1,shouldRefresh:!0});return t&&t.ok?await t.json():null},W=async(e,t,n,s,i,a)=>{const r=new FormData,o=Date.now().toString()+".wav";r.append("sourcecast[title]",e),r.append("sourcecast[description]",t),r.append("sourcecast[uid]",n),r.append("sourcecast[audio]",s,o),r.append("sourcecast[playbackData]",JSON.stringify(i));return await re(`${le()}/admin/sourcecast`,"POST",{...a,body:r,noContentType:!0,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0})},$=async(e,t)=>await re(`${le()}/admin/sourcecast/${e}`,"DELETE",{...t,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),X=async(e,t,n)=>await re(`${le()}/admin/assessments/${e}`,"POST",{...n,body:t,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),q=async(e,t)=>await re(`${le()}/admin/assessments/${e}`,"DELETE",{...t,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),z=async(e,t,n,s)=>{const i=new FormData;i.append("assessment[file]",e),i.append("forceUpdate",String(n)),i.append("assessmentConfigId",String(s));return await re(`${le()}/admin/assessments`,"POST",{...t,body:i,noContentType:!0,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0})},Y=async e=>{const t=await re(`${le()}/admin/grading/summary`,"GET",{...e,shouldRefresh:!0});return t&&t.ok?await t.json():null},K=async(e,t)=>await re(`${le()}/admin/config`,"PUT",{...e,body:t,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),Q=async e=>{const t=await re(`${le()}/admin/config/assessment_configs`,"GET",{...e,shouldRefresh:!0});return t&&t.ok?await t.json():null},J=async(e,t,n)=>await re(`${null!=n?`courses/${n}`:le()}/admin/config/assessment_configs`,"PUT",{...e,body:{assessmentConfigs:t},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),Z=async(e,t)=>await re(`${le()}/admin/config/assessment_config/${t.assessmentConfigId}`,"DELETE",{...e,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),ee=async e=>{const t=await re(`${le()}/admin/users`,"GET",{...e,shouldRefresh:!0});return t&&t.ok?await t.json():null},te=async(e,t,n)=>await re(`${le()}/admin/users`,"PUT",{...e,body:{users:t,provider:n},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),ne=async(e,t,n)=>await re(`${le()}/admin/users/${t}/role`,"PUT",{...e,body:{role:n},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),se=async(e,t)=>await re(`${le()}/admin/users/${t}`,"DELETE",{...e,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0});async function ie(e){const t=await re("devices","GET",{accessToken:e.accessToken,refreshToken:e.refreshToken,shouldRefresh:!0});return t&&t.ok?t.json():null}async function ae(e,t){const n=await re(`devices/${e.id}/ws_endpoint`,"GET",{accessToken:t.accessToken,refreshToken:t.refreshToken,shouldRefresh:!0,shouldAutoLogout:!1});return n&&n.ok?n.json():null}const re=async(e,t,n)=>{const s=new Headers;n.noHeaderAccept||s.append("Accept","application/json"),n.accessToken&&s.append("Authorization",`Bearer ${n.accessToken}`);const a={method:t,headers:s};n.body&&(n.noContentType?a.body=n.body:(s.append("Content-Type","application/json"),a.body=JSON.stringify(n.body)));try{const s=await fetch(`${l.b.backendUrl}/v2/${e}`,a);if(n.shouldRefresh&&s&&401===s.status){const s=await(async e=>{const t=await re("auth/refresh","POST",{body:{refresh_token:e}});if(!t)return null;const n=await t.json();return{accessToken:n.access_token,refreshToken:n.refresh_token}})(n.refreshToken);i.a.dispatch(c.a.setTokens(s));const a={...n,accessToken:s.accessToken,shouldRefresh:!1};return re(e,t,a)}return s&&!s.ok&&!1===n.shouldAutoLogout||s.ok?s:(Object(d.e)(n.errorMessage?n.errorMessage:`Error while communicating with backend: ${s.status} ${s.statusText}${401===s.status||403===s.status?"; try logging in again, after manually saving any work.":""}`),null)}catch(r){return Object(d.e)(n.errorMessage?n.errorMessage:"Error while communicating with backend; check your network?"),null}};function*oe(e){if(!e)return void(yield Object(s.a)(d.e,"Couldn't reach our servers. Are you online?"));let t=yield e.text();t.length>100&&e.status&&(t=`Something went wrong (got ${e.status} response)`),yield Object(s.a)(d.e,t)}const ce=(e,t,n,s)=>e&&"submitted"===t?0===n?"none":n===s?"graded":"grading":"excluded",le=()=>{const e=i.a.getState().session.courseId;if(e)return`courses/${e}`;throw Object(d.e)("No course selected!",1e3),new Error("No course selected")}},332:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProp=t.setProp=t.evaluateBinaryExpression=t.binaryOp=t.evaluateUnaryExpression=t.unaryOp=t.boolOrErr=t.callIfFuncAndRightArgs=t.makeLazyFunction=t.wrapLazyCallee=t.forceIt=void 0;const s=n(241),i=n(136),a=n(272),r=n(333),o=n(333),c=n(501),l=n(334);function d(e){if(void 0!==e&&null!==e&&void 0!==e.isMemoized){if(e.isMemoized)return e.memoizedValue;const t=d(e.f());return e.isMemoized=!0,e.memoizedValue=t,t}return e}function u(e,t){return"!"===e?!t:"-"===e?-t:"typeof"===e?typeof t:+t}function h(e,t,n){switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"/":return t/n;case"%":return t%n;case"===":return t===n;case"!==":return t!==n;case"<=":return t<=n;case"<":return t<n;case">":return t>n;case">=":return t>=n;default:return}}t.forceIt=d,t.wrapLazyCallee=function(e){if("function"===typeof(e=d(e))){const t=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e(...n.map(d))};return(0,c.makeWrapper)(e,t),t[Symbol.toStringTag]=()=>e.toString(),t.toString=()=>e.toString(),t}if(e instanceof s.LazyBuiltIn){if(e.evaluateArgs){const t=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e.func(...n.map(d))};return(0,c.makeWrapper)(e.func,t),t[Symbol.toStringTag]=()=>e.toString(),t.toString=()=>e.toString(),t}return e}return e},t.makeLazyFunction=function(e){return new s.LazyBuiltIn(e,!1)},t.callIfFuncAndRightArgs=function(e,t,n){for(var r=arguments.length,c=new Array(r>3?r-3:0),l=3;l<r;l++)c[l-3]=arguments[l];const u=o.callExpression(o.locationDummyNode(t,n),c,{start:{line:t,column:n},end:{line:t,column:n}});if("function"===typeof e){const t=e;void 0!==e.transformedFunction&&(e=e.transformedFunction);const n=e.length,s=c.length,r=void 0!==e.minArgsNeeded;if(r?e.minArgsNeeded>s:n!==s)throw new i.InvalidNumberOfArguments(u,r?e.minArgsNeeded:n,s,r);try{return t(...c.map(d))}catch(h){throw h instanceof a.RuntimeSourceError||h instanceof i.ExceptionError?h:new i.ExceptionError(h,u.loc)}}else{if(!(e instanceof s.LazyBuiltIn))throw new i.CallingNonFunctionValue(e,u);try{return e.evaluateArgs&&(c=c.map(d)),e.func(...c)}catch(h){throw h instanceof a.RuntimeSourceError||h instanceof i.ExceptionError?h:new i.ExceptionError(h,u.loc)}}},t.boolOrErr=function(e,t,n){e=d(e);const s=l.checkIfStatement(o.locationDummyNode(t,n),e);if(void 0===s)return e;throw s},t.unaryOp=function(e,t,n,s){t=d(t);const i=l.checkUnaryExpression(o.locationDummyNode(n,s),e,t);if(void 0===i)return u(e,t);throw i},t.evaluateUnaryExpression=u,t.binaryOp=function(e,t,n,s,i){t=d(t),n=d(n);const a=l.checkBinaryExpression(o.locationDummyNode(s,i),e,t,n);if(void 0===a)return h(e,t,n);throw a},t.evaluateBinaryExpression=h;t.setProp=(e,t,n,s,i)=>{const a=(0,r.locationDummyNode)(s,i),o=l.checkMemberAccess(a,e,t);if(void 0===o)return e[t]=n;throw o};t.getProp=(e,t,n,s)=>{const a=(0,r.locationDummyNode)(n,s),o=l.checkMemberAccess(a,e,t);if(void 0===o){if(void 0===e[t]||e.hasOwnProperty(t))return e[t];throw new i.GetInheritedPropertyError(a,e,t)}throw o}},333:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.whileStatement=t.ifStatement=t.variableDeclarator=t.variableDeclaration=t.arrowFunctionExpression=t.blockExpression=t.functionDeclaration=t.functionDeclarationExpression=t.primitive=t.unaryExpression=t.binaryExpression=t.assignmentExpression=t.arrayExpression=t.conditionalExpression=t.mutateToConditionalExpression=t.logicalExpression=t.mutateToMemberExpression=t.mutateToReturnStatement=t.mutateToExpressionStatement=t.mutateToAssignmentExpression=t.mutateToCallExpression=t.objectExpression=t.property=t.returnStatement=t.program=t.blockStatement=t.functionExpression=t.blockArrowFunction=t.expressionStatement=t.callExpression=t.constantDeclaration=t.declaration=t.memberExpression=t.literal=t.identifier=t.locationDummyNode=t.getVariableDecarationName=void 0;t.getVariableDecarationName=e=>e.declarations[0].id.name;t.locationDummyNode=(e,n)=>(0,t.literal)("Dummy",{start:{line:e,column:n},end:{line:e,column:n}});t.identifier=(e,t)=>({type:"Identifier",name:e,loc:t});t.literal=(e,t)=>({type:"Literal",value:e,loc:t});t.memberExpression=(e,n)=>({type:"MemberExpression",object:e,computed:"number"===typeof n,optional:!1,property:"number"===typeof n?(0,t.literal)(n):(0,t.identifier)(n)});t.declaration=(e,n,s,i)=>({type:"VariableDeclaration",declarations:[{type:"VariableDeclarator",id:(0,t.identifier)(e),init:s}],kind:n,loc:i});t.constantDeclaration=(e,n,s)=>(0,t.declaration)(e,"const",n,s);t.callExpression=(e,t,n)=>({type:"CallExpression",callee:e,arguments:t,optional:!1,loc:n});t.expressionStatement=e=>({type:"ExpressionStatement",expression:e});t.blockArrowFunction=(e,n,s)=>({type:"ArrowFunctionExpression",expression:!1,generator:!1,params:e,body:Array.isArray(n)?(0,t.blockStatement)(n):n,loc:s});t.functionExpression=(e,n,s)=>({type:"FunctionExpression",id:null,async:!1,generator:!1,params:e,body:Array.isArray(n)?(0,t.blockStatement)(n):n,loc:s});t.blockStatement=e=>({type:"BlockStatement",body:e});t.program=e=>({type:"Program",sourceType:"module",body:e});t.returnStatement=(e,t)=>({type:"ReturnStatement",argument:e,loc:t});t.property=(e,n)=>({type:"Property",method:!1,shorthand:!1,computed:!1,key:(0,t.identifier)(e),value:n,kind:"init"});t.objectExpression=e=>({type:"ObjectExpression",properties:e});t.mutateToCallExpression=(e,t,n)=>{e.type="CallExpression",(e=e).callee=t,e.arguments=n};t.mutateToAssignmentExpression=(e,t,n)=>{e.type="AssignmentExpression",(e=e).operator="=",e.left=t,e.right=n};t.mutateToExpressionStatement=(e,t)=>{e.type="ExpressionStatement",(e=e).expression=t};t.mutateToReturnStatement=(e,t)=>{e.type="ReturnStatement",(e=e).argument=t};t.mutateToMemberExpression=(e,t,n)=>{e.type="MemberExpression",(e=e).object=t,e.property=n,e.computed=!1};t.logicalExpression=(e,t,n,s)=>({type:"LogicalExpression",operator:e,left:t,right:n,loc:s});t.mutateToConditionalExpression=(e,t,n,s)=>{e.type="ConditionalExpression",(e=e).test=t,e.consequent=n,e.alternate=s};t.conditionalExpression=(e,t,n,s)=>({type:"ConditionalExpression",test:e,consequent:t,alternate:n,loc:s});t.arrayExpression=e=>({type:"ArrayExpression",elements:e});t.assignmentExpression=(e,t)=>({type:"AssignmentExpression",operator:"=",left:e,right:t});t.binaryExpression=(e,t,n,s)=>({type:"BinaryExpression",operator:e,left:t,right:n,loc:s});t.unaryExpression=(e,t,n)=>({type:"UnaryExpression",operator:e,prefix:!0,argument:t,loc:n});t.primitive=e=>void 0===e?(0,t.identifier)("undefined"):(0,t.literal)(e);t.functionDeclarationExpression=(e,t,n,s)=>({type:"FunctionExpression",id:e,params:t,body:n,loc:s});t.functionDeclaration=(e,t,n,s)=>({type:"FunctionDeclaration",id:e,params:t,body:n,loc:s});t.blockExpression=(e,t)=>({type:"BlockExpression",body:e,loc:t});t.arrowFunctionExpression=(e,t,n)=>({type:"ArrowFunctionExpression",expression:"BlockStatement"!==t.type,generator:!1,params:e,body:t,loc:n});t.variableDeclaration=(e,t)=>({type:"VariableDeclaration",kind:"const",declarations:e,loc:t});t.variableDeclarator=(e,t,n)=>({type:"VariableDeclarator",id:e,init:t,loc:n});t.ifStatement=(e,t,n,s)=>({type:"IfStatement",test:e,consequent:t,alternate:n,loc:s});t.whileStatement=(e,t,n)=>({type:"WhileStatement",test:t,body:e,loc:n})},334:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIdentifier=t.checkMemberAccess=t.checkIfStatement=t.checkBinaryExpression=t.checkUnaryExpression=t.TypeError=void 0;const s=n(272),i=n(27),a=" on left hand side of operation",r=" on right hand side of operation";class o extends s.RuntimeSourceError{constructor(e,t,n,s){super(e),this.side=t,this.expected=n,this.got=s,this.type=i.ErrorType.RUNTIME,this.severity=i.ErrorSeverity.ERROR}explain(){return`Expected ${this.expected}${this.side}, got ${this.got}.`}elaborate(){return this.explain()}}t.TypeError=o;const c=e=>null===e?"null":Array.isArray(e)?"array":typeof e,l=e=>"number"===c(e),d=e=>"string"===c(e),u=e=>"boolean"===c(e);t.checkUnaryExpression=(e,t,n)=>"+"!==t&&"-"!==t||l(n)?"!"!==t||u(n)?void 0:new o(e,"","boolean",c(n)):new o(e,"","number",c(n));t.checkBinaryExpression=(e,t,n,s)=>{switch(t){case"-":case"*":case"/":case"%":return l(n)?l(s)?void 0:new o(e,r,"number",c(s)):new o(e,a,"number",c(n));case"+":case"<":case"<=":case">":case">=":case"!==":case"===":return l(n)?l(s)?void 0:new o(e,r,"number",c(s)):d(n)?d(s)?void 0:new o(e,r,"string",c(s)):new o(e,a,"string or number",c(n));default:return}};t.checkIfStatement=(e,t)=>u(t)?void 0:new o(e," as condition","boolean",c(t));t.checkMemberAccess=(e,t,n)=>"object"===c(t)?d(n)?void 0:new o(e," as prop","string",c(n)):(e=>"array"===c(e))(t)?(e=>l(e)&&e>>>0===e&&e<2**32-1)(n)?void 0:l(n)?new o(e," as prop","array index","other number"):new o(e," as prop","array index",c(n)):new o(e,"","object or array",c(t));t.isIdentifier=e=>void 0!==e.name},34:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return h})),n.d(t,"e",(function(){return p}));var s=n(1),i=n.n(s),a=n(33),r=n(187),o=n(16);function c(e,t){const[n,s]=i.a.useState(t);return i.a.useEffect((()=>{(async()=>{const t=await e();s(t)})()}),[e]),{value:n,setValue:s}}function l(e){const[t,n]=i.a.useState(e);return{value:t,setValue:n,inputProps:{value:t,onChange:e=>{n(e.target.value)}}}}function d(e,t){const[n,s]=i.a.useState(((e,t)=>{const n=window.localStorage.getItem(e);return n?JSON.parse(n):t})(e,t));return i.a.useEffect((()=>{((e,t)=>{window.localStorage.setItem(e,JSON.stringify(t))})(e,n)}),[e,n]),[n,s]}const u=a.d,h=e=>{const[t,n]=i.a.useState(0),[s,a]=i.a.useState(0),r=i.a.useMemo((()=>new ResizeObserver(((e,t)=>{if(1!==e.length)throw new Error("Expected only a single HTML element to be observed by the ResizeObserver.");const s=e[0].contentRect;n(s.width),a(s.height)}))),[]);return i.a.useEffect((()=>{const t=e.current;if(null!==t)return r.observe(t),()=>r.disconnect()}),[e,r]),[t,s]},p=()=>({isMobileBreakpoint:Object(r.useMediaQuery)({maxWidth:o.b.mobileBreakpoint})})},351:function(e,t){ace.define("ace/theme/source",["require","exports","module","ace/lib/dom"],(function(e,t,n){t.isDark=!0,t.cssClass="ace-source",t.cssText=".ace-source .ace_gutter {                        background: #011e3a;                        color: rgb(128,145,160)                        }                        .ace-source .ace_print-margin {                        width: 1px;                        background: #555555                        }                        .ace-source {                        background-color: #002240;                        color: #FFFFFF                        }                        .ace-source .ace_cursor {                        color: #FFFFFF                        }                        .ace-source .ace_marker-layer .ace_selection {                        background: rgba(179, 101, 57, 0.75)                        }                        .ace-source.ace_multiselect .ace_selection.ace_start {                        box-shadow: 0 0 3px 0px #002240;                        }                        .ace-source .ace_marker-layer .ace_step {                        background: rgb(127, 111, 19)                        }                        .ace-source .ace_marker-layer .ace_bracket {                        background: #090;                        }                        .ace-terminal-theme .ace_marker-layer .ace_bracket-start {                        background: #090;                        }                        .ace-terminal-theme .ace_marker-layer .ace_bracket-unmatched {                        margin: -1px 0 0 -1px;                        border: 1px solid #900                        }                        .ace-source .ace_marker-layer .ace_active-line {                        background: rgba(0, 0, 0, 0.35)                        }                        .ace-source .ace_gutter-active-line {                        background-color: rgba(0, 0, 0, 0.35)                        }                        .ace-source .ace_marker-layer .ace_selected-word {                        border: 1px solid rgba(179, 101, 57, 0.75)                        }                        .ace-source .ace_invisible {                        color: rgba(255, 255, 255, 0.15)                        }                        .ace-source .ace_keyword,                        .ace-source .ace_meta {                        color: #FF9D00                        }                        .ace-source .ace_constant,                        .ace-source .ace_constant.ace_character,                        .ace-source .ace_constant.ace_other,                        .ace-source .ace_string,                        .ace-source .ace_string.ace_regexp {                        color: #FF628C                        }                        .ace-source .ace_constant.ace_character.ace_escape {                        color: #FFFFFF                        }                        .ace-source .ace_invalid {                        color: #F8F8F8;                        background-color: #800F00                        }                        .ace-source .ace_support {                        color: #80FFBB                        }                        .ace-source .ace_support.ace_constant {                        color: #EB939A                        }                        .ace-source .ace_fold {                        background-color: #FF9D00;                        border-color: #FFFFFF                        }                        .ace-source .ace_support.ace_function {                        color: #FFFFFF                        }                        .ace-source .ace_builtinconsts {                        color: #FFFFFF                        }                        .ace-source .ace_storage {                        color: #FFEE80                        }                        .ace-source .ace_entity {                        color: #FFDD00                        }                        .ace-source .ace_comment {                        font-style: italic;                        color: #0088FF                        }                        .ace-source .ace_heading,                        .ace-source .ace_markup.ace_heading {                        color: #C8E4FD;                        background-color: #001221                        }                        .ace-source .ace_list,                        .ace-source .ace_markup.ace_list {                        background-color: #130D26                        }                        .ace-source .ace_variable {                        color: #CCCCCC                        }                        .ace-source .ace_variable.ace_language {                        color: #FF80E1                        }                        .ace-source .ace_meta.ace_tag {                        color: #9EFFFF                        }                        .ace-source .ace_indent-guide {                        background: url(data:image/png;base64,                        iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbY                        nAAAAEklEQVQImWNgYGBgYHCLSvkPAAP3AgSDTRd4AAAAAElFTkSuQmCC) right repeat-y                        }                        .ace_dark.ace-source.ace_editor.ace_autocomplete {                        background-color: #2c3e50;                        border-color: #555555;                        color: white;                        }                        .ace_dark.ace-source.ace_editor.ace_autocomplete .ace_completion-highlight {                        color: #FF9D00;                        }                        .ace_dark.ace-source.ace_editor.ace_autocomplete .ace_content .ace_marker-layer .ace_active-line {                        border-color: #555555;                        background-color: #495a6b;                        }                        .ace_dark.ace-source.ace_editor.ace_autocomplete .ace_content .ace_marker-layer .ace_line-hover {                        border-color: #555555;                        background-color: #6b839a;                        }                        .ace_dark.ace-source.ace_editor.ace_autocomplete .ace_content.ace_text-layer .ace_rightAlignedText {                        color: #ced9e0;                        }                        .ace_tooltip.ace_doc-tooltip {                        width: 400px;                        max-height: 40vh;                        white-space: normal;                        overflow: auto;                        background-color: #495a6b;                        color: white;                        border-color:#555555;                        }                        .ace_tooltip.ace_doc-tooltip h4 {                        color: white;                        margin: 0 0 1em;                        }                        .ace_tooltip.ace_doc-tooltip a {                        color: #48aff0;                        }                        ",e("../lib/dom").importCssString(t.cssText,t.cssClass)}))},36:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return h}));const s="SAVE_SOURCECAST_DATA",i="SET_CURRENT_PLAYER_TIME",a="SET_CODE_DELTAS_TO_APPLY",r="SET_INPUT_TO_APPLY",o="SET_SOURCECAST_DATA",c="SET_SOURCECAST_PLAYBACK_DURATION",l="SET_SOURCECAST_PLAYBACK_STATUS";let d,u,h;!function(e){e.run="run"}(d||(d={})),function(e){e.forcedPaused="forcedPaused",e.playing="playing",e.paused="paused"}(u||(u={})),function(e){e.notStarted="notStarted",e.recording="recording",e.paused="paused",e.finished="finished"}(h||(h={}))},363:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SourceDocumentation=void 0;const s=n(554);t.SourceDocumentation={builtins:{},ext_lib:s}},368:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFilePath=t.validateFilePath=t.transformFunctionNameToInvokedFunctionResultVariableName=t.transformFilePathToValidFunctionName=t.nonAlphanumericCharEncoding=void 0;const s=n(277);t.nonAlphanumericCharEncoding={_:"_","/":"$",".":"$$$$dot$$$$","-":"$$$$dash$$$$"};t.transformFilePathToValidFunctionName=e=>{const n=Object.entries(t.nonAlphanumericCharEncoding).reduce(((e,t)=>{let[n,s]=t;return t=>e(t).replaceAll(n,s)}),(e=>e));return`__${n(e)}__`};t.transformFunctionNameToInvokedFunctionResultVariableName=e=>`_${e}_`;const i=e=>null!==/[a-zA-Z0-9]/i.exec(e);t.validateFilePath=e=>{if(e.includes("//"))return new s.ConsecutiveSlashesInFilePathError(e);for(const n of e)if(!i(n)&&!(n in t.nonAlphanumericCharEncoding))return new s.IllegalCharInFilePathError(e);return null};t.isFilePath=e=>e.includes("/")},369:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkConditionOperandType=t.checkBinaryExprssionOperandType=t.checkAssignmentOperandType=t.getHigherPrecisionType=t.checkUnaryMinusOperandType=t.checkSubscriptType=t.assertSubscritable=void 0;const s=n(126),i=n(278);function a(e,t,n,s,i){throw new Error(n.formatError("invalid operand type to binary expression ('"+s+"' and '"+i+"')",e,t))}function r(e,t){if(e instanceof s.PointerType)return e;if(t instanceof s.PointerType)return t;if(e==s.PrimitiveType.FLOAT||t==s.PrimitiveType.FLOAT)return s.PrimitiveType.FLOAT;if(e==s.PrimitiveType.INT||t==s.PrimitiveType.INT)return s.PrimitiveType.INT;if(e==s.PrimitiveType.CHAR&&t==s.PrimitiveType.CHAR)return s.PrimitiveType.CHAR;throw new Error("impossible execution path")}function o(e,t,n,o,c,l){if("+"==c||"-"==c){if(o instanceof s.PointerType){if("-"==c&&o.toString()==l.toString())return s.PrimitiveType.INT;s.WHOLE_PRIMITIVE_TYPES.has(l.toString())||a(e,t,n,o,l)}else"+"==c&&l instanceof s.PointerType?s.WHOLE_PRIMITIVE_TYPES.has(o.toString())||a(e,t,n,o,l):s.ARITH_PRIMITIVE_TYPES.has(o.toString())&&s.ARITH_PRIMITIVE_TYPES.has(l.toString())||a(e,t,n,o,l);return r(o,l)}if("*"==c||"/"==c)return s.ARITH_PRIMITIVE_TYPES.has(o.toString())&&s.ARITH_PRIMITIVE_TYPES.has(l.toString())||a(e,t,n,o,l),r(o,l);if("%"==c)return s.WHOLE_PRIMITIVE_TYPES.has(o.toString())&&s.WHOLE_PRIMITIVE_TYPES.has(l.toString())||a(e,t,n,o,l),r(o,l);{const r=i.RELATIONAL_OPERATOR_RETEX.exec(c);if("&&"==c||"||"==c||r&&r[0].length==c.length)return(o instanceof s.PointerType||s.ARITH_PRIMITIVE_TYPES.has(o.toString()))&&(l instanceof s.PointerType||s.ARITH_PRIMITIVE_TYPES.has(l.toString()))||a(e,t,n,o,l),s.PrimitiveType.INT;throw new Error("impossible execution path")}}t.assertSubscritable=function(e,t){if(!(e instanceof s.PointerType))throw new Error(t.formatError("subscripted value is not an array, pointer"))},t.checkSubscriptType=function(e,t,n,i){if(!s.WHOLE_PRIMITIVE_TYPES.has(e.toString()))throw new Error(i.formatError("array subscript is not an integer",t,n))},t.checkUnaryMinusOperandType=function(e,t,n,i){if(e instanceof s.PointerType)throw new Error(i.formatError("invalid argument type '"+e.toString()+"' to unary expression",t,n))},t.getHigherPrecisionType=r,t.checkAssignmentOperandType=function(e,t,n,i,a,c){let l=c;return"="!=a&&(l=o(e,t,n,i,a.replace("=",""),c)),function(e,t,n,i,a){if(i.toString()==a.toString())return;if(i==s.PrimitiveType.CHAR&&a==s.PrimitiveType.INT)return;if(i instanceof s.PointerType&&a instanceof s.PointerType&&(i.dereference()==s.PrimitiveType.VOID||a.dereference()==s.PrimitiveType.VOID))return;const o=new Error(n.formatError("implicit conversion from '"+a+"' to '"+i+"'",e,t));if(i instanceof s.PointerType||a instanceof s.PointerType)throw o;if(r(i,a).toString()!=i.toString())throw o}(e,t,n,i,l),i},t.checkBinaryExprssionOperandType=o,t.checkConditionOperandType=function(e,t,n,i){if(i==s.PrimitiveType.VOID)throw new Error(n.formatError("non-'void' type is required",e,t))}},37:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchAuth",(function(){return r})),n.d(t,"fetchUserAndCourse",(function(){return o})),n.d(t,"fetchCourseConfig",(function(){return c})),n.d(t,"fetchAssessment",(function(){return l})),n.d(t,"fetchAssessmentAdmin",(function(){return d})),n.d(t,"fetchAssessmentOverviews",(function(){return u})),n.d(t,"fetchTotalXp",(function(){return h})),n.d(t,"fetchTotalXpAdmin",(function(){return p})),n.d(t,"fetchAllUserXp",(function(){return g})),n.d(t,"fetchGrading",(function(){return m})),n.d(t,"fetchGradingOverviews",(function(){return b})),n.d(t,"login",(function(){return f})),n.d(t,"logoutGoogle",(function(){return v})),n.d(t,"loginGitHub",(function(){return y})),n.d(t,"logoutGitHub",(function(){return j})),n.d(t,"setTokens",(function(){return x})),n.d(t,"setUser",(function(){return O})),n.d(t,"setCourseConfiguration",(function(){return S})),n.d(t,"setCourseRegistration",(function(){return w})),n.d(t,"setAssessmentConfigurations",(function(){return C})),n.d(t,"setAdminPanelCourseRegistrations",(function(){return E})),n.d(t,"setGoogleUser",(function(){return T})),n.d(t,"setGitHubAssessment",(function(){return k})),n.d(t,"setGitHubOctokitObject",(function(){return A})),n.d(t,"setGitHubAccessToken",(function(){return _})),n.d(t,"removeGitHubOctokitObjectAndAccessToken",(function(){return I})),n.d(t,"submitAnswer",(function(){return N})),n.d(t,"submitAssessment",(function(){return P})),n.d(t,"submitGrading",(function(){return R})),n.d(t,"submitGradingAndContinue",(function(){return M})),n.d(t,"reautogradeSubmission",(function(){return L})),n.d(t,"reautogradeAnswer",(function(){return D})),n.d(t,"updateAssessmentOverviews",(function(){return B})),n.d(t,"updateTotalXp",(function(){return U})),n.d(t,"updateAllUserXp",(function(){return G})),n.d(t,"updateAssessment",(function(){return F})),n.d(t,"updateGradingOverviews",(function(){return H})),n.d(t,"updateGrading",(function(){return V})),n.d(t,"unsubmitSubmission",(function(){return W})),n.d(t,"fetchNotifications",(function(){return $})),n.d(t,"acknowledgeNotifications",(function(){return X})),n.d(t,"updateNotifications",(function(){return q})),n.d(t,"updateLatestViewedCourse",(function(){return z})),n.d(t,"updateCourseConfig",(function(){return Y})),n.d(t,"fetchAssessmentConfigs",(function(){return K})),n.d(t,"updateAssessmentConfigs",(function(){return Q})),n.d(t,"deleteAssessmentConfig",(function(){return J})),n.d(t,"fetchAdminPanelCourseRegistrations",(function(){return Z})),n.d(t,"updateUserRole",(function(){return ee})),n.d(t,"deleteUserCourseRegistration",(function(){return te})),n.d(t,"updateCourseResearchAgreement",(function(){return ne}));var s=n(7),i=n(245),a=n(15);const r=(e,t)=>Object(s.action)(a.j,{code:e,providerId:t}),o=()=>Object(s.action)(a.q),c=()=>Object(s.action)(a.k),l=e=>Object(s.action)(a.f,e),d=(e,t)=>Object(s.action)(a.g,{assessmentId:e,courseRegId:t}),u=()=>Object(s.action)(a.i),h=()=>Object(s.action)(a.o),p=e=>Object(s.action)(a.p,e),g=()=>Object(s.action)(a.e),m=e=>Object(s.action)(a.l,e),b=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Object(s.action)(a.m,e)},f=e=>Object(s.action)(a.r,e),v=()=>Object(s.action)(a.u),y=()=>Object(s.action)(a.s),j=()=>Object(s.action)(a.t),x=e=>{let{accessToken:t,refreshToken:n}=e;return Object(s.action)(a.G,{accessToken:t,refreshToken:n})},O=e=>Object(s.action)(a.H,e),S=e=>Object(s.action)(a.A,e),w=e=>Object(s.action)(a.B,e),C=e=>Object(s.action)(a.z,e),E=e=>Object(s.action)(a.y,e),T=e=>Object(s.action)(a.F,e),k=e=>Object(s.action)(a.D,e),A=e=>Object(s.action)(a.E,Object(i.a)(e||"")),_=e=>Object(s.action)(a.C,e),I=()=>Object(s.action)(a.x),N=(e,t)=>Object(s.action)(a.I,{id:e,answer:t}),P=e=>Object(s.action)(a.J,e),R=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;return Object(s.action)(a.K,{submissionId:e,questionId:t,xpAdjustment:n,comments:i})},M=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;return Object(s.action)(a.L,{submissionId:e,questionId:t,xpAdjustment:n,comments:i})},L=e=>Object(s.action)(a.w,e),D=(e,t)=>Object(s.action)(a.v,{submissionId:e,questionId:t}),B=e=>Object(s.action)(a.Q,e),U=e=>Object(s.action)(a.X,e),G=e=>Object(s.action)(a.N,e),F=e=>Object(s.action)(a.O,e),H=e=>Object(s.action)(a.U,e),V=(e,t)=>Object(s.action)(a.T,{submissionId:e,grading:t}),W=e=>Object(s.action)(a.M,{submissionId:e}),$=()=>Object(s.action)(a.n),X=e=>Object(s.action)(a.a,{withFilter:e}),q=e=>Object(s.action)(a.W,e),z=e=>Object(s.action)(a.V,{courseId:e}),Y=e=>Object(s.action)(a.R,e),K=()=>Object(s.action)(a.h),Q=e=>Object(s.action)(a.P,e),J=e=>Object(s.action)(a.b,e),Z=()=>Object(s.action)(a.d),ee=(e,t)=>Object(s.action)(a.Y,{courseRegId:e,role:t}),te=e=>Object(s.action)(a.c,{courseRegId:e}),ne=e=>Object(s.action)(a.S,{agreedToResearch:e})},370:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelfDefinedFunction=void 0;const s=n(126),i=n(211),a=n(117),r=n(161),o=n(281),c=n(280);class l extends c.Function{constructor(e,t,n,s){super(e,t),this.parameterList=n,this.body=s}isDefined(){return null!=this.body}call(e,t,n){if(null==this.body)throw new Error("function '"+this.functionName+"' has no definition yet");if(n.length!=this.parameterList.length)throw new Error("expected "+String(this.parameterList.length)+" parameters, but got "+String(n.length));const a=i.Frame.extendWithStackTop(t.baseFrame,e.getStackTop());this.parameterList.forEach((e=>a.declareVariable(e[1],e[0]))),n.forEach(((e,t)=>a.assignValue(this.parameterList[t][1],e)));try{if(this.body.execute(a,t),this.returnType!=s.PrimitiveType.VOID)return r.NumericLiteral.new(0).castToType(this.returnType)}catch(c){if(!(c instanceof o.Return))throw c;if(this.returnType!=s.PrimitiveType.VOID)return c.getEvaluated()}}parseActualParameters(e,t){const n=[];return t.eatDelimiter("("),this.parameterList.forEach(((s,i)=>{this.checkTooFewArguments(t),0!=i&&t.eatDelimiter(","),n.push(a.ExpressionParser.parse(e,t,!1,!1,s[0]))})),t.eatDelimiter(")"),n}toString(){let e=this.returnType.toString()+" "+this.functionName+"(";if(this.parameterList.length>0){e+=this.parameterList[0][0].toString();for(let t=1;t<this.parameterList.length;t++)e+=", "+this.parameterList[t][0].toString()}return e+")"}}t.SelfDefinedFunction=l},371:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionStatement=void 0;const s=n(117),i=n(151);class a extends i.Statement{constructor(e){super(),this.expression=e}doExecute(e,t){this.expression.evaluate(e,t)}static parse(e,t){const n=new a(s.ExpressionParser.parse(e,t,!0,!1,null));return t.eatDelimiter(";"),[n]}}t.ExpressionStatement=a},372:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedErrorPromise=t.determineVariant=void 0,t.determineVariant=function(e,t){return t.variant?t.variant:e.variant},t.resolvedErrorPromise=Promise.resolve({status:"error"})},39:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return y}));var s=n(1),i=n.n(s),a=n(155),r=n(16);const o=i.a.createContext(new a.a([],[]));let c,l;!function(e){e.RED="#f00",e.BLACK="#000"}(c||(c={})),function(e){e.BLUE="#4df",e.WHITE="#fff"}(l||(l={}));const d=`${r.a.sourceAcademyAssets}achievement`,u=`${d}/view-background`,h=`${d}/card-background`,p=`${d}/cover-image`,g=()=>({background:`url(${u}/exploration.png) no-repeat center/cover`}),m=()=>"#9ce",b=()=>({border:`1px solid ${m()}`,boxShadow:`0 0 10px ${m()}`}),f=(e,t)=>e===t?l.BLUE:l.WHITE,v=(e,t)=>e===t?b():void 0,y=1e3},407:function(e,t){},44:function(e,t,n){"use strict";var s=n(3),i=n(19),a=n.n(i),r=n(1),o=n(441),c=n(0);const l=e=>{const t=new o.Converter({tables:!0,simplifiedAutoLink:e.simplifiedAutoLink,strikethrough:e.strikethrough,tasklists:e.tasklists,openLinksInNewWindow:e.openLinksInNewWindow});return Object(c.jsx)("div",{className:a()(e.className?e.className:"md",s.a.RUNNING_TEXT),dangerouslySetInnerHTML:{__html:t.makeHtml(e.content)}})};t.a=r.memo(l)},440:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModeSelector=t.HighlightRulesSelector=void 0;const s=n(27),i=n(363);t.HighlightRulesSelector=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NONE",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];function a(n,a,r){const o=n("../lib/oop"),c=n("./doc_comment_highlight_rules").DocCommentHighlightRules,l=n("./text_highlight_rules").TextHighlightRules,d="[a-zA-Z\\$_\xa1-\uffff][a-zA-Z\\d\\$_\xa1-\uffff]*",u=e.toString()+"_"+t,h=i.SourceDocumentation.builtins[u];function p(e){const t=function(e){if(null===h)return"";let t="";for(const n in h)h[n].meta===e&&(t+="|"+n);return t}(e)+function(e){if(null===s)return"";let t="";return s.forEach((n=>{n.meta===e&&(t+="|"+n.caption)})),t}(e);return t.substr(1)}const g=()=>{const t=[];return e>=1&&t.push("import","const","else","if","return","function","debugger"),e>=3&&t.push("while","for","break","continue","let"),t.join("|")},m=function(e){const t=this.createKeywordMapper({builtinconsts:p("const"),"constant.language.boolean":"true|false","constant.language.null":"null",keyword:g(),"storage.type":"const|let|function","support.function":p("func"),"variable.language":"this|arguments|var|yield|async|await|with|switch|throw|try|eval|class|enum|extends|super|export|implements|private|public|interface|package|protected|static|in|of|instanceof|new|case|catch|default|delete|do|finally|"},"identifier"),n="\\\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|u{[0-9a-fA-F]{1,6}}|[0-2][0-7]{0,2}|3[0-7][0-7]?|[4-7][0-7]?|.)";this.$rules={no_regex:[c.getStartRule("doc-start"),f("no_regex"),{token:"string",regex:"'(?=.)",next:"qstring"},{token:"string",regex:'"(?=.)',next:"qqstring"},{token:"constant.numeric",regex:/0(?:[xX][0-9a-fA-F]+|[oO][0-7]+|[bB][01]+)\b/},{token:"constant.numeric",regex:/(?:\d\d*(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+\b)?/},{token:["storage.type","punctuation.operator","support.function","punctuation.operator","entity.name.function","text","keyword.operator"],regex:"("+d+")(\\.)(prototype)(\\.)("+d+")(\\s*)(=)",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+d+")(\\.)("+d+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+d+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+d+")(\\.)("+d+")(\\s*)(=)(\\s*)(function)(\\s+)(\\w+)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","text","entity.name.function","text","paren.lparen"],regex:"(function)(\\s+)("+d+")(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","punctuation.operator","text","storage.type","text","paren.lparen"],regex:"("+d+")(\\s*)(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["text","text","storage.type","text","paren.lparen"],regex:"(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:"keyword",regex:"from(?=\\s*('|\"))"},{token:"keyword",regex:"(?:else|return)\\b",next:"start"},{token:["support.constant"],regex:/that\b/},{token:["variable.language"],regex:/\.{3}|--+|\+\++|\^|(==|!=)[^=]|[$%&*+\-~\/^]=+|[^&]*&[^&]|[^\|]*\|[^\|]/},{token:t,regex:d},{token:"variable.language",regex:/[.](?![.])/,next:"property"},{token:"storage.type",regex:/=>/},{token:"keyword.operator",regex:/===|=|!==|<+=?|>+=?|!|&&|\|\||[%*+-\/]/,next:"start"},{token:"punctuation.operator",regex:/[?:,;.]/,next:"start"},{token:"paren.lparen",regex:/[\[({]/,next:"start"},{token:"paren.rparen",regex:/[\])}]/},{token:"comment",regex:/^#!.*$/}],property:[{token:"text",regex:"\\s+"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+d+")(\\.)("+d+")(\\s*)(=)(\\s*)(function)(?:(\\s+)(\\w+))?(\\s*)(\\()",next:"function_arguments"},{token:"punctuation.operator",regex:/[.](?![.])/},{token:"variable.language",regex:/(s(?:h(?:ift|ow(?:Mod(?:elessDialog|alDialog)|Help))|croll(?:X|By(?:Pages|Lines)?|Y|To)?|t(?:op|rike)|i(?:n|zeToContent|debar|gnText)|ort|u(?:p|b(?:str(?:ing)?)?)|pli(?:ce|t)|e(?:nd|t(?:Re(?:sizable|questHeader)|M(?:i(?:nutes|lliseconds)|onth)|Seconds|Ho(?:tKeys|urs)|Year|Cursor|Time(?:out)?|Interval|ZOptions|Date|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Date|FullYear)|FullYear|Active)|arch)|qrt|lice|avePreferences|mall)|h(?:ome|andleEvent)|navigate|c(?:har(?:CodeAt|At)|o(?:s|n(?:cat|textual|firm)|mpile)|eil|lear(?:Timeout|Interval)?|a(?:ptureEvents|ll)|reate(?:StyleSheet|Popup|EventObject))|t(?:o(?:GMTString|S(?:tring|ource)|U(?:TCString|pperCase)|Lo(?:caleString|werCase))|est|a(?:n|int(?:Enabled)?))|i(?:s(?:NaN|Finite)|ndexOf|talics)|d(?:isableExternalCapture|ump|etachEvent)|u(?:n(?:shift|taint|escape|watch)|pdateCommands)|j(?:oin|avaEnabled)|p(?:o(?:p|w)|ush|lugins.refresh|a(?:ddings|rse(?:Int|Float)?)|r(?:int|ompt|eference))|e(?:scape|nableExternalCapture|val|lementFromPoint|x(?:p|ec(?:Script|Command)?))|valueOf|UTC|queryCommand(?:State|Indeterm|Enabled|Value)|f(?:i(?:nd|le(?:ModifiedDate|Size|CreatedDate|UpdatedDate)|xed)|o(?:nt(?:size|color)|rward)|loor|romCharCode)|watch|l(?:ink|o(?:ad|g)|astIndexOf)|a(?:sin|nchor|cos|t(?:tachEvent|ob|an(?:2)?)|pply|lert|b(?:s|ort))|r(?:ou(?:nd|teEvents)|e(?:size(?:By|To)|calc|turnValue|place|verse|l(?:oad|ease(?:Capture|Events)))|andom)|g(?:o|et(?:ResponseHeader|M(?:i(?:nutes|lliseconds)|onth)|Se(?:conds|lection)|Hours|Year|Time(?:zoneOffset)?|Da(?:y|te)|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Da(?:y|te)|FullYear)|FullYear|A(?:ttention|llResponseHeaders)))|m(?:in|ove(?:B(?:y|elow)|To(?:Absolute)?|Above)|ergeAttributes|a(?:tch|rgins|x))|b(?:toa|ig|o(?:ld|rderWidths)|link|ack))\b(?=\()/},{token:"variable.language.dom",regex:/(s(?:ub(?:stringData|mit)|plitText|e(?:t(?:NamedItem|Attribute(?:Node)?)|lect))|has(?:ChildNodes|Feature)|namedItem|c(?:l(?:ick|o(?:se|neNode))|reate(?:C(?:omment|DATASection|aption)|T(?:Head|extNode|Foot)|DocumentFragment|ProcessingInstruction|E(?:ntityReference|lement)|Attribute))|tabIndex|i(?:nsert(?:Row|Before|Cell|Data)|tem)|open|delete(?:Row|C(?:ell|aption)|T(?:Head|Foot)|Data)|focus|write(?:ln)?|a(?:dd|ppend(?:Child|Data))|re(?:set|place(?:Child|Data)|move(?:NamedItem|Child|Attribute(?:Node)?)?)|get(?:NamedItem|Element(?:sBy(?:Name|TagName|ClassName)|ById)|Attribute(?:Node)?)|blur)\b(?=\()/},{token:"support.constant",regex:/(s(?:ystemLanguage|cr(?:ipts|ollbars|een(?:X|Y|Top|Left))|t(?:yle(?:Sheets)?|atus(?:Text|bar)?)|ibling(?:Below|Above)|ource|uffixes|e(?:curity(?:Policy)?|l(?:ection|f)))|h(?:istory|ost(?:name)?|as(?:h|Focus))|y|X(?:MLDocument|SLDocument)|n(?:ext|ame(?:space(?:s|URI)|Prop))|M(?:IN_VALUE|AX_VALUE)|c(?:haracterSet|o(?:n(?:structor|trollers)|okieEnabled|lorDepth|mp(?:onents|lete))|urrent|puClass|l(?:i(?:p(?:boardData)?|entInformation)|osed|asses)|alle(?:e|r)|rypto)|t(?:o(?:olbar|p)|ext(?:Transform|Indent|Decoration|Align)|ags)|SQRT(?:1_2|2)|i(?:n(?:ner(?:Height|Width)|put)|ds|gnoreCase)|zIndex|o(?:scpu|n(?:readystatechange|Line)|uter(?:Height|Width)|p(?:sProfile|ener)|ffscreenBuffering)|NEGATIVE_INFINITY|d(?:i(?:splay|alog(?:Height|Top|Width|Left|Arguments)|rectories)|e(?:scription|fault(?:Status|Ch(?:ecked|arset)|View)))|u(?:ser(?:Profile|Language|Agent)|n(?:iqueID|defined)|pdateInterval)|_content|p(?:ixelDepth|ort|ersonalbar|kcs11|l(?:ugins|atform)|a(?:thname|dding(?:Right|Bottom|Top|Left)|rent(?:Window|Layer)?|ge(?:X(?:Offset)?|Y(?:Offset)?))|r(?:o(?:to(?:col|type)|duct(?:Sub)?|mpter)|e(?:vious|fix)))|e(?:n(?:coding|abledPlugin)|x(?:ternal|pando)|mbeds)|v(?:isibility|endor(?:Sub)?|Linkcolor)|URLUnencoded|P(?:I|OSITIVE_INFINITY)|f(?:ilename|o(?:nt(?:Size|Family|Weight)|rmName)|rame(?:s|Element)|gColor)|E|whiteSpace|l(?:i(?:stStyleType|n(?:eHeight|kColor))|o(?:ca(?:tion(?:bar)?|lName)|wsrc)|e(?:ngth|ft(?:Context)?)|a(?:st(?:M(?:odified|atch)|Index|Paren)|yer(?:s|X)|nguage))|a(?:pp(?:MinorVersion|Name|Co(?:deName|re)|Version)|vail(?:Height|Top|Width|Left)|ll|r(?:ity|guments)|Linkcolor|bove)|r(?:ight(?:Context)?|e(?:sponse(?:XML|Text)|adyState))|global|x|m(?:imeTypes|ultiline|enubar|argin(?:Right|Bottom|Top|Left))|L(?:N(?:10|2)|OG(?:10E|2E))|b(?:o(?:ttom|rder(?:Width|RightWidth|BottomWidth|Style|Color|TopWidth|LeftWidth))|ufferDepth|elow|ackground(?:Color|Image)))\b/},{token:"identifier",regex:d},{regex:"",token:"empty",next:"no_regex"}],start:[c.getStartRule("doc-start"),f("start"),{token:"string.regexp",regex:"\\/",next:"regex"},{token:"text",regex:"\\s+|^$",next:"start"},{token:"empty",regex:"",next:"no_regex"}],regex:[{token:"regexp.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"string.regexp",regex:"/[sxngimy]*",next:"no_regex"},{token:"invalid",regex:/\{\d+\b,?\d*\}[+*]|[+*$^?][+*]|[$^][?]|\?{3,}/},{token:"constant.language.escape",regex:/\(\?[:=!]|\)|\{\d+\b,?\d*\}|[+*]\?|[()$^+*?.]/},{token:"constant.language.delimiter",regex:/\|/},{token:"constant.language.escape",regex:/\[\^?/,next:"regex_character_class"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp"}],regex_character_class:[{token:"regexp.charclass.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"constant.language.escape",regex:"]",next:"regex"},{token:"constant.language.escape",regex:"-"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp.charachterclass"}],function_arguments:[{token:"variable.parameter",regex:d},{token:"punctuation.operator",regex:"[, ]+"},{token:"punctuation.operator",regex:"$"},{token:"empty",regex:"",next:"no_regex"}],qqstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",consumeLineEnd:!0},{token:"string",regex:'"|$',next:"no_regex"},{defaultToken:"string"}],qstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",consumeLineEnd:!0},{token:"string",regex:"'|$",next:"no_regex"},{defaultToken:"string"}]},e&&e.noES6||(this.$rules.no_regex.unshift({regex:"[{}]",onMatch:function(e,t,n){if(this.next="{"==e?this.nextState:"","{"==e&&n.length)n.unshift("start",t);else if("}"==e&&n.length&&(n.shift(),this.next=n.shift(),-1!=this.next.indexOf("string")||-1!=this.next.indexOf("jsx")))return"paren.quasi.end";return"{"==e?"paren.lparen":"paren.rparen"},nextState:"start"},{token:"string.quasi.start",regex:/`/,push:[{token:"constant.language.escape",regex:n},{token:"paren.quasi.start",regex:/\${/,push:"start"},{token:"string.quasi.end",regex:/`/,next:"pop"},{defaultToken:"string.quasi"}]}),e&&0==e.jsx||b.call(this)),this.embedRules(c,"doc-",[c.getEndRule("no_regex")]),this.normalizeRules()};function b(){const e=d.replace("\\d","\\d\\-"),t={onMatch:function(e,t,n){const s="/"==e.charAt(1)?2:1;return 1==s?(t!=this.nextState?n.unshift(this.next,this.nextState,0):n.unshift(this.next),n[2]++):2==s&&t==this.nextState&&(n[1]--,(!n[1]||n[1]<0)&&(n.shift(),n.shift())),[{type:"meta.tag.punctuation."+(1==s?"":"end-")+"tag-open.xml",value:e.slice(0,s)},{type:"meta.tag.tag-name.xml",value:e.substr(s)}]},regex:"</?"+e,next:"jsxAttributes",nextState:"jsx"};this.$rules.start.unshift(t);const n={regex:"{",token:"paren.quasi.start",push:"start"};this.$rules.jsx=[n,t,{include:"reference"},{defaultToken:"string"}],this.$rules.jsxAttributes=[{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",onMatch:function(e,t,n){return t==n[0]&&n.shift(),2==e.length&&(n[0]==this.nextState&&n[1]--,(!n[1]||n[1]<0)&&n.splice(0,2)),this.next=n[0]||"start",[{type:this.token,value:e}]},nextState:"jsx"},n,f("jsxAttributes"),{token:"entity.other.attribute-name.xml",regex:e},{token:"keyword.operator.attribute-equals.xml",regex:"="},{token:"text.tag-whitespace.xml",regex:"\\s+"},{token:"string.attribute-value.xml",regex:"'",stateName:"jsx_attr_q",push:[{token:"string.attribute-value.xml",regex:"'",next:"pop"},{include:"reference"},{defaultToken:"string.attribute-value.xml"}]},{token:"string.attribute-value.xml",regex:'"',stateName:"jsx_attr_qq",push:[{token:"string.attribute-value.xml",regex:'"',next:"pop"},{include:"reference"},{defaultToken:"string.attribute-value.xml"}]},t],this.$rules.reference=[{token:"constant.language.escape.reference.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}]}function f(e){return[{token:"comment",regex:/\/\*/,next:[c.getTagRule(),{token:"comment",regex:"\\*\\/",next:e||"pop"},{defaultToken:"comment",caseInsensitive:!0}]},{token:"comment",regex:"\\/\\/",next:[c.getTagRule(),{token:"comment",regex:"$|^",next:e||"pop"},{defaultToken:"comment",caseInsensitive:!0}]}]}o.inherits(m,l),a.SourceHighlightRules=m}const r=e.toString()+t+n;ace.define("ace/mode/source_highlight_rules"+r,["require","exports","module","ace/lib/oop","ace/mode/doc_comment_highlight_rules","ace/mode/text_highlight_rules"],a)},t.ModeSelector=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.Variant.DEFAULT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NONE";const i=e.toString()+t+n;function a(e,t,n){const s=e("../lib/oop"),a=e("./text").Mode,r=e("./source_highlight_rules"+i).SourceHighlightRules,o=e("./matching_brace_outdent").MatchingBraceOutdent,c=e("./behaviour/cstyle").CstyleBehaviour,l=e("./folding/cstyle").FoldMode,d=function(){this.HighlightRules=r,this.$outdent=new o,this.$behaviour=new c,this.foldingRules=new l};s.inherits(d,a),function(){this.lineCommentStart="//",this.blockComment={start:"/*",end:"*/"},this.$quotes={'"':'"',"'":"'","`":"`"},this.getNextLineIndent=function(e,t,n){let s=this.$getIndent(t);const i=this.getTokenizer().getLineTokens(t,e),a=i.tokens,r=i.state;if(a.length&&"comment"==a[a.length-1].type)return s;if("start"==e||"no_regex"==e){t.match(/^.*(?:\bcase\b.*:|[\{\(\[])\s*$/)&&(s+=n)}else if("doc-start"==e){if("start"==r||"no_regex"==r)return"";const e=t.match(/^\s*(\/?)\*/);e&&(e[1]&&(s+=" "),s+="* ")}return s},this.checkOutdent=function(e,t,n){return this.$outdent.checkOutdent(t,n)},this.autoOutdent=function(e,t,n){this.$outdent.autoOutdent(t,n)},this.$id="ace/mode/source"+i}.call(d.prototype),t.Mode=d}ace.define("ace/mode/source"+i,["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/source_highlight_rules1","ace/mode/matching_brace_outdent","ace/worker/worker_client","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle"],a)}},449:function(e,t,n){"use strict";(function(e){var s=n(41),i=n(116),a=n(1),r=n(24),o=n(34),c=n(89),l=n(459),d=n(10),u=n(54),h=n(450),p=n(455),g=n(451),m=n(0);async function b(t,n,s){const i=(await t.users.getAuthenticated()).data.login,a="source-academy-course-".concat(n),r=(await t.repos.listForAuthenticatedUser({per_page:100})).data,o=r.filter((e=>e.owner.login===a)).find((e=>e.name.includes("course-info")));if(void 0===o)return void Object(d.e)("The course-info repository cannot be located.",2e3);const c=(await t.repos.getContent({owner:o.owner.login,repo:o.name,path:""})).data;if(Array.isArray(c)){if(!c.find((e=>"course-info.json"===e.name)))return void Object(d.e)("The course-info.json file cannot be located.",2e3);{const n=await t.repos.getContent({owner:o.owner.login,repo:o.name,path:"course-info.json"}),a=JSON.parse(e.from(n.data.content,"base64").toString());a.types.forEach((e=>{const t=[];e.assessments.forEach((e=>{if(!e.published)return;const n=e.repoPrefix+"-"+i,s=r.find((e=>e.name===n));let a,c=new Date;void 0===s?a=e.acceptLink:null!==s.created_at&&(c=new Date(s.created_at)),t.push({title:e.title,coverImage:e.coverImage,webSummary:e.shortSummary,missionRepoData:{repoOwner:o.owner.login,repoName:n,dateOfCreation:c},dueDate:new Date(e.closeAt),link:a}),t.sort(((e,t)=>e.dueDate<=t.dueDate?-1:1))})),e.assessments=t})),s(a.types)}}}t.a=e=>{var t,n,d;const f=Object(r.i)(),v=Object(o.f)((e=>e.session.githubOctokitObject)).octokit,[y,j]=Object(a.useState)(null===(t=f.state)||void 0===t?void 0:t.courses),[x,O]=Object(a.useState)((null===(n=f.state)||void 0===n?void 0:n.selectedCourse)||""),[S,w]=Object(a.useState)(null===(d=f.state)||void 0===d?void 0:d.assessmentTypeOverviews),C=null===S||void 0===S?void 0:S.map((e=>e.typeName));Object(a.useEffect)((()=>{void 0!==v&&(y||async function(e,t,n,s){const i=[],a=(await e.orgs.listForAuthenticatedUser({per_page:100})).data;a.filter((e=>e.login.includes("source-academy-course"))).forEach((e=>{i.push(e.login.replace("source-academy-course-",""))})),t(i),i.length>0&&(n(i[0]),b(e,i[0],s))}(v,j,O,w))}),[y,v]);const E=a.useCallback((e=>{void 0!==v&&(b(v,e.target.innerText,w),O(e.target.innerText))}),[v,O,w]),T=()=>{void 0!==v&&b(v,x,w)},k=()=>Object(m.jsx)(r.b,{to:"/githubassessments/login"}),A=()=>Object(m.jsx)(r.b,{to:{pathname:`/githubassessments/${Object(u.a)(C?C[0]:"welcome")}`,state:{courses:y,assessmentTypeOverviews:S,selectedCourse:x}}});return Object(m.jsxs)("div",{className:"Academy",style:{overflow:"hidden"},children:[Object(m.jsx)(l.a,{changeCourseHandler:E,handleGitHubLogIn:e.handleGitHubLogIn,handleGitHubLogOut:()=>{e.handleGitHubLogOut(),j(void 0),w(void 0),O("")},octokit:v,courses:y,selectedCourse:x,types:C,assessmentTypeOverviews:S}),Object(m.jsxs)(r.e,{children:[Object(m.jsx)(r.c,{path:"/githubassessments/login",render:()=>v&&(!y||y.length>0&&!S)?Object(m.jsx)(c.a,{display:Object(m.jsx)(s.G,{description:"Loading...",icon:Object(m.jsx)(s.R,{})}),loadContentDispatch:()=>{}}):v&&y&&0===y.length?Object(m.jsx)(r.b,{to:"/githubassessments/welcome"}):v?A():Object(m.jsx)(c.a,{display:Object(m.jsx)(s.G,{description:"Please sign in to GitHub.",icon:i.a.WARNING_SIGN}),loadContentDispatch:()=>{}})}),Object(m.jsx)(r.c,{path:"/githubassessments/welcome",component:()=>v?Object(m.jsx)(g.a,{}):k()}),Object(m.jsx)(r.c,{path:"/githubassessments/editor",component:p.a}),v?null===C||void 0===C?void 0:C.map(((e,t)=>{const n=S?S[t].assessments:void 0;return Object(m.jsx)(r.c,{path:`/githubassessments/${Object(u.a)(e)}`,render:()=>Object(m.jsx)(h.a,{assessmentOverviews:n,refreshAssessmentOverviews:T})},t)})):null,Object(m.jsx)(r.c,{render:v&&y&&y.length>0?A:k})]})]})}}).call(this,n(72).Buffer)},450:function(e,t,n){"use strict";var s=n(41),i=n(132),a=n(116),r=n(1),o=n(34),c=n(190),l=n(89),d=n(44),u=n(51),h=n(0);t.a=e=>{const{isMobileBreakpoint:t}=Object(o.e)();let n;const p=Object(r.useMemo)((()=>Object(h.jsx)(s.b,{icon:a.a.ADD,onClick:()=>u.a.push("/githubassessments/editor"),children:"Create a New Assessment!"})),[]),g=Object(r.useMemo)((()=>Object(h.jsx)(s.b,{icon:a.a.REFRESH,onClick:e.refreshAssessmentOverviews,children:"Refresh Assessments"})),[e.refreshAssessmentOverviews]);if(e.assessmentOverviews)if(0===e.assessmentOverviews.length)n=Object(h.jsxs)(h.Fragment,{children:[p,g,Object(h.jsx)(s.G,{title:"There are no assessments.",icon:a.a.FLAME})]});else{const r=e.assessmentOverviews.map((e=>function(e,t){const n=t?5:3,r=e.missionRepoData.repoOwner+"/"+e.missionRepoData.repoName,o=e.dueDate.toDateString(),l=new Date(864e13)>e.dueDate,p=new Date>e.dueDate,g=void 0!==e.link;let m="Open",b=()=>u.a.push("/githubassessments/editor",e);g?(m="Accept",b=()=>window.open(e.link)):p&&(m="Review Answers");return Object(h.jsx)("div",{children:Object(h.jsxs)(s.e,{className:"row listing",elevation:i.a.ONE,children:[Object(h.jsx)("div",{className:`col-xs-${String(n)} listing-picture`,children:Object(h.jsx)("img",{alt:"Assessment",className:`cover-image-${e.title}`,src:e.coverImage?e.coverImage:c.a})}),Object(h.jsxs)("div",{className:`col-xs-${String(12-n)} listing-text`,children:[Object(h.jsx)("div",{className:"listing-header",children:Object(h.jsxs)(s.Y,{ellipsize:!0,children:[Object(h.jsx)(s.r,{className:"listing-title",children:e.title}),Object(h.jsx)(s.t,{children:r})]})}),Object(h.jsx)("div",{className:"listing-description",children:Object(h.jsx)(d.a,{content:e.webSummary})}),Object(h.jsxs)("div",{className:"listing-footer",children:[Object(h.jsxs)(s.Y,{className:"listing-due-date",children:[Object(h.jsx)(s.w,{className:"listing-due-icon",iconSize:12,icon:a.a.TIME}),l?"Due: "+o:"No due date"]}),Object(h.jsx)("div",{className:"listing-button",children:Object(h.jsx)(s.b,{icon:a.a.PLAY,minimal:!0,onClick:b,children:Object(h.jsx)("span",{className:"custom-hidden-xxxs",children:m})})})]})]})]})},r)}(e,t)));n=Object(h.jsxs)(h.Fragment,{children:[p,g,r]})}else n=Object(h.jsxs)(h.Fragment,{children:[p,Object(h.jsx)(s.G,{description:"Fetching assessment...",icon:Object(h.jsx)(s.R,{})})]});return Object(h.jsx)("div",{className:"Assessment",style:{overflow:"auto"},children:Object(h.jsx)(l.a,{display:n,loadContentDispatch:()=>{}})})}},451:function(e,t,n){"use strict";var s=n(41),i=n(0);t.a=()=>Object(i.jsx)("div",{className:"github-welcome",children:Object(i.jsx)(s.e,{className:"github-welcome-content",children:Object(i.jsx)("div",{style:{marginTop:"20px",display:"flex",justifyContent:"center"},children:Object(i.jsxs)("div",{children:[Object(i.jsx)(s.p,{children:"Welcome to Source Academy with GitHub Classroom!"}),Object(i.jsx)("br",{}),Object(i.jsx)(s.r,{children:"Source Academy does not find any course information for this account."}),Object(i.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(i.jsxs)(s.cb,{style:{textAlign:"justify"},children:[Object(i.jsx)("li",{children:"If you are enrolled in a Source Academy course that uses GitHub Classroom, check with the course staff to make sure your account is added to the course."}),Object(i.jsxs)("li",{children:["If you are looking for a course to join, check"," ",Object(i.jsx)("a",{href:"https://about.sourceacademy.org/learner/README.html",children:"here"})," to find a course that suits your needs."]})]})})]})})})})},455:function(e,t,n){"use strict";var s=n(27),i=n(33),a=n(24),r=n(43),o=n(13),c=n(41),l=n(3),d=n(116),u=n(19),h=n.n(u),p=n(32),g=n(1),m=n.n(g),b=n(34),f=n(69),v=n(120),y=n(105),j=n(106),x=n(157),O=n(153),S=n(154),w=n(191),C=n(138),E=n(192),T=n(12),k=n(0);const A=e=>{const t=e.mcqDisplayed?"Show MCQ Text":"Hide MCQ Text",n=e.mcqDisplayed?e.displayTextInEditor:e.displayMCQInEditor;return Object(k.jsx)(T.a,{label:t,icon:d.a.REFRESH,onClick:n})};var _=n(144),I=n(10);const N=e=>Object(k.jsx)(T.a,{label:"Add Task",icon:d.a.ADD,onClick:function(){e.numberOfTasks!==_.f?e.addNewQuestion():Object(I.e)("Cannot have more than "+_.f+" Tasks in a Mission!")}});var P=n(68);const R=e=>Object(k.jsx)(T.a,{label:"Delete Current Task",icon:d.a.DELETE,onClick:async function(){if(e.numberOfTasks<=1)return void Object(I.e)("Cannot delete the only remaining task!");await Object(P.b)({contents:Object(k.jsxs)("div",{children:[Object(k.jsx)("p",{children:"Warning: you are about to delete a task."}),Object(k.jsx)("p",{children:"This action cannot be undone."}),Object(k.jsx)("p",{children:"Please click 'Confirm' to continue, or 'Cancel' to go back."})]}),negativeLabel:"Cancel",positiveIntent:"primary",positiveLabel:"Confirm"})&&e.deleteCurrentQuestion()}});var M=n(94),L=n(98);const D=e=>{const[t,n]=Object(g.useState)("sa-new-mission-repository");return Object(k.jsxs)(c.h,{className:"missionBrowser",isOpen:!0,children:[Object(k.jsx)("div",{className:h()("githubDialogHeader",l.a.DIALOG_HEADER),children:Object(k.jsx)("h3",{children:"Please confirm your save"})}),Object(k.jsxs)("div",{className:h()("githubDialogBody",l.a.DIALOG_BODY),children:[Object(k.jsxs)("div",{children:[Object(k.jsxs)("h4",{children:["This will create a repository owned by ",e.userLogin," with the title:"]}),Object(k.jsx)(c.y,{onChange:function(e){n(e.target.value)},placeholder:"Enter Repository Title",value:t})]}),Object(k.jsxs)("div",{children:[Object(k.jsx)("h4",{children:"This repository will be created with following files:"}),e.filesToCreate.map((e=>Object(k.jsx)("li",{children:e},e)))]})]}),Object(k.jsx)("div",{className:h()(l.a.DIALOG_FOOTER),children:Object(k.jsxs)("div",{className:h()(l.a.DIALOG_FOOTER_ACTIONS),children:[Object(k.jsx)(c.b,{onClick:function(){e.resolveDialog({confirmSave:!1,repoName:""})},children:"Close"}),Object(k.jsx)(c.a,{onClick:function(){if(""===t)return void Object(I.e)("Cannot create repository without title!",2e3);e.resolveDialog({confirmSave:!0,repoName:t})},intent:L.a.PRIMARY,children:"Confirm"})]})})]})};var B=n(44),U=n(156);var G=e=>{const[t,n]=m.a.useState(!1),s=e.allowEdits,i=m.a.useRef();return Object(g.useEffect)((()=>{function e(e){s&&(i.current&&!i.current.contains(e.target)&&n(!1),i.current&&i.current.contains(e.target)&&n(!0))}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[s]),Object(k.jsx)("div",{ref:i,children:t?Object(k.jsx)(c.Z,{onChange:function(t){e.setContent(t.target.value)},fill:!0,growVertically:!0,defaultValue:e.content}):Object(k.jsx)(B.a,{content:e.content,openLinksInNewWindow:!0})})},F=n(16);var H=e=>Object(k.jsx)("div",{className:"SideContentMissionEditor",children:Object(k.jsxs)("div",{className:"SideContentMissionEditorRow",children:[Object(k.jsx)("div",{className:"SideContentMissionEditorLabelColumn",children:Object(k.jsx)(c.z,{children:"Source Version"})}),Object(k.jsx)("div",{className:"SideContentMissionEditorOptionColumn",children:Object(k.jsx)(v.a,{sourceChapter:e.missionMetadata.sourceVersion,sourceVariant:F.b.defaultSourceVariant,disabled:!1,handleChapterSelect:function(t,n){!function(t,n){const s=Object.assign({},e.missionMetadata);s[t]=n,e.setMissionMetadata(s)}("sourceVersion",t.chapter)}},"chapter")})]})});var V=e=>{const t=e.currentTaskNumber-1,n=e.taskDescriptions,s=e.setTaskDescriptions,i=t<0||t>=n.length||0===n.length,a=i?"Welcome to Mission Mode! This is where the Task Briefing for each question will appear!":n[t],r=m.a.useCallback((e=>{if(i)return;const a=n.map((e=>e));a[t]=e,s(a)}),[s,n,t,i]);return Object(k.jsx)("div",{children:Object(k.jsx)(G,{allowEdits:e.allowEdits,content:a,setContent:r})})},W=n(265),$=n(139),X=n.n($),q=n(254),z=n(132),Y=n(91),K=n(102),Q=n(18);var J=e=>{const{index:t,testcase:n,setTestcaseProgram:s,setTestcaseExpectedResult:i,handleTestcaseEval:a,deleteTestcase:r}=e,o=g.useMemo((()=>{const e=void 0!==n.result||n.errors,t=Object(K.stringify)(n.result)===n.answer;return{correct:e&&t,wrong:e&&!t,secret:n.type===Q.f.secret||n.type===Q.f.opaque}}),[n]),u=g.useCallback((()=>{a(t)}),[t,a]),p=n.program,m=n.answer,b=Object(k.jsx)(c.b,{className:"testcase-button",icon:d.a.PLAY,onClick:u}),f=Object(k.jsx)(c.b,{className:"testcase-button",icon:d.a.DELETE,onClick:()=>r(t)}),v=g.useMemo((()=>{let e="No Answer";return n.errors?e=Object(Y.parseError)(n.errors):void 0!==n.result&&(e=Object(K.stringify)(n.result)),e}),[n]);return Object(k.jsx)("div",{className:h()("EditableAutograderCard",o),children:Object(k.jsxs)(c.e,{className:l.a.INTERACTIVE,elevation:z.a.ONE,children:[Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(c.y,{className:"testcase-program",value:p,onChange:e=>s(e.target.value)}),Object(k.jsx)(c.y,{className:"testcase-expected",value:m,onChange:e=>i(e.target.value)}),Object(k.jsx)(c.y,{className:"testcase-actual",value:v,readOnly:!0})]}),b,f]})})};function Z(e,t){return Object(k.jsx)(X.a,{className:"react-ace",fontSize:14,highlightActiveLine:!1,mode:"javascript",onChange:t,theme:"source",value:e,width:"100%",height:"16rem"})}const ee=Object(k.jsxs)("div",{className:"autograder-help-tooltip",children:[Object(k.jsx)("p",{children:"Click on each testcase below to execute it with the program in the editor."}),Object(k.jsx)("p",{children:"To execute all testcases at once, evaluate the program in the editor with this tab active."}),Object(k.jsx)("p",{children:"A green or red background indicates a passed or failed testcase respectively."}),Object(k.jsx)("p",{children:"Private testcases (only visible to staff when grading) have a grey background."})]}),te=(e,t)=>Object(k.jsxs)("div",{className:e,children:[t,Object(k.jsx)(c.w,{icon:d.a.CARET_DOWN})]}),ne=Object(k.jsxs)("div",{className:"testcases-header",children:[te("header-fn","Testcase"),te("header-expected","Expected result"),te("header-actual","Actual result")]}),se=(e,t,n)=>Object(k.jsx)(T.a,{label:e,icon:t?d.a.CARET_DOWN:d.a.CARET_RIGHT,onClick:n,options:{className:"collapse-button",minimal:!0}});var ie=e=>{const[t,n]=g.useState(!0),[s,i]=g.useState(!0),[a,r]=g.useState(!0),{testcases:o,testPrepend:l,testPostpend:u,allowEdits:h,handleTestcaseEval:p,setTaskTestcases:m,setTestPrepend:b,setTestPostpend:f}=e,v=g.useCallback((e=>t=>{const n=o.map((e=>Object.assign({},e)));n[e].program=t,delete n[e].result,m(n)}),[m,o]),y=g.useCallback((e=>t=>{const n=o.map((e=>Object.assign({},e)));n[e].answer=t,delete n[e].result,m(n)}),[m,o]),j=g.useCallback((()=>{const e=[...o];e.push({answer:"",program:"",score:0,type:"public"}),m(e)}),[o,m]),x=g.useCallback((async e=>{if(!await Object(P.b)({title:"confirm testcase deletion",contents:"Are you sure you want to delete this testcase? This cannot be undone.",positiveLabel:"Confirm",negativeLabel:"Cancel"}))return;const t=o.slice(0,e).concat(o.slice(e+1));m(t)}),[o,m]),O=g.useCallback(((e,t)=>h?Object(k.jsx)(J,{index:t,testcase:e,setTestcaseProgram:v(t),setTestcaseExpectedResult:y(t),deleteTestcase:x,handleTestcaseEval:p},t):Object(k.jsx)(q.a,{index:t,testcase:e,handleTestcaseEval:p,workspaceLocation:"githubAssessment"},t)),[h,x,p,v,y]),S=g.useMemo((()=>o.length>0?Object(k.jsxs)("div",{className:"testcaseCards",children:[ne,o.map(((e,t)=>O(e,t)))]}):Object(k.jsx)("div",{className:"noResults",children:"There are no testcases provided for this question."})),[o,O]),w=g.useMemo((()=>Object(k.jsx)(c.b,{className:"collapse-button",icon:d.a.ADD,minimal:!0,text:"Add a new testcase",onClick:j})),[j]),C=g.useCallback((()=>{n(!t)}),[t]),E=g.useCallback((()=>{i(!s)}),[s]),T=g.useCallback((()=>{r(!a)}),[a]);return Object(k.jsxs)("div",{className:"Autograder",children:[Object(k.jsxs)(c.b,{className:"collapse-button",icon:a?d.a.CARET_DOWN:d.a.CARET_RIGHT,minimal:!0,onClick:T,children:[Object(k.jsx)("span",{children:"Testcases"}),Object(k.jsx)(W.a,{content:ee,placement:c.L.LEFT,children:Object(k.jsx)(c.w,{icon:d.a.HELP})})]}),Object(k.jsx)(c.g,{isOpen:a,keepChildrenMounted:!0,children:Object(k.jsxs)("div",{className:"testcaseeditor-subcomponent",children:[S,h&&w]})}),h&&se("Testcase Prepend",t,C),h&&Object(k.jsx)(c.g,{isOpen:t,keepChildrenMounted:!0,children:Object(k.jsx)("div",{className:"testcaseeditor-subcomponent",children:Z(l,(e=>b(e)))})}),h&&se("Testcase Postpend",s,E),h&&Object(k.jsx)(c.g,{isOpen:s,keepChildrenMounted:!0,children:Object(k.jsx)("div",{className:"testcaseeditor-subcomponent",children:Z(u,(e=>f(e)))})})]})},ae=n(23),re=n(51),oe=n(107),ce=n(70);const le="### Assignment Briefing (Click to Edit!)\nWelcome to Assignment Creator! This is where the Briefing for each assignment will appear.\n\nIf you are on the SourceAcademy website, you may edit **this section** by clicking on it. You can also add or delete questions through the control bar.\n\nThe text written here will show up as the `README.md` file on the GitHub repository.\n\nPlease also refer to our instructor's guide [here](https://github.com/source-academy/general/tree/master/instructor/github) to learn more about how to use this website.\n\n### Brief Markdown Cheatsheet\nEverything here is written in Markdown.\n\nThis means that you can **bolden** or *italicize* text by adding asterisks.\n\nPrograms can be formatted through the use of triple backticks:\n```\n// This is a program example\n```\nIf you want to in-line program snippets, rather than display it as a block, you can also use single backticks like `this`.\n\nLists can be created by adding dashes to the start of a line:\n- First element\n- Second element\n- Third element\n\n\nIt is also possible to embed images, like this:\n\n![an embedded image](https://avatars.githubusercontent.com/u/35620705?s=400&u=32f72fd1d65a0d6877ad1d5870ffa327dda754f1&v=4)\n\nIf you need a more detailed cheatsheet, please click [here](https://www.markdownguide.org/cheat-sheet/)!\n",de="// Your program here!\n",ue={sourceVersion:s.Chapter.CALC},he={questionNumber:0,taskDescription:"### Problem Description (Click to Edit!)\nWelcome to the Assignment Creator! This is where the problem description specific to each problem should be written.\n\nIf you are on the SourceAcademy website, you may edit **this section** by clicking on it. You can also add or delete questions through the control bar.\n\nIf you would like to add new questions outside of the website, simply duplicate this folder, and edit the `Problem.md` and `StarterCode.js` files accordingly. Make sure that the folders are named 'Q1', 'Q2', 'Q3' and so on.\n\nPlease also refer to our instructor's guide [here](https://github.com/source-academy/general/tree/master/instructor/github).\n\n### Brief Markdown Cheatsheet\nEverything here is written in Markdown.\n\nThis means that you can **bolden** or *italicize* text by adding asterisks.\n\nPrograms can be formatted through the use of triple backticks:\n```\n// This is a program example\n```\nIf you want to in-line program snippets, rather than display it as a block, you can also use single backticks like `this`.\n\nLists can be created by adding dashes to the start of a line:\n- First element\n- Second element\n- Third element\n\n\nIt is also possible to embed images, like this:\n\n![an embedded image](https://avatars.githubusercontent.com/u/35620705?s=400&u=32f72fd1d65a0d6877ad1d5870ffa327dda754f1&v=4)\n\nIf you need a more detailed cheatsheet, please click [here](https://www.markdownguide.org/cheat-sheet/)!\n",starterCode:de,savedCode:de,testPrepend:"",testPostpend:"",testCases:[]},pe={answer:-1,choices:[],solution:-1,type:"mcq",content:"",grade:0,id:0,library:{chapter:s.Chapter.CALC,external:{name:"NONE",symbols:[]},globals:[]},maxGrade:0,xp:0,maxXp:0},ge="githubAssessment";var me=e=>{const t=Object(i.c)(),n=Object(ce.f)();void 0===n&&re.a.push("/githubassessments/login");const[a,r]=m.a.useState(ue),[u,T]=m.a.useState(ue),[L,W]=m.a.useState(!1),[$,X]=m.a.useState(le),[q,z]=m.a.useState(le),[Y,K]=m.a.useState(!1),[Q,J]=m.a.useState([]),[Z,ee]=m.a.useState([]),[te,ne]=m.a.useState(!1),[se,de]=m.a.useState(""),[me,be]=m.a.useState(0),[fe,ve]=m.a.useState(!1),[ye,je]=m.a.useState(!0),[xe,Oe]=m.a.useState(!1),[Se,we]=m.a.useState(!0),[Ce,Ee]=m.a.useState(pe),[Te,ke]=m.a.useState(void 0),Ae=e.location.state,[_e,Ie]=m.a.useState(!1),[Ne,Pe]=m.a.useState(ae.b.questionOverview),{isMobileBreakpoint:Re}=Object(b.e)(),Me=e.hasUnsavedChanges,Le=e.editorTestcases,De=e.handleEditorValueChange,Be=e.handleUpdateWorkspace,Ue=e.handleUpdateHasUnsavedChanges,Ge=e.handleReplOutputClear,Fe=Object(g.useCallback)(((e,t)=>{be(e);const n=e-1;Be({editorTabs:[{value:t[n].savedCode,prependValue:t[n].testPrepend,postpendValue:t[n].testPostpend,highlightedLines:[],breakpoints:[]}],editorTestcases:t[n].testCases}),Ge();const[s,i]=Object(_.b)(t[n].savedCode);Oe(s),Ee(i)}),[Be,Ge]),He=Object(g.useCallback)((e=>{X(e),K(e!==q)}),[q]),Ve=Object(g.useCallback)((e=>{r(e),W(!Object(p.isEqual)(e,u))}),[u]),We=Object(g.useCallback)((e=>{ee(e),ne(!Object(p.isEqual)(e,Q))}),[Q]),$e=Object(g.useCallback)((e=>{if(e){const[e,t]=Object(_.b)(Z[me-1].savedCode);Oe(e),Ee(t)}we(e)}),[Z,me]),Xe=Object(g.useMemo)((()=>L||Y||te),[L,Y,te]);Object(g.useEffect)((()=>{Xe!==Me&&Ue(Xe)}),[Xe,Me,Ue]);const qe=Object(g.useCallback)((async()=>{if(void 0===n)return;const e=Ae.missionRepoData,t=[Object(_.e)(e,n),n.users.getAuthenticated().then((t=>t.data.login===e.repoOwner))];Promise.all(t).then((t=>{ke(e),ne(!1),K(!1),W(!1),Ue(!1);const n=t[0];de(n.missionBriefing),r(n.missionMetadata),T(n.missionMetadata),X(n.missionBriefing),z(n.missionBriefing),ee(n.tasksData),J(n.tasksData.map((e=>Object.assign({},e)))),Fe(1,n.tasksData);const s=t[1];ve(s),je(!1)}))}),[Ae,n,Fe,Ue]),ze=Object(g.useCallback)((()=>{de(le),r(ue),T(ue),X(le),z(le),ee([he]),J([he]),we(!1),Fe(1,[he]),ne(!1),K(!1),W(!1),Ue(!1),ve(!0),je(!1)}),[Fe,Ue]);Object(g.useEffect)((()=>{void 0===Ae?ze():qe()}),[Ae,qe,ze]);const Ye=Object(k.jsx)(c.h,{className:"assessment-briefing",isOpen:_e,children:Object(k.jsxs)(c.e,{children:[Object(k.jsx)(B.a,{content:se}),Object(k.jsx)(c.b,{className:"assessment-briefing-button",onClick:()=>Ie(!1),text:"Continue"})]})}),Ke=Object(g.useCallback)(((e,t)=>{if(e>Z.length)return;const n=Z.map((e=>Object.assign({},e)));n[e-1]={...n[e-1],savedCode:t},We(n)}),[Z,We]),Qe=Object(g.useCallback)((()=>{const e=Z[me-1].starterCode;De(e),Ke(me,e)}),[me,Ke,De,Z]),Je=Object(g.useCallback)((async(e,t,s,i,a)=>{const r=Te,{saveType:o}=await Object(ce.b)(n,r.repoOwner,r.repoName,e);"Overwrite"===o&&await Object(ce.j)(n,r.repoOwner,r.repoName,e,s,i,a,t),"Create"===o&&await Object(ce.h)(n,r.repoOwner,r.repoName,e,s,i,a,t)}),[Te,n]),Ze=Object(g.useCallback)((async(e,t,s,i)=>{const a=Te;await Object(ce.i)(n,a.repoOwner,a.repoName,e,t,s,i)}),[Te,n]),et=Object(g.useCallback)((async()=>{if(void 0===n)return void Object(I.e)("Please sign in with GitHub!",2e3);const[e,t]=Object(_.c)(a,u,$,q,Z,Q,fe),s=Object.keys(e),i=await n.users.getAuthenticated(),r=i.data.name,o=i.data.email;for(let n=0;n<t.length;n++)await Ze(t[n],r,o,"");for(let n=0;n<s.length;n++){const t=s[n],i=e[t];await Je(t,i,r,o,"")}J(Z),z($),T(a),ne(!1),K(!1),W(!1)}),[n,fe,$,a,Z,Q,q,u,Je,Ze]),tt=Object(g.useCallback)((async()=>{if(void 0===n)return void Object(I.e)("Please sign in with GitHub!",2e3);const e=Object(_.d)(a,$,Z),t=Object.keys(e).sort(),s=await n.users.getAuthenticated(),i=await Object(P.a)(D,(e=>({filesToCreate:t,userLogin:s.data.login,resolveDialog:t=>e(t)})));if(!i.confirmSave)return;const r=s.data.name,o=s.data.email,c=i.repoName,l=s.data.login;try{await n.repos.createForAuthenticatedUser({name:c});for(let s=0;s<t.length;s++){const i=t[s],a=e[i];await Object(ce.h)(n,l,c,i,r,o,"Repository created from Source Academy",a)}J(Z),z($),T(a),ne(!1),K(!1),W(!1),ke({repoOwner:l,repoName:c,dateOfCreation:new Date})}catch(d){console.error(d),Object(I.e)("Something went wrong while creating the repository!",2e3)}}),[$,a,n,Z]),nt=Object(g.useCallback)((()=>{void 0!==Ae&&new Date>Ae.dueDate?Object(I.e)("It is past the due date for this assessment!"):void 0!==Te?et():tt()}),[Ae,Te,et,tt]),st=Object(g.useCallback)((async()=>{await Object(P.b)({contents:Object(k.jsxs)("div",{className:l.a.DIALOG_BODY,children:[Object(k.jsx)(B.a,{content:"Are you sure you want to reset the template?"}),Object(k.jsx)(B.a,{content:"*Note this will not affect the saved copy of your program, unless you save over it.*"})]}),negativeLabel:"Cancel",positiveIntent:"primary",positiveLabel:"Confirm"})&&Qe()}),[Qe]),it=Object(g.useCallback)(((e,t,n,s)=>{if(void 0===s)return!0;const i=e-1;return!!Object(p.isEqual)(t[i],n[i])||window.confirm("You have unsaved changes to the current question. Are you sure you want to continue?")}),[]),at=Object(g.useCallback)((()=>{if(it(me,Z,Q,Te)){let e=Z;void 0!==Te&&(e=Q.map((e=>Object.assign({},e))),We(e));Fe(me-1,e)}}),[me,Z,Q,Te,We,it,Fe]),rt=Object(g.useCallback)((()=>{if(it(me,Z,Q,Te)){let e=Z;void 0!==Te&&(e=Q.map((e=>Object.assign({},e))),We(e));Fe(me+1,e)}}),[me,Z,Q,Te,We,it,Fe]),ot=Object(g.useCallback)((()=>{re.a.push("/githubassessments/missions")}),[]);m.a.useEffect((()=>{Re||Ne!==ae.b.mobileEditor&&Ne!==ae.b.mobileEditorRun||Pe(ae.b.questionOverview)}),[Re,e,Ne]);const ct=m.a.useCallback((e=>{De(e),Ke(me,e)}),[me,Ke,De]),lt=(e,t,n)=>{e!==t&&Pe(e)},dt=m.a.useRef(Ne);dt.current=Ne;const ut=()=>{e.handleEditorEval(),dt.current===ae.b.testcases&&t(Object(o.runAllTestcases)(ge))},ht=Object(g.useCallback)((e=>{const t=[];for(let n=0;n<Z.length;n++){const s=Object.assign({},Z[n]);s.taskDescription=e[n],t.push(s)}We(t)}),[Z,We]),pt=Object(g.useCallback)((e=>{const t=Z.map((e=>Object.assign({},e)));t[me-1]={...t[me-1],testCases:e},Be({editorTestcases:t[me-1].testCases}),We(t)}),[me,Z,Be,We]),gt=Object(g.useCallback)((e=>{const t=Z.map((e=>Object.assign({},e)));t[me-1]={...t[me-1],testPrepend:e},We(t)}),[me,Z,We]),mt=Object(g.useCallback)((e=>{const t=Z.map((e=>Object.assign({},e)));t[me-1]={...t[me-1],testPostpend:e},We(t)}),[me,Z,We]),bt=e=>{const n=[{label:"Task",iconName:d.a.NINJA,body:Object(k.jsx)(V,{allowEdits:fe,currentTaskNumber:me,taskDescriptions:Z.map((e=>e.taskDescription)),setTaskDescriptions:ht}),id:ae.b.questionOverview},{label:"Briefing",iconName:d.a.BRIEFCASE,body:Object(k.jsx)(G,{allowEdits:fe,content:$,setContent:He}),id:ae.b.briefing}],s=me-1,i=Z[s]?Z[s].testPrepend:"",r=Z[s]?Z[s].testPostpend:"";return n.push({label:"Testcases",iconName:d.a.AIRPLANE,body:Object(k.jsx)(ie,{allowEdits:fe,testcases:Le,testPrepend:i,testPostpend:r,setTaskTestcases:pt,setTestPrepend:gt,setTestPostpend:mt,handleTestcaseEval:e=>t(Object(o.evalTestcase)(ge,e))}),id:ae.b.testcases}),fe&&n.push({label:"Mission Metadata",iconName:d.a.BUILD,body:Object(k.jsx)(H,{missionMetadata:a,setMissionMetadata:Ve}),id:ae.b.missionMetadata}),{selectedTabId:Ne,tabs:{beforeDynamicTabs:n,afterDynamicTabs:[]},onChange:lt,workspaceLocation:"githubAssessment"}},ft=()=>{const e=Z.slice(0,me).concat([he]).concat(Z.slice(me,Z.length));We(e);Fe(me+1,e)},vt=()=>{const e=me-1,t=Z.slice(0,e).concat(Z.slice(me,Z.length));We(t);Fe(1===me?me:me-1,t)},yt=()=>{const e=Object(k.jsx)(C.a,{handleEditorEval:ut},"run"),t=Object(k.jsx)(E.a,{hasUnsavedChanges:Me,onClickSave:nt},"save"),n=Object(k.jsx)(w.a,{onClick:st},"reset"),s=Object(k.jsx)(v.a,{handleChapterSelect:()=>{},sourceChapter:a.sourceVersion,sourceVariant:F.b.defaultSourceVariant,disabled:!0},"chapter"),i=Object(k.jsx)(x.a,{onClickNext:rt,onClickReturn:ot,questionProgress:[me,Z.length]},"next_question"),r=Object(k.jsx)(O.a,{onClick:at,questionProgress:[me,Z.length]},"previous_question"),o=Object(k.jsx)(S.a,{questionProgress:[me,Z.length]},"task_view"),c=Re?[t,n]:[e,t,n,s];if(fe){const e=Object(k.jsx)(N,{addNewQuestion:ft,numberOfTasks:Z.length},"add_task"),t=Object(k.jsx)(R,{deleteCurrentQuestion:vt,numberOfTasks:Z.length},"delete_task"),n=Object(k.jsx)(A,{displayMCQInEditor:()=>$e(!0),displayTextInEditor:()=>$e(!1),mcqDisplayed:Se},"display MCQ");c.push(e,t,n)}return{editorButtons:c,flowButtons:[r,o,i]}},jt=Object(g.useCallback)((e=>{if(!xe)return;const t=Object.assign({},Ce);t.answer=e,Ee(t),Ke(me,Object(_.a)(t))}),[xe,me,Ke,Ce]),xt=Object(g.useMemo)((()=>xe&&Se?{mcq:Ce,handleMCQSubmit:jt}:void 0),[xe,Se,Ce,jt]),Ot={editorVariant:"normal",editorTabs:e.editorTabs.map(M.a),editorSessionId:"",handleDeclarationNavigate:e=>t(Object(o.navigateToDeclaration)(ge,e)),handleEditorEval:ut,handleEditorCheck:()=>{},handleEditorValueChange:ct,handleUpdateHasUnsavedChanges:Ue,handleEditorUpdateBreakpoints:e=>t(Object(o.setEditorBreakpoint)(e,ge)),handlePromptAutocomplete:(e,n,s)=>t(Object(o.promptAutocomplete)(ge,e,n,s)),isEditorAutorun:!1},St={handleBrowseHistoryDown:()=>t(Object(o.browseReplHistoryDown)(ge)),handleBrowseHistoryUp:()=>t(Object(o.browseReplHistoryUp)(ge)),handleReplEval:e.handleReplEval,handleReplValueChange:e=>t(Object(o.updateReplValue)(e,ge)),output:e.output,replValue:e.replValue,sourceChapter:a.sourceVersion||s.Chapter.CALC,sourceVariant:s.Variant.DEFAULT,externalLibrary:f.a.NONE,replButtons:(()=>{const t=Object(k.jsx)(y.a,{handleReplOutputClear:Ge},"clear_repl");return[Object(k.jsx)(j.a,{handleReplEval:e.handleReplEval,isRunning:e.isRunning},"eval_repl"),t]})()},wt={tabs:[]},Ct={controlBarProps:yt(),editorContainerProps:xe&&Se?void 0:Ot,handleSideContentHeightChange:e=>t(Object(o.changeSideContentHeight)(e,ge)),hasUnsavedChanges:Me,mcqProps:xt,sideBarProps:wt,sideContentHeight:e.sideContentHeight,sideContentProps:bt(),replProps:St},Et={editorContainerProps:xe&&Se?void 0:Ot,replProps:St,sideBarProps:wt,hasUnsavedChanges:Me,mcqProps:xt,mobileSideContentProps:(()=>{const e=bt();return{mobileControlBarProps:{...yt()},...e,onChange:(e,t,n)=>{e!==t&&(t===ae.b.testcases&&e===ae.b.mobileEditorRun||Pe(e))},selectedTabId:Ne,handleEditorEval:ut}})()};return ye?Object(k.jsx)("div",{className:h()("missionLoading",l.a.DARK),children:Object(k.jsx)(c.G,{description:"Loading",icon:Object(k.jsx)(c.R,{size:c.S.LARGE})})}):Object(k.jsxs)("div",{className:h()("WorkspaceParent",l.a.DARK),children:[Ye,Re?Object(k.jsx)(U.a,{...Et}):Object(k.jsx)(oe.a,{...Ct})]})};const be="githubAssessment",fe=Object(a.l)(Object(i.b)((e=>({activeEditorTabIndex:e.workspaces.githubAssessment.activeEditorTabIndex,editorTabs:e.workspaces.githubAssessment.editorTabs,editorTestcases:e.workspaces.githubAssessment.editorTestcases,hasUnsavedChanges:e.workspaces.githubAssessment.hasUnsavedChanges,isRunning:e.workspaces.githubAssessment.isRunning,isDebugging:e.workspaces.githubAssessment.isDebugging,enableDebugging:e.workspaces.githubAssessment.enableDebugging,output:e.workspaces.githubAssessment.output,replValue:e.workspaces.githubAssessment.replValue,sideContentHeight:e.workspaces.githubAssessment.sideContentHeight,sourceChapter:s.Chapter.CALC})),(e=>Object(r.b)({handleChapterSelect:e=>Object(o.chapterSelect)(e,s.Variant.DEFAULT,be),handleEditorEval:()=>Object(o.evalEditor)(be),handleEditorValueChange:e=>Object(o.updateEditorValue)(e,be),handleReplEval:()=>Object(o.evalRepl)(be),handleReplOutputClear:()=>Object(o.clearReplOutput)(be),handleUpdateHasUnsavedChanges:e=>Object(o.updateHasUnsavedChanges)(be,e),handleUpdateWorkspace:e=>Object(o.updateWorkspace)(be,e)},e)))(me));t.a=fe},459:function(e,t,n){"use strict";var s=n(41),i=n(216),a=n(3),r=n(116),o=n(329),c=n(19),l=n.n(c),d=(n(1),n(46)),u=n(34),h=n(12),p=n(0);const g=e=>{const{isMobileBreakpoint:t}=Object(u.e)(),n=void 0!==Object(u.f)((e=>e.session.githubOctokitObject)).octokit?Object(p.jsx)(h.a,{label:"Log Out",icon:r.a.GIT_BRANCH,onClick:e.onClickLogOut}):Object(p.jsx)(h.a,{label:"Log In",icon:r.a.GIT_BRANCH,onClick:e.onClickLogIn});return Object(p.jsx)(s.c,{large:!t,children:n})};var m=n(54);const b=[r.a.FLAME,r.a.LIGHTBULB,r.a.PREDICTIVE_ANALYSIS,r.a.COMPARISON,r.a.MANUAL];t.a=e=>{var t,n;const r=t=>{e.changeCourseHandler(t)};return Object(p.jsxs)(s.C,{className:"NavigationBar secondary-navbar",children:[Object(p.jsx)(s.E,{align:i.a.LEFT,children:null===(t=e.types)||void 0===t?void 0:t.map(((t,n)=>Object(p.jsxs)(d.b,{to:{pathname:`/githubassessments/${Object(m.a)(t)}`,state:{courses:e.courses,assessmentTypeOverviews:e.assessmentTypeOverviews,selectedCourse:e.selectedCourse}},activeClassName:a.a.ACTIVE,className:l()("NavigationBar__link",a.a.BUTTON,a.a.MINIMAL),children:[Object(p.jsx)(s.w,{icon:n<5?b[n]:b[0]}),Object(p.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:t})]},t)))}),Object(p.jsxs)(s.E,{align:i.a.RIGHT,children:[void 0!==e.octokit&&e.types&&e.types.length>0&&Object(p.jsx)(s.y,{disabled:!0,leftElement:Object(p.jsx)(o.a,{content:Object(p.jsx)(s.A,{children:null===(n=e.courses)||void 0===n?void 0:n.map((e=>Object(p.jsx)(s.B,{onClick:r,text:e},e)))}),placement:"bottom-end",children:Object(p.jsx)(s.b,{minimal:!0,rightIcon:"caret-down","aria-label":"choose"})}),placeholder:"Select Course",onChange:e.changeCourseHandler,value:e.selectedCourse},"courseselect"),Object(p.jsx)(g,{onClickLogIn:e.handleGitHubLogIn,onClickLogOut:e.handleGitHubLogOut},"loginlogout")]})]})}},487:function(e,t,n){},501:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeWrapper=void 0,t.makeWrapper=function(e,t){for(const n in e)e.hasOwnProperty(n)&&Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n));for(const n of["length","name"])e.hasOwnProperty(n)&&Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var s=n(103);const i=Object(s.a)()},54:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i}));const s=e=>e.toLowerCase().replace(/\W+/g,"_"),i=e=>{if(void 0===e)return null;const t=parseInt(e,10);return Number.isInteger(t)?t:null}},554:function(e){e.exports=JSON.parse('{"blank":{"title":"blank","description":"<div><h4>blank</h4><div class=\\"description\\">\\n    primitive Rune in the rune of a blank square\\n</div></div>","meta":"const"},"circle":{"title":"circle","description":"<div><h4>circle</h4><div class=\\"description\\">\\n    primitive Rune in the rune of a circle\\n</div></div>","meta":"const"},"corner":{"title":"corner","description":"<div><h4>corner</h4><div class=\\"description\\">\\n    primitive Rune with black triangle,\\nfilling upper right corner\\n</div></div>","meta":"const"},"heart":{"title":"heart","description":"<div><h4>heart</h4><div class=\\"description\\">\\n    primitive Rune in the rune of a heart\\n</div></div>","meta":"const"},"nova":{"title":"nova","description":"<div><h4>nova</h4><div class=\\"description\\">\\n    primitive Rune in the rune of two overlapping\\ntriangles, residing in the upper half\\nof\\n</div></div>","meta":"const"},"pentagram":{"title":"pentagram","description":"<div><h4>pentagram</h4><div class=\\"description\\">\\n    primitive Rune in the rune of a pentagram\\n</div></div>","meta":"const"},"rcross":{"title":"rcross","description":"<div><h4>rcross</h4><div class=\\"description\\">\\n    primitive Rune in the rune of a \\nsmallsquare inside a large square,\\neach diagonally split into a\\nblack and white half\\n</div></div>","meta":"const"},"ribbon":{"title":"ribbon","description":"<div><h4>ribbon</h4><div class=\\"description\\">\\n    primitive Rune in the rune of a ribbon\\nwinding outwards in an anticlockwise spiral\\n</div></div>","meta":"const"},"sail":{"title":"sail","description":"<div><h4>sail</h4><div class=\\"description\\">\\n    primitive Rune in the rune of a sail\\n</div></div>","meta":"const"},"square":{"title":"square","description":"<div><h4>square</h4><div class=\\"description\\">\\n    primitive Rune in the rune of a full square\\n</div></div>","meta":"const"},"add":{"title":"add(obj)","description":"<div><h4>add(obj)</h4><div class=\\"description\\">\\n    Add the object to the scene. Only objects added to the scene\\nwill appear.\\n</div></div>","meta":"func"},"add_keyboard_listener":{"title":"add_keyboard_listener(key, event, callback) \u2192 {Phaser.Input.Keyboard.Key}","description":"<div><h4>add_keyboard_listener(key, event, callback) \u2192 {Phaser.Input.Keyboard.Key}</h4><div class=\\"description\\">\\n    Attach a listener to the object. The callback will be executed\\nwhen the event is emitted.\\nMutate the object.\\n\\nFor all available events, see:\\nhttps://photonstorm.github.io/phaser3-docs/Phaser.Input.Events.html\\n\\nFor list of keycodes, see:\\nhttps://github.com/photonstorm/phaser/blob/v3.22.0/src/input/keyboard/keys/KeyCodes.js\\n</div></div>","meta":"func"},"add_listener":{"title":"add_listener(obj, event, callback) \u2192 {Phaser.Input.InputPlugin}","description":"<div><h4>add_listener(obj, event, callback) \u2192 {Phaser.Input.InputPlugin}</h4><div class=\\"description\\">\\n    Attach a listener to the object. The callback will be executed\\nwhen the event is emitted.\\nMutate the object.\\n\\nFor all available events, see:\\nhttps://photonstorm.github.io/phaser3-docs/Phaser.Input.Events.html\\n</div></div>","meta":"func"},"add_to_container":{"title":"add_to_container(container, objs) \u2192 {Phaser.GameObject.Container}","description":"<div><h4>add_to_container(container, objs) \u2192 {Phaser.GameObject.Container}</h4><div class=\\"description\\">\\n    Add the given game object to the container.\\nMutates the container.\\n</div></div>","meta":"func"},"add_tween":{"title":"(async) add_tween(obj, config) \u2192 {Phaser.GameObjects.GameObject}","description":"<div><h4>(async) add_tween(obj, config) \u2192 {Phaser.GameObjects.GameObject}</h4><div class=\\"description\\">\\n    Create a tween to the object and plays it.\\nMutate the object.\\n</div></div>","meta":"func"},"adsr":{"title":"adsr(attack_ratio, decay_ratio, sustain_level, release_ratio) \u2192 {function}","description":"<div><h4>adsr(attack_ratio, decay_ratio, sustain_level, release_ratio) \u2192 {function}</h4><div class=\\"description\\">\\n    Returns an envelope: a function from Sound to Sound.\\nWhen the envelope is applied to a Sound, it returns\\na new Sound that results from applying ADSR to\\nthe given Sound. The Attack, Sustain and\\nRelease ratios are given in the first, second and fourth\\narguments, and the Sustain level is given in \\nthe third argument as a fraction between 0 and 1.\\n</div></div>","meta":"func"},"alpha_of":{"title":"alpha_of(px) \u2192 {Number}","description":"<div><h4>alpha_of(px) \u2192 {Number}</h4><div class=\\"description\\">\\n    Returns the alpha component of a given Pixel <code>px</code>\\n</div></div>","meta":"func"},"anaglyph":{"title":"anaglyph(rune) \u2192 {Picture}","description":"<div><h4>anaglyph(rune) \u2192 {Picture}</h4><div class=\\"description\\">\\n    turns a given Rune into an anaglyph Picture\\n</div></div>","meta":"func"},"arc":{"title":"arc(t) \u2192 {Point}","description":"<div><h4>arc(t) \u2192 {Point}</h4><div class=\\"description\\">\\n    this function is a curve: a function from a\\nfraction t to a point. The points lie on the\\nright half of the unit circle. They start at Point (0,1) when\\nt is 0. When t is 0.5, they reach Point (1,0),\\nwhen t is 1, they reach Point (0, -1).\\n</div></div>","meta":"func"},"b_of":{"title":"b_of(p) \u2192 {Number}","description":"<div><h4>b_of(p) \u2192 {Number}</h4><div class=\\"description\\">\\n    retrieves the blue component of a given Point\\n</div></div>","meta":"func"},"bell":{"title":"bell(note, duration) \u2192 {Sound}","description":"<div><h4>bell(note, duration) \u2192 {Sound}</h4><div class=\\"description\\">\\n    returns a Sound that is reminiscent of a bell, playing\\na given note for a given <code>duration</code> of seconds\\n</div></div>","meta":"func"},"beside":{"title":"beside(rune1, rune2) \u2192 {Rune}","description":"<div><h4>beside(rune1, rune2) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a new Rune from two given Runes by\\nplacing the first on the left of the second,\\nboth occupying equal portions of the width \\nof the result\\n</div></div>","meta":"func"},"beside_frac":{"title":"beside_frac(frac, rune1, rune2) \u2192 {Rune}","description":"<div><h4>beside_frac(frac, rune1, rune2) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a new Rune from two given Runes by\\nplacing the first on the left of the second\\nsuch that the first one occupies frac \\nportion of the width of the result and \\nthe second the rest\\n</div></div>","meta":"func"},"black":{"title":"black(rune) \u2192 {Rune}","description":"<div><h4>black(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    colors the given rune black.\\n</div></div>","meta":"func"},"blue":{"title":"blue(rune) \u2192 {Rune}","description":"<div><h4>blue(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    colors the given rune blue.\\n</div></div>","meta":"func"},"blue_of":{"title":"blue_of(px) \u2192 {Number}","description":"<div><h4>blue_of(px) \u2192 {Number}</h4><div class=\\"description\\">\\n    Returns the blue component of a given Pixel <code>px</code>\\n</div></div>","meta":"func"},"brown":{"title":"brown(rune) \u2192 {Rune}","description":"<div><h4>brown(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    colors the given rune brown.\\n</div></div>","meta":"func"},"cello":{"title":"cello(note, duration) \u2192 {Sound}","description":"<div><h4>cello(note, duration) \u2192 {Sound}</h4><div class=\\"description\\">\\n    returns a Sound that is reminiscent of a cello, playing\\na given note for a given <code>duration</code> of seconds\\n</div></div>","meta":"func"},"color":{"title":"color(rune, r, g, b) \u2192 {Rune}","description":"<div><h4>color(rune, r, g, b) \u2192 {Rune}</h4><div class=\\"description\\">\\n    adds color to rune by specifying \\nthe red, green, blue (RGB) value, ranging from 0.0 to 1.0.\\nRGB is additive: if all values are 1, the color is white,\\nand if all values are 0, the color is black.\\n</div></div>","meta":"func"},"connect_ends":{"title":"connect_ends(curve1, curve2) \u2192 {Curve}","description":"<div><h4>connect_ends(curve1, curve2) \u2192 {Curve}</h4><div class=\\"description\\">\\n    this function is a binary Curve operator: It\\ntakes two Curves as arguments and returns\\na new Curve. The two Curves are combined\\nby using the full first Curve for the first portion\\nof the result and by using the full second Curve for the second\\nportion of the result.\\nThe second Curve is translated such that its point\\nat fraction 0 is the same as the Point of the first\\nCurve at fraction 1.\\n</div></div>","meta":"func"},"connect_rigidly":{"title":"connect_rigidly(curve1, curve2) \u2192 {Curve}","description":"<div><h4>connect_rigidly(curve1, curve2) \u2192 {Curve}</h4><div class=\\"description\\">\\n    this function is a binary Curve operator: It\\ntakes two Curves as arguments and returns\\na new Curve. The two Curves are combined\\nby using the full first Curve for the first portion\\nof the result and by using the full second Curve for the \\nsecond portion of the result.\\nThe second Curve is not changed, and therefore\\nthere might be a big jump in the middle of the\\nresult Curve.\\n</div></div>","meta":"func"},"consecutively":{"title":"consecutively(sounds) \u2192 {Sound}","description":"<div><h4>consecutively(sounds) \u2192 {Sound}</h4><div class=\\"description\\">\\n    makes a new sound by combining the sounds in a given\\nlist so that\\nthey are arranged consecutively. Let us say the durations\\nof the sounds are <code>d1</code>, ..., <code>dn</code> and the wave \\nfunctions are <code>w1</code>, ..., <code>wn</code>. Then the resulting\\nsound has the duration of the sum of <code>d1</code>, ..., <code>dn</code>.\\nThe wave function <code>w</code> of the resulting sound uses <code>w1</code> for the first\\n<code>d1</code> seconds, <code>w2</code> for the next \\n<code>d2</code> seconds etc. We specify that <code>w(d1) = w2(0)</code>,\\n<code>w(d1+d2) = w3(0)</code>, etc\\n</div></div>","meta":"func"},"copy_image":{"title":"copy_image(src, dst) \u2192 {undefined}","description":"<div><h4>copy_image(src, dst) \u2192 {undefined}</h4><div class=\\"description\\">\\n    Filter that copies all Pixels faithfully from the\\nsource Image <code>src</code> to the destination Image <code>dst</code>\\n</div></div>","meta":"func"},"create_anim":{"title":"create_anim(anim_config) \u2192 {boolean}","description":"<div><h4>create_anim(anim_config) \u2192 {boolean}</h4><div class=\\"description\\">\\n    Create a new animation and add it to the available animations.\\nAnimations are global i.e. once created, it can be used anytime, anywhere.\\n\\nNOTE: Anims DO NOT need to be added into the scene to be used.\\nIt is automatically added to the scene when it is created.\\n\\nWIll return true if the animation key is valid\\n(key is specified within the anim_config); false if the key\\nis already in use.\\n</div></div>","meta":"func"},"create_anim_config":{"title":"create_anim_config(anims_key, anim_frames, frame_rate, duration, repeat, yoyo, show_on_start, hide_on_complete) \u2192 {config}","description":"<div><h4>create_anim_config(anims_key, anim_frames, frame_rate, duration, repeat, yoyo, show_on_start, hide_on_complete) \u2192 {config}</h4><div class=\\"description\\">\\n    Create anims config, can be used to configure anims\\n\\nFor more details about the config object, see:\\nhttps://photonstorm.github.io/phaser3-docs/Phaser.Types.Animations.html#.Animation\\n</div></div>","meta":"func"},"create_anim_frame_config":{"title":"create_anim_frame_config(key, frame, duration, visible) \u2192 {config}","description":"<div><h4>create_anim_frame_config(key, frame, duration, visible) \u2192 {config}</h4><div class=\\"description\\">\\n    Create animation frame config, can be used to configure a specific frame\\nwithin an animation.\\n\\nThe key should refer to an image that is already loaded.\\nTo make frame_config from spritesheet based on its frames,\\nuse create_anim_spritesheet_frame_configs instead.\\n</div></div>","meta":"func"},"create_anim_spritesheet_frame_configs":{"title":"create_anim_spritesheet_frame_configs(key) \u2192 {list_of_configs}","description":"<div><h4>create_anim_spritesheet_frame_configs(key) \u2192 {list_of_configs}</h4><div class=\\"description\\">\\n    Create list of animation frame config, can be used directly as part of \\nanim_config\'s `frames` parameter.\\n\\nThis function will generate list of frame configs based on the \\nspritesheet_config attached to the associated spritesheet.\\nThis function requires that the given key is a spritesheet key\\ni.e. a key associated with loaded spritesheet, loaded in using\\nload_spritesheet function.\\n\\nWill return empty frame configs if key is not associated with\\na spritesheet.\\n</div></div>","meta":"func"},"create_award":{"title":"create_award(x, y, award_key) \u2192 {Phaser.GameObject.Sprite}","description":"<div><h4>create_award(x, y, award_key) \u2192 {Phaser.GameObject.Sprite}</h4><div class=\\"description\\">\\n    Create an award using the key associated with the award.\\nThe award key can be obtained from the Awards Hall or\\nAwards menu, after attaining the award.\\n\\nValid award will have an on-hover VERIFIED tag to distinguish\\nit from images created by create_image.\\n\\nIf student does not possess the award, this function will\\nreturn a untagged, default image.\\n</div></div>","meta":"func"},"create_config":{"title":"create_config(lst) \u2192 {config}","description":"<div><h4>create_config(lst) \u2192 {config}</h4><div class=\\"description\\">\\n    Transforms the given list into config object. The list follows\\nthe format of list([key1, value1], [key2, value2]).\\n\\ne.g list([\\"alpha\\", 0], [\\"duration\\", 1000])\\n</div></div>","meta":"func"},"create_container":{"title":"create_container(x, y) \u2192 {Phaser.GameObjects.Container}","description":"<div><h4>create_container(x, y) \u2192 {Phaser.GameObjects.Container}</h4><div class=\\"description\\">\\n    Create a container object. Container is able to contain any other game object,\\nand the positions of contained game object will be relative to the container.\\n\\nRendering the container as visible or invisible will also affect the contained\\ngame object.\\n\\nContainer can also contain another container.\\n\\n0, 0 is located at the top, left hand side.\\n\\nFor more details about container object, see:\\nhttps://photonstorm.github.io/phaser3-docs/Phaser.GameObjects.Container.html\\n</div></div>","meta":"func"},"create_ellipse":{"title":"create_ellipse(x, y, width, height, fill, alpha) \u2192 {Phaser.GameObjects.Ellipse}","description":"<div><h4>create_ellipse(x, y, width, height, fill, alpha) \u2192 {Phaser.GameObjects.Ellipse}</h4><div class=\\"description\\">\\n    Create an ellipse object.\\n</div></div>","meta":"func"},"create_image":{"title":"create_image(x, y, asset_key) \u2192 {Phaser.GameObjects.Sprite}","description":"<div><h4>create_image(x, y, asset_key) \u2192 {Phaser.GameObjects.Sprite}</h4><div class=\\"description\\">\\n    Create an image using the key associated with a loaded image.\\nIf key is not associated with any loaded image, throws error.\\n\\n0, 0 is located at the top, left hand side.\\n</div></div>","meta":"func"},"create_interactive_config":{"title":"create_interactive_config(draggable, use_hand_cursor, pixel_perfect, alpha_tolerance) \u2192 {config}","description":"<div><h4>create_interactive_config(draggable, use_hand_cursor, pixel_perfect, alpha_tolerance) \u2192 {config}</h4><div class=\\"description\\">\\n    Create interactive config object, can be used to configure interactive settings.\\n\\nFor more details about interactive config object, see:\\nhttps://photonstorm.github.io/phaser3-docs/Phaser.Types.Input.html#.InputConfiguration\\n</div></div>","meta":"func"},"create_rect":{"title":"create_rect(x, y, width, height, fill, alpha) \u2192 {Phaser.GameObjects.Rectangle}","description":"<div><h4>create_rect(x, y, width, height, fill, alpha) \u2192 {Phaser.GameObjects.Rectangle}</h4><div class=\\"description\\">\\n    Create a rectangle object.\\n\\n0, 0 is located at the top, left hand side.\\n</div></div>","meta":"func"},"create_sound_config":{"title":"create_sound_config(mute, volume, rate, detune, seek, loop, delay) \u2192 {config}","description":"<div><h4>create_sound_config(mute, volume, rate, detune, seek, loop, delay) \u2192 {config}</h4><div class=\\"description\\">\\n    Create sound config object, can be used to configure sound settings.\\n\\nFor more details about sound config object, see:\\nhttps://photonstorm.github.io/phaser3-docs/Phaser.Types.Sound.html#.SoundConfig\\n</div></div>","meta":"func"},"create_spritesheet_config":{"title":"create_spritesheet_config(frame_width, frame_height, start_frame, margin, spacing) \u2192 {config}","description":"<div><h4>create_spritesheet_config(frame_width, frame_height, start_frame, margin, spacing) \u2192 {config}</h4><div class=\\"description\\">\\n    Create spritesheet config, can be used to configure the frames within the\\nspritesheet. Can be used as config at load_spritesheet.\\n</div></div>","meta":"func"},"create_text":{"title":"create_text(x, y, text, config) \u2192 {Phaser.GameObjects.Text}","description":"<div><h4>create_text(x, y, text, config) \u2192 {Phaser.GameObjects.Text}</h4><div class=\\"description\\">\\n    Create a text object.\\n\\n0, 0 is located at the top, left hand side.\\n</div></div>","meta":"func"},"create_text_config":{"title":"create_text_config(font_family, font_size, color, stroke, stroke_thickness, align) \u2192 {config}","description":"<div><h4>create_text_config(font_family, font_size, color, stroke, stroke_thickness, align) \u2192 {config}</h4><div class=\\"description\\">\\n    Create text config object, can be used to stylise text object.\\n\\nfont_family: for available font_family, see:\\nhttps://developer.mozilla.org/en-US/docs/Web/CSS/font-family#Valid_family_names\\n\\nalign: must be either \'left\', \'right\', \'center\', or \'justify\'\\n\\nFor more details about text config, see:\\nhttps://photonstorm.github.io/phaser3-docs/Phaser.Types.GameObjects.Text.html#.TextStyle\\n</div></div>","meta":"func"},"create_tween_config":{"title":"create_tween_config(target_prop, target_value, delay, duration, ease, on_complete, yoyo, loop, loop_delay, on_loop) \u2192 {config}","description":"<div><h4>create_tween_config(target_prop, target_value, delay, duration, ease, on_complete, yoyo, loop, loop_delay, on_loop) \u2192 {config}</h4><div class=\\"description\\">\\n    Create tween config object, can be used to configure tween settings.\\n\\nFor more details about tween config object, see:\\nhttps://photonstorm.github.io/phaser3-docs/Phaser.Types.Tweens.html#.TweenBuilderConfig\\n</div></div>","meta":"func"},"destroy_obj":{"title":"destroy_obj(obj)","description":"<div><h4>destroy_obj(obj)</h4><div class=\\"description\\">\\n    Destroy the given game object. Destroyed game object\\nis removed from the scene, and all of its listeners\\nis also removed.\\n</div></div>","meta":"func"},"draw_3D_connected":{"title":"draw_3D_connected(num) \u2192 {function}","description":"<div><h4>draw_3D_connected(num) \u2192 {function}</h4><div class=\\"description\\">\\n    returns a function that turns a given 3D Curve into a Drawing, \\nby sampling the 3D Curve at <code>num</code> sample points \\nand connecting each pair with a line. \\nWhen a program evaluates to a Drawing, the Source system \\ndisplays it graphically, in a window, instead of textually. \\nThe parts between (0,0,0) and (1,1,1) of the resulting \\nDrawing are shown within the unit cube.\\n</div></div>","meta":"func"},"draw_3D_connected_full_view":{"title":"draw_3D_connected_full_view(num) \u2192 {function}","description":"<div><h4>draw_3D_connected_full_view(num) \u2192 {function}</h4><div class=\\"description\\">\\n    returns a function that turns a given 3D Curve into a Drawing, \\nby sampling the 3D Curve at <code>num</code> sample points \\nand connecting each pair with a line. \\nWhen a program evaluates to a Drawing, the Source system \\ndisplays it graphically, in a window, instead of textually. \\nThe Drawing is stretched or shrunk \\nto show the full curve \\nand maximize its width, height and depth within the cube.\\n</div></div>","meta":"func"},"draw_3D_connected_full_view_proportional":{"title":"draw_3D_connected_full_view_proportional(num) \u2192 {function}","description":"<div><h4>draw_3D_connected_full_view_proportional(num) \u2192 {function}</h4><div class=\\"description\\">\\n    returns a function that turns a given 3D Curve into a Drawing, \\nby sampling the 3D Curve at <code>num</code> sample points \\nand connecting each pair with a line. \\nWhen a program evaluates to a Drawing, the Source system \\ndisplays it graphically, in a window, instead of textually. \\nThe Drawing is scaled proportionally with its size maximized \\nto fit entirely inside the cube.\\n</div></div>","meta":"func"},"draw_3D_points_full_view_proportional":{"title":"draw_3D_points_full_view_proportional(num) \u2192 {function}","description":"<div><h4>draw_3D_points_full_view_proportional(num) \u2192 {function}</h4><div class=\\"description\\">\\n    returns a function that turns a given 3D Curve into a Drawing, \\nby sampling the 3D Curve at <code>num</code> sample points. \\nThe Drawing consists of isolated points, and does not connect them. \\nWhen a program evaluates to a Drawing, the Source system \\ndisplays it graphically, in a window, instead of textually. \\nThe Drawing is scaled proportionally with its size maximized \\nto fit entirely inside the cube.\\n</div></div>","meta":"func"},"draw_3D_points_on":{"title":"draw_3D_points_on(num) \u2192 {function}","description":"<div><h4>draw_3D_points_on(num) \u2192 {function}</h4><div class=\\"description\\">\\n    returns a function that turns a given 3D Curve into a Drawing, \\nby sampling the 3D Curve at <code>num</code> sample points. \\nThe Drawing consists of isolated points, and does not connect them. \\nWhen a program evaluates to a Drawing, the Source system \\ndisplays it graphically, in a window, instead of textually. \\nThe parts between (0,0,0) and (1,1,1) of the resulting \\nDrawing are shown within the unit cube.\\n</div></div>","meta":"func"},"draw_connected":{"title":"draw_connected(num) \u2192 {function}","description":"<div><h4>draw_connected(num) \u2192 {function}</h4><div class=\\"description\\">\\n    returns a function that turns a given Curve into a Drawing, \\nby sampling the Curve at <code>num</code> sample points \\nand connecting each pair with a line. \\nWhen a program evaluates to a Drawing, the Source system\\ndisplays it graphically, in a window, instead of textually.\\nThe parts between (0,0) and (1,1) of the resulting Drawing \\nare shown in the window.\\n</div></div>","meta":"func"},"draw_connected_full_view":{"title":"draw_connected_full_view(num) \u2192 {function}","description":"<div><h4>draw_connected_full_view(num) \u2192 {function}</h4><div class=\\"description\\">\\n    returns a function that turns a given Curve into a Drawing, \\nby sampling the Curve at <code>num</code> sample points \\nand connecting each pair with a line. \\nWhen a program evaluates to a Drawing, the Source system\\ndisplays it graphically, in a window, instead of textually.\\nThe Drawing is stretched or shrunk\\nto show the full curve\\nand maximize its width and height, with some padding.\\n</div></div>","meta":"func"},"draw_connected_full_view_proportional":{"title":"draw_connected_full_view_proportional(num) \u2192 {function}","description":"<div><h4>draw_connected_full_view_proportional(num) \u2192 {function}</h4><div class=\\"description\\">\\n    returns a function that turns a given Curve into a Drawing, \\nby sampling the Curve at <code>num</code> sample points \\nand connecting each pair with a line. \\nWhen a program evaluates to a Drawing, the Source system\\ndisplays it graphically, in a window, instead of textually.\\nThe Drawing is scaled proportionally to show the full curve\\nand maximize its size, with some padding.\\n</div></div>","meta":"func"},"draw_points_full_view_proportional":{"title":"draw_points_full_view_proportional(num) \u2192 {function}","description":"<div><h4>draw_points_full_view_proportional(num) \u2192 {function}</h4><div class=\\"description\\">\\n    returns a function that turns a given Curve into a Drawing, \\nby sampling the Curve at <code>num</code> sample points.\\nThe Drawing consists of isolated points, and does not connect them.\\nWhen a program evaluates to a Drawing, the Source system\\ndisplays it graphically, in a window, instead of textually.\\nThe Drawing is scaled proportionally with its size maximized \\nto fit entirely inside the window, with some padding.\\n</div></div>","meta":"func"},"draw_points_on":{"title":"draw_points_on(num) \u2192 {function}","description":"<div><h4>draw_points_on(num) \u2192 {function}</h4><div class=\\"description\\">\\n    returns a function that turns a given Curve into a Drawing, \\nby sampling the Curve at <code>num</code> sample points.\\nThe Drawing consists of isolated points, and does not connect them.\\nWhen a program evaluates to a Drawing, the Source system\\ndisplays it graphically, in a window, instead of textually.\\nThe parts between (0,0) and (1,1) of the resulting Drawing \\nare shown in the window.\\n</div></div>","meta":"func"},"ev3_ambientLightIntensity":{"title":"ev3_ambientLightIntensity(colorSensor) \u2192 {number}","description":"<div><h4>ev3_ambientLightIntensity(colorSensor) \u2192 {number}</h4><div class=\\"description\\">\\n    Gets the ambient light intensity seen by the colour sensor.\\n</div></div>","meta":"func"},"ev3_colorSensor":{"title":"ev3_colorSensor() \u2192 {peripheral}","description":"<div><h4>ev3_colorSensor() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the colour sensor connected any of ports 1, 2, 3 or 4.\\n</div></div>","meta":"func"},"ev3_colorSensorBlue":{"title":"ev3_colorSensorBlue(colorSensor) \u2192 {number}","description":"<div><h4>ev3_colorSensorBlue(colorSensor) \u2192 {number}</h4><div class=\\"description\\">\\n    Gets the amount of blue seen by the colour sensor.\\n</div></div>","meta":"func"},"ev3_colorSensorGetColor":{"title":"ev3_colorSensorGetColor(colorSensor) \u2192 {number}","description":"<div><h4>ev3_colorSensorGetColor(colorSensor) \u2192 {number}</h4><div class=\\"description\\">\\n    Gets the colour as seen by the colour sensor.\\n\\nPossible colour return values are:\\n<ul><li>0 none</li>\\n<li>1 black</li>\\n<li>2 blue</li>\\n<li>3 green</li>\\n<li>4 yellow</li>\\n<li>5 red</li>\\n<li>6 white</li>\\n<li>7 brown</li></ul>\\n</div></div>","meta":"func"},"ev3_colorSensorGreen":{"title":"ev3_colorSensorGreen(colorSensor) \u2192 {number}","description":"<div><h4>ev3_colorSensorGreen(colorSensor) \u2192 {number}</h4><div class=\\"description\\">\\n    Gets the amount of green seen by the colour sensor.\\n</div></div>","meta":"func"},"ev3_colorSensorRed":{"title":"ev3_colorSensorRed(colorSensor) \u2192 {number}","description":"<div><h4>ev3_colorSensorRed(colorSensor) \u2192 {number}</h4><div class=\\"description\\">\\n    Gets the amount of red seen by the colour sensor.\\n</div></div>","meta":"func"},"ev3_connected":{"title":"ev3_connected(obj) \u2192 {boolean}","description":"<div><h4>ev3_connected(obj) \u2192 {boolean}</h4><div class=\\"description\\">\\n    Checks if the peripheral is connected.\\n</div></div>","meta":"func"},"ev3_gyroSensor":{"title":"ev3_gyroSensor() \u2192 {peripheral}","description":"<div><h4>ev3_gyroSensor() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the gyro sensor connected any of ports 1, 2, 3 or 4.\\n</div></div>","meta":"func"},"ev3_gyroSensorAngle":{"title":"ev3_gyroSensorAngle(gyroSensor) \u2192 {number}","description":"<div><h4>ev3_gyroSensorAngle(gyroSensor) \u2192 {number}</h4><div class=\\"description\\">\\n    Gets the absolute angle detected by the gyro sensor, measured from when\\nthe sensor was last switched to angle mode from sensor rate mode.\\n</div></div>","meta":"func"},"ev3_gyroSensorRate":{"title":"ev3_gyroSensorRate(gyroSensor) \u2192 {number}","description":"<div><h4>ev3_gyroSensorRate(gyroSensor) \u2192 {number}</h4><div class=\\"description\\">\\n    Gets the rate of rotation detected by the gyro sensor.\\n</div></div>","meta":"func"},"ev3_hello":{"title":"ev3_hello() \u2192 {string}","description":"<div><h4>ev3_hello() \u2192 {string}</h4><div class=\\"description\\">\\n    Returns a hello world message.\\n</div></div>","meta":"func"},"ev3_ledGetBrightness":{"title":"ev3_ledGetBrightness(led) \u2192 {number}","description":"<div><h4>ev3_ledGetBrightness(led) \u2192 {number}</h4><div class=\\"description\\">\\n    Gets the brightness of the given LED.\\n\\nThe brightness is a number ranging from 0 (off) to 255 (maximum).\\n</div></div>","meta":"func"},"ev3_ledLeftGreen":{"title":"ev3_ledLeftGreen() \u2192 {peripheral}","description":"<div><h4>ev3_ledLeftGreen() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the left green LED.\\n\\nNote that the four LEDs on the EV3 are laid out in two pairs of green and\\nred. If both in a pair are turned on, you can vary the colours in a small\\nspectrum between red and green.\\n</div></div>","meta":"func"},"ev3_ledLeftRed":{"title":"ev3_ledLeftRed() \u2192 {peripheral}","description":"<div><h4>ev3_ledLeftRed() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the left red LED.\\n\\nNote that the four LEDs on the EV3 are laid out in two pairs of green and\\nred. If both in a pair are turned on, you can vary the colours in a small\\nspectrum between red and green.\\n</div></div>","meta":"func"},"ev3_ledRightGreen":{"title":"ev3_ledRightGreen() \u2192 {peripheral}","description":"<div><h4>ev3_ledRightGreen() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the right green LED.\\n\\nNote that the four LEDs on the EV3 are laid out in two pairs of green and\\nred. If both in a pair are turned on, you can vary the colours in a small\\nspectrum between red and green.\\n</div></div>","meta":"func"},"ev3_ledRightRed":{"title":"ev3_ledRightRed() \u2192 {peripheral}","description":"<div><h4>ev3_ledRightRed() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the right red LED.\\n\\nNote that the four LEDs on the EV3 are laid out in two pairs of green and\\nred. If both in a pair are turned on, you can vary the colours in a small\\nspectrum between red and green.\\n</div></div>","meta":"func"},"ev3_ledSetBrightness":{"title":"ev3_ledSetBrightness(led, brightness)","description":"<div><h4>ev3_ledSetBrightness(led, brightness)</h4><div class=\\"description\\">\\n    Sets the brightness of the given LED.\\n\\nThe brightness is a number ranging from 0 (off) to 255 (maximum).\\n</div></div>","meta":"func"},"ev3_motorA":{"title":"ev3_motorA() \u2192 {peripheral}","description":"<div><h4>ev3_motorA() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the motor connected to port A.\\n</div></div>","meta":"func"},"ev3_motorB":{"title":"ev3_motorB() \u2192 {peripheral}","description":"<div><h4>ev3_motorB() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the motor connected to port B.\\n</div></div>","meta":"func"},"ev3_motorC":{"title":"ev3_motorC() \u2192 {peripheral}","description":"<div><h4>ev3_motorC() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the motor connected to port C.\\n</div></div>","meta":"func"},"ev3_motorD":{"title":"ev3_motorD() \u2192 {peripheral}","description":"<div><h4>ev3_motorD() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the motor connected to port D.\\n</div></div>","meta":"func"},"ev3_motorGetPosition":{"title":"ev3_motorGetPosition(motor) \u2192 {number}","description":"<div><h4>ev3_motorGetPosition(motor) \u2192 {number}</h4><div class=\\"description\\">\\n    Gets the motor\'s current position, in pulses of the rotary encoder.\\n</div></div>","meta":"func"},"ev3_motorGetSpeed":{"title":"ev3_motorGetSpeed(motor) \u2192 {number}","description":"<div><h4>ev3_motorGetSpeed(motor) \u2192 {number}</h4><div class=\\"description\\">\\n    Gets the motor\'s current speed, in tacho counts per second.\\n</div></div>","meta":"func"},"ev3_motorSetSpeed":{"title":"ev3_motorSetSpeed(motor, speed)","description":"<div><h4>ev3_motorSetSpeed(motor, speed)</h4><div class=\\"description\\">\\n    Sets the speed the motor will run at the next time <a href=\\"global.html#ev3_motorStart\\">ev3_motorStart</a>\\nis called.\\n</div></div>","meta":"func"},"ev3_motorSetStopAction":{"title":"ev3_motorSetStopAction(motor, stopAction)","description":"<div><h4>ev3_motorSetStopAction(motor, stopAction)</h4><div class=\\"description\\">\\n    Sets the stop action of the motor.\\n\\nPossible stop actions are:\\n\\n<ul><li><code>\\"coast\\"</code>: power will be removed from the motor and it will freely coast to a stop.</li>\\n<li><code>\\"brake\\"</code>: power will be removed from the motor and a passive electrical load will be placed on the motor. This load will absorb the energy from the rotation of the motors and cause the motor to stop more quickly than coasting.</li>\\n<li><code>\\"hold\\"</code>: actively try to hold the motor at the current position. If an external force tries to turn the motor, the motor will \u2018push back\u2019 to maintain its position.</li></ul>\\n</div></div>","meta":"func"},"ev3_motorStart":{"title":"ev3_motorStart(motor)","description":"<div><h4>ev3_motorStart(motor)</h4><div class=\\"description\\">\\n    Causes the motor to start with the previously set speed and stop action\\n(see motorSetSpeed and motorSetStopAction).\\n</div></div>","meta":"func"},"ev3_motorStop":{"title":"ev3_motorStop(motor)","description":"<div><h4>ev3_motorStop(motor)</h4><div class=\\"description\\">\\n    Causes the motor to stop using the previously set stop action.\\n</div></div>","meta":"func"},"ev3_pause":{"title":"ev3_pause(time)","description":"<div><h4>ev3_pause(time)</h4><div class=\\"description\\">\\n    Pauses for a period of time.\\n</div></div>","meta":"func"},"ev3_playSequence":{"title":"ev3_playSequence(beeps)","description":"<div><h4>ev3_playSequence(beeps)</h4><div class=\\"description\\">\\n    Causes the robot to emit a sequence of beeps. Returns after the beeps are\\nemitted.\\n\\nThe beep sequence is an array of <code>[frequency, length (ms), delay (ms),\\n...]</code>. For example, <code>[1000, 500, 500, 250, 500, 0]</code> will\\ncause the robot to emit a 1000 Hz beep for 500 ms, wait 500 ms, then emit a\\n250 Hz beep for 500 ms.\\n</div></div>","meta":"func"},"ev3_reflectedLightIntensity":{"title":"ev3_reflectedLightIntensity(colorSensor) \u2192 {number}","description":"<div><h4>ev3_reflectedLightIntensity(colorSensor) \u2192 {number}</h4><div class=\\"description\\">\\n    Gets the reflected light intensity seen by the colour sensor.\\n</div></div>","meta":"func"},"ev3_runForTime":{"title":"ev3_runForTime(motor, time, speed)","description":"<div><h4>ev3_runForTime(motor, time, speed)</h4><div class=\\"description\\">\\n    Causes the motor to rotate for a specified duration at the specified speed.\\n\\nNote: this works by sending instructions to the motors. This will return almost immediately, without waiting for the motor to actually run for the specified duration. If you wish to wait, use <a href=\\"global.html#ev3_pause\\">ev3_pause</a>.\\n</div></div>","meta":"func"},"ev3_runToAbsolutePosition":{"title":"ev3_runToAbsolutePosition(motor, position, speed)","description":"<div><h4>ev3_runToAbsolutePosition(motor, position, speed)</h4><div class=\\"description\\">\\n    Causes the motor to rotate to the given absolute position (as reported by\\n<a href=\\"global.html#ev3_motorGetPosition\\">ev3_motorGetPosition</a>) with the given speed.\\n\\nNote: this works by sending instructions to the motors. This will return almost immediately, without waiting for the motor to reach the given absolute position. If you wish to wait, use <a href=\\"global.html#ev3_pause\\">ev3_pause</a>.\\n</div></div>","meta":"func"},"ev3_runToRelativePosition":{"title":"ev3_runToRelativePosition(motor, position, speed)","description":"<div><h4>ev3_runToRelativePosition(motor, position, speed)</h4><div class=\\"description\\">\\n    Causes the motor to rotate until the position reaches <code><a href=\\"global.html#ev3_motorGetPosition\\">ev3_motorGetPosition</a>()\\n + position</code> with the given speed.\\n\\nNote: this works by sending instructions to the motors. This will return almost immediately, without waiting for the motor to reach the given absolute position. If you wish to wait, use <a href=\\"global.html#ev3_pause\\">ev3_pause</a>.\\n</div></div>","meta":"func"},"ev3_speak":{"title":"ev3_speak(words)","description":"<div><h4>ev3_speak(words)</h4><div class=\\"description\\">\\n    Makes the robot speak the given words through its speaker. Returns after the\\nwords are spoken.\\n</div></div>","meta":"func"},"ev3_touchSensor1":{"title":"ev3_touchSensor1() \u2192 {peripheral}","description":"<div><h4>ev3_touchSensor1() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the touch sensor connected to port 1.\\n</div></div>","meta":"func"},"ev3_touchSensor2":{"title":"ev3_touchSensor2() \u2192 {peripheral}","description":"<div><h4>ev3_touchSensor2() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the touch sensor connected to port 2.\\n</div></div>","meta":"func"},"ev3_touchSensor3":{"title":"ev3_touchSensor3() \u2192 {peripheral}","description":"<div><h4>ev3_touchSensor3() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the touch sensor connected to port 3.\\n</div></div>","meta":"func"},"ev3_touchSensor4":{"title":"ev3_touchSensor4() \u2192 {peripheral}","description":"<div><h4>ev3_touchSensor4() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the touch sensor connected to port 4.\\n</div></div>","meta":"func"},"ev3_touchSensorPressed":{"title":"ev3_touchSensorPressed(touchSensor) \u2192 {boolean}","description":"<div><h4>ev3_touchSensorPressed(touchSensor) \u2192 {boolean}</h4><div class=\\"description\\">\\n    Gets whether the touch sensor is pressed.\\n</div></div>","meta":"func"},"ev3_ultrasonicSensor":{"title":"ev3_ultrasonicSensor() \u2192 {peripheral}","description":"<div><h4>ev3_ultrasonicSensor() \u2192 {peripheral}</h4><div class=\\"description\\">\\n    Gets the ultrasonic sensor connected any of ports 1, 2, 3 or 4.\\n</div></div>","meta":"func"},"ev3_ultrasonicSensorDistance":{"title":"ev3_ultrasonicSensorDistance(ultrasonicSensor) \u2192 {number}","description":"<div><h4>ev3_ultrasonicSensorDistance(ultrasonicSensor) \u2192 {number}</h4><div class=\\"description\\">\\n    Gets the distance read by the ultrasonic sensor in centimeters.\\n</div></div>","meta":"func"},"ev3_waitForButtonPress":{"title":"ev3_waitForButtonPress() \u2192 {number}","description":"<div><h4>ev3_waitForButtonPress() \u2192 {number}</h4><div class=\\"description\\">\\n    Waits for one of the buttons on the EV3\'s control face to be pressed, then\\nreturns a value corresponding to the button that was pressed:\\n\\n<ul><li>0 enter (the middle button)</li>\\n<li>1 back (the top left button)</li>\\n<li>2 left</li>\\n<li>3 right</li>\\n<li>4 up</li>\\n<li>5 down</li></ul>\\n</div></div>","meta":"func"},"flip_horiz":{"title":"flip_horiz(rune) \u2192 {Rune}","description":"<div><h4>flip_horiz(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a new Rune from a given Rune by\\nflipping it around a vertical axis,\\ncreating a mirror image\\n</div></div>","meta":"func"},"flip_vert":{"title":"flip_vert(rune) \u2192 {Rune}","description":"<div><h4>flip_vert(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a new Rune from a given Rune by\\nflipping it around a horizontal axis,\\nturning it upside down\\n</div></div>","meta":"func"},"g_of":{"title":"g_of(p) \u2192 {Number}","description":"<div><h4>g_of(p) \u2192 {Number}</h4><div class=\\"description\\">\\n    retrieves the green component of a given Point\\n</div></div>","meta":"func"},"get_duration":{"title":"get_duration(sound) \u2192 {Number}","description":"<div><h4>get_duration(sound) \u2192 {Number}</h4><div class=\\"description\\">\\n    Accesses the duration of a Sound, in seconds.\\n</div></div>","meta":"func"},"get_screen_display_height":{"title":"get_screen_display_height() \u2192 {number}","description":"<div><h4>get_screen_display_height() \u2192 {number}</h4><div class=\\"description\\">\\n    Get game screen display height (accounting window size).\\n</div></div>","meta":"func"},"get_screen_display_width":{"title":"get_screen_display_width() \u2192 {number}","description":"<div><h4>get_screen_display_width() \u2192 {number}</h4><div class=\\"description\\">\\n    Get game screen display width (accounting window size).\\n</div></div>","meta":"func"},"get_screen_height":{"title":"get_screen_height() \u2192 {number}","description":"<div><h4>get_screen_height() \u2192 {number}</h4><div class=\\"description\\">\\n    Get in-game screen height.\\n</div></div>","meta":"func"},"get_screen_width":{"title":"get_screen_width() \u2192 {number}","description":"<div><h4>get_screen_width() \u2192 {number}</h4><div class=\\"description\\">\\n    Get in-game screen width.\\n</div></div>","meta":"func"},"get_wave":{"title":"get_wave(sound) \u2192 {function}","description":"<div><h4>get_wave(sound) \u2192 {function}</h4><div class=\\"description\\">\\n    Accesses the wave of a Sound.\\nThe wave is a function from a nonnegative time (in seconds)\\nto an amplitude value that should lie between\\n-1 and 1.\\n</div></div>","meta":"func"},"green":{"title":"green(rune) \u2192 {Rune}","description":"<div><h4>green(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    colors the given rune green.\\n</div></div>","meta":"func"},"green_of":{"title":"green_of(px) \u2192 {Number}","description":"<div><h4>green_of(px) \u2192 {Number}</h4><div class=\\"description\\">\\n    Returns the green component of a given Pixel <code>px</code>\\n</div></div>","meta":"func"},"hollusion":{"title":"hollusion(rune) \u2192 {Picture}","description":"<div><h4>hollusion(rune) \u2192 {Picture}</h4><div class=\\"description\\">\\n    turns a given Rune into Hollusion\\n</div></div>","meta":"func"},"indigo":{"title":"indigo(rune) \u2192 {Rune}","description":"<div><h4>indigo(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    colors the given rune indigo.\\n</div></div>","meta":"func"},"init_record":{"title":"init_record() \u2192 {undefined}","description":"<div><h4>init_record() \u2192 {undefined}</h4><div class=\\"description\\">\\n    Initialize recording by obtaining permission\\nto use the default device microphone\\n</div></div>","meta":"func"},"install_filter":{"title":"install_filter(f) \u2192 {undefined}","description":"<div><h4>install_filter(f) \u2192 {undefined}</h4><div class=\\"description\\">\\n    Installs a given Filter to be used to transform\\nthe Images that the camera captures into Images\\ndisplayed on the screen. A Filter is a function\\nthat is applied to two Images (2-D arrays\\nof Pixels): the source Image and the destination\\nImage.\\n</div></div>","meta":"func"},"invert":{"title":"invert(original) \u2192 {Curve}","description":"<div><h4>invert(original) \u2192 {Curve}</h4><div class=\\"description\\">\\n    this function is a Curve transformation: a function from a\\nCurve to a Curve. The points of the result Curve are\\nthe same points as the points of the original Curve, but\\nin reverse: The result Curve applied to 0 is the original Curve\\napplied to 1 and vice versa.\\n</div></div>","meta":"func"},"is_sound":{"title":"is_sound(x) \u2192 {boolean}","description":"<div><h4>is_sound(x) \u2192 {boolean}</h4><div class=\\"description\\">\\n    Checks if a given value is a Sound\\n</div></div>","meta":"func"},"letter_name_to_frequency":{"title":"letter_name_to_frequency(str) \u2192 {Number}","description":"<div><h4>letter_name_to_frequency(str) \u2192 {Number}</h4><div class=\\"description\\">\\n    converts a letter name <code>str</code> to corresponding frequency.\\nFirst converts <code>str</code> to a note using <code>letter_name_to_midi_note</code>\\nand then to a frequency using <code>midi_note_to_frequency</code>\\n</div></div>","meta":"func"},"letter_name_to_midi_note":{"title":"letter_name_to_midi_note(str) \u2192 {Number}","description":"<div><h4>letter_name_to_midi_note(str) \u2192 {Number}</h4><div class=\\"description\\">\\n    converts a letter name <code>str</code> to corresponding midi note.\\nExamples for letter names are <code>\\"A5\\"</code>, <code>\\"B3\\"</code>, <code>\\"D#4\\"</code>.\\nSee <a href=\\"https://i.imgur.com/qGQgmYr.png\\">mapping from\\nletter name to midi notes</a>\\n</div></div>","meta":"func"},"load_image":{"title":"load_image(key, url)","description":"<div><h4>load_image(key, url)</h4><div class=\\"description\\">\\n    Load the image asset into the scene for use. All images\\nmust be loaded before used in create_image.\\n</div></div>","meta":"func"},"load_sound":{"title":"load_sound(key, url)","description":"<div><h4>load_sound(key, url)</h4><div class=\\"description\\">\\n    Load the sound asset into the scene for use. All sound\\nmust be loaded before used in play_sound.\\n</div></div>","meta":"func"},"load_spritesheet":{"title":"load_spritesheet(key, url, spritesheet_config)","description":"<div><h4>load_spritesheet(key, url, spritesheet_config)</h4><div class=\\"description\\">\\n    Load the spritesheet into the scene for use. All spritesheet must\\nbe loaded before used in create_image.\\n</div></div>","meta":"func"},"make_3D_color_point":{"title":"make_3D_color_point(x, y, z, r, g, b) \u2192 {Point}","description":"<div><h4>make_3D_color_point(x, y, z, r, g, b) \u2192 {Point}</h4><div class=\\"description\\">\\n    makes a 3D color Point with given x, y and z coordinates, \\nand RGB values ranging from 0 to 255. \\nAny input lower than 0 for RGB will be rounded up to 0, \\nand any input higher than 255 will be rounded down to 255.\\n</div></div>","meta":"func"},"make_3D_point":{"title":"make_3D_point(x, y, z) \u2192 {Point}","description":"<div><h4>make_3D_point(x, y, z) \u2192 {Point}</h4><div class=\\"description\\">\\n    makes a 3D Point with given x, y and z coordinates\\n</div></div>","meta":"func"},"make_color_point":{"title":"make_color_point(x, y, r, g, b) \u2192 {Point}","description":"<div><h4>make_color_point(x, y, r, g, b) \u2192 {Point}</h4><div class=\\"description\\">\\n    makes a color Point with given x and y coordinates, \\nand RGB values ranging from 0 to 255. \\nAny input lower than 0 for RGB will be rounded up to 0, \\nand any input higher than 255 will be rounded down to 255.\\n</div></div>","meta":"func"},"make_cross":{"title":"make_cross(rune) \u2192 {Rune}","description":"<div><h4>make_cross(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a new Rune from a given Rune by\\narranging into a square for copies of the \\ngiven Rune in different orientations\\n</div></div>","meta":"func"},"make_point":{"title":"make_point(x, y) \u2192 {Point}","description":"<div><h4>make_point(x, y) \u2192 {Point}</h4><div class=\\"description\\">\\n    makes a Point with given x and y coordinates\\n</div></div>","meta":"func"},"make_sound":{"title":"make_sound(wave, duration) \u2192 {Sound}","description":"<div><h4>make_sound(wave, duration) \u2192 {Sound}</h4><div class=\\"description\\">\\n    Makes a Sound from a wave and a duration.\\nThe wave is a function from a nonnegative time (in seconds)\\nto an amplitude value that should lie between\\n-1 and 1. The duration is given in seconds.\\n</div></div>","meta":"func"},"midi_note_to_frequency":{"title":"midi_note_to_frequency(n) \u2192 {Number}","description":"<div><h4>midi_note_to_frequency(n) \u2192 {Number}</h4><div class=\\"description\\">\\n    converts a midi note <code>n</code> to corresponding frequency.\\nThe note is given as an integer Number.\\n</div></div>","meta":"func"},"noise_sound":{"title":"noise_sound(duration) \u2192 {Sound}","description":"<div><h4>noise_sound(duration) \u2192 {Sound}</h4><div class=\\"description\\">\\n    makes a Sound of a given duration by randomly\\ngenerating amplitude values\\n</div></div>","meta":"func"},"orange":{"title":"orange(rune) \u2192 {Rune}","description":"<div><h4>orange(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    colors the given rune orange.\\n</div></div>","meta":"func"},"overlay":{"title":"overlay(rune1, rune2) \u2192 {Rune}","description":"<div><h4>overlay(rune1, rune2) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a 3D-Rune from two given Runes by\\noverlaying the first with the second, each\\noccupying equal parts of the depth of the\\nresult\\n</div></div>","meta":"func"},"overlay_frac":{"title":"overlay_frac(frac, rune1, rune2) \u2192 {Rune}","description":"<div><h4>overlay_frac(frac, rune1, rune2) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a 3D-Rune from two given Runes by\\noverlaying the first with the second\\nsuch that the first one occupies frac \\nportion of the depth of the 3D result \\nand the second the rest\\n</div></div>","meta":"func"},"piano":{"title":"piano(note, duration) \u2192 {Sound}","description":"<div><h4>piano(note, duration) \u2192 {Sound}</h4><div class=\\"description\\">\\n    returns a Sound that is reminiscent of a piano, playing\\na given note for a given <code>duration</code> of seconds\\n</div></div>","meta":"func"},"pink":{"title":"pink(rune) \u2192 {Rune}","description":"<div><h4>pink(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    colors the given rune pink.\\n</div></div>","meta":"func"},"play":{"title":"play(sound) \u2192 {Sound}","description":"<div><h4>play(sound) \u2192 {Sound}</h4><div class=\\"description\\">\\n    plays a given Sound using your computer\'s sound device\\n</div></div>","meta":"func"},"play_anim_on_image":{"title":"play_anim_on_image(image, anims_key)","description":"<div><h4>play_anim_on_image(image, anims_key)</h4><div class=\\"description\\">\\n    Start playing the given animation on image game object.\\n</div></div>","meta":"func"},"play_concurrently":{"title":"play_concurrently(sound) \u2192 {undefined}","description":"<div><h4>play_concurrently(sound) \u2192 {undefined}</h4><div class=\\"description\\">\\n    plays a given sound without regard if a sound is already playing\\n</div></div>","meta":"func"},"play_sound":{"title":"play_sound(key, config)","description":"<div><h4>play_sound(key, config)</h4><div class=\\"description\\">\\n    Play the sound associated with the key.\\nThrows error if key is nonexistent.\\n</div></div>","meta":"func"},"purple":{"title":"purple(rune) \u2192 {Rune}","description":"<div><h4>purple(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    colors the given rune purple.\\n</div></div>","meta":"func"},"put_in_standard_position":{"title":"put_in_standard_position(curve) \u2192 {Curve}","description":"<div><h4>put_in_standard_position(curve) \u2192 {Curve}</h4><div class=\\"description\\">\\n    this function is a Curve transformation: It\\ntakes a Curve as argument and returns\\na new Curve, as follows.\\nA Curve is in <em>standard position</em> if it starts at (0,0) ends at (1,0).\\nThis function puts the given Curve in standard position by \\nrigidly translating it so its\\nstart Point is at the origin (0,0), then rotating it about the origin to put\\nits endpoint on the x axis, then scaling it to put the endpoint at (1,0).\\nBehavior is unspecified on closed Curves where start-point equal end-point.\\n</div></div>","meta":"func"},"quarter_turn_left":{"title":"quarter_turn_left(rune) \u2192 {Rune}","description":"<div><h4>quarter_turn_left(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a new Rune from a given Rune\\nby turning it a quarter-turn in\\nanti-clockwise direction.\\n</div></div>","meta":"func"},"quarter_turn_right":{"title":"quarter_turn_right(rune) \u2192 {Rune}","description":"<div><h4>quarter_turn_right(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a new Rune from a given Rune\\nby turning it a quarter-turn around the centre in\\nclockwise direction.\\n</div></div>","meta":"func"},"r_of":{"title":"r_of(p) \u2192 {Number}","description":"<div><h4>r_of(p) \u2192 {Number}</h4><div class=\\"description\\">\\n    retrieves the red component of a given Point\\n</div></div>","meta":"func"},"random_color":{"title":"random_color(rune) \u2192 {Rune}","description":"<div><h4>random_color(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    Gives random color to the given rune.\\nThe color is chosen randomly from the following nine \\ncolors: red, pink, purple, indigo, blue, green, yellow, orange, brown\\n</div></div>","meta":"func"},"record":{"title":"record(buffer) \u2192 {function}","description":"<div><h4>record(buffer) \u2192 {function}</h4><div class=\\"description\\">\\n    takes a <code>buffer</code> duration (in seconds) as argument, and\\nreturns a nullary stop function <code>stop</code>. A call\\n<code>stop()</code> returns a sound promise: a nullary function\\nthat returns a sound. Example: <pre><code>init_record();\\nconst stop = record(0.5);\\n// record after 0.5 seconds. Then in next query:\\nconst promise = stop();\\n// In next query, you can play the promised sound, by\\n// applying the promise:\\nplay(promise());</code></pre>\\n</div></div>","meta":"func"},"record_for":{"title":"record_for(duration, buffer) \u2192 {function}","description":"<div><h4>record_for(duration, buffer) \u2192 {function}</h4><div class=\\"description\\">\\n    Records a sound of given <code>duration</code> in seconds, after\\na <code>buffer</code> also in seconds, and\\nreturns a sound promise: a nullary function\\nthat returns a sound. Example: <pre><code>init_record();\\nconst promise = record_for(2, 0.5);\\n// In next query, you can play the promised sound, by\\n// applying the promise:\\nplay(promise());</code></pre>\\n</div></div>","meta":"func"},"red":{"title":"red(rune) \u2192 {Rune}","description":"<div><h4>red(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    colors the given rune red.\\n</div></div>","meta":"func"},"red_of":{"title":"red_of(px) \u2192 {Number}","description":"<div><h4>red_of(px) \u2192 {Number}</h4><div class=\\"description\\">\\n    Returns the red component of a given Pixel <code>px</code>\\n</div></div>","meta":"func"},"remove_listener":{"title":"remove_listener(listener)","description":"<div><h4>remove_listener(listener)</h4><div class=\\"description\\">\\n    Deactivate and remove listener.\\n</div></div>","meta":"func"},"repeat_pattern":{"title":"repeat_pattern(n, f, initial) \u2192 {t}","description":"<div><h4>repeat_pattern(n, f, initial) \u2192 {t}</h4><div class=\\"description\\">\\n    applies a given function n times to an initial value\\n</div></div>","meta":"func"},"reset_filter":{"title":"reset_filter() \u2192 {undefined}","description":"<div><h4>reset_filter() \u2192 {undefined}</h4><div class=\\"description\\">\\n    Resets the installed Filter back to the default Filter\\n</div></div>","meta":"func"},"rotate":{"title":"rotate(rad, rune) \u2192 {Rune}","description":"<div><h4>rotate(rad, rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    rotates a given Rune by a given angle,\\ngiven in radians, in anti-clockwise direction.\\nNote that parts of the Rune\\nmay be cropped as a result.\\n</div></div>","meta":"func"},"rotate_around_origin":{"title":"rotate_around_origin(a, b, c) \u2192 {unary_Curve_operator}","description":"<div><h4>rotate_around_origin(a, b, c) \u2192 {unary_Curve_operator}</h4><div class=\\"description\\">\\n    this function \\ntakes either 1 or 3 angles, a, b and c in radians as parameter and \\nreturns a Curve transformation: \\na function that takes a Curve as argument and returns\\na new Curve, which is the original Curve rotated by the given angle\\naround the z-axis (1 parameter) in counter-clockwise direction, or \\nthe original Curve rotated extrinsically with Euler angles (a, b, c) \\nabout x, y, and z axes (3 parameters).\\n</div></div>","meta":"func"},"sawtooth_sound":{"title":"sawtooth_sound(freq, duration) \u2192 {Sound}","description":"<div><h4>sawtooth_sound(freq, duration) \u2192 {Sound}</h4><div class=\\"description\\">\\n    makes a sawtooth wave Sound with given frequency and a given duration\\n</div></div>","meta":"func"},"scale":{"title":"scale(ratio, rune) \u2192 {Rune}","description":"<div><h4>scale(ratio, rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    scales a given Rune by a given factor in both x and y direction\\n</div></div>","meta":"func"},"scale_curve":{"title":"scale_curve(a, b, c) \u2192 {unary_Curve_operator}","description":"<div><h4>scale_curve(a, b, c) \u2192 {unary_Curve_operator}</h4><div class=\\"description\\">\\n    this function takes scaling factors <code>a</code>, <code>b</code> \\nand <code>c</code>, each with default value of 1, as arguments and \\nreturns a Curve transformation that \\nscales a given Curve by <code>a</code> in x-direction, <code>b</code> \\nin y-direction and <code>c</code> in z-direction.\\n</div></div>","meta":"func"},"scale_independent":{"title":"scale_independent(ratio_x, ratio_y, rune) \u2192 {Rune}","description":"<div><h4>scale_independent(ratio_x, ratio_y, rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    scales a given Rune by separate factors in x and y direction\\n</div></div>","meta":"func"},"scale_proportional":{"title":"scale_proportional(s) \u2192 {unary_Curve_operator}","description":"<div><h4>scale_proportional(s) \u2192 {unary_Curve_operator}</h4><div class=\\"description\\">\\n    this function takes a scaling factor s argument and returns a\\nCurve transformation that\\nscales a given Curve by s in x, y and z direction.\\n</div></div>","meta":"func"},"set_alpha":{"title":"set_alpha(obj, alpha) \u2192 {Phaser.GameObjects.GameObject}","description":"<div><h4>set_alpha(obj, alpha) \u2192 {Phaser.GameObjects.GameObject}</h4><div class=\\"description\\">\\n    Set the alpha of the object.\\nMutate the object.\\n</div></div>","meta":"func"},"set_display_size":{"title":"set_display_size(obj, x, y) \u2192 {Phaser.GameObjects.GameObject}","description":"<div><h4>set_display_size(obj, x, y) \u2192 {Phaser.GameObjects.GameObject}</h4><div class=\\"description\\">\\n    Set the display size of the object.\\nMutate the object.\\n</div></div>","meta":"func"},"set_flip":{"title":"set_flip(obj, x, y) \u2192 {Phaser.GameObjects.GameObject}","description":"<div><h4>set_flip(obj, x, y) \u2192 {Phaser.GameObjects.GameObject}</h4><div class=\\"description\\">\\n    Sets the horizontal and flipped state of the object.\\nMutate the object.\\n</div></div>","meta":"func"},"set_interactive":{"title":"set_interactive(obj, config) \u2192 {Phaser.GameObjects.GameObject}","description":"<div><h4>set_interactive(obj, config) \u2192 {Phaser.GameObjects.GameObject}</h4><div class=\\"description\\">\\n    Set the interactivity of the object.\\nMutate the object.\\n\\nRectangle and Ellipse are not able to receive configs, only boolean\\ni.e. set_interactive(rect, true); set_interactive(ellipse, false)\\n</div></div>","meta":"func"},"set_origin":{"title":"set_origin(obj, x, y) \u2192 {Phaser.GameObjects.GameObject}","description":"<div><h4>set_origin(obj, x, y) \u2192 {Phaser.GameObjects.GameObject}</h4><div class=\\"description\\">\\n    Set the origin in which all position related will be relative to.\\nIn other words, the anchor of the object.\\nMutate the object.\\n</div></div>","meta":"func"},"set_position":{"title":"set_position(obj, x, y) \u2192 {Phaser.GameObjects.Container}","description":"<div><h4>set_position(obj, x, y) \u2192 {Phaser.GameObjects.Container}</h4><div class=\\"description\\">\\n    Set the position of the game object\\nMutate the object\\n</div></div>","meta":"func"},"set_rgba":{"title":"set_rgba(px, r, g, b, a) \u2192 {undefined}","description":"<div><h4>set_rgba(px, r, g, b, a) \u2192 {undefined}</h4><div class=\\"description\\">\\n    Assigns the red, green, blue and alpha components of a Pixel \\n<code>px</code> to given values\\n</div></div>","meta":"func"},"set_rotation":{"title":"set_rotation(obj, rad) \u2192 {Phaser.GameObjects.GameObject}","description":"<div><h4>set_rotation(obj, rad) \u2192 {Phaser.GameObjects.GameObject}</h4><div class=\\"description\\">\\n    Set the rotation of the object.\\nMutate the object.\\n</div></div>","meta":"func"},"set_scale":{"title":"set_scale(obj, x, y) \u2192 {Phaser.GameObjects.GameObject}","description":"<div><h4>set_scale(obj, x, y) \u2192 {Phaser.GameObjects.GameObject}</h4><div class=\\"description\\">\\n    Set the scale of the object.\\nMutate the object.\\n</div></div>","meta":"func"},"show":{"title":"show(rune) \u2192 {Picture}","description":"<div><h4>show(rune) \u2192 {Picture}</h4><div class=\\"description\\">\\n    turns a given Rune into a two-dimensional Picture\\n</div></div>","meta":"func"},"silence_sound":{"title":"silence_sound(duration) \u2192 {Sound}","description":"<div><h4>silence_sound(duration) \u2192 {Sound}</h4><div class=\\"description\\">\\n    makes a silence Sound with a given duration\\n</div></div>","meta":"func"},"simultaneously":{"title":"simultaneously(sounds) \u2192 {Sound}","description":"<div><h4>simultaneously(sounds) \u2192 {Sound}</h4><div class=\\"description\\">\\n    makes a new sound by combining the sounds in a given\\nlist so that\\nthey play simutaneously, all starting at the beginning of the \\nresulting sound\\n</div></div>","meta":"func"},"sine_sound":{"title":"sine_sound(freq, duration) \u2192 {Sound}","description":"<div><h4>sine_sound(freq, duration) \u2192 {Sound}</h4><div class=\\"description\\">\\n    makes a sine wave Sound with given frequency and a given duration\\n</div></div>","meta":"func"},"square_sound":{"title":"square_sound(freq, duration) \u2192 {Sound}","description":"<div><h4>square_sound(freq, duration) \u2192 {Sound}</h4><div class=\\"description\\">\\n    makes a square wave Sound with given frequency and a given duration\\n</div></div>","meta":"func"},"stack":{"title":"stack(rune1, rune2) \u2192 {Rune}","description":"<div><h4>stack(rune1, rune2) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a new Rune from two given Runes by\\nplacing the first on top of the second, each\\noccupying equal parts of the height of the \\nresult\\n</div></div>","meta":"func"},"stack_frac":{"title":"stack_frac(frac, rune1, rune2) \u2192 {Rune}","description":"<div><h4>stack_frac(frac, rune1, rune2) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a new Rune from two given Runes by\\nplacing the first on top of the second\\nsuch that the first one occupies frac \\nportion of the height of the result and \\nthe second the rest\\n</div></div>","meta":"func"},"stacking_adsr":{"title":"stacking_adsr(waveform, base_frequency, duration, envelopes) \u2192 {Sound}","description":"<div><h4>stacking_adsr(waveform, base_frequency, duration, envelopes) \u2192 {Sound}</h4><div class=\\"description\\">\\n    Returns a Sound that results from applying a list of envelopes\\nto a given wave form. The wave form should be a Sound generator that\\ntakes a frequency and a duration as arguments and produces a\\nSound with the given frequency and duration. Each envelope is\\napplied to a harmonic: the first harmonic has the given frequency,\\nthe second has twice the frequency, the third three times the\\nfrequency etc.\\n</div></div>","meta":"func"},"stackn":{"title":"stackn(n, rune) \u2192 {Rune}","description":"<div><h4>stackn(n, rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a new Rune from a given Rune\\nby vertically stacking n copies of it\\n</div></div>","meta":"func"},"stop":{"title":"stop() \u2192 {undefined}","description":"<div><h4>stop() \u2192 {undefined}</h4><div class=\\"description\\">\\n    Stops playing the current sound\\n</div></div>","meta":"func"},"translate":{"title":"translate(x, y, rune) \u2192 {Rune}","description":"<div><h4>translate(x, y, rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    translates a given Rune by given values in x and y direction\\n</div></div>","meta":"func"},"translate_curve":{"title":"translate_curve(x0, y0, z0) \u2192 {function}","description":"<div><h4>translate_curve(x0, y0, z0) \u2192 {function}</h4><div class=\\"description\\">\\n    this function returns a Curve transformation: \\nIt takes an x-value x0, a y-value y0 and a z-value z0, \\neach with default value of 0, as arguments \\nand returns a Curve transformation that\\ntakes a Curve as argument and returns\\na new Curve, by translating the original by x0 in x-direction, \\ny0 in y-direction and z0 in z-direction.\\n</div></div>","meta":"func"},"triangle_sound":{"title":"triangle_sound(freq, duration) \u2192 {Sound}","description":"<div><h4>triangle_sound(freq, duration) \u2192 {Sound}</h4><div class=\\"description\\">\\n    makes a triangle wave Sound with given frequency and a given duration\\n</div></div>","meta":"func"},"trombone":{"title":"trombone(note, duration) \u2192 {Sound}","description":"<div><h4>trombone(note, duration) \u2192 {Sound}</h4><div class=\\"description\\">\\n    returns a Sound that is reminiscent of a trombone, playing\\na given note for a given <code>duration</code> of seconds\\n</div></div>","meta":"func"},"turn_upside_down":{"title":"turn_upside_down(rune) \u2192 {Rune}","description":"<div><h4>turn_upside_down(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    makes a new Rune from a given Rune\\nby turning it upside-down\\n</div></div>","meta":"func"},"unit_circle":{"title":"unit_circle(t) \u2192 {Point}","description":"<div><h4>unit_circle(t) \u2192 {Point}</h4><div class=\\"description\\">\\n    this function is a curve: a function from a\\nfraction t to a point. The points lie on the\\nunit circle. They start at Point (1,0) when\\nt is 0. When t is 0.25, they reach Point (0,1),\\nwhen t is 0.5, they reach Point (-1, 0), etc.\\n</div></div>","meta":"func"},"unit_line":{"title":"unit_line(t) \u2192 {Point}","description":"<div><h4>unit_line(t) \u2192 {Point}</h4><div class=\\"description\\">\\n    this function is a curve: a function from a\\nfraction t to a point. The x-coordinate at\\nfranction t is t, and the y-coordinate is 0.\\n</div></div>","meta":"func"},"unit_line_at":{"title":"unit_line_at(t) \u2192 {Curve}","description":"<div><h4>unit_line_at(t) \u2192 {Curve}</h4><div class=\\"description\\">\\n    this function is a Curve generator: it takes\\na number and returns a horizontal curve. The number\\nis a y-coordinate, and the Curve generates\\nonly points with the given y-coordinate.\\n</div></div>","meta":"func"},"video_height":{"title":"video_height() \u2192 {Number}","description":"<div><h4>video_height() \u2192 {Number}</h4><div class=\\"description\\">\\n    Returns the current height of the output video display in\\npixels, i.e. the number of pixels in vertical direction\\n</div></div>","meta":"func"},"video_width":{"title":"video_width() \u2192 {Number}","description":"<div><h4>video_width() \u2192 {Number}</h4><div class=\\"description\\">\\n    Returns the current width of the output video display in\\npixels, i.e. the number of pixels in horizontal direction\\n</div></div>","meta":"func"},"violin":{"title":"violin(note, duration) \u2192 {Sound}","description":"<div><h4>violin(note, duration) \u2192 {Sound}</h4><div class=\\"description\\">\\n    returns a Sound that is reminiscent of a violin, playing\\na given note for a given <code>duration</code> of seconds\\n</div></div>","meta":"func"},"white":{"title":"white(rune) \u2192 {Rune}","description":"<div><h4>white(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    colors the given rune white.\\n</div></div>","meta":"func"},"x_of":{"title":"x_of(p) \u2192 {Number}","description":"<div><h4>x_of(p) \u2192 {Number}</h4><div class=\\"description\\">\\n    retrieves the x-coordinate of a given Point\\n</div></div>","meta":"func"},"y_of":{"title":"y_of(p) \u2192 {Number}","description":"<div><h4>y_of(p) \u2192 {Number}</h4><div class=\\"description\\">\\n    retrieves the y-coordinate of a given Point\\n</div></div>","meta":"func"},"yellow":{"title":"yellow(rune) \u2192 {Rune}","description":"<div><h4>yellow(rune) \u2192 {Rune}</h4><div class=\\"description\\">\\n    colors the given rune yellow.\\n</div></div>","meta":"func"},"z_of":{"title":"z_of(p) \u2192 {Number}","description":"<div><h4>z_of(p) \u2192 {Number}</h4><div class=\\"description\\">\\n    retrieves the z-coordinate of a given Point\\n</div></div>","meta":"func"}}')},564:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(565),t),i(n(372),t)},565:function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,a){function r(e){try{c(s.next(e))}catch(t){a(t)}}function o(e){try{c(s.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sourceFilesRunner=t.sourceRunner=void 0;const i=n(136),a=n(277),r=(n(566),n(221)),o=(n(577),n(27)),c=n(372),l={scheduler:"async",steps:1e3,stepLimit:1e3,executionMethod:"auto",variant:o.Variant.DEFAULT,originalMaxExecTime:1e3,useSubst:!1,isPrelude:!1,throwInfiniteLoops:!0};function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(this,void 0,void 0,(function*(){Object.assign(Object.assign({},l),n);t.variant=(0,c.determineVariant)(t,n),t.errors=[];const s=(0,r.parse)(e,t);if(!s)return c.resolvedErrorPromise;try{return Promise.resolve({status:"finished",value:s.execute(),context:t})}catch(a){return t.errors.push(new i.CRuntimeError(a)),c.resolvedErrorPromise}}))}t.sourceRunner=d,t.sourceFilesRunner=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return s(this,void 0,void 0,(function*(){const s=e[t];return void 0===s?(n.errors.push(new a.CannotFindModuleError(t)),c.resolvedErrorPromise):(n.variant=(0,c.determineVariant)(n,i),d(s,n,i))}))}},566:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evaluate=t.evaluators=t.pushEnvironment=t.actualValue=void 0;const s=n(332),i=n(334);function*a(e,n){if(e instanceof class{constructor(e,t){this.exp=e,this.env=t,this.isMemoized=!1,this.value=null}}){if(e.isMemoized)return e.value;(0,t.pushEnvironment)(n,e.env);const s=yield*r(e.exp,n);return c(n),e.value=s,e.isMemoized=!0,s}return e}function*r(e,t){const n=yield*l(e,t);return yield*a(n,t)}t.actualValue=r;const o=(e,t)=>{throw e.errors.push(t),e.runtime.environments=e.runtime.environments.slice(-e.numberOfOuterEnvironments),t};const c=e=>e.runtime.environments.shift();function*l(e,n){const s=yield*t.evaluators[e.type](e,n);return yield*function*(e){e.runtime.break=!1,e.runtime.nodes.shift(),yield e}(n),s}t.pushEnvironment=(e,t)=>{e.runtime.environments.unshift(t),e.runtime.environmentTree.insert(t)},t.evaluators={Literal:function*(e,t){return e.value},TemplateLiteral:function*(e){return e.quasis[0].value.cooked},ThisExpression:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},ArrayExpression:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},FunctionExpression:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},ArrowFunctionExpression:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},Identifier:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},CallExpression:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},NewExpression:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},UnaryExpression:function*(e,t){const n=yield*r(e.argument,t),a=i.checkUnaryExpression(e,e.operator,n);return a?o(t,a):(0,s.evaluateUnaryExpression)(e.operator,n)},BinaryExpression:function*(e,t){const n=yield*r(e.left,t),a=yield*r(e.right,t),c=i.checkBinaryExpression(e,e.operator,n,a);return c?o(t,c):(0,s.evaluateBinaryExpression)(e.operator,n,a)},ConditionalExpression:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},LogicalExpression:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},VariableDeclaration:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},ContinueStatement:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},BreakStatement:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},ForStatement:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},AssignmentExpression:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},FunctionDeclaration:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},IfStatement:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},ExpressionStatement:function*(e,t){return yield*l(e.expression,t)},ReturnStatement:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},WhileStatement:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},BlockStatement:function*(e,t){throw new Error(`not supported yet: ${e.type}`)},Program:function*(e,t){const n=yield*a(yield*function*(e,t){let n;for(const s of t.body)n=yield*l(s,e);return n}(t,e),t);return n}},t.evaluate=l},567:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Program=void 0;const s=n(211),i=n(279),a=n(282);class r{constructor(e){this.declarations=e}static parse(e){const t=[],n=s.Frame.extend(s.Frame.getBuiltinFrame());for(i.FunctionCall.clearCalledFunctions();e.hasNext();)a.Declaration.parse(n,e,!1,!1,null,!0).forEach((e=>t.push(e)));try{n.lookupFunction("main")}catch(o){throw new Error("entry of execution 'main' function not found, "+(o instanceof Error?o.message:String(o)))}return i.FunctionCall.checkCalledFunctionDefinition(n),new r(t)}execute(){console.log("=".repeat(20)+"start executing"+"=".repeat(20));const e={stdout:"",baseFrame:s.Frame.extend(s.Frame.getBuiltinFrame()),currentLine:0};try{return this.declarations.forEach((t=>t.execute(e.baseFrame,e))),e.baseFrame.lookupFunction("main").call(e.baseFrame,e,[]),e.stdout}catch(t){throw console.log("stdout:",e.stdout),new Error("Line "+String(e.currentLine)+": execution failed, "+(t instanceof Error?t.message:String(t)))}finally{console.log("=".repeat(20)+"executing finished"+"=".repeat(20))}}}t.Program=r},568:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BuiltinFunction=void 0;const s=n(126),i=n(117),a=n(280);class r extends a.Function{constructor(e,t,n,s){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];super(e,t),this.parameterTypes=n,this.realFunction=s,this.isAddress=i,this.isFormatString=a}call(e,t,n){return this.realFunction(e,t,n)}isDefined(){return!0}parseFormatStringParameters(e,t,n){let a=s.PLACEHOLDER_REGEX.exec(n);const r=[];for(;null!=a;){let o;this.checkTooFewArguments(t),t.eatDelimiter(",");if("%d"==a[0]||"%ld"==a[0])o=s.PrimitiveType.INT;else if("%f"==a[0]||"%lf"==a[0])o=s.PrimitiveType.FLOAT;else if("%c"==a[0])o=s.PrimitiveType.CHAR;else if("%s"==a[0])o=new s.PointerType(s.PrimitiveType.CHAR);else{if("%p"!=a[0])throw new Error("impossible execution path");o=new s.PointerType(s.PrimitiveType.VOID)}!this.isAddress||null==o||o instanceof s.PointerType||(o=new s.PointerType(o)),r.push(i.ExpressionParser.parse(e,t,!1,!1,o)),n=n.replace(a[0],"0"),a=s.PLACEHOLDER_REGEX.exec(n)}return r}parseActualParameters(e,t){const n=[];if(t.eatDelimiter("("),this.parameterTypes.forEach(((s,a)=>{this.checkTooFewArguments(t),0!=a&&t.eatDelimiter(","),n.push(i.ExpressionParser.parse(e,t,!1,!1,s))})),!this.isFormatString)return t.eatDelimiter(")"),n;if(!n[0].isImmediateString())throw new Error("TODO: is not immediateString");return this.parseFormatStringParameters(e,t,n[0].toImmediateString()).forEach((e=>n.push(e))),t.eatDelimiter(")"),n}toString(){let e=this.returnType.toString()+" "+this.functionName+"(";if(this.isFormatString)e+="char*, ...any";else if(this.parameterTypes.length>0){e+=this.parameterTypes[0].toString();for(let t=1;t<this.parameterTypes.length;t++)e+=", "+this.parameterTypes[t].toString()}return e+")"}}t.BuiltinFunction=r},569:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Expression=t.IncrementDecrement=t.Jump=void 0;const s=n(126),i=n(117),a=n(279),r=n(161);class o{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.condition=e,this.toPosition=t}}t.Jump=o,function(e){e.PRE_INCREMENT="$PRE_INCREMENT",e.POST_INCREMENT="$POST_INCREMENT",e.PRE_DECREMENT="$PRE_DECREMENT",e.POST_DECREMENT="$POST_DECREMENT"}(t.IncrementDecrement||(t.IncrementDecrement={}));class c{constructor(e,t){this.elements=e,this.type=t}getType(){return this.type}isImmediateString(){return"char*"==this.type.toString()&&1==this.elements.length}toImmediateString(){if(!this.isImmediateString())throw new Error("cannot get immediate string literal");return this.elements[0]}static toNumberLiteral(e,t){if(void 0==e)throw new Error("undefined operand");return e}evaluate(e,t){const n=[];let l=0;for(;l<this.elements.length;){const d=this.elements[l];if(d instanceof o){const t=d;if(void 0==t.condition||t.condition==c.toNumberLiteral(n[n.length-1],e).toBoolean()){void 0!=t.condition&&(n[n.length-1]=r.NumericLiteral.booleanToNumericLiteral(c.toNumberLiteral(n[n.length-1],e).toBoolean())),l=t.toPosition;continue}}else if(d instanceof a.FunctionCall){const i=d.execute(e,t);d.getReturnType()!=s.PrimitiveType.VOID&&n.push(i)}else if(d instanceof r.NumericLiteral)n.push(d);else if(d instanceof s.PointerType||s.PRIMITIVE_TYPES.includes(d))n.push(c.toNumberLiteral(n.pop(),e).castToType(d));else if(d.startsWith('"'))n.push(e.allocateStringLiteral(d));else if("&"==d)n.push(c.toNumberLiteral(n.pop(),e).toAddress());else if(d==i.DEREFERENCE_TAG)n.push(e.dereference(c.toNumberLiteral(n.pop(),e)));else if(d in c.INCREMENT_DECREMENT_OPERATORS)n.push(c.INCREMENT_DECREMENT_OPERATORS[d](n.pop(),e));else if(r.NumericLiteral.BINARY_ARITHMETIC_OPERATORS.has(d)){const t=r.NumericLiteral.BINARY_ARITHMETIC_OPERATORS.get(d);if(!t)throw new Error("impossible execution path");n.push(t(c.toNumberLiteral(n.pop(),e),c.toNumberLiteral(n.pop(),e)))}else if(r.NumericLiteral.UNARY_ARITHMETIC_OPERATORS.has(d)){const t=r.NumericLiteral.UNARY_ARITHMETIC_OPERATORS.get(d);if(!t)throw new Error("impossible execution path");n.push(t(c.toNumberLiteral(n.pop(),e)))}else if(c.ASSIGNMENT_OPERATORS.has(d)){const t=n.pop();n.push(c.toNumberLiteral(n.pop(),e).assign(e,c.toNumberLiteral(t,e),d))}else n.push(e.lookupNumber(d));l++}return n.pop()}}t.Expression=c,c.INCREMENT_DECREMENT_OPERATORS={$PRE_INCREMENT:(e,t)=>e.increment(t,!0),$POST_INCREMENT:(e,t)=>e.increment(t,!1),$PRE_DECREMENT:(e,t)=>e.decrement(t,!0),$POST_DECREMENT:(e,t)=>e.decrement(t,!1)},c.ASSIGNMENT_OPERATORS=new Set(["=","+=","-=","*=","/=","%="])},570:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConditionalStatement=void 0;const s=n(174),i=n(117),a=n(151);class r extends a.Statement{constructor(e,t){super(),this.ifBlocks=e,this.elseBlock=t}static parse(e,t,n,a,o){const c=[];let l,d=!0;for(;;){t.eatKeyword("if"),t.eatDelimiter("(");const r=i.ExpressionParser.parse(e,t,!1,!1,null);t.eatDelimiter(")");const l=s.Block.parse(e,t,n,a,o);if(c.push([r,l]),!t.matchKeyword("else")){d=!1;break}if(t.eatKeyword("else"),!t.matchKeyword("if"))break}return d&&(l=s.Block.parse(e,t,n,a,o)),[new r(c,l)]}doExecute(e,t){var n;let s=!1;for(const[i,a]of this.ifBlocks)if(i.evaluate(e,t).toBoolean()){a.execute(e,t),s=!0;break}s||null===(n=this.elseBlock)||void 0===n||n.execute(e,t)}}t.ConditionalStatement=r},571:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DoWhile=void 0;const s=n(174),i=n(117),a=n(283),r=n(175);class o extends a.LoopStatement{constructor(e,t){super(),this.body=e,this.condition=t}static parse(e,t,n,a,r){t.eatKeyword("do");const c=s.Block.parse(e,t,!0,!0,r);t.eatKeyword("while"),t.eatDelimiter("(");const l=i.ExpressionParser.parse(e,t,!1,!1,null);return t.eatDelimiter(")"),t.eatDelimiter(";"),[new o(c,l)]}doExecute(e,t){this.resetLoopCounter();do{this.incrementLoopCounter(t);try{this.body.execute(e,t)}catch(n){if(n instanceof r.Break)break;if(n instanceof r.Continue)continue;throw n}}while(this.condition.evaluate(e,t).toBoolean())}}t.DoWhile=o},572:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.For=void 0;const s=n(211),i=n(174),a=n(117),r=n(282),o=n(371),c=n(283),l=n(175);class d extends c.LoopStatement{constructor(e,t,n,s){super(),this.init=e,this.condition=t,this.updation=n,this.body=s}static parse(e,t,n,c,l){const u=new d([],null,null,new i.Block([]));t.eatKeyword("for"),t.eatDelimiter("(");const h=s.Frame.extend(e);return t.matchDelimiter(";")?t.eatDelimiter(";"):t.matchDataType()?r.Declaration.parse(h,t,!1,!1,l,!1).forEach((e=>u.init.push(e))):o.ExpressionStatement.parse(h,t).forEach((e=>u.init.push(e))),t.matchDelimiter(";")||(u.condition=a.ExpressionParser.parse(h,t,!1,!1,null)),t.eatDelimiter(";"),t.matchDelimiter(")")||(u.updation=new o.ExpressionStatement(a.ExpressionParser.parse(h,t,!0,!1,null))),t.eatDelimiter(")"),u.body=i.Block.parse(h,t,!0,!0,l),[u]}doExecute(e,t){var n;const i=s.Frame.extend(e);for(this.init.forEach((e=>e.execute(i,t))),this.resetLoopCounter();void 0==this.condition||this.condition.evaluate(i,t).toBoolean();){this.incrementLoopCounter(t);try{this.body.execute(i,t)}catch(a){if(a instanceof l.Break)break;if(!(a instanceof l.Continue))throw a}null===(n=this.updation)||void 0===n||n.execute(i,t)}}}t.For=d},573:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Switch=void 0;const s=n(174),i=n(117),a=n(175),r=n(151);class o{constructor(e){this.expression=e}static parse(e,t){t.eatKeyword("case");const n=i.ExpressionParser.parse(e,t,!1,!0,null);return t.eatDelimiter(":"),new o(n)}evaluate(e,t){return this.expression.evaluate(e,t)}}class c extends r.Statement{constructor(e,t,n){super(),this.expression=e,this.body=t,this.defaultExecutables=n}static parse(e,t,n,a,l){t.eatKeyword("switch"),t.eatDelimiter("(");const d=i.ExpressionParser.parse(e,t,!1,!1,null);t.eatDelimiter(")"),t.eatDelimiter("{");const u=[];let h=!1;const p=[];for(;!t.matchDelimiter("}");){if(t.matchKeyword("default")){if(h)throw new Error(t.formatError("multiple default labels in one switch"));t.eatKeyword("default"),t.eatDelimiter(":"),h=!0}for(;t.matchKeyword("case");)u.push(o.parse(e,t));if(t.matchDelimiter("{")){const n=s.Block.parse(e,t,!0,!1,l);u.push(n),h&&p.push(n)}else{if(t.matchDataType())throw new Error(t.formatError("expected an expression"));r.Statement.parse(e,t,!0,!1,l).forEach((e=>{u.push(e),h&&p.push(e)}))}}return t.eatDelimiter("}"),[new c(d,u,p)]}doExecute(e,t){const n=this.expression.evaluate(e,t).getValue();let s=!1;for(let r=0;r<this.body.length;r++)try{if(!s&&this.body[r]instanceof o){s=n==this.body[r].evaluate(e,t).getValue()}else!s||this.body[r]instanceof o||this.body[r].execute(e,t)}catch(i){if(i instanceof a.Break)return;throw i}s||this.defaultExecutables.forEach((n=>n.execute(e,t)))}}t.Switch=c},574:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.While=void 0;const s=n(174),i=n(117),a=n(283),r=n(175);class o extends a.LoopStatement{constructor(e,t){super(),this.expression=e,this.body=t}static parse(e,t,n,a,r){t.eatKeyword("while"),t.eatDelimiter("(");const c=i.ExpressionParser.parse(e,t,!1,!1,null);t.eatDelimiter(")");const l=s.Block.parse(e,t,!0,!0,r);return[new o(c,l)]}doExecute(e,t){for(this.resetLoopCounter();this.expression.evaluate(e,t).toBoolean();){this.incrementLoopCounter(t);try{this.body.execute(e,t)}catch(n){if(n instanceof r.Break)break;if(n instanceof r.Continue)continue;throw n}}}}t.While=o},575:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Memory=void 0;const s=n(161),i=n(126);class a{constructor(){this.buffer=new ArrayBuffer(a.DEFAULT_READONLY_MEMORY_SIZE+a.DEFAULT_HEAP_SIZE+a.DEFAULT_STACK_SIZE),this.view=new DataView(this.buffer),this.allocatedAddresses=new Set,this.stringLiteralToAddress=new Map,this.readonlyTop=0,this.stackBottom=a.DEFAULT_READONLY_MEMORY_SIZE+a.DEFAULT_HEAP_SIZE,this.heapBottom=a.DEFAULT_READONLY_MEMORY_SIZE,this.setTag(this.heapBottom,this.heapBottom,!0,a.DEFAULT_HEAP_SIZE)}getStackBottom(){return this.stackBottom}assertValidAddress(e,t){if(e<0||e>=this.view.byteLength)throw new Error((t?"read from":"write to")+" invalid address: "+String(e));if(!t){if(e<this.heapBottom)throw new Error("attempt to write to readonly memory");if(e<this.stackBottom){const t=e>>2<<2;if(t==this.heapBottom||t==this.heapBottom+4)throw new Error("attemt to write to illegal address");this.allocatedAddresses.forEach((e=>{const n=e-a.TAG_LENGTH,s=n+this.getLength(n);if(n==t||n+4==t||s==t||s+4==t)throw new Error("attemt to write to illegal address")}))}}}readInt(e){return this.assertValidAddress(e,!0),s.NumericLiteral.new(this.view.getInt32(e),e).castToType(i.PrimitiveType.INT,!0)}readPointer(e,t){return this.assertValidAddress(e,!0),s.NumericLiteral.new(this.view.getInt32(e),e).castToType(t,!0)}writeNumeric(e,t){if(this.assertValidAddress(e,!1),t.getDataType()instanceof i.PointerType)this.view.setInt32(e,t.getValue());else if(t.getDataType()==i.PrimitiveType.INT)this.view.setInt32(e,t.getValue());else if(t.getDataType()==i.PrimitiveType.FLOAT)this.view.setFloat32(e,t.getValue());else{if(t.getDataType()!=i.PrimitiveType.CHAR)throw new Error("attempt to write datatype '"+t.getDataType()+"' as numeric type");this.view.setUint8(e,t.getValue())}return e+4}readFloat(e){return this.assertValidAddress(e,!0),s.NumericLiteral.new(this.view.getFloat32(e),e).castToType(i.PrimitiveType.FLOAT,!0)}readChar(e){return this.assertValidAddress(e,!0),s.NumericLiteral.new(this.view.getUint8(e),e).castToType(i.PrimitiveType.CHAR,!0)}allocateStringLiteral(e){const t=this.stringLiteralToAddress.get(e);if(void 0!=t)return t;const n=this.readonlyTop+e.length-2,s=this.readonlyTop;if(n>=this.heapBottom)throw new Error("insufficient memory to allocate string literal "+e);for(let i=1;i<e.length-1;i++)this.view.setUint8(s+i-1,e.charCodeAt(i));return this.view.setUint8(n,0),this.readonlyTop=n+1,this.stringLiteralToAddress.set(e,s),s}readStringLiteral(e){this.assertValidAddress(e,!0);let t=e,n="";for(;t<this.view.byteLength;){const e=this.view.getUint8(t);if(0==e)break;n+=String.fromCharCode(e),t++}return n}setTag(e,t,n,s){this.setPrev(e,t),this.setIsFree(e,n),this.setLength(e,s)}setPrev(e,t){this.view.setUint32(e,t)}getPrev(e){return this.view.getUint32(e)}setIsFree(e,t){const n=this.view.getUint32(e+a.FREE_LENGTH_OFFSET),s=t?n&Math.pow(2,31)-1:n|Math.pow(2,31);this.view.setUint32(e+a.FREE_LENGTH_OFFSET,s)}isFree(e){return 0==(this.view.getUint32(e+a.FREE_LENGTH_OFFSET)&Math.pow(2,31))}setLength(e,t){const n=this.isFree(e)?0:1;this.view.setUint32(e+a.FREE_LENGTH_OFFSET,t|n<<31)}getLength(e){return this.view.getUint32(e+a.FREE_LENGTH_OFFSET)&Math.pow(2,31)-1}free(e){if(!this.allocatedAddresses.has(e))throw new Error("pointer being freed was not allocated, at address "+String(e));this.allocatedAddresses.delete(e);const t=e-a.TAG_LENGTH,n=this.getPrev(t);let s=t;n!=t&&this.isFree(n)?(this.setLength(n,this.getLength(n)+this.getLength(t)),s=n):this.setIsFree(t,!0);const i=s+this.getLength(s);let r=i;i<this.stackBottom&&this.isFree(i)&&(r=i+this.getLength(i),this.setLength(s,this.getLength(s)+this.getLength(i))),r<this.stackBottom&&this.setPrev(r,s)}allocate(e){if(e<=0)throw new Error("allocated memory size must be > 0, but got "+String(e));let t=4*Math.ceil(e/4),n=this.heapBottom;for(;n<this.stackBottom&&!(this.isFree(n)&&this.getLength(n)-a.TAG_LENGTH>=t);)n+=this.getLength(n);if(n>=this.stackBottom)throw new Error("heap out of memory");const r=this.getLength(n);return r-a.TAG_LENGTH>t+a.TAG_LENGTH?(this.setIsFree(n,!1),this.setLength(n,t+a.TAG_LENGTH),this.setTag(n+this.getLength(n),n,!0,r-this.getLength(n)),n+r<this.stackBottom&&this.setPrev(n+r,n+this.getLength(n))):(t=this.getLength(n)-a.TAG_LENGTH,this.setIsFree(n,!1)),this.allocatedAddresses.add(n+a.TAG_LENGTH),s.NumericLiteral.new(n+a.TAG_LENGTH).castToType(new i.PointerType(i.PrimitiveType.VOID))}printHeap(e){let t=this.heapBottom;for(e.stdout+="\n"+"=".repeat(15)+"Heap Visualization"+"=".repeat(15)+"\n";t<this.stackBottom;)e.stdout+=String(t)+": isfree="+String(this.isFree(t))+"; length="+String(this.getLength(t))+"; prev="+String(this.getPrev(t))+"\n",t+=this.getLength(t);e.stdout+="=".repeat(21)+"ENDING"+"=".repeat(21)+"\n"}}t.Memory=a,a.DEFAULT_READONLY_MEMORY_SIZE=Math.pow(2,10),a.DEFAULT_HEAP_SIZE=Math.pow(2,18),a.DEFAULT_STACK_SIZE=Math.pow(2,18),a.FREE_LENGTH_OFFSET=4,a.TAG_LENGTH=8},576:function(e,t,n){"use strict";function s(e,t){return"string"===typeof e?e:t.reduce(((t,n,s)=>t+n+e[s+1]),e[0])}Object.defineProperty(t,"__esModule",{value:!0}),t.simplify=t.stripIndent=t.oneLine=void 0,t.oneLine=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return s(e,n).replace(/(?:\n(?:\s*))+/g," ").trim()},t.stripIndent=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const a=s(e,n),r=a.match(/^[^\S\n]*(?=\S)/gm),o=r&&Math.min(...r.map((e=>e.length)));return o?a.replace(new RegExp(`^.{${o}}`,"gm"),"").trim():a.trim()},t.simplify=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"...";if(e.length<t)return e;const s=Math.ceil(t-n.length/2);return e.slice(0,s)+" ... "+e.slice(s)}},577:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreemptiveScheduler=void 0;const s=n(136);t.PreemptiveScheduler=class{constructor(e){this.steps=e}run(e,t){return new Promise(((n,i)=>{t.runtime.isRunning=!0;let a=!1,r=e.next();const o=setInterval((()=>{let i=0;try{for(;!r.done&&i<this.steps;)i++,r=e.next(),a=t.runtime.break&&t.runtime.debuggerOn,a&&(r.done=!0)}catch(c){!function(e,t){if(/Maximum call stack/.test(e.toString())){const e=t.runtime.environments,n=[];let i=0;for(let t=0;i<s.MaximumStackLimitExceeded.MAX_CALLS_TO_SHOW&&t<e.length;t++)e[t].callExpression&&(n.unshift(e[t].callExpression),i++);t.errors.push(new s.MaximumStackLimitExceeded(t.runtime.nodes[0],n))}}(c,t),t.runtime.isRunning=!1,clearInterval(o),n({status:"error"})}r.done&&(t.runtime.isRunning=!1,clearInterval(o),n(a?{status:"suspended",it:e,scheduler:this,context:t}:{status:"finished",context:t,value:r.value}))}))}))}}},58:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"j",(function(){return c})),n.d(t,"k",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return p})),n.d(t,"l",(function(){return g}));const s="BEGIN_INTERRUPT_EXECUTION",i="END_INTERRUPT_EXECUTION",a="EVAL_INTERPRETER_ERROR",r="EVAL_INTERPRETER_SUCCESS",o="EVAL_TESTCASE_FAILURE",c="EVAL_TESTCASE_SUCCESS",l="HANDLE_CONSOLE_LOG",d="BEGIN_DEBUG_PAUSE",u="END_DEBUG_PAUSE",h="DEBUG_RESUME",p="DEBUG_RESET",g="HIGHLIGHT_LINE"},627:function(e,t){},629:function(e,t){},654:function(e,t){},656:function(e,t){},67:function(e,t,n){"use strict";n.r(t),n.d(t,"handleConsoleLog",(function(){return a})),n.d(t,"evalInterpreterSuccess",(function(){return r})),n.d(t,"evalTestcaseSuccess",(function(){return o})),n.d(t,"evalTestcaseFailure",(function(){return c})),n.d(t,"evalInterpreterError",(function(){return l})),n.d(t,"beginInterruptExecution",(function(){return d})),n.d(t,"endInterruptExecution",(function(){return u})),n.d(t,"beginDebuggerPause",(function(){return h})),n.d(t,"endDebuggerPause",(function(){return p})),n.d(t,"debuggerResume",(function(){return g})),n.d(t,"debuggerReset",(function(){return m}));var s=n(7),i=n(58);const a=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return Object(s.action)(i.k,{logString:n,workspaceLocation:e})},r=(e,t)=>Object(s.action)(i.h,{type:"result",value:e,workspaceLocation:t}),o=(e,t,n)=>Object(s.action)(i.j,{type:"result",value:e,workspaceLocation:t,index:n}),c=(e,t,n)=>Object(s.action)(i.i,{type:"errors",value:e,workspaceLocation:t,index:n}),l=(e,t)=>Object(s.action)(i.g,{type:"errors",errors:e,workspaceLocation:t}),d=e=>Object(s.action)(i.b,{workspaceLocation:e}),u=e=>Object(s.action)(i.f,{workspaceLocation:e}),h=e=>Object(s.action)(i.a,{workspaceLocation:e}),p=e=>Object(s.action)(i.e,{workspaceLocation:e}),g=e=>Object(s.action)(i.d,{workspaceLocation:e}),m=e=>Object(s.action)(i.c,{workspaceLocation:e})},676:function(e,t){},68:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return y}));var s=n(98),i=n(1),a=n(52),r=n(41),o=n(3),c=n(19),l=n.n(c),d=n(0);function u(e){const t=e.choices.map(((t,n)=>Object(d.jsx)(r.b,{onClick:()=>e.onResponse&&e.onResponse(t.key),intent:t.intent,fill:e.largeButtons,className:l()(e.largeButtons&&"large-button"),...t.props,children:t.label},n))),{escapeResponse:n}=e,s="undefined"===typeof n?void 0:()=>e.onResponse&&e.onResponse(n);return Object(d.jsxs)(r.h,{className:l()(o.a.DARK,"ConfirmDialog"),title:e.title,isCloseButtonShown:"undefined"===typeof e.title&&void 0,canEscapeKeyClose:!!s,onClose:s,isOpen:e.isOpen,icon:e.icon,...e.props,children:[Object(d.jsx)("div",{className:o.a.DIALOG_BODY,children:e.contents}),Object(d.jsxs)("div",{className:o.a.DIALOG_FOOTER,children:[e.largeButtons&&t,!e.largeButtons&&Object(d.jsx)("div",{className:o.a.DIALOG_FOOTER_ACTIONS,children:t})]})]})}function h(e){const{enterResponse:t,validationFunction:n}=e,a=i.useRef(null),[o,c]=i.useState(!n||n(e.defaultValue||""));i.useEffect((()=>{a.current&&c(!n||n(a.current.value))}),[n]);const l=t=>{var s;t!==e.escapeResponse&&n&&!n(a.current.value)||e.onResponse(t,(null===(s=a.current)||void 0===s?void 0:s.value)||"")},h=e.choices.map((e=>({...e,props:{...e.props,disabled:e.disableOnInvalid&&!o}}))),p=t?e=>{13===e.keyCode&&l(t)}:void 0,g=n?e=>{n(e.target.value)!==o&&c(!o)}:void 0;return Object(d.jsx)(u,{...e,onResponse:l,choices:h,contents:Object(d.jsxs)(d.Fragment,{children:[e.contents,Object(d.jsx)(r.y,{autoFocus:!0,defaultValue:e.defaultValue,inputRef:a,onKeyDown:p,onChange:g,intent:o?s.a.NONE:s.a.DANGER})]})})}class p extends i.PureComponent{constructor(){super(...arguments),this.state={dialog:null,dialogOnClose:null}}static create(){const e=document.createElement("div");document.body.appendChild(e);const t=a.render(Object(d.jsx)(p,{}),e);if(null==t)throw new Error("Could not create DialogHelper - are you in a React lifecycle method?");return t}show(e,t){this.setState((()=>({dialog:e,dialogOnClose:t||null})))}close(){this.state.dialogOnClose&&this.state.dialogOnClose(),this.setState((()=>({dialog:null,dialogOnClose:null})))}render(){return this.state.dialog}}const g=p.create();function m(){g.close()}function b(e,t){return new Promise(((n,s)=>{var i,a;i=Object(d.jsx)(e,{...t(n)}),a=s,g.show(i,a)})).finally(m)}function f(e){return b(u,(t=>({...e,onResponse:t,isOpen:!0})))}function v(e){return f({title:e.title,contents:e.contents,choices:[{key:!1,label:e.negativeLabel||"No"},{key:!0,label:e.positiveLabel||"Yes",intent:e.positiveIntent||s.a.SUCCESS,props:{type:"submit"}}],escapeResponse:!1,icon:e.icon,...e.props})}function y(e){return b(h,(t=>({title:e.title,contents:e.contents,choices:[{key:!1,label:e.negativeLabel||"Cancel"},{key:!0,label:e.positiveLabel||"Accept",intent:s.a.SUCCESS,disableOnInvalid:!0}],escapeResponse:!1,enterResponse:!0,onResponse:(e,n)=>t({buttonResponse:e,value:n}),isOpen:!0,...e.props})))}},69:function(e,t,n){"use strict";let s;n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return a})),function(e){e.NONE="NONE",e.SOUNDS="SOUNDS",e.EV3="EV3"}(s||(s={}));const i=[[s.NONE,[]],[s.SOUNDS,[]]],a=new Map(i)},70:function(e,t,n){"use strict";(function(e){n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"j",(function(){return m})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return f}));var s=n(8),i=n(68),a=n(10),r=n(85),o=n(0);async function c(e,t){return await fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:t})}function l(){const e=r.a.getState().session.githubOctokitObject;return void 0===e?void 0:e.octokit}async function d(e,t,n,s){if(void 0===e)return Object(a.e)("Please log in and try again",2e3),!1;if(""===s)return Object(a.e)("Please select a file!",2e3),!1;let i;try{i=(await e.repos.getContent({owner:t,repo:n,path:s})).data}catch(r){return Object(a.e)("Connection denied or file does not exist.",2e3),console.error(r),!1}return!Array.isArray(i)||(Object(a.e)("Can't open folder as a file!",2e3),!1)}async function u(e,t,n,s){let i,r="";if(""===s)return Object(a.e)("No file name given.",2e3),{canBeSaved:!1,saveType:r};if(void 0===e)return Object(a.e)("Please log in and try again",2e3),{canBeSaved:!1,saveType:r};try{i=(await e.repos.getContent({owner:t,repo:n,path:s})).data,r="Overwrite"}catch(o){if(404!==o.status)return Object(a.e)("Connection denied or file does not exist.",2e3),console.error(o),{canBeSaved:!1,saveType:r};r="Create"}return Array.isArray(i)?(Object(a.e)("Can't save over a folder!",2e3),{canBeSaved:!1,saveType:r}):{canBeSaved:!0,saveType:r}}async function h(){return await Object(i.b)({contents:Object(o.jsxs)("div",{children:[Object(o.jsx)("p",{children:"Warning: opening this file will overwrite the text data in the editor."}),Object(o.jsx)("p",{children:"Please click 'Confirm' to continue, or 'Cancel' to go back."})]}),negativeLabel:"Cancel",positiveIntent:"primary",positiveLabel:"Confirm"})}async function p(){return await Object(i.b)({contents:Object(o.jsxs)("div",{children:[Object(o.jsx)("p",{children:"Warning: You are saving over an existing file in the repository."}),Object(o.jsx)("p",{children:"Please click 'Confirm' to continue, or 'Cancel' to go back."})]}),negativeLabel:"Cancel",positiveIntent:"primary",positiveLabel:"Confirm"})}async function g(t,n,i,o){if(void 0===t)return;const c=(await t.repos.getContent({owner:n,repo:i,path:o})).data.content;if(c){const t=e.from(c,"base64").toString();r.a.dispatch(s.a.updateEditorValue(t,"playground")),r.a.dispatch(s.a.playgroundUpdateGitHubSaveInfo(i,o,new Date)),Object(a.d)("Successfully loaded file!",1e3)}}async function m(t,n,i,o,c,l,d,u){if(void 0===t)return;l=l||"No public email provided",c=c||"Source Academy User",d=d||"Changes made from Source Academy",u=u||"";const h=e.from(u,"utf8").toString("base64");try{const e=(await t.repos.getContent({owner:n,repo:i,path:o})).data;if(Array.isArray(e))return;const u=e.sha;await t.repos.createOrUpdateFileContents({owner:n,repo:i,path:o,message:d,content:h,sha:u,committer:{name:c,email:l},author:{name:c,email:l}}),r.a.dispatch(s.a.playgroundUpdateGitHubSaveInfo(i,o,new Date)),Object(a.d)("Successfully saved file!",1e3)}catch(p){console.error(p),Object(a.e)("Something went wrong when trying to save the file.",1e3)}}async function b(t,n,i,o,c,l,d,u){if(void 0===t)return;l=l||"No public email provided",c=c||"Source Academy User",d=d||"Changes made from Source Academy",u=u||"";const h=e.from(u,"utf8").toString("base64");try{await t.repos.createOrUpdateFileContents({owner:n,repo:i,path:o,message:d,content:h,committer:{name:c,email:l},author:{name:c,email:l}}),r.a.dispatch(s.a.playgroundUpdateGitHubSaveInfo(i,o,new Date)),Object(a.d)("Successfully created file!",1e3)}catch(p){console.error(p),Object(a.e)("Something went wrong when trying to save the file.",1e3)}}async function f(e,t,n,s,i,r,o){if(void 0!==e){r=r||"No public email provided",i=i||"Source Academy User",o=o||"Changes made from Source Academy";try{const i=(await e.repos.getContent({owner:t,repo:n,path:s})).data;if(!Array.isArray(i))return void Object(a.e)("Something went wrong when trying to delete the folder.",1e3);for(let s=0;s<i.length;s++){const a=i[s];await e.repos.deleteFile({owner:t,repo:n,path:a.path,message:o,sha:a.sha})}Object(a.d)("Successfully deleted folder!",1e3)}catch(c){console.error(c),Object(a.e)("Something went wrong when trying to delete the folder.",1e3)}}}}).call(this,n(72).Buffer)},73:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return h}));var s=n(64),i=n.n(s);const a=new Date,r=e=>void 0!==e&&e<=a,o=e=>void 0===e||e<=a,c=(e,t)=>{if(void 0===e&&void 0===t)return!0;const n=new Date,s=100*n.getHours()+n.getMinutes(),i=void 0===e?void 0:100*e.getHours()+e.getMinutes(),a=void 0===t?void 0:100*t.getHours()+t.getMinutes();return void 0===i?s<=a:void 0===a?s>=i:i>=a?s<=a||s>=i:s<=a&&s>=i},l=e=>void 0===e?0:e.getTime()-a.getTime(),d=e=>void 0===e?"":i()(e).format("D MMMM YYYY HH:mm"),u=e=>void 0===e?"":i()(e).format("HH:mm"),h=e=>{if(void 0===e)return"Unlimited";if(r(e))return"Expired";const t=i()(),n=Math.ceil(i()(e).diff(t,"weeks",!0)),s=Math.ceil(i()(e).diff(t,"days",!0)),a=Math.ceil(i()(e).diff(t,"hours",!0));let o="";return o=n>1?n+" Weeks":s>1?s+" Days":a>1?a+" Hours":"1 Hour",o}},8:function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var s={};n.r(s),n.d(s,"persistenceOpenPicker",(function(){return b})),n.d(s,"persistenceSaveFile",(function(){return f})),n.d(s,"persistenceSaveFileAs",(function(){return v})),n.d(s,"persistenceInitialise",(function(){return y}));var i={};n.r(i),n.d(i,"remoteExecFetchDevices",(function(){return O})),n.d(i,"remoteExecUpdateDevices",(function(){return S})),n.d(i,"remoteExecUpdateSession",(function(){return w})),n.d(i,"remoteExecConnect",(function(){return C})),n.d(i,"remoteExecDisconnect",(function(){return E})),n.d(i,"remoteExecRun",(function(){return T})),n.d(i,"remoteExecReplInput",(function(){return k}));var a=n(244),r=n(67),o=n(37),c=n(223),l=n(13),d=n(186),u=n(93),h=n(256),p=n(170),g=n(7),m=n(143);const b=()=>Object(g.action)(m.b),f=e=>Object(g.action)(m.c,e),v=()=>Object(g.action)(m.d),y=()=>Object(g.action)(m.a);var j=n(122),x=n(86);const O=()=>Object(g.action)(x.c),S=e=>Object(g.action)(x.f,e),w=e=>Object(g.action)(x.g,e),C=(e,t)=>Object(g.action)(x.a,{workspace:e,device:t}),E=()=>Object(g.action)(x.b),T=e=>Object(g.action)(x.e,e),k=e=>Object(g.action)(x.d,e);const A={...u,...a,...c,...h,...r,...j,...o,...n(193),...n(92),...n(114),...l,...p,...d,...s,...i}},83:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return u}));const s="DELETE_SOURCECAST_ENTRY",i="RECORD_INIT",a="RECORD_INPUT",r="RESET_INPUTS",o="TIMER_PAUSE",c="TIMER_RESET",l="TIMER_RESUME",d="TIMER_START",u="TIMER_STOP"},85:function(e,t,n){"use strict";n.d(t,"a",(function(){return Mt}));var s=n(27),i=n(32),a=n.n(i),r=n(43),o=n(458),c=n(21),l=n(137),d=n(121);const u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.a:return c.c;case d.c:return{...e,gameCanvas:t.payload};default:return e}};var h=n(25);const p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.p:return{...e,achievements:t.payload};case h.q:return{...e,goals:t.payload};case h.r:return{...e,users:t.payload};case h.s:return{...e,assessmentOverviews:t.payload};default:return e}};var g=n(148);const m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.f,t=arguments.length>1?arguments[1]:void 0;return t.type===g.b?{...e,gradingSummary:t.payload}:e};var b=n(104);const f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b.a:return{...e,queryString:t.payload};case b.f:return{...e,shortURL:t.payload};case b.c:return{...e,githubSaveInfo:t.payload};case b.d:return{...e,persistenceFile:t.payload};default:return e}};var v=n(102),y=n(36),j=n(128);const x=(e,t)=>{switch(t.type){case y.d:return{...e,title:t.payload.title,description:t.payload.description,uid:t.payload.uid,audioUrl:t.payload.audioUrl,playbackData:t.payload.playbackData};case y.f:return{...e,currentPlayerTime:t.payload.playerTime};case y.e:return{...e,codeDeltasToApply:t.payload.deltas};case y.g:return{...e,inputToApply:t.payload.inputToApply};case y.h:return{...e,title:t.payload.title,description:t.payload.description,uid:t.payload.uid,audioUrl:t.payload.audioUrl,playbackData:t.payload.playbackData};case y.i:return{...e,playbackDuration:t.payload.duration};case y.j:return{...e,playbackStatus:t.payload.playbackStatus};case j.c:return{...e,sourcecastIndex:t.payload.index};default:return e}};var O=n(83);const S=(e,t)=>{switch(t.type){case O.b:return{...e,playbackData:{init:t.payload.initData,inputs:[]}};case O.c:return{...e,playbackData:{...e.playbackData,inputs:[...e.playbackData.inputs,t.payload.input]}};case O.d:return{...e,playbackData:{...e.playbackData,inputs:t.payload.inputs}};case O.e:return{...e,recordingStatus:y.c.paused,timeElapsedBeforePause:e.timeElapsedBeforePause+t.payload.timeNow-e.timeResumed};case O.f:return{...e,recordingStatus:y.c.notStarted,timeElapsedBeforePause:0,timeResumed:0};case O.g:return{...e,recordingStatus:y.c.recording,timeElapsedBeforePause:t.payload.timeBefore>=0?t.payload.timeBefore:e.timeElapsedBeforePause,timeResumed:t.payload.timeNow};case O.h:return{...e,recordingStatus:y.c.recording,timeElapsedBeforePause:0,timeResumed:t.payload.timeNow};case O.i:return{...e,recordingStatus:y.c.finished,timeElapsedBeforePause:0,timeResumed:0};default:return e}};var w=n(58),C=n(205),E=n(23),T=n(16),k=n(96),A=n(29);const _=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.l,t=arguments.length>1?arguments[1]:void 0;const n=t.payload?t.payload.workspaceLocation:"assessment";let s,i;switch(n){case"sourcecast":const n=x(e.sourcecast,t);if(n===e.sourcecast)break;return{...e,sourcecast:n};case"sourcereel":const s=S(e.sourcereel,t);if(s===e.sourcereel)break;return{...e,sourcereel:s}}switch(t.type){case A.c:if(null===e[n].replHistory.browseIndex)return e;if(0!==e[n].replHistory.browseIndex){const t=e[n].replHistory.browseIndex-1,s=e[n].replHistory.records[t];return{...e,[n]:{...e[n],replValue:s,replHistory:{...e[n].replHistory,browseIndex:t}}}}{const t=null,s=e[n].replHistory.originalValue,i=e[n].replHistory.records.slice();return{...e,[n]:{...e[n],replValue:s,replHistory:{browseIndex:t,records:i,originalValue:""}}}}case A.d:const a=e[n].replHistory.records,r=e[n].replHistory.browseIndex;if(0===a.length||null!==r&&void 0===a[r+1])return e;if(null===r){const t=0,s=a.slice(),i=e[n].replValue,r=s[t];return{...e,[n]:{...e[n],replValue:r,replHistory:{...e[n].replHistory,browseIndex:t,records:s,originalValue:i}}}}{const t=r+1,s=a[t];return{...e,[n]:{...e[n],replValue:s,replHistory:{...e[n].replHistory,browseIndex:t}}}}case A.e:return{...e,[n]:{...e[n],execTime:t.payload.execTime}};case A.g:return{...e,[n]:{...e[n],sideContentHeight:t.payload.height}};case A.h:return{...e,[n]:{...e[n],stepLimit:t.payload.stepLimit}};case A.l:return{...e,[n]:{...e[n],replValue:""}};case A.n:return{...e,[n]:{...e[n],output:e[n].output.slice(0,-1)}};case A.m:return{...e,[n]:{...e[n],output:[]}};case A.o:return{...e,[n]:{...e[n],context:Object(k.a)(t.payload.library.external.symbols,n,t.payload.library.variant),globals:t.payload.library.globals,externalLibrary:t.payload.library.external.name}};case A.A:let o;return s=e[n].output.concat(t.payload),o=""!==t.payload.value?[t.payload.value].concat(e[n].replHistory.records):e[n].replHistory.records,o.length>T.b.maxBrowseIndex&&o.pop(),{...e,[n]:{...e[n],output:s,replHistory:{...e[n].replHistory,records:o}}};case A.f:return{...e,[n]:{...e[n],externalLibrary:t.payload.newExternal}};case w.k:if(i=e[n].output[e[n].output.length-1],void 0===i||"running"!==i.type)s=e[n].output.concat({type:"running",consoleLogs:[...t.payload.logString]});else{const a={type:i.type,consoleLogs:i.consoleLogs.concat(t.payload.logString)};s=e[n].output.slice(0,-1),s.push(a)}return{...e,[n]:{...e[n],output:s}};case l.a:const d=e.playground;return{...c.l,playground:d};case A.p:return{...e,[n]:{...e[n],isRunning:!0,isDebugging:!1}};case A.r:return{...e,[n]:{...e[n],isRunning:!0}};case w.h:const u=e[n].context.executionMethod,h={type:t.payload.type,value:"interpreter"===u?t.payload.value:Object(v.stringify)(t.payload.value)};return i=e[n].output.slice(-1)[0],s=void 0!==i&&"running"===i.type?e[n].output.slice(0,-1).concat({consoleLogs:i.consoleLogs,...h}):e[n].output.concat({consoleLogs:[],...h}),{...e,[n]:{...e[n],output:s,isRunning:!1}};case w.j:return{...e,[n]:{...e[n],editorTestcases:e[n].editorTestcases.map(((e,n)=>n===t.payload.index?{...e,result:t.payload.value,errors:void 0}:e)),isRunning:!1}};case w.i:return{...e,[n]:{...e[n],editorTestcases:e[n].editorTestcases.map(((e,n)=>n===t.payload.index?{...e,result:void 0,errors:t.payload.value}:e))}};case w.g:return i=e[n].output.slice(-1)[0],s=void 0!==i&&"running"===i.type?e[n].output.slice(0,-1).concat({type:t.payload.type,errors:t.payload.errors,consoleLogs:i.consoleLogs}):e[n].output.concat({type:t.payload.type,errors:t.payload.errors,consoleLogs:[]}),{...e,[n]:{...e[n],output:s,isRunning:!1,isDebugging:!1}};case w.f:return{...e,[n]:{...e[n],isRunning:!1,isDebugging:!1}};case w.e:return{...e,[n]:{...e[n],isRunning:!1,isDebugging:!0}};case w.d:return{...e,[n]:{...e[n],isRunning:!0,isDebugging:!1}};case w.c:return{...e,[n]:{...e[n],isRunning:!1,isDebugging:!1}};case A.y:return{...e,[n]:{...e[n],editorTestcases:e[n].editorTestcases.map(((e,n)=>n===t.payload.index?{...e,result:void 0,errors:void 0}:e))}};case A.z:return{...e,[n]:{...e[n],...Object(c.b)(n),...t.payload.workspaceOptions}};case A.L:return{...e,[n]:{...e[n],...t.payload.workspaceOptions}};case C.a:return{...e,[n]:{...e[n],editorSessionId:t.payload.editorSessionId}};case j.b:return{...e,[n]:{...e[n],isEditorReadonly:t.payload.isEditorReadonly}};case C.b:return{...e,[n]:{...e[n],sharedbConnected:t.payload.connected}};case A.B:return{...e,[n]:{...e[n],isEditorAutorun:!e[n].isEditorAutorun}};case A.C:return"playground"===n||"sicp"===n?{...e,[n]:{...e[n],usingSubst:t.payload.usingSubst}}:e;case A.E:return{...e,assessment:{...e.assessment,currentAssessment:t.payload.assessmentId,currentQuestion:t.payload.questionId}};case A.F:return{...e,grading:{...e.grading,currentSubmission:t.payload.submissionId,currentQuestion:t.payload.questionId}};case A.D:const p=e[n].activeEditorTabIndex;if(null===p)return e;const g=[...e[n].editorTabs];return g[p]={...g[p],...t.payload.activeEditorTabOptions},{...e,[n]:{...e[n],editorTabs:g}};case A.G:return{...e,[n]:{...e[n],editorTabs:[{...e[n].editorTabs[0],breakpoints:t.payload.breakpoints}]}};case A.H:return{...e,[n]:{...e[n],editorTabs:[{...e[n].editorTabs[0],value:t.payload.newEditorValue}]}};case w.l:return{...e,[n]:{...e[n],editorTabs:[{...e[n].editorTabs[0],highlightedLines:t.payload.highlightedLines}]}};case A.u:return{...e,[n]:{...e[n],editorTabs:[{...e[n].editorTabs[0],newCursorPosition:t.payload.cursorPosition}]}};case A.J:return{...e,[n]:{...e[n],replValue:t.payload.newReplValue}};case A.I:return{...e,[n]:{...e[n],hasUnsavedChanges:t.payload.hasUnsavedChanges}};case A.K:return{...e,playground:{...e.playground,context:{...e.playground.context,chapter:t.payload.sublang.chapter,variant:t.payload.sublang.variant}}};case E.a:return{...e,[n]:{...e[n],debuggerContext:{...e[n].debuggerContext,result:t.payload.result,lastDebuggerResult:t.payload.lastDebuggerResult,code:t.payload.code,context:t.payload.context,workspaceLocation:t.payload.workspaceLocation}}};default:return e}},I=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.e;return e};var N=n(86),P=n(15);const R=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.a:return c.j;case P.D:return{...e,githubAssessment:t.payload};case P.E:return{...e,githubOctokitObject:{octokit:t.payload}};case P.C:return{...e,githubAccessToken:t.payload};case P.F:return{...e,googleUser:t.payload};case P.G:case P.H:case P.A:case P.B:return{...e,...t.payload};case P.z:return{...e,assessmentConfigurations:t.payload};case P.y:return{...e,userCourseRegistrations:t.payload};case P.O:const n=new Map(e.assessments);return n.set(t.payload.id,t.payload),{...e,assessments:n};case P.Q:return{...e,assessmentOverviews:t.payload};case P.X:return{...e,xp:t.payload};case P.N:return{...e,allUserXp:t.payload};case P.T:const s=new Map(e.gradings);return s.set(t.payload.submissionId,t.payload.grading),{...e,gradings:s};case P.U:return{...e,gradingOverviews:t.payload};case P.W:return{...e,notifications:t.payload};case N.f:return{...e,remoteExecutionDevices:t.payload};case N.g:return{...e,remoteExecutionSession:t.payload};case P.x:return{...e,githubOctokitObject:{octokit:void 0},githubAccessToken:void 0};default:return e}};var M=()=>Object(r.c)({academy:u,achievement:p,application:I,dashboard:m,playground:f,session:R,workspaces:_}),L=n(2),D=n(18),B=n(8),U=n(51),G=n(10),F=n(69);const H=[[{assessmentConfigId:1,type:"Missions",isManuallyGraded:!0,displayInDashboard:!0,hoursBeforeEarlyXpDecay:48,earlySubmissionXp:200},{assessmentConfigId:2,type:"Quests",isManuallyGraded:!0,displayInDashboard:!0,hoursBeforeEarlyXpDecay:48,earlySubmissionXp:200},{assessmentConfigId:3,type:"Paths",isManuallyGraded:!0,displayInDashboard:!0,hoursBeforeEarlyXpDecay:48,earlySubmissionXp:200},{assessmentConfigId:4,type:"Contests",isManuallyGraded:!0,displayInDashboard:!0,hoursBeforeEarlyXpDecay:48,earlySubmissionXp:200},{assessmentConfigId:5,type:"Others",isManuallyGraded:!0,displayInDashboard:!0,hoursBeforeEarlyXpDecay:48,earlySubmissionXp:200}],[{assessmentConfigId:1,type:"Mission Impossible",isManuallyGraded:!0,displayInDashboard:!0,hoursBeforeEarlyXpDecay:48,earlySubmissionXp:200},{assessmentConfigId:2,type:"Data Structures",isManuallyGraded:!0,displayInDashboard:!0,hoursBeforeEarlyXpDecay:48,earlySubmissionXp:200},{assessmentConfigId:3,type:"Algorithm Frenzy",isManuallyGraded:!0,displayInDashboard:!0,hoursBeforeEarlyXpDecay:48,earlySubmissionXp:200}]],V=[...[{type:"Missions",isManuallyGraded:!0,closeAt:"2048-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/300/",id:1,maxXp:1e3,openAt:"2038-06-18T05:24:26.026Z",title:"An Odessey to Runes (Duplicate)",shortSummary:"This is a test for the UI of the unopened assessment overview. It links to the mock Mission 0",status:D.a.not_attempted,story:"mission-1",xp:0,gradingStatus:D.c.none}],...[{type:"Missions",isManuallyGraded:!0,closeAt:"2048-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/300/",id:1,maxXp:1e3,openAt:"2018-06-18T05:24:26.026Z",title:"An Odessey to Runes",shortSummary:"\n  *Lorem ipsum* dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor\n  incididunt ut labore et dolore magna aliqua.\n  \n  ```\n  const a = 5;\n  ```\n  \n  Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium\n  _doloremque laudantium_, totam rem aperiam, eaque ipsa quae ab illo inventore\n  [veritatis et quasi architecto](google.com) beatae vitae dicta sunt\n  `explicabo`.\n  \n  ",status:D.a.attempted,story:"mission-1",xp:1,gradingStatus:D.c.none},{type:"Missions",isManuallyGraded:!0,closeAt:"2048-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/?text=World&font=lobster",id:2,maxXp:1e3,openAt:"2018-07-18T05:24:26.026Z",title:"The Secret to Streams",shortSummary:"Once upon a time, Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin nec vulputate sapien. Fusce vel lacus fermentum, efficitur ipsum.",status:D.a.attempting,story:"mission-2",xp:2,gradingStatus:D.c.none},{type:"Quests",isManuallyGraded:!0,closeAt:"2048-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/?text=Hello",id:3,maxXp:1e3,openAt:"2018-07-18T05:24:26.026Z",title:"A sample Sidequest",shortSummary:"Once upon a time, Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin nec vulputate sapien. Fusce vel lacus fermentum, efficitur ipsum.",status:D.a.not_attempted,story:"sidequest-2.1",xp:3,gradingStatus:D.c.none},{type:"Paths",isManuallyGraded:!0,closeAt:"2069-04-20T01:23:45.111Z",coverImage:"https://fakeimg.pl/700x400/417678,64/?text=%E3%83%91%E3%82%B9&font=noto",id:6,maxXp:200,openAt:"2018-01-01T00:00:00.000Z",title:"Basic logic gates",shortSummary:"This mock path serves as a demonstration of the support provided for mock programming path functionality.",status:D.a.not_attempted,story:null,xp:0,gradingStatus:D.c.excluded},{type:"Others",isManuallyGraded:!1,closeAt:"2048-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/?text=Hello",id:5,maxXp:1e3,openAt:"2018-07-18T05:24:26.026Z",title:"A sample Practical",shortSummary:"Once upon a time, Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin nec vulputate sapien. Fusce vel lacus fermentum, efficitur ipsum.",status:D.a.not_attempted,story:"sidequest-2.1",xp:3,gradingStatus:D.c.none,private:!0}],...[{type:"Missions",isManuallyGraded:!0,closeAt:"2008-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/ff0000/000",id:4,maxXp:1e3,openAt:"2007-07-18T05:24:26.026Z",title:"A closed Mission",shortSummary:"This is a test for the grading status tooltip when the assessment is partially graded (undergoing manual grading). It should render as an orange clock.",status:D.a.submitted,story:"mission-3",xp:800,gradingStatus:D.c.grading},{type:"Quests",isManuallyGraded:!0,closeAt:"2008-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/ff0000,128/000,255",id:5,maxXp:1e3,openAt:"2007-07-18T05:24:26.026Z",title:"Closed (not graded) Sidequest",shortSummary:"This is a test for the grading status tooltip when the assessment is not graded. It should render as a red cross.",status:D.a.submitted,story:null,xp:500,gradingStatus:D.c.none},{type:"Quests",isManuallyGraded:!0,closeAt:"2008-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/ff0000,128/000,255",id:5,maxXp:500,openAt:"2007-07-18T05:24:26.026Z",title:"Closed (fully graded) Sidequest",shortSummary:"This is a test for the grading status tooltip when the assessment is fully graded. It should render as a green tick. This sidequest links to the mock Sidequest 4.",status:D.a.submitted,story:null,xp:150,gradingStatus:D.c.graded},{type:"Quests",isManuallyGraded:!0,closeAt:"2008-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/ff0000/000",id:5,maxXp:0,openAt:"2007-07-18T05:24:26.026Z",title:"Ungraded assessment",shortSummary:"This is a test for the grading status tooltip when the assessment does not require manual grading (e.g. paths and contests). It should render as a blue disable sign. This sidequest links to the mock Sidequest 4.",status:D.a.submitted,story:null,xp:100,gradingStatus:D.c.excluded}]],W={external:{name:F.a.NONE,symbols:[]},globals:[]},$=[{autogradingResults:[],answer:null,content:"\n  This question has an id of `0`.\n  \n  ```\n  What's your favourite dinner food?\n  ```\n  ",id:0,library:W,prepend:'const pizza = "pizza";\n  const sushi = "sushi";\n  const chickenrice = "chicken rice";',postpend:"// This is a mock Postpend! You shouldn't be able to see me!",testcases:[{type:D.f.public,program:"answer();",score:1,answer:'"pizza"'},{type:D.f.public,program:"answer();",score:1,answer:'"sushi"'},{type:D.f.public,program:"answer();",score:1,answer:'"chicken rice"'}],solutionTemplate:"function answer() {\n      // Write something here!\n  }\n  ",type:"programming",xp:0,maxXp:2,blocking:!1},{autogradingResults:[],answer:"function areaOfCircle(x) {\n      return square(x) * pi;\n  }\n  \n  function volumeOfSphere(x) {\n      return 4 / 3 * cube(x) * pi;\n  }",content:"Hello and welcome to this assessment! This is the 1st question.",id:1,library:W,prepend:"const square = x => x * x;\n  const cube = x => x * x * x;\n  const pi = 3.1415928;",postpend:"",testcases:[{type:D.f.public,program:"areaOfCircle(5);",score:1,answer:"78.53982"},{type:D.f.public,program:"volumeOfSphere(5);",score:1,answer:"523.5988"}],solutionTemplate:"function areaOfCircle(x) {\n      // return area of circle\n  }\n  \n  function volumeOfSphere(x) {\n      // return volume of sphere\n  }",type:"programming",xp:0,maxXp:2,blocking:!1},{answer:3,content:"This is the 3rd question. Oddly enough, it is an ungraded MCQ question that uses the binary tree library! Option C has a null hint!",choices:[{content:"**Option** `A`",hint:"_hint_ A is `here`"},{content:"### B",hint:"hint B"},{content:"C",hint:null},{content:"D",hint:"hint D"}],id:2,library:W,type:"mcq",solution:0,xp:0,maxXp:2,blocking:!1},{answer:3,content:"This is the 4th question. Oddly enough, it is a graded MCQ question that uses the binary tree library!",choices:[{content:"A",hint:null},{content:"B",hint:null},{content:"C",hint:null},{content:"D",hint:null}],id:3,library:W,type:"mcq",solution:void 0,xp:0,maxXp:2,blocking:!1},{autogradingResults:[],answer:null,content:"You have reached the last question! Have some fun with the tone matrix...",id:4,library:W,prepend:"",postpend:"",testcases:[],solutionTemplate:"5th question mock solution template",type:"programming",xp:0,maxXp:2,blocking:!1}],X=[{answer:"function fibonacci(n) {\n      if (n <= 2) {\n          return 1;\n      } else {\n          return fibonacci(n-1) + fibonacci(n-2);\n      }\n  }",content:"You can see autograding results!!!",id:0,library:W,prepend:"",postpend:"// This is a mock Postpend! You shouldn't be able to see me!",testcases:[{type:D.f.public,program:"fibonacci(3);",score:1,answer:"2"},{type:D.f.public,program:"fibonacci(4);",score:1,answer:"3"},{type:D.f.public,program:"fibonacci(5);",score:1,answer:"5"}],solutionTemplate:"function fibonacci(n) {\n      // Your answer here\n  }",type:"programming",grader:{name:"avenger",id:1},gradedAt:"2038-06-18T05:24:26.026Z",xp:0,maxXp:2,blocking:!1,comments:"Good job. You are awarded the full marks!\n  \n  ----\n  ## markdown test\n  \n  # header\n  \n  **bold**\n  \n  _italics_\n  \n  * list\n  \n  1. numbered list\n  \n  - [] checkboxes\n  \n  > quote\n  \n      code\n  \n  [link to Source Academy](https://sourceacademy.nus.edu.sg)  \n  \n  ![](image-url-goes-here)",autogradingResults:[{resultType:"pass"},{resultType:"fail",expected:"8",actual:"5"},{resultType:"error",errors:[{errorType:"timeout"},{errorType:"syntax",line:1,location:"student",errorLine:"function fibonacci(n) {",errorExplanation:"Just kidding!"}]}]},{answer:"function recurse(rune, n) {\n      return n <= 1 ? rune : make_cross(recurse(rune, n - 1));\n  }",content:"This is a runes question - there are no testcases nor autograding results.",id:1,library:W,prepend:"",postpend:"",testcases:[],solutionTemplate:"function recurse(rune, n) {\n      // Your answer here\n  }",type:"programming",grader:{name:"some avenger",id:1},gradedAt:"2038-06-18T05:24:26.026Z",xp:0,maxXp:2,blocking:!1,comments:"You open the Report Card, not knowing what to expect...\n  \n      ## WOW!\n      Amazing grasp of runes. We can now move on to the next assignment.\n      \n      <br/>\n      \n      Robot Dog: `woof`\n      \n      You look at the display of the robot dog.\n      \n          FEED ME\n      1. Bread\n      2. Water\n      \n      <br/>\n      \n      * I am hungry.\n      * I am thirsty.\n      \n      <br/>\n      <br/>\n          \n      New message from **Avenger**!\n      \n      > _Cadet, please meet me at Level X-05, outside the pod bay doors. There is an important mission awaiting us._\n      \n      > _May the [Source](https://sourceacademy.nus.edu.sg) be with you._\n      \n      > Best regards, Avocado A. Avenger\n      \n      #### Upcoming Tasks\n      - [] Meet Avenger Avenger at Level X-05\n      - [] Open the Pod Bay Doors",autogradingResults:[]}],q=[{type:"Missions",id:1,longSummary:"This is the mission briefing. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas viverra, sem scelerisque ultricies ullamcorper, sem nibh sollicitudin enim, at ultricies sem orci eget odio. Pellentesque varius et mauris quis vestibulum. Etiam in egestas dolor. Nunc consectetur, sapien sodales accumsan convallis, lectus mi tempus ipsum, vel ornare metus turpis sed justo. Vivamus at tellus sed ex convallis commodo at in lectus. Pellentesque pharetra pulvinar sapien pellentesque facilisis. Curabitur efficitur malesuada urna sed aliquam. Quisque massa metus, aliquam in sagittis non, cursus in sem. Morbi vel nunc at nunc pharetra lobortis. Aliquam feugiat ultricies ipsum vel sollicitudin. Vivamus nulla massa, hendrerit sit amet nibh quis, porttitor convallis nisi. ",missionPDF:"www.google.com",questions:$,title:"An Odessey to Runes"},{type:"Missions",id:2,longSummary:"This is the mission briefing. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas viverra, sem scelerisque ultricies ullamcorper, sem nibh sollicitudin enim, at ultricies sem orci eget odio. Pellentesque varius et mauris quis vestibulum. Etiam in egestas dolor. Nunc consectetur, sapien sodales accumsan convallis, lectus mi tempus ipsum, vel ornare metus turpis sed justo. Vivamus at tellus sed ex convallis commodo at in lectus. Pellentesque pharetra pulvinar sapien pellentesque facilisis. Curabitur efficitur malesuada urna sed aliquam. Quisque massa metus, aliquam in sagittis non, cursus in sem. Morbi vel nunc at nunc pharetra lobortis. Aliquam feugiat ultricies ipsum vel sollicitudin. Vivamus nulla massa, hendrerit sit amet nibh quis, porttitor convallis nisi. ",missionPDF:"www.google.com",questions:$,title:"The Secret to Streams"},{type:"Quests",id:3,longSummary:"###This is the sidequest briefing.\n  \n  *Lorem ipsum* dolor sit amet, consectetur adipiscing elit.\n  \n  > Maecenas viverra, sem scelerisque ultricies ullamcorper, sem nibh sollicitudin\n  enim, at ultricies sem orci eget odio. Pellentesque varius et mauris quis\n  vestibulum.\n  \n  - Etiam in egestas dolor.\n  - Nunc consectetur, sapien sodales accumsan convallis, lectus mi tempus ipsum,\n    vel ornare metus turpis sed justo.\n  - Vivamus at tellus sed ex convallis commodo at in lectus.\n  \n  ```\n  Pellentesque\n  pharetra\n  pulvinar\n  sapien\n  ```",missionPDF:"www.google.com",questions:$,title:"A sample Sidequest"},{type:"Missions",id:4,longSummary:"This is the closed mission briefing. The save button should not be there. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas viverra, sem scelerisque ultricies ullamcorper, sem nibh sollicitudin enim, at ultricies sem orci eget odio. Pellentesque varius et mauris quis vestibulum. Etiam in egestas dolor. Nunc consectetur, sapien sodales accumsan convallis, lectus mi tempus ipsum, vel ornare metus turpis sed justo. Vivamus at tellus sed ex convallis commodo at in lectus. Pellentesque pharetra pulvinar sapien pellentesque facilisis. Curabitur efficitur malesuada urna sed aliquam. Quisque massa metus, aliquam in sagittis non, cursus in sem. Morbi vel nunc at nunc pharetra lobortis. Aliquam feugiat ultricies ipsum vel sollicitudin. Vivamus nulla massa, hendrerit sit amet nibh quis, porttitor convallis nisi. ",missionPDF:"www.google.com",questions:X,title:"A Closed Mission"},{type:"Quests",id:5,longSummary:"This is the closed sidequest briefing. The save button should not exist. This is a placeholder sidequest for testing rendering of grading statuses.",missionPDF:"www.google.com",questions:X,title:"A Closed Sidequest"},{type:"Paths",id:6,longSummary:"### Basic logic gates\n  \n  This path is intended to demonstrate concepts from the lecture **Logic Circuits**. You are strongly encouraged to attempt this path to check your understanding, prior to the next Studio session. For this, you will be granted a small amount of XP!\n  \n  The path comprises 4 questions and is fully autograded and guided, and there are **no private test cases** - there will be no manual review by default. Please consult your Avenger if you require assistance!</TEXT>",missionPDF:"www.google.com",questions:[{answer:null,content:"As a recap: which of the following is not a valid logic gate?",choices:[{content:"XOR gate",hint:"This is the exclusive-OR gate!"},{content:"IF gate",hint:"Correct!"},{content:"AND gate",hint:"This logic gate exists!"},{content:"OR gate",hint:"This logic gate exists!"}],id:0,library:W,type:"mcq",solution:1,xp:0,maxXp:0,blocking:!1},{autogradingResults:[],answer:null,content:"An AND gate is a digital logic gate that implements logical conjunction on its inputs. It returns a single output that is HIGH (active) iff all the inputs to the AND gate are HIGH (active).\n  \n  In this question, let us model an AND gate as a function, and treat HIGH (active) inputs as the boolean value `true` and LOW (inactive) inputs as the boolean value `false`.\n  \n  As an AND gate is not restricted to exactly two inputs, our function shall be the same. Implement the function `AND(inputs)` which takes in the list `inputs` (a list of boolean values), and returns the output of the AND gate as a boolean. You may assume the list `inputs` is of minimum length 2.\n  \n  This question makes use of the sentinel function method to throw custom errors for each testcase.",id:1,library:W,prepend:"const OR = (x, y) => x || y;",postpend:"\n  const __AND = (xs) => {\n    if (AND(list(true, true)) === undefined) {\n      error('Your function is empty!');\n    } else {}\n    \n    const result = AND(xs);\n  \n    if (!is_boolean(result)) {\n      error('Your function does not return a boolean!');\n    } else {}\n    \n    if (equal(xs, list(true, false)) && result) {\n      error('Check the truth table for an AND gate again!');\n    } else if (equal(xs, list(true, true, false)) && result) {\n      error('Are you using all inputs in the list?');\n    } else if (equal(xs, list(true, true, true)) && !result) {\n      error('Are you sure your base case is correct?');\n    } else if (AND(list(true, true)) === AND(list(false, false))) {\n      error('Oi! Do not hardcode values!');\n    } else {\n      return result;\n    }\n  };",testcases:[{type:D.f.public,program:"__AND(list(true, false));",score:0,answer:"false"},{type:D.f.public,program:"__AND(list(true, true, false));",score:0,answer:"false"},{type:D.f.public,program:"__AND(list(true, OR(true, false), OR(true, true)));",score:0,answer:"true"},{type:D.f.opaque,program:"__AND(list(true, OR(false, true), AND(list(true, false)), false));",score:0,answer:"false"},{type:D.f.opaque,program:"__AND(list(true, OR(true, false), OR(true, AND(list(false, true))), true));",score:0,answer:"true"}],solutionTemplate:"function AND(inputs) {\n      // Your answer here!\n  }",type:"programming",xp:0,maxXp:0,blocking:!1},{autogradingResults:[],answer:null,content:"The XOR (exclusive-OR) gate is a digital logic gate that accepts two inputs and returns a single output that is HIGH (active) iff one of the inputs are HIGH (active), but not both.\n  \n  In this question, let us model the XOR gate as a function. Implement the function `XOR(x, y)` which takes two boolean inputs `x` and `y` and which returns the output of the XOR gate as a boolean.\n  \n  This question makes use of the wrapping container method to throw custom errors for each testcase.",id:2,library:W,prepend:"",postpend:"\n  const __XOR = (x, y) => {\n    if (XOR(false, false) === undefined) {\n      error('Your function is empty!');\n    } else {}\n    \n    const result = XOR(x, y);\n  \n    if (!is_boolean(result)) {\n      error('Your function does not return a boolean!');\n    } else {}\n    \n    if (((x && !y) || (y && !x)) && !result) {\n      error('Check your truth tables!');\n    } else if (XOR(false, false) === XOR(false, true)) {\n      error('Oi! Do not hardcode values!');\n    } else {\n      return result;\n    }\n  };",testcases:[{type:D.f.public,program:"__XOR(true, false);",score:0,answer:"true"},{type:D.f.public,program:"__XOR(false, true);",score:0,answer:"true"},{type:D.f.opaque,program:"__XOR(true, XOR(true, false));",score:0,answer:"false"}],solutionTemplate:"function XOR(x, y) {\n      // Your answer here!\n  }",type:"programming",xp:0,maxXp:0,blocking:!1},{autogradingResults:[],answer:null,content:"The NOR logic gate is special in that it is an _universal logic gate_, that is to say, they can be composed to form any other logic gate.\n  \n  Implement the AND logic gate **using ONLY the NOR logic gate**, as the `NOR_AND(x, y)` function that takes in two booleans as input.\n  \n  The `NOR` function modeled after a NOR gate is provided for you - it accepts two boolean values and returns `true` iff both inputs are `false`.",id:3,library:W,prepend:"\n  let counter = 0;\n  const NOR = (x, y) => {\n    counter = counter + 1;\n    return !(x || y);\n  };",postpend:"\n  const __NOR_AND = (x, y) => {\n    if (NOR_AND(false, false) === undefined) {\n      error('Your function is empty!');\n    } else {}\n    \n    counter = 0;\n    const result = NOR_AND(x, y);\n  \n    if (!is_boolean(result)) {\n      error('Your function does not return a boolean!');\n    } else {}\n    \n    if (!x && y && result) {\n      error('Check your truth tables!');\n    } else if (x && y && !result && counter > 0) {\n      error('Nope! Try again :)');\n    } else if (x && y && !result) {\n      error('...You did not use NOR and still got it wrong!');\n    } else if (x && y && result && counter !== 3) {\n      error('Did you use NOR in your solution? >:(');\n    } else if (x && !y && counter !== 6) {\n      error('Incorrect number of calls.');\n    } else {\n      return result;\n    }\n  };",testcases:[{type:D.f.public,program:"__NOR_AND(false, true);",score:0,answer:"false"},{type:D.f.public,program:"__NOR_AND(true, true);",score:0,answer:"true"},{type:D.f.opaque,program:"__NOR_AND(true, NOR_AND(false, true));",score:0,answer:"false"}],solutionTemplate:"function NOR_AND(x, y) {\n      // Your answer here!\n  }",type:"programming",xp:0,maxXp:0,blocking:!1}],title:"A sample guided path"},{type:"Others",id:7,title:"A sample contest voting assessment",longSummary:"Vote for your favourite contest entries here!",missionPDF:"www.google.com",questions:[{id:0,type:"voting",content:"Sample Contest Voting Question",xp:0,maxXp:0,answer:[],prepend:"",postpend:"",contestEntries:[{submission_id:1,answer:{code:"display('voting test')"}},{submission_id:2,answer:{code:"function voting_test() { return true; }"}}],contestLeaderboard:[{submission_id:1,student_name:"student_1",answer:{code:"display('leaderboard test')"}},{submission_id:2,student_name:"student_2",answer:{code:"function leaderboard_test() { return true; }"}}],library:W,blocking:!1}]}];var z=n(99);const Y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.a.Staff;return t},K={userId:123,name:"DevAdmin",courses:[{courseId:1,courseName:"CS1101S Programming Methodology (AY20/21 Sem 1)",courseShortName:"CS1101S",role:c.a.Admin,viewable:!0},{courseId:2,courseName:"CS2040S Data Structures and Algorithms (AY20/21 Sem 2)",courseShortName:"CS2040S",role:c.a.Admin,viewable:!1},{courseId:3,courseName:"CS2030S Programming Methodology II (AY21/22 Sem 1)",courseShortName:"CS2030S",role:c.a.Staff,viewable:!1}]},Q=[{courseRegId:1,role:c.a.Admin,group:"1F",gameState:{},courseId:1,xp:0,story:{story:"mission-1",playStory:!0},agreedToResearch:!0},{courseRegId:2,role:c.a.Student,group:"1F",gameState:{},courseId:2,xp:0,story:{story:"mission-1",playStory:!0},agreedToResearch:!0}],J=[{courseRegId:1,courseId:1,name:"DevAdmin",username:"test/admin",role:c.a.Admin},{courseRegId:3,courseId:1,name:"Dummy student",username:"test/student",role:c.a.Student},{courseRegId:4,courseId:1,name:"Dummy staff",username:"test/staff",role:c.a.Staff}],Z=[{courseName:"CS1101S Programming Methodology (AY20/21 Sem 1)",courseShortName:"CS1101S",viewable:!0,enableGame:!1,enableAchievements:!0,enableSourcecast:!0,sourceChapter:s.Chapter.CALC,sourceVariant:s.Variant.DEFAULT,moduleHelpText:"",assetsPrefix:""},{courseName:"CS2040S Data Structures and Algorithms (AY20/21 Sem 2)",courseShortName:"CS2040S",viewable:!0,enableGame:!1,enableAchievements:!1,enableSourcecast:!1,sourceChapter:s.Chapter.CALC,sourceVariant:s.Variant.DEFAULT,moduleHelpText:"Help Text!",assetsPrefix:""}],ee=[{id:1,type:z.a.deadline,assessment_id:3,assessment_type:"Quests",assessment_title:"The Secret to Streams"},{id:2,type:z.a.autograded,assessment_id:4,assessment_type:"Missions",assessment_title:"A Closed Mission"},{id:3,type:z.a.graded,assessment_id:4,assessment_type:"Missions",assessment_title:"A Closed Mission"},{id:4,type:z.a.new,assessment_id:6,assessment_type:"Paths",assessment_title:"Basic Logic"},{id:5,type:z.a.new,assessment_id:7,assessment_type:"Missions",assessment_title:"Symphony of the Winds"},{id:6,type:z.a.submitted,submission_id:1,assessment_type:"Missions",assessment_title:"Mission 0"},{id:7,type:z.a.submitted,submission_id:2,assessment_type:"Missions",assessment_title:"Mission 1"},{id:8,type:z.a.submitted,submission_id:3,assessment_type:"Missions",assessment_title:"Mission 0"}],te=[{xpAdjustment:0,assessmentType:"Missions",assessmentId:0,assessmentName:"Mission 0 ",currentXp:69,xpBonus:10,initialXp:69,maxXp:100,studentId:0,studentName:"Al Gorithm",submissionId:1,submissionStatus:"submitted",groupName:"1D",gradingStatus:"graded",questionCount:6,gradedCount:6},{xpAdjustment:-2,assessmentType:"Missions",assessmentId:1,assessmentName:"Mission 1",currentXp:-2,xpBonus:12,initialXp:0,maxXp:400,studentId:0,studentName:"Dee Sign",submissionId:2,submissionStatus:"submitted",groupName:"1F",gradingStatus:"grading",questionCount:6,gradedCount:2},{xpAdjustment:4,assessmentType:"Missions",assessmentId:0,assessmentName:"Mission 0",currentXp:1e3,xpBonus:12,initialXp:996,maxXp:1e3,studentId:1,studentName:"May Trix",submissionId:3,submissionStatus:"submitted",groupName:"1F",gradingStatus:"none",questionCount:6,gradedCount:0}],ne=[{question:{answer:"function remainder(n, d) {\n  return (n - d) < 0 ? n : remainder(n - d, d);\n}",content:"\nHello and welcome to this assessment! This is the *0th question*.\n\n```\n>>> import this\n```\n",prepend:"// THIS IS A PREPEND",postpend:"// THIS IS A POSTPEND",testcases:[{type:D.f.public,program:"remainder(12, 7);",score:1,answer:"5"},{type:D.f.public,program:"remainder(6, 1);",score:2,answer:"0"},{type:D.f.opaque,program:"remainder(-15, 6);",score:2,answer:"-3"},{type:D.f.opaque,program:"remainder(17, 23) === 17;",score:2,answer:"true"}],id:0,library:W,solutionTemplate:"0th question mock solution template",solution:"This is how the 0th question is solved. [7 points]\n\nfunction remainder(n, d) {\n  return n % d;\n}",type:"programming",maxXp:1e3,grader:{name:"avenger",id:1},gradedAt:"2038-06-18T05:24:26.026Z",xp:1,autogradingResults:[{resultType:"pass"},{resultType:"fail",expected:"8",actual:"5"},{resultType:"error",errors:[{errorType:"dummyErrorType"}]},{resultType:"error",errors:[{errorType:"systemError",errorMessage:"Cannot read property 'getUniformLocation' of null"}]},{resultType:"error",errors:[{errorType:"timeout"},{errorType:"syntax",line:2,location:"student",errorLine:"return (n - d) < 0 ? n : remainder(n - d, d)",errorExplanation:"Missing semicolon at the end of statement"}]}],blocking:!1},grade:{xpAdjustment:0,xp:0,comments:"Good job. You are awarded the full marks!\n\n----\n## markdown test\n\n# header\n\n**bold**\n\n_italics_\n\n* list\n\n1. numbered list\n\n- [] checkboxes\n\n> quote\n\n    code\n\n[link to Source Academy](https://sourceacademy.nus.edu.sg)\n\n![](image-url-goes-here)\n      ",grader:{name:"HARTIN MENZ",id:100},gradedAt:"2019-08-16T13:26:32+00:00"},student:{name:"Al Gorithm",id:0}},{question:{prepend:"",postpend:"",testcases:[],answer:"This student's answer to the 1st question",content:"Hello and welcome to this assessment! This is the 1st question.",id:1,library:W,solutionTemplate:"1st question mock solution template",solution:null,type:"programming",maxXp:200,grader:{name:"avenger",id:1},gradedAt:"2038-06-18T05:24:26.026Z",xp:1,autogradingResults:[{resultType:"pass"},{resultType:"fail",expected:"8",actual:"5"},{resultType:"error",errors:[{errorType:"timeout"},{errorType:"syntax",line:1,location:"student",errorLine:"function fibonacci(n) {",errorExplanation:"Just kidding!"}]}],blocking:!1},grade:{xpAdjustment:0,xp:100,comments:"You open the Report Card, not knowing what to expect...\n\n## WOW!\nAmazing grasp of runes. We can now move on to the next assignment.\n\n<br/>\n\nRobot Dog: `woof`\n\nYou look at the display of the robot dog.\n\n    FEED ME\n1. Bread\n2. Water\n\n<br/>\n\n* I am hungry.\n* I am thirsty.\n\n<br/>\n<br/>\n\nNew message from **Avenger**!\n\n> _Cadet, please meet me at Level X-05, outside the pod bay doors. There is an important mission awaiting us._\n\n> _May the [Source](https://sourceacademy.nus.edu.sg) be with you._\n\n> Best regards, Avocado A. Avenger\n\n#### Upcoming Tasks\n- [] Meet Avenger Avenger at Level X-05\n- [] Open the Pod Bay Doors\n      "},student:{name:"Al Gorithm",id:0}},{question:{prepend:"",postpend:"",testcases:[],answer:3,solution:2,content:"Hello and welcome to this assessment! This is the 2nd question. Oddly enough, it is an MCQ question!",choices:[{content:"A",hint:"hint A"},{content:"B",hint:"hint B"},{content:"C",hint:"hint C"},{content:"D",hint:"hint D"}],id:2,library:W,type:"mcq",maxXp:100,grader:{name:"avenger",id:1},gradedAt:"2038-06-18T05:24:26.026Z",xp:1,autogradingResults:[{resultType:"pass"},{resultType:"fail",expected:"8",actual:"5"},{resultType:"error",errors:[{errorType:"timeout"},{errorType:"syntax",line:1,location:"student",errorLine:"function fibonacci(n) {",errorExplanation:"Just kidding!"}]}],blocking:!1},grade:{xpAdjustment:0,xp:50},student:{name:"Al Gorithm",id:0}}],se={cols:["group","avenger","ungradedMissions","submittedMissions","ungradedQuests","submittedQuests"],rows:[{group:"Mock Group 1",avenger:"John",ungradedMissions:123,submittedMissions:200,ungradedQuests:100,submittedQuests:117},{group:"Mock Group 2",avenger:"Molly",ungradedMissions:1232,submittedMissions:205430,ungradedQuests:345,submittedQuests:11547},{group:"Mock Group 3",avenger:"Lenny",ungradedMissions:1532,submittedMissions:22200,ungradedQuests:134500,submittedQuests:6777}]};function*ie(){yield Object(L.h)(P.j,(function*(t){yield Object(L.d)(B.a.setTokens({accessToken:"accessToken",refreshToken:"refreshToken"})),yield e();const n=yield Object(L.f)((e=>e.session.courseId));yield U.a.push(`/courses/${n}`)}));const e=function*(){const e={...K},t={...Q[0]},n={...Z[0]},s=[...H[0]],i={chapter:n.sourceChapter,variant:n.sourceVariant,displayName:Object(c.o)(n.sourceChapter,n.sourceVariant)};yield Object(L.d)(B.a.setUser(e)),yield Object(L.d)(B.a.setCourseRegistration(t)),yield Object(L.d)(B.a.setCourseConfiguration(n)),yield Object(L.d)(B.a.setAssessmentConfigurations(s)),yield Object(L.d)(B.a.updateSublanguage(i))};yield Object(L.h)(P.q,e),yield Object(L.h)(P.k,(function*(){const e={...Z[0]};yield Object(L.d)(B.a.setCourseConfiguration(e))})),yield Object(L.h)(D.b,(function*(){yield Object(L.d)(B.a.updateAssessmentOverviews([...V]))})),yield Object(L.h)(P.f,(function*(e){const t=e.payload,n=q[t-1];yield Object(L.d)(B.a.updateAssessment({...n}))})),yield Object(L.h)(P.I,(function*(e){const t=e.payload.id,n=e.payload.answer,s=yield Object(L.f)((e=>e.workspaces.assessment.currentAssessment)),i=yield Object(L.f)((e=>e.session.assessments.get(s))),a=i.questions.slice().map((e=>(e.id===t&&(e.answer=n),e))),r={...i,questions:a};return yield Object(L.d)(B.a.updateAssessment(r)),yield Object(L.a)(G.d,"Saved!",1e3),yield Object(L.d)(B.a.updateHasUnsavedChanges("assessment",!1))})),yield Object(L.h)(D.e,(function*(e){const t=e.payload,n=(yield Object(L.f)((e=>e.session.assessmentOverviews))).map((e=>e.id===t?{...e,status:D.a.submitted}:e));return yield Object(L.a)(G.d,"Submitted!",2e3),yield Object(L.d)(B.a.updateAssessmentOverviews(n))})),yield Object(L.h)(P.m,(function*(e){const t=yield Object(L.f)((e=>e.session.accessToken)),n=e.payload,s=yield Object(L.a)((()=>((e,t)=>{const n=[c.a.Admin,c.a.Staff],s=Y(e);return null!==s&&n.includes(s)?t?[te[0]]:te.sort(((e,t)=>e.assessmentId!==t.assessmentId?t.assessmentId-e.assessmentId:t.submissionId-e.submissionId)):null})(t,n)));null!==s&&(yield Object(L.d)(B.a.updateGradingOverviews([...s])))})),yield Object(L.h)(P.l,(function*(e){const t=e.payload,n=yield Object(L.f)((e=>e.session.accessToken)),s=yield Object(L.a)((()=>((e,t)=>{const n=[c.a.Admin,c.a.Staff],s=Y(e);return null!==s&&n.includes(s)?ne:null})(n)));null!==s&&(yield Object(L.d)(B.a.updateGrading(t,[...s])))})),yield Object(L.h)(P.M,(function*(e){const{submissionId:t}=e.payload,n=yield Object(L.f)((e=>e.session.gradingOverviews||[]));if(-1===n.findIndex((e=>e.submissionId===t&&"submitted"===e.submissionStatus)))return void(yield Object(L.a)(G.e,"400: Bad Request"));const s=n.map((e=>e.submissionId===t?{...e,submissionStatus:"attempted"}:e));yield Object(L.a)(G.d,"Unsubmit successful!",1e3),yield Object(L.d)(B.a.updateGradingOverviews(s))}));const t=function*(e){if((yield Object(L.f)((e=>e.session.role)))===c.a.Student)return yield Object(L.a)(G.e,"Only staff can submit answers.");const{submissionId:t,questionId:n,xpAdjustment:s,comments:i}=e.payload,a=(yield Object(L.f)((e=>e.session.gradings.get(t)))).slice().map((e=>(e.question.id===n&&(e.grade={xpAdjustment:s,xp:e.grade.xp,comments:i}),e)));yield Object(L.d)(B.a.updateGrading(t,a)),yield Object(L.a)(G.d,"Submitted!",1e3)};yield Object(L.h)(P.K,t),yield Object(L.h)(P.L,(function*(e){const{submissionId:n}=e.payload;yield*t(e);const[s,i]=yield Object(L.f)((e=>[e.workspaces.grading.currentQuestion,e.session.courseId]));yield U.a.push(`/courses/${i}/grading/${n}/${(s||0)+1}`)})),yield Object(L.h)(P.n,(function*(e){yield Object(L.d)(B.a.updateNotifications([...ee]))})),yield Object(L.h)(P.a,(function*(e){const t=e.payload.withFilter,n=yield Object(L.f)((e=>e.session.notifications));let s=n;if(t&&(s=t(n)),0===s.length)return;const i=s.map((e=>e.id)),a=n.filter((e=>!i.includes(e.id)));yield Object(L.d)(B.a.updateNotifications(a))})),yield Object(L.h)(P.V,(function*(e){const{courseId:t}=e.payload,n=t-1,s={...Z[n]};yield Object(L.d)(B.a.setCourseConfiguration(s)),yield Object(L.d)(B.a.setAssessmentConfigurations([...H[n]])),yield Object(L.d)(B.a.setCourseRegistration({...Q[n]})),yield Object(L.d)(B.a.updateSublanguage({chapter:s.sourceChapter,variant:s.sourceVariant,displayName:Object(c.o)(s.sourceChapter,s.sourceVariant)})),yield Object(L.a)(G.d,`Switched to ${s.courseName}!`,5e3)})),yield Object(L.h)(P.R,(function*(e){const t=e.payload;yield Object(L.d)(B.a.setCourseConfiguration(t)),yield Object(L.a)(G.d,"Updated successfully!",1e3)})),yield Object(L.h)(P.P,(function*(e){const t=e.payload;yield Object(L.d)(B.a.setAssessmentConfigurations(t)),yield Object(L.a)(G.d,"Updated successfully!",1e3)})),yield Object(L.h)(P.d,(function*(e){const t=[...J];yield Object(L.d)(B.a.setAdminPanelCourseRegistrations(t))})),yield Object(L.h)(g.a,(function*(){yield Object(L.d)(B.a.updateGroupGradingSummary({...se}))}))}var ae=n(255),re=n(155),oe=n(73);function ce(e,t){if(e.meta.type===h.l.EVENT&&(n=e.meta,!Object(oe.a)(n.deadline)&&Object(oe.b)(n.release)&&Object(oe.c)(n.observeFrom,n.observeTo)))for(let s=0;s<e.meta.eventNames.length;s++)for(let n=0;n<t.length;n++)if(e.meta.eventNames[s]===t[n])return!0;var n;return!1}var le=n(30),de=n(1167);function ue(e){de.a(e),console.error(e)}function he(e){return e&&"function"===typeof e.next&&"function"===typeof e.throw}function pe(e,t){function*n(){try{const e=t(...arguments);he(e)&&(yield*e)}catch(e){ue(e)}}for(var s=arguments.length,i=new Array(s>2?s-2:0),a=2;a<s;a++)i[a-2]=arguments[a];return Object(L.h)(e,n,...i)}function ge(e,t){function*n(){try{const e=t(...arguments);he(e)&&(yield*e)}catch(e){ue(e)}}for(var s=arguments.length,i=new Array(s>2?s-2:0),a=2;a<s;a++)i[a-2]=arguments[a];return Object(L.i)(e,n,...i)}function me(){return Object(L.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken})))}function*be(){yield pe(h.c,(function*(e){const t=yield me(),n=e.payload;yield Object(L.a)(le.a,n,t)})),yield pe(h.d,(function*(e){const t=yield me(),n=e.payload;yield Object(L.a)(le.b,n,t)})),yield pe(h.g,(function*(){const e=yield me(),t=yield Object(L.a)(le.f,e);t&&(yield Object(L.d)(B.a.saveAchievements(t)))})),yield pe(h.h,(function*(e){const t=yield me(),n=e.payload,s=yield Object(L.a)(le.n,t,n);s&&(yield Object(L.d)(B.a.saveGoals(s)))})),yield pe(h.i,(function*(e){const t=yield me(),n=yield Object(L.a)(le.t,t);n&&(yield Object(L.d)(B.a.saveGoals(n)))})),yield pe(h.j,(function*(e){const t=yield me(),n=yield Object(L.a)(le.h,t);n&&(yield Object(L.d)(B.a.saveUsers(n)))})),yield pe(h.n,(function*(e){const t=yield me(),n=e.payload;yield Object(L.a)(le.Q,n,t)})),yield pe(h.o,(function*(e){const t=yield me(),n=e.payload;yield Object(L.a)(le.S,n,t)})),yield pe(h.u,(function*(e){const t=yield me(),n=e.payload;yield Object(L.a)(le.X,n,t)})),yield pe(h.t,(function*(e){const t=yield me(),{studentCourseRegId:n,progress:s}=e.payload,i=yield Object(L.a)(le.W,n,s,t);i&&i.ok&&(yield Object(L.d)(B.a.getGoals(n)),Object(ae.b)())}));let e=[],t=!1;yield pe(h.a,(function*(n){const s=yield Object(L.f)((e=>e.session.role)),i=yield Object(L.f)((e=>e.session.enableAchievements));s&&i&&!T.b.playgroundOnly&&(e.push(n.payload),!t&&s&&(t=!0,yield Object(L.b)(3e3),t=!1,yield Object(L.d)(B.a.handleEvent(e)),e=[]))})),yield pe(h.m,(function*(e){const t=yield me(),n=yield Object(L.a)(le.f,t);n&&(yield Object(L.d)(B.a.saveAchievements(n)));const s=yield Object(L.a)(le.t,t);if(!s)return;yield Object(L.d)(B.a.saveGoals(s));const i=yield Object(L.f)((e=>e.achievement.achievements)),a=yield Object(L.f)((e=>e.achievement.goals)),r=new re.a(i,a),o=e.payload,c=new Set;o.forEach((e=>{a.filter((t=>ce(t,e))).map((e=>e.uuid)).forEach((e=>{!function(e,t){const n={...t.getGoalProgress(e)};n.count=n.count+1;const s=n.completed;n.completed=n.count>=n.targetCount;const i=[];if(!s&&n.completed){const n=t.getAchievementsByGoal(e);for(const e of n)t.isCompleted(t.getAchievement(e))||i.push(e)}t.modifyGoalProgress(n);for(const a of i){const e=t.getAchievement(a);t.isCompleted(e)&&Object(G.d)("Completed acheivement: "+e.title)}}(e,r),c.add(e)}))}));for(const l of c){if(!(yield Object(L.a)(le.X,r.getGoalProgress(l),t)))return}})),yield pe(h.k,(function*(e){const t=yield me(),n=yield Object(L.a)(le.x,e.payload,t);n&&(yield Object(L.d)(B.a.saveUserAssessmentOverviews(n)))}))}var fe=n(142);function ve(e){const t=T.b.authProviders.get(e);if(!t)return;const n=""===window.location.port?"":`:${window.location.port}`;return`${window.location.protocol}//${window.location.hostname}${n}/login${t.isDefault?"":"?provider="+encodeURIComponent(e)}`}function ye(){return Object(L.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken})))}function*je(e){return e&&e.ok?yield Object(L.a)(G.d,"Autograde job queued successfully."):e&&400===e.status?yield Object(L.a)(G.e,"Cannot reautograde non-submitted submission."):yield Object(L.a)(G.e,"Failed to queue autograde job.")}var xe=function*(){yield pe(P.j,(function*(e){const{code:t,providerId:n}=e.payload,s=n||([...T.b.authProviders.entries()].find((e=>{let[t,{isDefault:n}]=e;return n}))||[null])[0];if(!s)return yield Object(L.a)(G.e,"Could not log in; invalid provider or no providers configured."),yield U.a.push("/");const i=function(e){const t=T.b.authProviders.get(e);if(t)try{return new URL(t.endpoint).searchParams.get("client_id")||void 0}catch(n){return t.endpoint||void 0}}(s),a=ve(s),r=yield Object(L.a)(le.D,t,s,i,a);if(!r)return yield U.a.push("/");yield Object(L.d)(B.a.setTokens(r));const{user:o,courseRegistration:c,courseConfiguration:l,assessmentConfigurations:d}=yield Object(L.a)(le.w,r);return o?(yield Object(L.d)(B.a.setUser(o)),null===l&&o.courses.length>0&&(yield Object(L.d)(B.a.updateLatestViewedCourse(o.courses[0].courseId))),c&&l&&d?(yield Object(L.d)(B.a.setCourseRegistration(c)),yield Object(L.d)(B.a.setCourseConfiguration(l)),yield Object(L.d)(B.a.setAssessmentConfigurations(d)),yield U.a.push(`/courses/${c.courseId}`)):yield U.a.push("/welcome")):void 0})),yield pe(P.q,(function*(e){const t=yield ye(),{user:n,courseRegistration:s,courseConfiguration:i,assessmentConfigurations:a}=yield Object(L.a)(le.w,t);n&&(yield Object(L.d)(B.a.setUser(n)),null===i&&n.courses.length>0&&(yield Object(L.d)(B.a.updateLatestViewedCourse(n.courses[0].courseId))),s&&i&&a&&(yield Object(L.d)(B.a.setCourseRegistration(s)),yield Object(L.d)(B.a.setCourseConfiguration(i)),yield Object(L.d)(B.a.setAssessmentConfigurations(a))))})),yield pe(P.k,(function*(){const e=yield ye(),{config:t}=yield Object(L.a)(le.l,e);t&&(yield Object(L.d)(B.a.setCourseConfiguration(t)))})),yield pe(D.b,(function*(){const e=yield ye(),t=yield Object(L.a)(le.k,e);t&&(yield Object(L.d)(B.a.updateAssessmentOverviews(t)))})),yield pe(P.e,(function*(){const e=yield ye(),t=yield Object(L.a)(le.g,e);t&&(yield Object(L.d)(B.a.updateAllUserXp(t.all_users_xp)))})),yield pe(P.o,(function*(){const e=yield ye(),t=yield Object(L.a)(le.v,e);t&&(yield Object(L.d)(B.a.updateTotalXp(t.totalXp)))})),yield pe(P.p,(function*(e){const t=yield ye(),n=e.payload,s=yield Object(L.a)(le.v,t,n);s&&(yield Object(L.d)(B.a.updateTotalXp(s.totalXp)))})),yield pe(P.f,(function*(e){const t=yield ye(),n=e.payload,s=yield Object(L.a)(le.i,n,t);s&&(yield Object(L.d)(B.a.updateAssessment(s)))})),yield pe(P.g,(function*(e){const t=yield ye(),{assessmentId:n,courseRegId:s}=e.payload,i=yield Object(L.a)(le.i,n,t,s);i&&(yield Object(L.d)(B.a.updateAssessment(i)))})),yield pe(P.I,(function*(e){const t=yield ye(),n=e.payload.id,s=e.payload.answer,i=yield Object(L.a)(le.B,n,s,t);if(!i||!i.ok)return yield Object(le.z)(i);yield Object(L.a)(G.d,"Saved!",1e3);const a=yield Object(L.f)((e=>e.workspaces.assessment.currentAssessment)),r=yield Object(L.f)((e=>e.session.assessments.get(a))),o=r.questions.slice().map((e=>e.id===n?{...e,answer:s}:e)),c={...r,questions:o};return yield Object(L.d)(B.a.updateAssessment(c)),yield Object(L.d)(B.a.updateHasUnsavedChanges("assessment",!1))})),yield pe(D.e,(function*(e){const t=yield ye(),n=e.payload,s=yield Object(L.a)(le.C,n,t);if(!s||!s.ok)return yield Object(le.z)(s);yield Object(L.a)(G.d,"Submitted!",2e3);const i=(yield Object(L.f)((e=>e.session.assessmentOverviews))).map((e=>e.id===n?{...e,status:D.a.submitted}:e));return yield Object(L.d)(B.a.updateAssessmentOverviews(i))})),yield pe(P.m,(function*(e){const t=yield ye(),n=e.payload,s=yield Object(L.a)(le.p,t,n);s&&(yield Object(L.d)(B.a.updateGradingOverviews(s)))})),yield pe(P.l,(function*(e){const t=yield ye(),n=e.payload,s=yield Object(L.a)(le.o,n,t);s&&(yield Object(L.d)(B.a.updateGrading(n,s)))})),yield pe(P.M,(function*(e){const t=yield ye(),{submissionId:n}=e.payload,s=yield Object(le.J)(n,t);if(!s||!s.ok)return yield Object(le.z)(s);const i=(yield Object(L.f)((e=>e.session.gradingOverviews||[]))).map((e=>e.submissionId===n?{...e,submissionStatus:"attempted"}:e));yield Object(L.a)(G.d,"Unsubmit successful",1e3),yield Object(L.d)(B.a.updateGradingOverviews(i))}));const e=function*(e){if((yield Object(L.f)((e=>e.session.role)))===c.a.Student)return yield Object(L.a)(G.e,"Only staff can submit answers.");const{submissionId:t,questionId:n,xpAdjustment:s,comments:i}=e.payload,a=yield ye(),r=yield Object(le.F)(t,n,s,a,i);if(!r||!r.ok)return yield Object(le.z)(r);yield Object(L.a)(G.d,"Submitted!",1e3);const o=(yield Object(L.f)((e=>e.session.gradings.get(t)))).slice().map((e=>(e.question.id===n&&(e.grade={xpAdjustment:s,xp:e.grade.xp,comments:i}),e)));yield Object(L.d)(B.a.updateGrading(t,o))};yield pe(P.K,e),yield pe(P.L,(function*(t){yield*e(t);const{submissionId:n}=t.payload,[s,i]=yield Object(L.f)((e=>[e.workspaces.grading.currentQuestion,e.session.courseId]));yield U.a.push(`/courses/${i}/grading/${n}/${(s||0)+1}`)})),yield pe(P.w,(function*(e){const t=e.payload,n=yield ye(),s=yield Object(L.a)(le.H,t,n);yield Object(L.a)(je,s)})),yield pe(P.v,(function*(e){const{submissionId:t,questionId:n}=e.payload,s=yield ye(),i=yield Object(L.a)(le.G,t,n,s);yield Object(L.a)(je,i)})),yield pe(P.n,(function*(e){const t=yield ye(),n=yield Object(L.a)(le.s,t);yield Object(L.d)(B.a.updateNotifications(n))})),yield pe(P.a,(function*(e){const t=yield ye(),n=e.payload.withFilter,s=yield Object(L.f)((e=>e.session.notifications));let i=s;if(n&&(i=n(s)),0===i.length)return;const a=i.map((e=>e.id)),r=s.filter((e=>!a.includes(e.id)));yield Object(L.d)(B.a.updateNotifications(r));const o=yield Object(L.a)(le.A,t,a);return o&&o.ok?void 0:yield Object(le.z)(o)})),yield pe(O.a,(function*(e){if((yield Object(L.f)((e=>e.session.role)))===c.a.Student)return yield Object(L.a)(G.e,"Only staff can delete sourcecasts.");const t=yield ye(),{id:n}=e.payload,s=yield Object(le.d)(n,t);if(!s||!s.ok)return yield Object(le.z)(s);const i=yield Object(L.a)(le.u,t);i&&(yield Object(L.d)(B.a.updateSourcecastIndex(i,e.payload.workspaceLocation))),yield Object(L.a)(G.d,"Deleted successfully!",1e3)})),yield pe(j.a,(function*(e){const t=yield ye(),n=yield Object(L.a)(le.u,t);n&&(yield Object(L.d)(B.a.updateSourcecastIndex(n,e.payload.workspaceLocation)))})),yield pe(y.d,(function*(e){const[t,n]=yield Object(L.f)((e=>[e.session.role,e.session.courseId]));if(t===c.a.Student)return yield Object(L.a)(G.e,"Only staff can save sourcecasts.");const{title:s,description:i,uid:a,audio:r,playbackData:o}=e.payload,l=yield ye(),d=yield Object(le.I)(s,i,a,r,o,l);if(!d||!d.ok)return yield Object(le.z)(d);yield Object(L.a)(G.d,"Saved successfully!",1e3),yield U.a.push(`/courses/${n}/sourcecast`)})),yield pe(A.i,(function*(e){const t=yield ye(),{sublang:n}=e.payload,s=yield Object(L.a)(le.L,t,{sourceChapter:n.chapter,sourceVariant:n.variant});if(!s||!s.ok)return yield Object(le.z)(s);yield Object(L.d)(B.a.setCourseConfiguration({sourceChapter:n.chapter,sourceVariant:n.variant})),yield Object(L.a)(G.d,"Updated successfully!",1e3)})),yield pe(P.V,(function*(e){const t=yield ye(),{courseId:n}=e.payload,s=yield Object(L.a)(le.N,t,n);if(!s||!s.ok)return yield Object(le.z)(s);const{courseRegistration:i,courseConfiguration:a,assessmentConfigurations:r}=yield Object(L.a)(le.r,t);if(!i||!a||!r)return yield Object(L.a)(G.e,"Failed to load course!"),yield U.a.push("/welcome");yield Object(L.d)(B.a.setCourseConfiguration(a)),yield Object(L.d)(B.a.setAssessmentConfigurations(r)),yield Object(L.d)(B.a.setCourseRegistration(i)),yield Object(L.a)(G.d,`Switched to ${a.courseName}!`,5e3)})),yield pe(P.R,(function*(e){const t=yield ye(),n=e.payload,s=yield Object(L.a)(le.L,t,n);if(!s||!s.ok)return yield Object(le.z)(s);yield Object(L.d)(B.a.setCourseConfiguration(n)),yield Object(L.a)(G.d,"Updated successfully!",1e3)})),yield pe(P.h,(function*(){const e=yield ye(),t=yield Object(L.a)(le.j,e);t&&(yield Object(L.d)(B.a.setAssessmentConfigurations(t)))})),yield pe(P.P,(function*(e){const t=yield ye(),n=e.payload,s=yield Object(L.a)(le.K,t,n);if(!s||!s.ok)return yield Object(le.z)(s);const i=yield Object(L.a)(le.j,t);i&&(yield Object(L.d)(B.a.setAssessmentConfigurations(i))),yield Object(L.a)(G.d,"Updated successfully!",1e3)})),yield pe(P.b,(function*(e){const t=yield ye(),n=e.payload,s=yield Object(L.a)(le.R,t,n);if(!s||!s.ok)return yield Object(le.z)(s)})),yield pe(P.d,(function*(e){const t=yield ye(),n=yield Object(L.a)(le.y,t);n&&(yield Object(L.d)(B.a.setAdminPanelCourseRegistrations(n)))})),yield pe(d.b,(function*(e){const t=yield ye(),n=e.payload,s=yield Object(L.a)(le.E,t,n);if(!s||!s.ok)return yield Object(le.z)(s);const{user:i,courseRegistration:a,courseConfiguration:r}=yield Object(L.a)(le.w,t);if(!i||!a||!r)return yield Object(G.e)("An error occurred. Please try again.");yield Object(L.d)(B.a.setUser(i)),yield Object(L.d)(B.a.setCourseRegistration({role:c.a.Student}));const o=yield Object(L.a)(le.K,t,[{type:"Missions",assessmentConfigId:-1,isManuallyGraded:!0,displayInDashboard:!0,hoursBeforeEarlyXpDecay:0,earlySubmissionXp:0}],a.courseId);if(!o||!o.ok)return yield Object(le.z)(s);yield Object(L.a)(G.d,"Successfully created your new course!"),yield Object(L.a)([U.a,"push"],`/courses/${a.courseId}`)})),yield pe(d.a,(function*(e){const t=yield ye(),{users:n,provider:s}=e.payload,i=yield Object(L.a)(le.O,t,n,s);if(!i||!i.ok)return yield Object(le.z)(i);yield Object(L.d)(B.a.fetchAdminPanelCourseRegistrations()),yield Object(L.a)(G.d,"Users added!")})),yield pe(P.Y,(function*(e){const t=yield ye(),{courseRegId:n,role:s}=e.payload,i=yield Object(L.a)(le.P,t,n,s);if(!i||!i.ok)return yield Object(le.z)(i);yield Object(L.d)(B.a.fetchAdminPanelCourseRegistrations()),yield Object(L.a)(G.d,"Role updated!")})),yield pe(P.S,(function*(e){const t=yield ye(),{agreedToResearch:n}=e.payload,s=yield Object(L.a)(le.M,t,n);if(!s||!s.ok)return yield Object(le.z)(s);yield Object(L.d)(B.a.setCourseRegistration({agreedToResearch:n})),yield Object(L.a)(G.d,"Research preference saved!")})),yield pe(P.c,(function*(e){const t=yield ye(),{courseRegId:n}=e.payload,s=yield Object(L.a)(le.T,t,n);if(!s||!s.ok)return yield Object(le.z)(s);yield Object(L.d)(B.a.fetchAdminPanelCourseRegistrations()),yield Object(L.a)(G.d,"User deleted!")})),yield pe(g.a,(function*(e){const t=yield ye(),n=yield Object(L.a)(le.q,t);n&&(yield Object(L.d)(B.a.updateGroupGradingSummary(n)))})),yield pe(fe.a,(function*(e){const t=yield ye(),n=e.payload.id,s=e.payload.closeAt,i=e.payload.openAt,a=yield Object(le.V)(n,{openAt:i,closeAt:s},t);if(!a||!a.ok)return yield Object(le.z)(a);yield Object(L.d)(B.a.fetchAssessmentOverviews()),yield Object(L.a)(G.d,"Updated successfully!",1e3)})),yield pe(fe.b,(function*(e){const t=yield ye(),n=e.payload,s=yield Object(le.c)(n,t);if(!s||!s.ok)return yield Object(le.z)(s);yield Object(L.d)(B.a.fetchAssessmentOverviews()),yield Object(L.a)(G.d,"Deleted successfully!",1e3)})),yield pe(fe.c,(function*(e){const t=yield ye(),n=e.payload.id,s=e.payload.togglePublishTo,i=yield Object(le.V)(n,{isPublished:s},t);if(!i||!i.ok)return yield Object(le.z)(i);yield Object(L.d)(B.a.fetchAssessmentOverviews()),s?yield Object(L.a)(G.d,"Published successfully!",1e3):yield Object(L.a)(G.d,"Unpublished successfully!",1e3)})),yield pe(fe.d,(function*(e){const t=yield ye(),{file:n,forceUpdate:s,assessmentConfigId:i}=e.payload,a=yield Object(le.Y)(n,t,s,i);if(!a||!a.ok)return yield Object(le.z)(a);const r=yield a.text();"OK"===r?yield Object(L.a)(G.d,"Uploaded successfully!",2e3):"Force Update OK"===r&&(yield Object(L.a)(G.d,"Assessment force updated successfully!",2e3)),yield Object(L.d)(B.a.fetchAssessmentOverviews())}))};var Oe=n(70),Se=n(41),we=n(3),Ce=n(98),Ee=n(19),Te=n.n(Ee),ke=n(1);class Ae{constructor(e,t){this.childrenRetrieved=!1,this.filePath="dummy_path",this.fileType="unset",this.filePath=e,this.fileType=t}}class _e{static async getFirstLayerRepoFileNodes(e){return""===e?[]:(_e.fileIndex=0,_e.currentRepoName=e,await _e.getChildNodes(e,""))}static async getChildNodes(e,t){const n=[];if(e!==_e.currentRepoName)return n;const s=Oe.f();if(void 0===s)return n;try{const i=(await s.users.getAuthenticated()).data.login,a=(await s.repos.getContent({owner:i,repo:e,path:t})).data;Array.isArray(a)&&a.forEach((e=>{n.push(this.createNode(e))}))}catch(i){console.error(i)}return n}static createNode(e){const t=_e.fileIndex;let n={id:t,label:"dummy file"};return"file"===e.type&&(n={id:t,nodeData:new Ae(e.path,"file"),icon:"document",label:e.name}),"dir"===e.type&&(n={id:t,nodeData:new Ae(e.path,"dir"),icon:"folder-close",label:e.name,childNodes:[]}),_e.fileIndex++,n}}_e.fileIndex=0,_e.currentRepoName="";var Ie=n(0);var Ne=e=>{const[t,n]=Object(ke.useState)([]),[s,i]=Object(ke.useState)(""),[a,r]=Object(ke.useState)("");return Object(ke.useEffect)((()=>{!async function(e,t){try{t(await _e.getFirstLayerRepoFileNodes(e))}catch(n){console.error(n)}}(e.repoName,n)}),[e.repoName]),Object(Ie.jsxs)(Se.h,{className:"githubDialog",isOpen:!0,onClose:o,children:[Object(Ie.jsx)("div",{className:Te()("githubDialogHeader",we.a.DIALOG_HEADER),children:Object(Ie.jsx)("h3",{children:"Select a File"})}),Object(Ie.jsxs)("div",{className:we.a.DIALOG_BODY,children:[Object(Ie.jsx)(Se.bb,{contents:t,onNodeClick:async function(e,s,a){const r=e.isSelected,o=await c(t,e,(e=>e.isSelected=!1),(e=>{e.isSelected=null===r||!r;const t=void 0!==e.nodeData&&e.isSelected?e.nodeData.filePath:"";i(t)}));null!==o&&n(o)},onNodeCollapse:async function(e){const s=await c(t,e,(e=>{}),(e=>e.isExpanded=!1));null!==s&&n(s)},onNodeExpand:async function(s){const i=await c(t,s,(e=>{}),(async t=>{t.isExpanded=!0,void 0===t.nodeData||t.nodeData.childrenRetrieved||(t.childNodes=await _e.getChildNodes(e.repoName,t.nodeData.filePath),t.nodeData.childrenRetrieved=!0)}));null!==i&&n(i)},className:Te()("FileTree",we.a.ELEVATION_0)}),"Save"===e.pickerType&&Object(Ie.jsxs)("div",{children:[Object(Ie.jsx)(Se.y,{id:"FileNameTextBox",onChange:function(e){i(e.target.value)},onClick:function(e){""===s&&i(".js")},placeholder:"Enter File Name",value:s}),Object(Ie.jsx)(Se.y,{onChange:function(e){r(e.target.value)},placeholder:"Enter Commit Message",value:a})]})]}),Object(Ie.jsx)("div",{className:we.a.DIALOG_FOOTER,children:Object(Ie.jsxs)("div",{className:we.a.DIALOG_FOOTER_ACTIONS,children:[Object(Ie.jsx)(Se.b,{onClick:o,children:"Close"}),Object(Ie.jsx)(Se.a,{onClick:async function(){const t=await e.octokit.users.getAuthenticated(),n=t.data.login,i=t.data.name,r=t.data.email;"Open"===e.pickerType&&await Object(Oe.a)(e.octokit,n,e.repoName,s)&&await Object(Oe.c)()&&Object(Oe.g)(e.octokit,n,e.repoName,s);if("Save"===e.pickerType){const{canBeSaved:t,saveType:o}=await Object(Oe.b)(e.octokit,n,e.repoName,s);t&&("Overwrite"===o&&await Object(Oe.d)()&&Object(Oe.j)(e.octokit,n,e.repoName,s,i,r,a,e.editorContent),"Create"===o&&Object(Oe.h)(e.octokit,n,e.repoName,s,i,r,a,e.editorContent))}e.onSubmit("")},intent:Ce.a.PRIMARY,text:e.pickerType})]})})]});function o(){e.onSubmit("")}async function c(e,t,n,s){if(null===e)return null;const i=[];for(let a=0;a<e.length;a++){const r=e[a],o=Object.assign({},r);if(await n(o),t===r&&await s(o),void 0!==o.childNodes){const e=await c(o.childNodes,t,n,s);null!==e&&(o.childNodes=e)}i.push(o)}return i}};var Pe=e=>{const[t,n]=Object(ke.useState)("");return Object(Ie.jsxs)(Se.h,{className:"githubDialog",isOpen:!0,onClose:s,children:[Object(Ie.jsx)("div",{className:Te()("githubDialogHeader",we.a.DIALOG_HEADER),children:Object(Ie.jsx)("h3",{children:"Select a Repository"})}),Object(Ie.jsx)("div",{className:we.a.DIALOG_BODY,children:Object(Ie.jsx)(Se.P,{className:"RepositoryRadioGroup",onChange:function(e){n(e.target.value)},selectedValue:t,children:e.userRepos.map((e=>Object(Ie.jsx)(Se.O,{label:e.name,value:e.name},e.id)))})}),Object(Ie.jsx)("div",{className:Te()(we.a.DIALOG_FOOTER),children:Object(Ie.jsxs)("div",{className:Te()(we.a.DIALOG_FOOTER_ACTIONS),children:[Object(Ie.jsx)(Se.b,{onClick:s,children:"Close"}),Object(Ie.jsx)(Se.a,{onClick:function(){""===t?Object(G.e)("No repository selected!",1e3):e.onSubmit(t)},intent:Ce.a.PRIMARY,children:"Select"})]})})]});function s(){e.onSubmit("")}},Re=n(68);function*Me(){const e=`https://github.com/login/oauth/authorize?client_id=${T.b.githubClientId}&scope=repo`,t="Connect With OAuth",n="height=600,width=400";new BroadcastChannel("GitHubOAuthAccessToken").onmessage=e=>{Mt.dispatch(B.a.setGitHubOctokitObject(e.data)),Mt.dispatch(B.a.setGitHubAccessToken(e.data)),Object(G.d)("Logged in to GitHub",1e3)},T.b.githubClientId?yield Object(L.a)(window.open,e,t,n):yield Object(L.a)(window.open,"/callback/github",t,n)}function*Le(){Mt.getState()&&Mt.getState().workspaces.githubAssessment.hasUnsavedChanges?yield Object(L.a)(G.e,"You have unsaved changes!",2e3):(yield Object(L.d)(B.a.removeGitHubOctokitObjectAndAccessToken()),yield Object(L.a)(G.d,"Logged out from GitHub",1e3))}function*De(){const e=Oe.f();if(void 0===e)return;const t=yield Object(L.a)((async()=>await e.paginate(e.repos.listForAuthenticatedUser,{per_page:100}))),n=yield Object(L.a)((async()=>await Object(Re.a)(Pe,(e=>({userRepos:t,onSubmit:e})))));if(""!==n){const t="Open",s=async()=>await Object(Re.a)(Ne,(s=>({repoName:n,pickerType:t,octokit:e,editorContent:"",onSubmit:s})));yield Object(L.a)(s)}}function*Be(){const e=Object(Oe.f)();if(void 0===e)return;const t=yield Object(L.a)(e.users.getAuthenticated),n=t.data.login,s=Mt.getState().playground.githubSaveInfo.repoName,i=Mt.getState().playground.githubSaveInfo.filePath,a=t.data.email,r=t.data.name,o=Mt.getState().workspaces.playground.editorTabs[0].value;Oe.j(e,n,s,i,a,r,"Changes made from Source Academy",o)}function*Ue(){const e=Oe.f();if(void 0===e)return;const t=yield Object(L.a)((async()=>await e.paginate(e.repos.listForAuthenticatedUser,{per_page:100}))),n=yield Object(L.a)((async()=>await Object(Re.a)(Pe,(e=>({userRepos:t,onSubmit:e}))))),s=Mt.getState().workspaces.playground.editorTabs[0].value;if(""!==n){const t="Save",i=async()=>await Object(Re.a)(Ne,(i=>({repoName:n,pickerType:t,octokit:e,editorContent:s,onSubmit:i})));yield Object(L.a)(i)}}var Ge=function*(){yield Object(L.i)(P.s,Me),yield Object(L.i)(P.t,Le),yield Object(L.i)("GITHUB_OPEN_FILE",De),yield Object(L.i)("GITHUB_SAVE_FILE",Be),yield Object(L.i)("GITHUB_SAVE_FILE_AS",Ue)};function*Fe(){yield pe(P.r,He),yield pe(P.H,(e=>{de.b({id:e.payload.userId.toString()})})),yield pe(l.a,(()=>{de.b(null)}))}function He(e){let{payload:t}=e;return function*(){const e=function(e){const t=T.b.authProviders.get(e);if(t)try{const n=new URL(t.endpoint);return n.searchParams.set("redirect_uri",ve(e)),n.toString()}catch(n){return t.endpoint||""}}(t);e?window.location.href=e:yield Object(L.a)(G.e,"Could not log in; invalid provider name provided.")}()}var Ve=n(143);const We=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],$e="https://www.googleapis.com/upload/drive/v3/files",Xe="text/plain";let qe;const ze=new Promise((e=>{qe=e})).then((async function(){await new Promise(((e,t)=>gapi.load("client:auth2",{callback:e,onerror:t}))),await gapi.client.init({apiKey:T.b.googleApiKey,clientId:T.b.googleClientId,discoveryDocs:We,scope:"profile https://www.googleapis.com/auth/drive.file"}),gapi.auth2.getAuthInstance().currentUser.listen(Ye),Ye(gapi.auth2.getAuthInstance().currentUser.get())}));function Ye(e){Mt.dispatch(B.a.setGoogleUser(e.isSignedIn()?e.getBasicProfile().getEmail():void 0))}function*Ke(){qe(),yield ze}function*Qe(){yield Object(L.a)(Ke),gapi.auth2.getAuthInstance().isSignedIn.get()||(yield gapi.auth2.getAuthInstance().signIn())}function Je(e,t){const n="undefined"!==typeof(null===t||void 0===t?void 0:t.pickFolders)&&(null===t||void 0===t?void 0:t.pickFolders),s="undefined"===typeof(null===t||void 0===t?void 0:t.showFolders)||(null===t||void 0===t?void 0:t.showFolders),i="undefined"===typeof(null===t||void 0===t?void 0:t.showFiles)||(null===t||void 0===t?void 0:t.showFiles);return new Promise((a=>{gapi.load("picker",(()=>{const r=new google.picker.DocsView(i?google.picker.ViewId.DOCS:google.picker.ViewId.FOLDERS);null!==t&&void 0!==t&&t.rootFolder&&r.setParent(t.rootFolder),r.setOwnedByMe(!0),r.setIncludeFolders(s),r.setSelectFolderEnabled(n),r.setMode(google.picker.DocsViewMode.LIST);(new google.picker.PickerBuilder).setTitle(e).enableFeature(google.picker.Feature.NAV_HIDDEN).addView(r).setOAuthToken(gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token).setAppId(T.b.googleAppId).setDeveloperKey(T.b.googleApiKey).setCallback((e=>{switch(e[google.picker.Response.ACTION]){case google.picker.Action.PICKED:{const{id:t,name:n,mimeType:s,parentId:i}=e.docs[0];a({id:t,name:n,mimeType:s,parentId:i,picked:!0});break}case google.picker.Action.CANCEL:a({picked:!1})}})).build().setVisible(!0)}))}))}function Ze(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4?arguments[4]:void 0;const a=e,r={name:a,mimeType:n,parents:[t],appProperties:{source:!0,...i}},{body:o,headers:c}=tt(r,s,n);return gapi.client.request({path:$e,method:"POST",params:{uploadType:"multipart"},headers:c,body:o}).then((e=>{let{result:t}=e;return{id:t.id,name:t.name}}))}function et(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4?arguments[4]:void 0;const a={name:t,mimeType:n,appProperties:{source:!0,...i}},{body:r,headers:o}=tt(a,s,n);return gapi.client.request({path:$e+"/"+e,method:"PATCH",params:{uploadType:"multipart"},headers:o,body:r})}function tt(e,t,n){const s=JSON.stringify(e);let i;do{i=nt()}while(s.includes(i)||t.includes(i));return{body:`--${i}\nContent-Type: application/json; charset=utf-8\n\n${JSON.stringify(e)}\n--${i}\nContent-Type: ${n}\n\n${t}\n--${i}--\n`,boundary:i,headers:{"Content-Type":`multipart/related; boundary=${i}`}}}function nt(){let e="--------------------------";for(let t=0;t<24;t++)e+=Math.floor(10*Math.random()).toString(16);return e}var st=function*(){yield ge(P.u,(function*(){yield Object(L.d)(B.a.playgroundUpdatePersistenceFile(void 0)),yield Object(L.a)(Ke),yield Object(L.a)([gapi.auth2.getAuthInstance(),"signOut"])})),yield ge(Ve.b,(function*(){let e;try{yield Object(L.a)(Qe);const{id:t,name:n,picked:i}=yield Object(L.a)(Je,"Pick a file to open");if(!i)return;if(!(yield Object(L.a)(Re.b,{title:"Opening from Google Drive",contents:Object(Ie.jsxs)("p",{children:["Opening ",Object(Ie.jsx)("strong",{children:n})," will overwrite the current contents of your workspace. Are you sure?"]}),positiveLabel:"Open",negativeLabel:"Cancel"})))return;e=yield Object(L.a)(G.c,{message:"Opening file...",timeout:0,intent:Ce.a.PRIMARY});const{result:a}=yield Object(L.a)([gapi.client.drive.files,"get"],{fileId:t,fields:"appProperties"}),r=yield Object(L.a)([gapi.client.drive.files,"get"],{fileId:t,alt:"media"});yield Object(L.d)(B.a.updateEditorValue(r.body,"playground")),yield Object(L.d)(B.a.playgroundUpdatePersistenceFile({id:t,name:n,lastSaved:new Date})),a&&a.appProperties&&(yield Object(L.d)(B.a.chapterSelect(parseInt(a.appProperties.chapter||"4",10),a.appProperties.variant||s.Variant.DEFAULT,"playground")),yield Object(L.d)(B.a.externalLibrarySelect(Object.values(F.a).find((e=>e===a.appProperties.external))||F.a.NONE,"playground"))),yield Object(L.a)(G.d,`Loaded ${n}.`,1e3)}catch(t){console.error(t),yield Object(L.a)(G.e,"Error while opening file.",1e3)}finally{e&&Object(G.a)(e)}})),yield ge(Ve.d,(function*(){let e;try{yield Object(L.a)(Qe);const[t,n,s]=yield Object(L.f)((e=>[e.workspaces.playground.editorTabs[0].value,e.workspaces.playground.context.variant,e.workspaces.playground.externalLibrary])),i=yield Object(L.a)(Je,"Pick a folder, or cancel to pick the root folder",{pickFolders:!0,showFolders:!0,showFiles:!1}),a=i.picked?i:{id:"root",name:"My Drive"},r=yield Object(L.a)(Je,`Saving to ${a.name}; pick a file to overwrite, or cancel to save as a new file`,{pickFolders:!1,showFolders:!1,showFiles:!0,rootFolder:a.id});if(r.picked){if(!(yield Object(L.a)(Re.b,{title:"Saving to Google Drive",contents:Object(Ie.jsxs)("span",{children:["Really overwrite ",Object(Ie.jsx)("strong",{children:r.name}),"?"]})})))return;yield Object(L.d)(B.a.playgroundUpdatePersistenceFile(r)),yield Object(L.d)(B.a.persistenceSaveFile(r))}else{const i=yield Object(L.a)(Re.c,{title:"Saving to Google Drive",contents:Object(Ie.jsxs)(Ie.Fragment,{children:[Object(Ie.jsxs)("p",{children:["Saving to folder ",Object(Ie.jsx)("strong",{children:a.name}),"."]}),Object(Ie.jsx)("p",{children:"Save as name?"})]}),positiveLabel:"Save as new file",negativeLabel:"Cancel",props:{validationFunction:e=>!!e}});if(!i.buttonResponse)return;const r={variant:n,external:s};e=yield Object(L.a)(G.c,{message:`Saving as ${i.value}...`,timeout:0,intent:Ce.a.PRIMARY});const o=yield Object(L.a)(Ze,i.value,a.id,Xe,t,r);yield Object(L.d)(B.a.playgroundUpdatePersistenceFile({...o,lastSaved:new Date})),yield Object(L.a)(G.d,`${i.value} successfully saved to Google Drive.`,1e3)}}catch(t){console.error(t),yield Object(L.a)(G.e,"Error while saving file.",1e3)}finally{e&&Object(G.a)(e)}})),yield pe(Ve.c,(function(e){let{payload:{id:t,name:n}}=e;return function*(){let e;try{e=yield Object(L.a)(G.c,{message:`Saving as ${n}...`,timeout:0,intent:Ce.a.PRIMARY}),yield Object(L.a)(Qe);const[s,i,a]=yield Object(L.f)((e=>[e.workspaces.playground.editorTabs[0].value,e.workspaces.playground.context.variant,e.workspaces.playground.externalLibrary])),r={variant:i,external:a};yield Object(L.a)(et,t,n,Xe,s,r),yield Object(L.d)(B.a.playgroundUpdatePersistenceFile({id:t,name:n,lastSaved:new Date})),yield Object(L.a)(G.d,`${n} successfully saved to Google Drive.`,1e3)}catch(s){console.error(s),yield Object(L.a)(G.e,"Error while saving file.",1e3)}finally{e&&Object(G.a)(e)}}()})),yield pe(Ve.a,Ke)},it=n(166),at=n(194),rt=n(122);function*ot(){yield pe(b.b,ct),yield pe(b.e,(function*(e){const t=yield Object(L.f)((e=>e.playground.queryString)),n=e.payload,s="ERROR";let i,a;try{const{result:e,hasTimedOut:s}=yield Object(L.e)({result:Object(L.a)(lt,t,n),hasTimedOut:Object(L.b)(1e4)});i=e,a=s}catch(r){}return!i||a?(yield Object(L.d)(Object(rt.updateShortURL)(s)),yield Object(L.a)(G.e,"Something went wrong trying to create the link.")):"success"===i.status||i.shorturl?("success"!==i.status&&(yield Object(L.a)(G.d,i.message)),void(yield Object(L.d)(Object(rt.updateShortURL)(T.b.urlShortenerBase+i.url.keyword)))):(yield Object(L.d)(Object(rt.updateShortURL)(s)),yield Object(L.a)(G.e,i.message))}))}function*ct(){const e=yield Object(L.f)((e=>e.workspaces.playground.editorTabs[0].value));if(!e||e===c.g)return void(yield Object(L.d)(Object(rt.changeQueryString)("")));const t=yield Object(L.f)((e=>e.workspaces.playground.context.variant)),n=yield Object(L.f)((e=>e.workspaces.playground.externalLibrary)),s=yield Object(L.f)((e=>e.workspaces.playground.execTime)),i=at.stringify({prgrm:Object(it.compressToEncodedURIComponent)(e),variant:t,ext:n,exec:s});yield Object(L.d)(Object(rt.changeQueryString)(i))}async function lt(e,t){const n=`${window.location.protocol}//${window.location.host}/playground#${e}`,s={signature:T.b.urlShortenerSignature,action:"shorturl",format:"json",keyword:t,url:n},i={method:"POST",body:Object.entries(s).reduce(((e,t)=>{let[n,s]=t;return e.append(n,s),e}),new FormData)},a=await fetch(`${T.b.urlShortenerBase}yourls-api.php`,i);if(!a||!a.ok)return null;return await a.json()}var dt=n(446),ut=n(136);const ht={start:{line:0,column:0},end:{line:0,column:0}};const pt="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",gt=()=>new Array(16).fill(void 0).map((e=>pt[Math.floor(Math.random()*pt.length)])).join("");var mt=function*(){yield ge(N.c,(function*(){const[e,t]=yield Object(L.f)((e=>[{accessToken:e.session.accessToken,refreshToken:e.session.refreshToken},e.session.remoteExecutionSession])),n=yield Object(L.a)(le.e,e);if(yield Object(L.d)(B.a.remoteExecUpdateDevices(n)),!t)return;const s=n.find((e=>{let{id:n}=e;return n===t.device.id}));s&&(yield Object(L.d)(B.a.remoteExecUpdateSession({...t,device:s})))})),yield pe(N.a,(function*(e){const[t,n]=yield Object(L.f)((e=>[{accessToken:e.session.accessToken,refreshToken:e.session.refreshToken},e.session.remoteExecutionSession])),{device:i,workspace:r}=e.payload;yield Object(L.d)(B.a.remoteExecUpdateSession({device:i,workspace:r,connection:{status:"CONNECTING"}}));const o=yield Object(L.a)(le.m,i,t);if(!o)return void(yield Object(L.d)(B.a.remoteExecUpdateSession({...e.payload,connection:{status:"FAILED",error:"Could not retrieve MQTT endpoint"}})));const c=null===n||void 0===n?void 0:n.connection.client;if(c)try{c.disconnect()}catch{}const l=new dt.SlingClient({clientId:`${o.clientNamePrefix}${gt()}`,deviceId:o.thingName,websocketEndpoint:o.endpoint});l.on("statusChange",(e=>{Mt.dispatch(B.a.updateWorkspace(r,{isRunning:e}))})),l.on("monitor",(e=>{const t=e[0].split(":")[1],n=`port${t.substring(t.length-1)}`,s=Mt.getState().session.remoteExecutionSession,i=e=>Mt.dispatch(B.a.remoteExecUpdateSession({...s,device:{...s.device,peripherals:{...a.a.pickBy(s.device.peripherals,(e=>Date.now()-e.lastUpdated<3e3)),[n]:{...e,lastUpdated:Date.now()}}}}));if(e[1].endsWith("motor")){i({type:e[1],position:parseInt(e[2]),speed:parseInt(e[3])})}else{i({type:e[1],mode:e[2],value:parseInt(e[3])})}})),l.on("display",((e,t)=>{switch(t){case"output":Mt.dispatch(B.a.handleConsoleLog(r,`${e}`));break;case"error":{const t=new ut.ExceptionError(new Error(`${e}`),ht);Mt.dispatch(B.a.evalInterpreterError([t],r));break}case"result":Mt.dispatch(B.a.evalInterpreterSuccess(e,r))}}));const d=N.i.get(i.type);yield Object(L.d)(B.a.remoteExecUpdateSession({device:i,workspace:r,connection:{status:"CONNECTING",client:l,endpoint:o}})),yield Object(L.d)(B.a.updateWorkspace(r,{isRunning:!1,isEditorAutorun:!1,isDebugging:!1,externalLibrary:null===d||void 0===d?void 0:d.deviceLibraryName,output:[]})),yield Object(L.d)(B.a.beginClearContext(r,{variant:s.Variant.DEFAULT,external:{name:(null===d||void 0===d?void 0:d.deviceLibraryName)||F.a.NONE,symbols:(null===d||void 0===d?void 0:d.internalFunctions)||[]},globals:[]},!1));try{const t=new Promise(((e,t)=>{try{l.once("connect",(()=>e(!0))),l.once("error",t),l.connect()}catch{t()}}));(yield Object(L.e)({connect:t,reconnect:Object(L.g)(N.a),disconnect:Object(L.g)(N.b)})).connect?yield Object(L.d)(B.a.remoteExecUpdateSession({...e.payload,connection:{status:"CONNECTED",client:l,endpoint:o}})):l.disconnect()}catch(u){l.disconnect(),yield Object(L.d)(B.a.remoteExecUpdateSession({...e.payload,connection:{status:"FAILED",client:l,error:u.toString()}}))}})),yield ge(N.b,(function*(e){const t=yield Object(L.f)((e=>e.session.remoteExecutionSession));if(!t)return;const n=t.connection.client;n&&n.disconnect(),yield Object(L.d)(B.a.remoteExecUpdateSession(void 0)),yield Object(L.d)(B.a.externalLibrarySelect(F.a.NONE,t.workspace,!0))})),yield pe(w.b,(function*(){const e=yield Object(L.f)((e=>e.session.remoteExecutionSession));e&&"CONNECTED"===e.connection.status&&e.connection.client.sendStop()}))},bt=n(91),ft=n(221),vt=n(149),yt=n.n(vt),jt=n(158),xt=n(195),Ot=n(261),St=n(13);function*wt(){let e;yield pe(A.a,(function*(e){yield Object(L.d)(B.a.handleConsoleLog(e.payload.workspaceLocation,e.payload.errorMsg))})),yield pe(A.k,(function*(e){const t=e.payload.workspaceLocation;yield*function*(e){const[t]=yield Object(L.f)((t=>[t.workspaces[e].editorTabs[0].value]));yield Object(L.d)(B.a.beginInterruptExecution(e)),yield*Tt(e,t),yield Object(L.d)(B.a.clearReplOutput(e));const n=yield Object(L.f)((t=>t.workspaces[e].context));if(Object(ft.parse)(t,n),n.errors.length>0){yield*kt(e),yield Object(L.d)(B.a.evalInterpreterError(n.errors,e));const t=[h.e.ERROR];yield Object(L.d)(B.a.addEvent(t))}else yield*kt(e),yield Object(L.d)(B.a.evalInterpreterSuccess("Ready to run!",e))}(t)})),yield pe(A.p,(function*(e){const t=e.payload.workspaceLocation;yield*At(t)})),yield pe(A.B,(function*(e){const t=e.payload.workspaceLocation,n=yield Object(L.f)((e=>e.workspaces[t].isEditorAutorun));yield Object(L.a)(G.e,"Autorun "+(n?"Started":"Stopped"),750)})),yield pe(A.r,(function*(t){const n=t.payload.workspaceLocation,s=yield Object(L.f)((e=>e.workspaces[n].replValue)),i=yield Object(L.f)((e=>e.workspaces[n].execTime));yield Object(L.d)(B.a.beginInterruptExecution(n)),yield Object(L.d)(B.a.clearReplInput(n)),yield Object(L.d)(B.a.sendReplInputToOutput(s,n)),e=yield Object(L.f)((e=>e.workspaces[n].context)),yield Object(L.a)(Nt,s,e,i,n,A.r)})),yield pe(w.d,(function*(t){const n=t.payload.workspaceLocation,s=yield Object(L.f)((e=>e.workspaces[n].editorTabs[0].value)),i=yield Object(L.f)((e=>e.workspaces[n].execTime));yield Object(L.d)(B.a.beginInterruptExecution(n)),yield Object(L.d)(B.a.clearReplOutput(n)),e=yield Object(L.f)((e=>e.workspaces[n].context)),yield Object(L.d)(B.a.highlightEditorLine([],n)),yield Object(L.a)(Nt,s,e,i,n,w.d)})),yield pe(w.c,(function*(t){const n=t.payload.workspaceLocation;e=yield Object(L.f)((e=>e.workspaces[n].context)),yield Object(L.d)(B.a.clearReplOutput(n)),yield Object(L.d)(B.a.highlightEditorLine([],n)),e.runtime.break=!1,Ct=void 0})),yield pe(w.l,(function*(e){const t=e.payload.highlightedLines;0===t.length?Object(k.f)():Object(k.g)(t[0]),yield})),yield pe(A.t,(function*(e){yield Object(L.d)(B.a.addEvent([h.e.RUN_TESTCASE]));const t=e.payload.workspaceLocation,n=e.payload.testcaseId;yield*_t(t,n)})),yield pe(A.j,(function*(e){const{workspaceLocation:t,chapter:n,variant:s}=e.payload,[i,a,r,o,l]=yield Object(L.f)((e=>[e.workspaces[t].context.variant,e.workspaces[t].context.externalSymbols,e.workspaces[t].globals,e.workspaces[t].externalLibrary]));if(n!==a||s!==i){const e={variant:s,external:{name:l,symbols:r},globals:o};yield Object(L.d)(B.a.beginClearContext(t,e,!1)),yield Object(L.d)(B.a.clearReplOutput(t)),yield Object(L.d)(B.a.debuggerReset(t)),yield Object(L.a)(G.d,`Switched to ${Object(c.o)(n,s)}`,1e3)}})),yield pe(A.w,(function*(e){const{workspaceLocation:t,externalLibraryName:n}=e.payload,[s,i]=yield Object(L.f)((e=>[e.workspaces[t].globals,e.workspaces[t].externalLibrary])),a={external:{name:n,symbols:F.b.get(n)},globals:s};(n!==i||e.payload.initialise)&&(yield Object(L.d)(B.a.changeExternalLibrary(n,t)),yield Object(L.d)(B.a.beginClearContext(t,a,!0)),yield Object(L.d)(B.a.clearReplOutput(t)),e.payload.initialise||(yield Object(L.a)(G.d,`Switched to ${n} library`,1e3)))})),yield pe(A.b,(function*(e){xt.a.clear(),jt.a.clear();const t=e.payload.library.globals;for(const[n,s]of t)window[n]=s;yield Object(L.d)(B.a.endClearContext({...e.payload.library,moduleParams:{runes:{},phaser:yt.a}},e.payload.workspaceLocation)),yield})),yield pe(A.v,(function*(t){const n=t.payload.workspaceLocation;e=yield Object(L.f)((e=>e.workspaces[n].context))})),yield function(e,t){function*n(){try{const e=t(...arguments);he(e)&&(yield*e)}catch(e){ue(e)}}for(var s=arguments.length,i=new Array(s>2?s-2:0),a=2;a<s;a++)i[a-2]=arguments[a];return Object(L.j)(e,n,...i)}(A.q,(function*(e){const{workspaceLocation:t}=e.payload;yield Object(L.a)(At,t);const n=yield Object(L.f)((e=>e.workspaces[t].editorTestcases));if(n.length>0){yield Object(L.a)(G.d,"Running all testcases!",2e3);for(const e of n.keys()){yield new Promise((e=>setTimeout(e,0)));if(!(yield Object(L.a)(_t,t,e)))return}}}))}let Ct;function*Et(e){try{const t=Ct.context.runtime.nodes[0].loc.start.line-1,n=Ct.context.runtime.nodes[0].loc.end.line-1;yield Object(L.d)(B.a.highlightEditorLine([t,n],e)),Object(k.i)(Ct)}catch(t){yield Object(L.d)(B.a.highlightEditorLine([],e))}}function*Tt(e,t){const[n,s,i,a]=yield Object(L.f)((t=>[t.workspaces[e].context.externalSymbols,t.workspaces[e].externalLibrary,t.workspaces[e].globals,t.workspaces[e].context.variant])),r={variant:a,external:{name:s,symbols:n},globals:i};yield Object(L.d)(B.a.beginClearContext(e,r,!1)),yield Object(L.g)(A.o)}function*kt(e){yield Object(L.d)(B.a.handleConsoleLog(e,...Ot.a.dump()))}function*At(e){const[t,n,s,i]=yield Object(L.f)((t=>[t.workspaces[e].editorTabs[0].prependValue,t.workspaces[e].editorTabs[0].value,t.workspaces[e].execTime,t.session.remoteExecutionSession]));if(yield Object(L.d)(B.a.addEvent([h.e.RUN_CODE])),i&&i.workspace===e)yield Object(L.d)(B.a.remoteExecRun(n));else{yield Object(L.d)(B.a.beginInterruptExecution(e)),yield*Tt(e),yield Object(L.d)(B.a.clearReplOutput(e));const i=yield Object(L.f)((t=>t.workspaces[e].context));let a=n;if(Object(c.m)(i.chapter)&&Object(ft.parse)(a,i),!i.errors.length){const t=n.split("\n"),s=yield Object(L.f)((t=>t.workspaces[e].editorTabs[0].breakpoints));for(const n in s){if("string"!==typeof n)continue;const s=+n;if(i.errors=[],t[s]="debugger;"+t[s],a=t.join("\n"),Object(c.m)(i.chapter)&&Object(ft.parse)(a,i),i.errors.length){const t="Hint: Misplaced breakpoint at line "+(s+1)+".";yield Object(L.d)(B.a.sendReplInputToOutput(t,e))}}}if(i.errors=[],t.length){const n=Object(k.h)(i);yield Object(L.a)(Nt,t,n,s,e,A.s),yield*It(n,i,s,e)}yield Object(L.a)(Nt,a,i,s,e,A.p)}}function*_t(e,t){const[n,s,a,r]=yield Object(L.f)((n=>[n.workspaces[e].editorTabs[0].prependValue,n.workspaces[e].editorTabs[0].value,n.workspaces[e].editorTabs[0].postpendValue,n.workspaces[e].editorTestcases[t].program])),o=yield Object(L.f)((n=>n.workspaces[e].editorTestcases[t].type)),c=yield Object(L.f)((t=>t.workspaces[e].execTime));yield*Tt(e);const l=yield Object(L.f)((t=>t.workspaces[e].context)),d=Object(k.h)(l);yield Object(L.a)(Nt,n,d,c,e,A.s);const u=String(Object(i.random)(1048576,68719476736));return yield*It(d,l,c,e,u),yield Object(L.a)(Nt,s,l,c,e,A.s),l.errors.length?(yield Object(L.d)(B.a.evalTestcaseFailure(l.errors,e,t)),!1):(a&&(yield*function*(e,t,n,s,i){const a=Object(k.c)(e,t),r=Object(k.d)(a,i);yield Object(L.a)(Nt,r,e,n,s,A.s)}(d,l,c,e,u),yield Object(L.a)(Nt,a,d,c,e,A.s),yield*It(d,l,c,e,u)),yield*function*(e,t,n,s,i,a){yield Object(L.d)(B.a.resetTestcase(s,i));const{result:r,interrupted:o}=yield Object(L.e)({result:Object(L.a)(bt.runInContext,e,t,{scheduler:"preemptive",originalMaxExecTime:n,throwInfiniteLoops:!0}),interrupted:Object(L.g)(w.b)});if(o)return Object(bt.interrupt)(t),yield*kt(s),t.errors.push(new ut.InterruptedError(t.runtime.nodes[0])),yield Object(L.d)(B.a.endInterruptExecution(s)),void(yield Object(L.a)(G.e,`Execution of testcase ${i} aborted`,750));yield*kt(s),"error"===r.status?(yield Object(L.d)(B.a.evalInterpreterError(t.errors,s)),yield Object(L.d)(B.a.evalTestcaseFailure(t.errors,s,i))):"finished"===r.status&&(yield Object(L.d)(B.a.evalInterpreterSuccess(r.value,s)),yield Object(L.d)(B.a.evalTestcaseSuccess(r.value,s,i)));a===D.f.opaque&&(yield Object(L.d)(B.a.clearReplOutputLast(s)))}(r,d,c,e,t,o),!0)}function*It(e,t,n,s,i){const a=Object(k.c)(e,t);if(i){const t=Object(k.e)(a,i);yield Object(L.a)(Nt,t,e,n,s,A.s)}const r=Object(k.b)(a);yield Object(L.a)(Nt,r,e,n,s,A.s)}function*Nt(e,t,n,i,a){const r=yield Object(L.f)((e=>e.workspaces[i].stepLimit)),{result:o,interrupted:c,paused:l}=yield Object(L.e)({result:Object(L.a)(bt.runInContext,e,t,{scheduler:"preemptive",executionMethod:"interpreter",originalMaxExecTime:n,stepLimit:r,variant:s.Variant.DEFAULT,useSubst:!1}),interrupted:Object(L.g)(w.b),paused:Object(L.g)(w.a)});if(console.log("result:",o),c)return Object(bt.interrupt)(t),t.errors.push(new ut.InterruptedError(t.runtime.nodes[0])),yield Object(L.d)(B.a.debuggerReset(i)),yield Object(L.d)(B.a.endInterruptExecution(i)),void(yield Object(L.a)(G.e,"Execution aborted",750));if(l)return yield Object(L.d)(B.a.endDebuggerPause(i)),yield Object(L.a)(Et,i),void(yield Object(L.a)(G.e,"Execution paused",750));if(a===A.p&&(Ct=o),yield Object(L.a)(Et,i),"suspended"===o.status||"finished"===o.status||"suspended-non-det"===o.status){if("suspended"===o.status)return yield Object(L.d)(B.a.endDebuggerPause(i)),void(yield Object(L.d)(B.a.evalInterpreterSuccess("Breakpoint hit!",i)));yield*kt(i),a!==A.s&&(yield Object(L.d)(B.a.evalInterpreterSuccess(o.value,i))),a!==A.p&&a!==A.r||(t.errors.length>0&&(yield Object(L.d)(B.a.addEvent([h.e.ERROR]))),yield Object(L.d)(Object(St.notifyProgramEvaluated)(o,Ct,e,t,i)))}else{yield*kt(i),yield Object(L.d)(B.a.evalInterpreterError(t.errors,i));const e=t.errors;t.errors=[],t.errors=e;const n=t.errors.length>0?[h.e.ERROR]:[];yield Object(L.d)(B.a.addEvent(n))}}function*Pt(){yield Object(L.c)(T.b.useBackend?xe:ie),yield Object(L.c)(wt),yield Object(L.c)(Fe),yield Object(L.c)(ot),yield Object(L.c)(be),yield Object(L.c)(st),yield Object(L.c)(Ge),yield Object(L.c)(mt)}var Rt=n(245);const Mt=function(){const e=Object(o.a)(),t=[e],n=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({serialize:!0,maxAge:300})||r.d,a=function(e){if(!e)return;return{...c.k,session:{...c.k.session,...e.session?e.session:{},githubOctokitObject:{octokit:e.session.githubAccessToken?Object(Rt.a)(e.session.githubAccessToken):void 0}},workspaces:{...c.k.workspaces,playground:{...c.k.workspaces.playground,editorTabs:e.playgroundEditorValue?[{value:e.playgroundEditorValue,prependValue:"",postpendValue:"",highlightedLines:[],breakpoints:[]}]:c.k.workspaces.playground.editorTabs,isEditorAutorun:e.playgroundIsEditorAutorun?e.playgroundIsEditorAutorun:c.k.workspaces.playground.isEditorAutorun,externalLibrary:e.playgroundExternalLibrary?e.playgroundExternalLibrary:c.k.workspaces.playground.externalLibrary,context:{...c.k.workspaces.playground.context,chapter:e.playgroundSourceChapter?e.playgroundSourceChapter:s.Chapter.CALC,variant:e.playgroundSourceVariant?e.playgroundSourceVariant:c.k.workspaces.playground.context.variant}}}}}((()=>{try{const e=localStorage.getItem("storedState");if(!e)return;const t=Object(it.decompressFromUTF16)(e);if(!t)return;return JSON.parse(t)}catch(e){return void Object(G.e)("Error loading from local storage")}})())||c.k,l=n(Object(r.a)(...t)),d=Object(r.e)(M(),a,l);return e.run(Pt),d.subscribe(Object(i.throttle)((()=>{(e=>{try{const t={session:{accessToken:e.session.accessToken,refreshToken:e.session.refreshToken,courseRegId:e.session.courseRegId,role:e.session.role,name:e.session.name,userId:e.session.userId,courses:e.session.courses,courseId:e.session.courseId,courseName:e.session.courseName,courseShortName:e.session.courseShortName,viewable:e.session.viewable,enableGame:e.session.enableGame,enableAchievements:e.session.enableAchievements,enableSourcecast:e.session.enableSourcecast,moduleHelpText:e.session.moduleHelpText,assetsPrefix:e.session.assetsPrefix,assessmentConfigurations:e.session.assessmentConfigurations,githubAccessToken:e.session.githubAccessToken},achievements:e.achievement.achievements,playgroundEditorValue:e.workspaces.playground.editorTabs[0].value,playgroundIsEditorAutorun:e.workspaces.playground.isEditorAutorun,playgroundSourceChapter:s.Chapter.CALC,playgroundSourceVariant:e.workspaces.playground.context.variant,playgroundExternalLibrary:e.workspaces.playground.externalLibrary},n=Object(it.compressToUTF16)(JSON.stringify(t));localStorage.setItem("storedState",n)}catch(t){Object(G.e)("Error saving to local storage")}})(d.getState())}),1e3)),d}()},86:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return p}));var s=n(27),i=n(69);const a="REMOTE_EXEC_FETCH_DEVICES",r="REMOTE_EXEC_UPDATE_DEVICES",o="REMOTE_EXEC_UPDATE_SESSION",c="REMOTE_EXEC_CONNECT",l="REMOTE_EXEC_DISCONNECT",d="REMOTE_EXEC_RUN",u="REMOTE_EXEC_REPL_INPUT",h=[{id:"EV3",name:"Lego Mindstorms EV3",internalFunctions:["ev3_pause","ev3_connected","ev3_motorA","ev3_motorB","ev3_motorC","ev3_motorD","ev3_motorGetSpeed","ev3_motorSetSpeed","ev3_motorStart","ev3_motorStop","ev3_motorSetStopAction","ev3_motorGetPosition","ev3_runForTime","ev3_runToAbsolutePosition","ev3_runToRelativePosition","ev3_colorSensor","ev3_colorSensorRed","ev3_colorSensorGreen","ev3_colorSensorBlue","ev3_reflectedLightIntensity","ev3_ambientLightIntensity","ev3_colorSensorGetColor","ev3_ultrasonicSensor","ev3_ultrasonicSensorDistance","ev3_gyroSensor","ev3_gyroSensorAngle","ev3_gyroSensorRate","ev3_touchSensor1","ev3_touchSensor2","ev3_touchSensor3","ev3_touchSensor4","ev3_touchSensorPressed","ev3_hello","ev3_waitForButtonPress","ev3_speak","ev3_playSequence","ev3_ledLeftGreen","ev3_ledLeftRed","ev3_ledRightGreen","ev3_ledRightRed","ev3_ledGetBrightness","ev3_ledSetBrightness"],languageChapter:s.Chapter.CALC,deviceLibraryName:i.a.EV3}],p=new Map(h.map((e=>[e.id,e])))},89:function(e,t,n){"use strict";var s=n(41),i=n(132),a=n(1),r=n(0);t.a=e=>(Object(a.useEffect)((()=>e.loadContentDispatch()),[]),Object(r.jsx)("div",{className:"ContentDisplay row center-xs",children:Object(r.jsx)("div",{className:(e.fullWidth?"col-md-12":"col-md-10 col-xs-11")+" contentdisplay-content-parent",children:Object(r.jsx)(s.e,{className:"contentdisplay-content",elevation:i.a.THREE,children:e.display})})}))},91:function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,a){function r(e){try{c(s.next(e))}catch(t){a(t)}}function o(e){try{c(s.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createContext=t.interrupt=t.resume=t.runFilesInContext=t.runInContext=t.parseError=t.SourceDocumentation=void 0;const i=n(555),a=n(241);t.createContext=a.default;const r=n(136);var o=n(363);Object.defineProperty(t,"SourceDocumentation",{enumerable:!0,get:function(){return o.SourceDocumentation}});const c=n(277),l=n(368),d=n(564);function u(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return s(this,void 0,void 0,(function*(){for(const t in e){const e=(0,l.validateFilePath)(t);if(null!==e)return n.errors.push(e),d.resolvedErrorPromise}return void 0===e[t]?(n.errors.push(new c.CannotFindModuleError(t)),d.resolvedErrorPromise):(0,d.sourceFilesRunner)(e,t,n,i)}))}"undefined"!==typeof window&&i.SourceMapConsumer.initialize({"lib/mappings.wasm":"https://unpkg.com/source-map@0.7.3/lib/mappings.wasm"}),t.parseError=function(e){return e.map((e=>e.explain())).join("\n")},t.runInContext=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(this,void 0,void 0,(function*(){const s="/default.js",i={};return i["/default.js"]=e,u(i,s,t,n)}))},t.runFilesInContext=u,t.resume=function(e){return"finished"===e.status||"error"===e.status?e:e.scheduler.run(e.it,e.context)},t.interrupt=function(e){const t=e.runtime.environments[e.runtime.environments.length-1];e.runtime.environments=[t],e.runtime.isRunning=!1,e.errors.push(new r.InterruptedError(e.runtime.nodes[0]))}},92:function(e,t,n){"use strict";n.r(t),n.d(t,"saveSourcecastData",(function(){return a})),n.d(t,"setCurrentPlayerTime",(function(){return r})),n.d(t,"setCodeDeltasToApply",(function(){return o})),n.d(t,"setInputToApply",(function(){return c})),n.d(t,"setSourcecastData",(function(){return l})),n.d(t,"setSourcecastDuration",(function(){return d})),n.d(t,"setSourcecastStatus",(function(){return u}));var s=n(7),i=n(36);const a=(e,t,n,a,r,o)=>Object(s.action)(i.d,{title:e,description:t,uid:n,audio:a,audioUrl:window.URL.createObjectURL(a),playbackData:r,workspaceLocation:o}),r=(e,t)=>Object(s.action)(i.f,{playerTime:e,workspaceLocation:t}),o=(e,t)=>Object(s.action)(i.e,{deltas:e,workspaceLocation:t}),c=(e,t)=>Object(s.action)(i.g,{inputToApply:e,workspaceLocation:t}),l=(e,t,n,a,r,o)=>Object(s.action)(i.h,{title:e,description:t,uid:n,audioUrl:a,playbackData:r,workspaceLocation:o}),d=(e,t)=>Object(s.action)(i.i,{duration:e,workspaceLocation:t}),u=(e,t)=>Object(s.action)(i.j,{playbackStatus:e,workspaceLocation:t})},93:function(e,t,n){"use strict";n.r(t),n.d(t,"bulkUpdateAchievements",(function(){return a})),n.d(t,"bulkUpdateGoals",(function(){return r})),n.d(t,"getAchievements",(function(){return o})),n.d(t,"getGoals",(function(){return c})),n.d(t,"getOwnGoals",(function(){return l})),n.d(t,"getUserAssessmentOverviews",(function(){return d})),n.d(t,"getUsers",(function(){return u})),n.d(t,"removeAchievement",(function(){return h})),n.d(t,"removeGoal",(function(){return p})),n.d(t,"updateOwnGoalProgress",(function(){return g})),n.d(t,"addEvent",(function(){return m})),n.d(t,"handleEvent",(function(){return b})),n.d(t,"updateGoalProgress",(function(){return f})),n.d(t,"saveAchievements",(function(){return v})),n.d(t,"saveGoals",(function(){return y})),n.d(t,"saveUsers",(function(){return j})),n.d(t,"saveUserAssessmentOverviews",(function(){return x}));var s=n(7),i=n(25);const a=e=>Object(s.action)(i.c,e),r=e=>Object(s.action)(i.d,e),o=()=>Object(s.action)(i.g),c=e=>Object(s.action)(i.h,e),l=()=>Object(s.action)(i.i),d=e=>Object(s.action)(i.k,e),u=()=>Object(s.action)(i.j),h=e=>Object(s.action)(i.n,e),p=e=>Object(s.action)(i.o,e),g=e=>Object(s.action)(i.u,e),m=e=>Object(s.action)(i.a,e),b=e=>Object(s.action)(i.m,e),f=(e,t)=>Object(s.action)(i.t,{studentCourseRegId:e,progress:t}),v=e=>Object(s.action)(i.p,e),y=e=>Object(s.action)(i.q,e),j=e=>Object(s.action)(i.r,e),x=e=>Object(s.action)(i.s,e)},94:function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var s=n(147),i=n(32),a=n.n(i),r=n(1),o=(n(350),n(525),n(351),n(139)),c=n.n(o),l=n(129),d=n(36),u=n(0);class h extends r.PureComponent{constructor(e){super(e),this.ShareAce=void 0,this.AceEditor=void 0,this.onChangeMethod=void 0,this.onCursorChange=void 0,this.onSelectionChange=void 0,this.getMarkers=()=>{const e=[];for(const t of this.props.highlightedLines)e.push({startRow:t[0],startCol:0,endRow:t[1],endCol:1,className:"myMarker",type:"fullLine"});return e},this.handleGutterClick=e=>{const t=e.domEvent.target;if(-1===t.className.indexOf("ace_gutter-cell")||!e.editor.isFocused()||e.clientX>35+t.getBoundingClientRect().left)return;const n=e.getDocumentPosition().row,s=e.editor.session.getLine(n);void 0!==e.editor.session.getBreakpoints(n,0)[n]||0===s.length||s.includes("//")||s.includes("debugger;")?e.editor.session.clearBreakpoint(n):e.editor.session.setBreakpoint(n),e.stop(),this.props.handleEditorUpdateBreakpoints(e.editor.session.$breakpoints)},this.handleAnnotationChange=e=>()=>{const t=e.getAnnotations();let n=0;for(const e of t)"info"===e.type&&(e.type="error",e.className="ace_error",n++);0!==n&&e.setAnnotations(t)},this.handleEvaluate=()=>{this.props.handleEditorEval(),this.props.isRecording&&this.props.handleRecordInput({type:"keyboardCommand",time:this.props.getTimerDuration(),data:d.a.run})},this.moveCursor=e=>{this.AceEditor.current.editor.selection.clearSelection(),this.AceEditor.current.editor.moveCursorToPosition(e),this.AceEditor.current.editor.renderer.showCursor(),this.AceEditor.current.editor.renderer.scrollCursorIntoView(e,.5)},this.handleDeclarationNavigate=()=>{this.props.handleDeclarationNavigate(this.AceEditor.current.editor.getCursorPosition())},this.AceEditor=r.createRef(),this.ShareAce=null,this.onChangeMethod=(e,t)=>{this.props.handleUpdateHasUnsavedChanges&&this.props.handleUpdateHasUnsavedChanges(!0),this.props.handleEditorValueChange(e),this.props.isRecording&&this.props.handleRecordInput({type:"codeDelta",time:this.props.getTimerDuration(),data:t});const n=this.AceEditor.current.editor.getSession().getAnnotations();this.props.isEditorAutorun&&0===n.length&&this.props.handleEditorEval()},this.onCursorChange=e=>{if(!this.props.isRecording)return;const t=e.getCursor();this.props.handleRecordInput({type:"cursorPositionChange",time:this.props.getTimerDuration(),data:t})},this.onSelectionChange=e=>{if(!this.props.isRecording)return;const t=e.getRange(),n=e.isBackwards();Object(i.isEqual)(t.start,t.end)||this.props.handleRecordInput({type:"selectionRangeData",time:this.props.getTimerDuration(),data:{range:t,isBackwards:n}})}}componentDidUpdate(e){const{codeDeltasToApply:t,inputToApply:n,newCursorPosition:s}=this.props;if(t&&t!==e.codeDeltasToApply&&(this.AceEditor.current.editor.session.getDocument().applyDeltas(t),this.AceEditor.current.editor.selection.clearSelection()),s&&s!==e.newCursorPosition&&this.moveCursor(s),n&&n!==e.inputToApply)switch(n.type){case"codeDelta":this.AceEditor.current.editor.session.getDocument().applyDelta(n.data),this.AceEditor.current.editor.selection.clearSelection();break;case"cursorPositionChange":this.moveCursor(n.data);break;case"selectionRangeData":const{range:e,isBackwards:t}=n.data;this.AceEditor.current.editor.selection.setRange(e,t);break;case"keyboardCommand":if("run"===n.data)this.props.handleEditorEval(),this.props.setDraggableReplPosition&&this.props.setDraggableReplPosition()}}getBreakpoints(){return this.AceEditor.current.editor.session.getBreakpoints().filter((e=>null!=e))}componentDidMount(){if(!this.AceEditor||!this.AceEditor.current||!this.AceEditor.current.editor)return;const e=this.AceEditor.current.editor,t=e.getSession();e.on("gutterclick",this.handleGutterClick),t.on("changeAnnotation",this.handleAnnotationChange(t));const{onFocus:n,onBlur:s}=this.props;n&&e.on("focus",(t=>n(t,e))),s&&e.on("blur",(t=>s(t,e)))}componentWillUnmount(){null!==this.ShareAce&&this.ShareAce.WS.close(),this.ShareAce=null}render(){return Object(u.jsx)(l.HotKeys,{className:"Editor bp4-card bp4-elevation-0",handlers:p,children:Object(u.jsx)("div",{className:"row editor-react-ace",children:Object(u.jsx)(c.a,{className:"react-ace",commands:[{name:"evaluate",bindKey:{win:"Shift-Enter",mac:"Shift-Enter"},exec:this.handleEvaluate},{name:"navigate",bindKey:{win:"Ctrl-B",mac:"Command-B"},exec:this.handleDeclarationNavigate}],editorProps:{$blockScrolling:1/0},ref:this.AceEditor,markers:this.getMarkers(),fontSize:17,height:"100%",highlightActiveLine:!1,mode:"javascript",onChange:this.onChangeMethod,onCursorChange:this.onCursorChange,onSelectionChange:this.onSelectionChange,readOnly:this.props.isEditorReadonly,theme:"source",value:this.props.editorValue,width:"100%",setOptions:{fontFamily:"'Inconsolata', 'Consolas', monospace"}})})})}}const p={goGreen:()=>{}};var g=h,m=(n(532),n(27));const b={evaluate:{win:"Shift-Enter",mac:"Shift-Enter"},navigate:{win:"Ctrl-B",mac:"Command-B"},refactor:{win:"Ctrl-M",mac:"Command-M"},highlightScope:{win:"Ctrl-Shift-H",mac:"Command-Shift-H"},typeInferenceDisplay:{win:"Ctrl-Shift-M",mac:"Command-Shift-M"}};var f=n(1167),v=n(437),y=n.n(v),j=n(200);var x=(e,t,n,s)=>{const i=r.useRef(e);i.current=e;const{editorSessionId:a}=e;r.useEffect((()=>{if(!a)return;const e=s.current.editor,t=new y.a(a,{WsUrl:Object(j.c)(a,!0),pluginWsUrl:null,namespace:"sa"});t.on("ready",(()=>{t.add(e,[],[]),i.current.handleSetSharedbConnected(!0)})),t.on("error",((e,t)=>{console.error("ShareAce error",t),f.a(t)}));const n=t.WS;let r;return r=setInterval((async()=>{if(null!==t)try{await Object(j.a)(a)||(clearInterval(r),n.close())}catch{n.reconnect()}}),5e3),n.addEventListener("open",(()=>{i.current.handleSetSharedbConnected(!0)})),n.addEventListener("close",(()=>{i.current.handleSetSharedbConnected(!1)})),()=>{clearInterval(r);for(const e of Object.values(t.connections))e.unlisten();t.WS.close()}}),[a,s])},O=n(206),S=n(141);const w=["onSelectionChange","onCursorChange","onInput","onLoad","onValidate","onBeforeLoad","onChange","onSelection","onCopy","onPaste","onFocus","onBlur","onScroll"],C={goGreen:()=>{}},E=r.memo((e=>{const t=r.useRef(null),n=r.useRef(e.handleEditorUpdateBreakpoints),i=r.useRef(e.handlePromptAutocomplete);r.useEffect((()=>{n.current=e.handleEditorUpdateBreakpoints,i.current=e.handlePromptAutocomplete}),[e.handleEditorUpdateBreakpoints,e.handlePromptAutocomplete]),r.useEffect((()=>(/iPhone|iPad|iPod/.test(navigator.userAgent)&&(document.body.style.position="fixed",document.body.style.width="100%"),()=>{document.body.style.position="",document.body.style.width=""})),[]);const[a,o,d]=[e.sourceChapter||m.Chapter.CALC,e.sourceVariant||m.Variant.DEFAULT,e.externalLibraryName||"NONE"];Object(O.b)(a,o,d),r.useLayoutEffect((()=>{if(!t.current)return;const e=t.current.editor,a=e.getSession();var r,o;e.on("gutterclick",(r=function(){return n.current(...arguments)},e=>{const t=e.domEvent.target;if(-1===t.className.indexOf("ace_gutter-cell")||!e.editor.isFocused()||e.clientX>35+t.getBoundingClientRect().left)return;const n=e.getDocumentPosition().row,s=e.editor.session.getLine(n);void 0!==e.editor.session.getBreakpoints()[n]||0===s.length||s.includes("//")||s.includes("debugger;")?e.editor.session.clearBreakpoint(n):e.editor.session.setBreakpoint(n,void 0),e.stop(),r(e.editor.session.getBreakpoints())})),a.on("changeAnnotation",(e=>()=>{const t=e.getAnnotations();let n=0;for(const e of t)"info"===e.type&&(e.type="error",e.className="ace_error",n++);0!==n&&e.setAnnotations(t)})(a)),Object(s.require)("ace/ext/language_tools").setCompleters([(o=function(){return i.current(...arguments)},{getCompletions:(e,t,n,s,i)=>{s&&/\d/.test(s.charAt(0))?i():o(n.row+1,n.column,i)}})])}),[]),r.useLayoutEffect((()=>{if(!t.current)return;const n=e.newCursorPosition;var s,i;n&&(s=t.current.editor,i=n,s.selection.clearSelection(),s.moveCursorToPosition(i),s.renderer.showCursor(),s.renderer.scrollCursorIntoView(i,.5))}),[e.newCursorPosition]);const{handleUpdateHasUnsavedChanges:h,handleEditorValueChange:p,isEditorAutorun:g,handleEditorEval:f,handleEditorCheck:v}=e,y={evaluate:f},j={className:"react-ace",editorProps:{$blockScrolling:1/0},markers:r.useMemo((()=>e.highlightedLines.map((e=>({startRow:e[0],startCol:0,endRow:e[1],endCol:1,className:"myMarker",type:"fullLine"})))),[e.highlightedLines]),fontSize:17,height:"100%",highlightActiveLine:!1,mode:Object(O.a)(a,o,d),theme:"source",value:e.editorValue,width:"100%",setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,fontFamily:"'Inconsolata', 'Consolas', monospace"},keyboardHandler:e.editorBinding},[x]=r.useState(e.hooks);if(x)for(const s of x)s(e,j,y,t);const S=j.onChange;return j.onChange=r.useCallback(((e,n)=>{if(!t.current)return;p(e),h&&h(!0);const s=t.current.editor.getSession().getAnnotations();g&&0===s.length?f():v(),S&&S(e,n)}),[p,h,g,S,f,v]),j.commands=Object.entries(y).filter((e=>{let[t,n]=e;return n})).map((e=>{let[t,n]=e;return{name:t,bindKey:b[t],exec:n}})),w.forEach((t=>{const n=e[t];if(n){const e=j[t];j[t]=e?function(){e(...arguments),n(...arguments)}:n}})),Object(u.jsx)(l.HotKeys,{className:"Editor bp4-card bp4-elevation-0",handlers:C,children:Object(u.jsx)("div",{className:"row editor-react-ace",children:Object(u.jsx)(c.a,{...j,ref:t})})})})),T=[x];var k=e=>{const[t]=r.useContext(S.b);return Object(u.jsx)(E,{...e,editorBinding:t.editorBinding,hooks:T})};const A=e=>({editorValue:e.value,...a.a.pick(e,"highlightedLines","breakpoints","newCursorPosition")});t.b=e=>{let t;if("sourcecast"===e.editorVariant){const{editorVariant:n,editorTabs:s,...i}=e;t=(e=>t=>Object(u.jsx)(g,{...e,...t}))(i)}else{const{editorVariant:n,editorTabs:s,...i}=e;t=(e=>t=>Object(u.jsx)(k,{...e,...t}))(i)}return t(e.editorTabs[0])}},96:function(e,t,n){"use strict";n.d(t,"i",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"h",(function(){return h})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return b}));var s=n(241),i=n.n(s),a=n(27),r=(n(102),n(32)),o=n(158);n(195),n(261);function c(e){let{context:t}=e;try{o.a.drawEnv(t)}catch(n){throw new Error("Env visualizer is not enabled")}}function l(){if(!window.Inspector)throw new Error("Inspector not loaded");window.Inspector.highlightClean()}function d(e){if(!window.Inspector)throw new Error("Inspector not loaded");window.Inspector.highlightLine(e)}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.Variant.DEFAULT;return i()(n,e,t)}function h(e){function t(){}t.prototype=e.runtime.environments[0].head;const n=new t,s=new Proxy(e.runtime.environments[0],{get:(e,t,s)=>"head"===t?n:e[t]}),i=new Proxy(e.runtime.environments,{get:(e,t,n)=>"0"===t?s:e[t]}),a=new Proxy(e.runtime,{get:(e,t,n)=>"environments"===t?i:e[t]});return new Proxy(e,{get(e,t,n){switch(t){case"chapter":return 4;case"runtime":return a;default:return e[t]}}})}function p(e,t){const n=e.runtime.environments[0].head,s=t.runtime.environments[0].head;return Object(r.difference)(Object(r.keys)(n),Object(r.keys)(s))}function g(e,t){return`const _____${t} = [${e.join(", ")}];`}function m(e,t){const n=`_____${t}`;return e.map(((e,t)=>"makeUndefinedErrorFunction"===e?"":`const ${e} = ${n}[${t}];`)).join("\n")}function b(e){return e.map((e=>"makeUndefinedErrorFunction"===e?"":`const ${e} = makeUndefinedErrorFunction('${e}');`)).join("\n")}},99:function(e,t,n){"use strict";let s;n.d(t,"a",(function(){return s})),function(e){e.new="new",e.deadline="deadline",e.autograded="autograded",e.graded="graded",e.submitted="submitted",e.unsubmitted="unsubmitted",e.new_message="new_message"}(s||(s={}))}},[[1155,1,2]]]);
//# sourceMappingURL=main.e95e1d71.chunk.js.map